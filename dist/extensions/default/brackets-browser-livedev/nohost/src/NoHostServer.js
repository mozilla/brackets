define(function(require,exports,module){"use strict";var BaseServer=brackets.getModule("LiveDevelopment/Servers/BaseServer").BaseServer;var Content=require("nohost/src/content");var Handlers=require("nohost/src/handlers");var Rewriter=require("nohost/src/rewriter");var Log=require("nohost/src/log");var Filer=appshell.Filer;var Path=Filer.Path;function NoHostServer(config){config=config||{};BaseServer.call(this,config)}NoHostServer.prototype=Object.create(BaseServer.prototype);NoHostServer.prototype.constructor=NoHostServer;NoHostServer.prototype.pathToUrl=function(path){return path};NoHostServer.prototype.urlToPath=function(url){return url};NoHostServer.prototype.start=function(){this.fs=Filer.fs()};NoHostServer.prototype.stop=function(){this.fs=null};NoHostServer.prototype.add=function(liveDocument){if(liveDocument.setInstrumentationEnabled){liveDocument.setInstrumentationEnabled(true)}BaseServer.prototype.add.call(this,liveDocument)};NoHostServer.prototype.servePath=function(path,callback){var fs=this.fs;fs.stat(path,function(err,stats){if(err){return callback(err)}if(stats.isDirectory()){return callback(new Error("expected file path"))}var ext=Path.extname(path);if(Content.isHTML(ext)){Handlers.handleHTML(path,fs,callback)}else{Handlers.handleFile(path,fs,callback)}})};NoHostServer.prototype.serveHTML=function(html,path,callback){var fs=this.fs;Rewriter.rewriteHTML(html,path,fs,function(err,rewrittenHTML){if(err){Log.error("unable to rewrite HTML for `"+path+"`");return Handlers.handle404(path,callback)}callback(null,rewrittenHTML)})};NoHostServer.prototype.maybeServeLiveDoc=function(path,callback){var fs=this.fs;var liveDocument=this._liveDocuments[path];function toURL(err,html){if(err){callback(err);return}var url=Content.toURL(html,"text/html");callback(null,url)}if(liveDocument&&liveDocument.getResponseData){Rewriter.rewriteHTML(liveDocument.getResponseData().body,path,fs,toURL)}else{fs.readFile(path,"utf8",toURL)}};exports.NoHostServer=NoHostServer});