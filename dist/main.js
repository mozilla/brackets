function universalModule(){function e(e,t,n,r){var i;if(r){var o=r.prototype;i=yt.create(o)}else i=e.prototype;return yt.keys(t).forEach(function(e){i[e]=t[e]}),yt.keys(n).forEach(function(t){e[t]=n[t]}),i.constructor=e,e.prototype=i,e}function t(e,t,n,r){return yt.getPrototypeOf(t)[n].apply(e,r)}function n(e,n,r){t(e,n,"constructor",r)}function r(e){return e.value=!1,e}function i(e){e&&(e.value=!0)}function o(){}function a(e,t){t=t||0;for(var n=Math.max(0,e.length-t),r=new Array(n),i=0;n>i;i++)r[i]=e[i+t];return r}function s(e){return Dt.value=e,Dt.done=!1,Dt}function l(){return Dt.value=void 0,Dt.done=!0,Dt}function c(e,t){if(!e)throw new Error(t)}function u(e){if(!e)return 0;if(e===!0)return 1;var t=typeof e;if("number"===t){if((0|e)===e)return e&Mt;e=""+e,t="string"}return"string"===t?e.length>xt?d(e):p(e):e.hashCode?u("function"==typeof e.hashCode?e.hashCode():e.hashCode):h(e)}function d(e){var t=kt[e];return null==t&&(t=p(e),Pt===At&&(Pt=0,kt={}),Pt++,kt[e]=t),t}function p(e){for(var t=0,n=0;n<e.length;n++)t=31*t+e.charCodeAt(n)&Mt;return t}function h(e){if(e[Rt])return e[Rt];var t=++Lt&Mt;if(!Nt)try{return Object.defineProperty(e,Rt,{enumerable:!1,configurable:!1,writable:!1,value:t}),t}catch(n){Nt=!0}return e[Rt]=t,t}function f(){return Object.create(jt)}function m(e){var t=Object.create(Bt);return t.__reversedIndices=e?e.__reversedIndices:!1,t}function g(e,t,n,r){var i=e.get?e.get(t[r],It):It;return i===It?n:++r===t.length?i:g(i,t,n,r)}function v(e,t,n){return(0===e||null!=n&&-n>=e)&&(null==t||null!=n&&t>=n)}function y(e,t){return E(e,t,0)}function _(e,t){return E(e,t,t)}function E(e,t,n){return null==e?n:0>e?Math.max(0,t+e):t?Math.min(t,e):e}function b(e){return e}function S(e,t){return[t,e]}function I(){return!0}function w(){return this}function C(e){return(e||0)+1}function D(e,t,n,r,i){var o=e.__makeSequence();return o.__iterateUncached=function(o,a,s){var l=0,c=e.__iterate(function(e,i,a){if(t.call(n,e,i,a)){if(o(e,r?i:l,a)===!1)return!1;l++}},a,s);return i?c:l},o}function T(e){return function(){return!e.apply(this,arguments)}}function O(e){return"string"==typeof e?JSON.stringify(e):e}function M(e,t){for(var n="";t;)1&t&&(n+=e),(t>>=1)&&(e+=e);return n}function L(e,t){return e>t?1:t>e?-1:0}function R(e){c(1/0!==e,"Cannot perform this action with an infinite sequence.")}function N(e,t){var n=new Gt;return n.next=function(){var n=e.next();return n.done?n:(n.value=t(n.value),n)},n}function x(e,t,n){return n instanceof Ft?A(e,t,n):n}function A(e,t,n){return new qt(e._rootData,e._keyPath.concat(t),e._onChange,n)}function P(e,t,n){var r=e._rootData.updateIn(e._keyPath,n?zt.empty():void 0,t),i=e._keyPath||[];return e._onChange&&e._onChange.call(void 0,r,e._rootData,n?i.concat(n):i),new qt(r,e._keyPath,e._onChange)}function k(e,t){return e instanceof qt&&(e=e.deref()),t instanceof qt&&(t=t.deref()),e===t?0!==e||0!==t||1/e===1/t:e!==e?t!==t:e instanceof Ft?e.equals(t):!1}function F(e,t){return s(0===e||1===e?t[e]:[t[0],t[1]])}function U(e,t){return{node:e,index:0,__prev:t}}function j(e,t,n,r){var i=Object.create(Xt);return i.length=e,i._root=t,i.__ownerID=n,i.__hash=r,i.__altered=!1,i}function $(e,t,n){var i=r(wt),o=r(Ct),a=V(e._root,e.__ownerID,0,u(t),t,n,i,o);if(!o.value)return e;var s=e.length+(i.value?n===It?-1:1:0);return e.__ownerID?(e.length=s,e._root=a,e.__hash=void 0,e.__altered=!0,e):a?j(s,a):zt.empty()}function V(e,t,n,r,o,a,s,l){return e?e.update(t,n,r,o,a,s,l):a===It?e:(i(l),i(s),new rn(t,r,[o,a]))}function B(e){return e.constructor===rn||e.constructor===tn}function H(e,t,n,r,i){if(e.hash===r)return new tn(t,r,[e.entry,i]);var o,a=(0===n?e.hash:e.hash>>>n)&St,s=(0===n?r:r>>>n)&St,l=a===s?[H(e,t,n+Et,r,i)]:(o=new rn(t,r,i),s>a?[e,o]:[o,e]);return new Qt(t,1<<a|1<<s,l)}function W(e,t,n,r){for(var i=0,o=0,a=new Array(n),s=0,l=1,c=t.length;c>s;s++,l<<=1){var u=t[s];null!=u&&s!==r&&(i|=l,a[o++]=u)}return new Qt(e,i,a)}function G(e,t,n,r,i){for(var o=0,a=new Array(bt),s=0;0!==n;s++,n>>>=1)a[s]=1&n?t[o++]:null;return a[r]=i,new Zt(e,o+1,a)}function K(e,t,n){for(var r=[],i=0;i<n.length;i++){var o=n[i];o&&r.push(Array.isArray(o)?Ft(o).fromEntrySeq():Ft(o))}return z(e,t,r)}function q(e){return function(t,n){return t&&t.mergeDeepWith?t.mergeDeepWith(e,n):e?e(t,n):n}}function z(e,t,n){return 0===n.length?e:e.withMutations(function(e){for(var r=t?function(n,r){var i=e.get(r,It);e.set(r,i===It?n:t(i,n))}:function(t,n){e.set(n,t)},i=0;i<n.length;i++)n[i].forEach(r)})}function Y(e,t,n,r,i){var o=t.length;if(i===o)return r(e);c(e.set,"updateIn with invalid keyPath");var a=i===o-1?n:zt.empty(),s=t[i],l=e.get(s,a),u=Y(l,t,n,r,i+1);return u===l?e:e.set(s,u)}function X(e){return e-=e>>1&1431655765,e=(858993459&e)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,127&e}function Q(e,t,n,r){var i=r?e:a(e);return i[t]=n,i}function J(e,t,n,r){var i=e.length+1;if(r&&t+1===i)return e[t]=n,e;for(var o=new Array(i),a=0,s=0;i>s;s++)s===t?(o[s]=n,a=-1):o[s]=e[s+a];return o}function Z(e,t,n){var r=e.length-1;if(n&&t===r)return e.pop(),e;for(var i=new Array(r),o=0,a=0;r>a;a++)a===t&&(o=1),i[a]=e[a+o];return i}function et(e,t,n,r,i,o){if(e){var a,s=e.array,l=s.length-1;if(0===t)for(a=0;l>=a;a++){var c=o?l-a:a;if(s.hasOwnProperty(c)){var u=c+n;if(u>=0&&r>u&&i(s[c],u)===!1)return!1}}else{var d=1<<t,p=t-Et;for(a=0;l>=a;a++){var h=o?l-a:a,f=n+h*d;if(r>f&&f+d>0){var m=s[h];if(m&&!et(m,p,f,r,i,o))return!1}}}}return!0}function tt(e,t,n,r,i){return{array:e,level:t,offset:n,max:r,rawMax:r-n>>t,index:0,__prev:i}}function nt(e,t,n,r,i,o,a){var s=Object.create(pn);return s.length=t-e,s._origin=e,s._size=t,s._level=n,s._root=r,s._tail=i,s.__ownerID=o,s.__hash=a,s.__altered=!1,s}function rt(e,t,n){if(t>=e.length)return n===It?e:e.withMutations(function(e){st(e,0,t+1).set(t,n)});t=ct(t,e._origin);var i=e._tail,o=e._root,a=r(Ct);return t>=ut(e._size)?i=it(i,e.__ownerID,0,t,n,a):o=it(o,e.__ownerID,e._level,t,n,a),a.value?e.__ownerID?(e._root=o,e._tail=i,e.__hash=void 0,e.__altered=!0,e):nt(e._origin,e._size,e._level,o,i):e}function it(e,t,n,r,o,a){var s,l=o===It,c=r>>>n&St,u=e&&c<e.array.length&&e.array.hasOwnProperty(c);if(l&&!u)return e;if(n>0){var d=e&&e.array[c],p=it(d,t,n-Et,r,o,a);return p===d?e:(s=ot(e,t),s.array[c]=p,s)}return!l&&u&&e.array[c]===o?e:(i(a),s=ot(e,t),l?delete s.array[c]:s.array[c]=o,s)}function ot(e,t){return t&&e&&t===e.ownerID?e:new hn(e?e.array.slice():[],t)}function at(e,t){if(t>=ut(e._size))return e._tail;if(t<1<<e._level+Et){for(var n=e._root,r=e._level;n&&r>0;)n=n.array[t>>>r&St],r-=Et;return n}}function st(e,t,n){var r=e.__ownerID||new o,i=e._origin,a=e._size,s=i+t,l=null==n?a:0>n?a+n:i+n;if(s===i&&l===a)return e;if(s>=l)return e.clear();for(var c=e._level,u=e._root,d=0;0>s+d;)u=new hn(u&&u.array.length?[null,u]:[],r),c+=Et,d+=1<<c;d&&(s+=d,i+=d,l+=d,a+=d);for(var p=ut(a),h=ut(l);h>=1<<c+Et;)u=new hn(u&&u.array.length?[u]:[],r),c+=Et;var f=e._tail,m=p>h?at(e,l-1):h>p?new hn([],r):f;if(f&&h>p&&a>s&&f.array.length){u=ot(u,r);for(var g=u,v=c;v>Et;v-=Et){var y=p>>>v&St;g=g.array[y]=ot(g.array[y],r)}g.array[p>>>Et&St]=f}if(a>l&&(m=m&&m.removeAfter(r,0,l)),s>=h)s-=h,l-=h,c=Et,u=null,m=m&&m.removeBefore(r,0,s);else if(s>i||p>h){var _,E;d=0;do _=s>>>c&St,E=h-1>>>c&St,_===E&&(_&&(d+=(1<<c)*_),c-=Et,u=u&&u.array[_]);while(u&&_===E);u&&s>i&&(u=u&&u.removeBefore(r,c,s-d)),u&&p>h&&(u=u&&u.removeAfter(r,c,h-d)),d&&(s-=d,l-=d)}return e.__ownerID?(e.length=l-s,e._origin=s,e._size=l,e._level=c,e._root=u,e._tail=m,e.__hash=void 0,e.__altered=!0,e):nt(s,l,c,u,m)}function lt(e,t,n){for(var r=[],i=0;i<n.length;i++){var o=n[i];o&&r.push(Ft(o))}var a=Math.max.apply(null,r.map(function(e){return e.length||0}));return a>e.length&&(e=e.setLength(a)),z(e,t,r)}function ct(e,t){return c(e>=0,"Index out of bounds"),e+t}function ut(e){return bt>e?0:e-1>>>Et<<Et}function dt(e,t){var n=Object.create(_n);return n.length=e?e.length:0,n._map=e,n.__ownerID=t,n}function pt(e,t,n,r){var i=Object.create(bn.prototype);return i.length=e?e.length:0,i._map=e,i._vector=t,i.__ownerID=n,i.__hash=r,i}function ht(e,t,n){var r=e._map,i=e._vector,o=r.get(t),a=void 0!==o,s=n===It;if(!a&&s||a&&n===i.get(o)[1])return e;a||(o=i.length);var l=s?r.remove(t):a?r:r.set(t,o),c=s?i.remove(o):i.set(o,[t,n]);return e.__ownerID?(e.length=l.length,e._map=l,e._vector=c,e.__hash=void 0,e):pt(l,c)}function ft(e,t,n){var r=Object.create(Object.getPrototypeOf(e));return r._map=t,r.__ownerID=n,r}function mt(e,t){return t?gt(t,e,"",{"":e}):vt(e)}function gt(e,t,n,r){return t&&(Array.isArray(t)||t.constructor===Object)?e.call(r,n,Ft(t).map(function(n,r){return gt(e,n,r,t)})):t}function vt(e){if(e){if(Array.isArray(e))return Ft(e).map(vt).toVector();if(e.constructor===Object)return Ft(e).map(vt).toMap()}return e}var yt=Object,_t={};_t.createClass=e,_t.superCall=t,_t.defaultSuperCall=n;var Et=5,bt=1<<Et,St=bt-1,It={},wt={value:!1},Ct={value:!1},Dt={value:void 0,done:!1},Tt="delete",Ot="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",Mt=2147483647,Lt=0,Rt="__immutablehash__";"undefined"!=typeof Symbol&&(Rt=Symbol(Rt));var Nt=!1,xt=16,At=255,Pt=0,kt={},Ft=function(e){return Ut.from(1===arguments.length?e:Array.prototype.slice.call(arguments))},Ut=Ft;_t.createClass(Ft,{toString:function(){return this.__toString("Seq {","}")},__toString:function(e,t){return 0===this.length?e+t:e+" "+this.map(this.__toStringMapper).join(", ")+" "+t},__toStringMapper:function(e,t){return t+": "+O(e)},toJS:function(){return this.map(function(e){return e instanceof Ut?e.toJS():e}).__toJS()},toArray:function(){R(this.length);var e=new Array(this.length||0);return this.valueSeq().forEach(function(t,n){e[n]=t}),e},toObject:function(){R(this.length);var e={};return this.forEach(function(t,n){e[n]=t}),e},toVector:function(){return R(this.length),un.from(this)},toMap:function(){return R(this.length),zt.from(this)},toOrderedMap:function(){return R(this.length),bn.from(this)},toSet:function(){return R(this.length),vn.from(this)},hashCode:function(){return this.__hash||(this.__hash=1/0===this.length?0:this.reduce(function(e,t,n){return e+(u(t)^(t===n?0:u(n)))&Mt},0))},equals:function(e){if(this===e)return!0;if(!(e instanceof Ut))return!1;if(null!=this.length&&null!=e.length){if(this.length!==e.length)return!1;if(0===this.length&&0===e.length)return!0}return null!=this.__hash&&null!=e.__hash&&this.__hash!==e.__hash?!1:this.__deepEquals(e)},__deepEquals:function(e){var t=this.cacheResult().entrySeq().toArray(),n=0;return e.every(function(e,r){var i=t[n++];return k(r,i[0])&&k(e,i[1])})},join:function(e){e=e||",";var t="",n=!0;return this.forEach(function(r){n?(n=!1,t+=r):t+=e+r}),t},count:function(e,t){return e?this.filter(e,t).count():(null==this.length&&(this.length=this.forEach(I)),this.length)},countBy:function(e){var t=this;return bn.empty().withMutations(function(n){t.forEach(function(t,r,i){n.update(e(t,r,i),C)})})},concat:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=[this].concat(e.map(function(e){return Ut(e)})),r=this.__makeSequence();return r.length=n.reduce(function(e,t){return null!=e&&null!=t.length?e+t.length:void 0},0),r.__iterateUncached=function(e,t){for(var r,i=0,o=n.length-1,a=0;o>=a&&!r;a++){var s=n[t?o-a:a];i+=s.__iterate(function(t,n,i){return e(t,n,i)===!1?(r=!0,!1):void 0},t)}return i},r},reverse:function(){var e=this,t=e.__makeSequence();return t.length=e.length,t.__iterateUncached=function(t,n){return e.__iterate(t,!n)},t.reverse=function(){return e},t},keySeq:function(){return this.flip().valueSeq()},valueSeq:function(){var e=this,t=m(e);return t.length=e.length,t.valueSeq=w,t.__iterateUncached=function(t,n,r){if(r&&null==this.length)return this.cacheResult().__iterate(t,n,r);var i,o=0;return r?(o=this.length-1,i=function(e,n,r){return t(e,o--,r)!==!1}):i=function(e,n,r){return t(e,o++,r)!==!1},e.__iterate(i,n),r?this.length:o},t},entrySeq:function(){var e=this;if(e._cache)return Ut(e._cache);var t=e.map(S).valueSeq();return t.fromEntries=function(){return e},t},forEach:function(e,t){return this.__iterate(t?e.bind(t):e)},reduce:function(e,t,n){var r=t;return this.forEach(function(t,i,o){r=e.call(n,r,t,i,o)}),r},reduceRight:function(e,t,n){return this.reverse(!0).reduce(e,t,n)},every:function(e,t){var n=!0;return this.forEach(function(r,i,o){return e.call(t,r,i,o)?void 0:(n=!1,!1)}),n},some:function(e,t){return!this.every(T(e),t)},first:function(){return this.find(I)},last:function(){return this.findLast(I)},rest:function(){return this.slice(1)},butLast:function(){return this.slice(0,-1)},has:function(e){return this.get(e,It)!==It},get:function(e,t){return this.find(function(t,n){return k(n,e)},null,t)},getIn:function(e,t){return e&&0!==e.length?g(this,e,t,0):this},contains:function(e){return this.find(function(t){return k(t,e)},null,It)!==It},find:function(e,t,n){var r=n;return this.forEach(function(n,i,o){return e.call(t,n,i,o)?(r=n,!1):void 0}),r},findKey:function(e,t){var n;return this.forEach(function(r,i,o){return e.call(t,r,i,o)?(n=i,!1):void 0}),n},findLast:function(e,t,n){return this.reverse(!0).find(e,t,n)},findLastKey:function(e,t){return this.reverse(!0).findKey(e,t)},flip:function(){var e=this,t=f();return t.length=e.length,t.flip=function(){return e},t.__iterateUncached=function(t,n){return e.__iterate(function(e,n,r){return t(n,e,r)!==!1},n)},t},map:function(e,t){var n=this,r=n.__makeSequence();return r.length=n.length,r.__iterateUncached=function(r,i){return n.__iterate(function(n,i,o){return r(e.call(t,n,i,o),i,o)!==!1},i)},r},mapKeys:function(e,t){var n=this,r=n.__makeSequence();return r.length=n.length,r.__iterateUncached=function(r,i){return n.__iterate(function(n,i,o){return r(n,e.call(t,i,n,o),o)!==!1},i)},r},filter:function(e,t){return D(this,e,t,!0,!1)},slice:function(e,t){if(v(e,t,this.length))return this;var n=y(e,this.length),r=_(t,this.length);if(n!==n||r!==r)return this.entrySeq().slice(e,t).fromEntrySeq();var i=0===n?this:this.skip(n);return null==r||r===this.length?i:i.take(r-n)},take:function(e){var t=this;if(e>t.length)return t;var n=t.__makeSequence();return n.__iterateUncached=function(n,r,i){if(r)return this.cacheResult().__iterate(n,r,i);var o=0;return t.__iterate(function(t,r,i){return e>o&&n(t,r,i)!==!1?void o++:!1},r,i),o},n.length=this.length&&Math.min(this.length,e),n},takeLast:function(e,t){return this.reverse(t).take(e).reverse(t)},takeWhile:function(e,t){var n=this,r=n.__makeSequence();return r.__iterateUncached=function(r,i,o){if(i)return this.cacheResult().__iterate(r,i,o);var a=0;return n.__iterate(function(n,i,o){return e.call(t,n,i,o)&&r(n,i,o)!==!1?void a++:!1},i,o),a},r},takeUntil:function(e,t,n){return this.takeWhile(T(e),t,n)},skip:function(e){var t=this;if(0===e)return t;var n=t.__makeSequence();return n.__iterateUncached=function(n,r,i){if(r)return this.cacheResult().__iterate(n,r,i);var o=!0,a=0,s=0;return t.__iterate(function(t,r,i){if(!o||!(o=s++<e)){if(n(t,r,i)===!1)return!1;a++}},r,i),a},n.length=this.length&&Math.max(0,this.length-e),n},skipLast:function(e,t){return this.reverse(t).skip(e).reverse(t)},skipWhile:function(e,t){var n=this,r=n.__makeSequence();return r.__iterateUncached=function(r,i,o){if(i)return this.cacheResult().__iterate(r,i,o);var a=!0,s=0;return n.__iterate(function(n,i,o){if(!a||!(a=e.call(t,n,i,o))){if(r(n,i,o)===!1)return!1;s++}},i,o),s},r},skipUntil:function(e,t,n){return this.skipWhile(T(e),t,n)},groupBy:function(e){var t=this,n=bn.empty().withMutations(function(n){t.forEach(function(t,r,i){var o=e(t,r,i),a=n.get(o,It);a===It&&(a=[],n.set(o,a)),a.push([r,t])})});return n.map(function(e){return Ut(e).fromEntrySeq()})},sort:function(e,t){return this.sortBy(b,e,t)},sortBy:function(e,t){t=t||L;var n=this;return Ut(this.entrySeq().entrySeq().toArray().sort(function(r,i){return t(e(r[1][1],r[1][0],n),e(i[1][1],i[1][0],n))||r[0]-i[0]})).fromEntrySeq().valueSeq().fromEntrySeq()},cacheResult:function(){return!this._cache&&this.__iterateUncached&&(R(this.length),this._cache=this.entrySeq().toArray(),null==this.length&&(this.length=this._cache.length)),this},__iterate:function(e,t,n){if(!this._cache)return this.__iterateUncached(e,t,n);var r=this.length-1,i=this._cache,o=this;if(t)for(var a=i.length-1;a>=0;a--){var s=i[a];if(e(s[1],n?s[0]:r-s[0],o)===!1)break}else i.every(n?function(t){return e(t[1],r-t[0],o)!==!1}:function(t){return e(t[1],t[0],o)!==!1});return this.length},__makeSequence:function(){return f()}},{from:function(e){if(e instanceof Ut)return e;if(!Array.isArray(e)){if(e&&e.constructor===Object)return new Ht(e);e=[e]}return new Wt(e)}});var jt=Ft.prototype;jt.toJSON=jt.toJS,jt.__toJS=jt.toObject,jt.inspect=jt.toSource=function(){return this.toString()};var $t=function(){_t.defaultSuperCall(this,Vt.prototype,arguments)},Vt=$t;_t.createClass($t,{toString:function(){return this.__toString("Seq [","]")},toArray:function(){R(this.length);var e=new Array(this.length||0);return e.length=this.forEach(function(t,n){e[n]=t}),e},fromEntrySeq:function(){var e=this,t=f();return t.length=e.length,t.entrySeq=function(){return e},t.__iterateUncached=function(t,n,r){return e.__iterate(function(e,n,r){return t(e[1],e[0],r)},n,r)},t},join:function(e){e=e||",";var t="",n=0;return this.forEach(function(r,i){var o=i-n;n=i,t+=(1===o?e:M(e,o))+r}),this.length&&n<this.length-1&&(t+=M(e,this.length-1-n)),t},concat:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=[this].concat(e).map(function(e){return Ft(e)}),r=this.__makeSequence();return r.length=n.reduce(function(e,t){return null!=e&&null!=t.length?e+t.length:void 0},0),r.__iterateUncached=function(e,t,r){if(r&&!this.length)return this.cacheResult().__iterate(e,t,r);for(var i,o=0,a=r&&this.length-1,s=n.length-1,l=0;s>=l&&!i;l++){var c=n[t?s-l:l];c instanceof Vt||(c=c.valueSeq()),o+=c.__iterate(function(t,n,s){return n+=o,e(t,r?a-n:n,s)===!1?(i=!0,!1):void 0},t)}return o},r},reverse:function(e){var t=this,n=t.__makeSequence();return n.length=t.length,n.__reversedIndices=!!(e^t.__reversedIndices),n.__iterateUncached=function(n,r,i){return t.__iterate(n,!r,i^e)},n.reverse=function(n){return e===n?t:Bt.reverse.call(this,n)},n},valueSeq:function(){var e=_t.superCall(this,Vt.prototype,"valueSeq",[]);return e.length=void 0,e},filter:function(e,t,n){var r=D(this,e,t,n,n);return n&&(r.length=this.length),r},indexOf:function(e){return this.findIndex(function(t){return k(t,e)})},lastIndexOf:function(e){return this.reverse(!0).indexOf(e)},findIndex:function(e,t){var n=this.findKey(e,t);return null==n?-1:n},findLastIndex:function(e,t){return this.reverse(!0).findIndex(e,t)},slice:function(e,t,n){var r=this;if(v(e,t,r.length))return r;var i=r.__makeSequence(),o=y(e,r.length),a=_(t,r.length);return i.length=r.length&&(n?r.length:a-o),i.__reversedIndices=r.__reversedIndices,i.__iterateUncached=function(i,s,l){if(s)return this.cacheResult().__iterate(i,s,l);var c=this.__reversedIndices^l;if(o!==o||a!==a||c&&null==r.length){var u=r.count();o=y(e,u),a=_(t,u)}var d=c?r.length-a:o,p=c?r.length-o:a,h=r.__iterate(function(e,t,r){return c?null!=p&&t>=p||t>=d&&i(e,n?t:t-d,r)!==!1:d>t||(null==p||p>t)&&i(e,n?t:t-d,r)!==!1},s,l);return null!=this.length?this.length:n?h:Math.max(0,h-d)},i},splice:function(e,t){var n=arguments.length;if(t=Math.max(0|t,0),0===n||2===n&&!t)return this;e=y(e,this.length);var r=this.slice(0,e);return 1===n?r:r.concat(a(arguments,2),this.slice(e+t))},take:function(e){var t=this;if(e>t.length)return t;var n=t.__makeSequence();return n.__iterateUncached=function(n,r,i){if(r)return this.cacheResult().__iterate(n,r,i);var o=0,a=0,s=!0,l=t.__iterate(function(t,r,i){return o++<e&&n(t,r,i)!==!1?void(a=r):(s=!1,!1)},r,i);return s?l:a+1},n.length=this.length&&Math.min(this.length,e),n},takeWhile:function(e,t,n){var r=this,i=r.__makeSequence();return i.__iterateUncached=function(o,a,s){if(a)return this.cacheResult().__iterate(o,a,s);var l=0,c=!0,u=r.__iterate(function(n,r,i){return e.call(t,n,r,i)&&o(n,r,i)!==!1?void(l=r):(c=!1,!1)},a,s);return n?i.length:c?u:l+1},n&&(i.length=this.length),i},skip:function(e,t){var n=this;if(0===e)return n;var r=n.__makeSequence();return t&&(r.length=this.length),r.__iterateUncached=function(r,i,o){if(i)return this.cacheResult().__iterate(r,i,o);var a=n.__reversedIndices^o,s=!0,l=0,c=0,u=n.__iterate(function(n,i,a){return s&&(s=c++<e,s||(l=i)),s||r(n,o||t?i:i-l,a)!==!1},i,o);return t?u:a?l+1:u-l},r.length=this.length&&Math.max(0,this.length-e),r},skipWhile:function(e,t,n){var r=this,i=r.__makeSequence();return n&&(i.length=this.length),i.__iterateUncached=function(i,o,a){if(o)return this.cacheResult().__iterate(i,o,a);var s=r.__reversedIndices^a,l=!0,c=0,u=r.__iterate(function(r,o,s){return l&&(l=e.call(t,r,o,s),l||(c=o)),l||i(r,a||n?o:o-c,s)!==!1},o,a);return n?u:s?c+1:u-c},i},groupBy:function(e,t,n){var r=this,i=bn.empty().withMutations(function(t){r.forEach(function(i,o,a){var s=e(i,o,a),l=t.get(s,It);l===It&&(l=new Array(n?r.length:0),t.set(s,l)),n?l[o]=i:l.push(i)})});return i.map(function(e){return Ft(e)})},sortBy:function(e,t,n){var r=_t.superCall(this,Vt.prototype,"sortBy",[e,t]);return n||(r=r.valueSeq()),r.length=this.length,r},__makeSequence:function(){return m(this)}},{},Ft);var Bt=$t.prototype;Bt.__toJS=Bt.toArray,Bt.__toStringMapper=O;var Ht=function(e){var t=Object.keys(e);this._object=e,this._keys=t,this.length=t.length};_t.createClass(Ht,{toObject:function(){return this._object},get:function(e,t){return void 0===t||this.has(e)?this._object[e]:t},has:function(e){return this._object.hasOwnProperty(e)},__iterate:function(e,t){for(var n=this._object,r=this._keys,i=r.length-1,o=0;i>=o;o++){var a=t?i-o:o;if(e(n[r[a]],r[a],n)===!1)break}return o}},{},Ft);var Wt=function(e){this._array=e,this.length=e.length};_t.createClass(Wt,{toArray:function(){return this._array},__iterate:function(e,t,n){var r=this._array,i=r.length-1,o=-1;if(t){for(var a=i;a>=0;a--){if(r.hasOwnProperty(a)&&e(r[a],n?a:i-a,r)===!1)return o+1;o=a}return r.length}var s=r.every(function(t,a){return e(t,n?i-a:a,r)===!1?!1:(o=a,!0)});return s?r.length:o+1}},{},$t),Wt.prototype.get=Ht.prototype.get,Wt.prototype.has=Ht.prototype.has;var Gt=function(){};_t.createClass(Gt,{toString:function(){return"[Iterator]"}},{});var Kt=Gt.prototype;Kt[Ot]=w,Kt.inspect=Kt.toSource=function(){return this.toString()};var qt=function(e,t,n,r){r=r?r:e.getIn(t),this.length=r instanceof Ft?r.length:null,this._rootData=e,this._keyPath=t,this._onChange=n};_t.createClass(qt,{deref:function(e){return this._rootData.getIn(this._keyPath,e)},get:function(e,t){if(Array.isArray(e)&&0===e.length)return this;var n=this._rootData.getIn(this._keyPath.concat(e),It);return n===It?t:x(this,e,n)},set:function(e,t){return P(this,function(n){return n.set(e,t)},e)},remove:function(e){return P(this,function(t){return t.remove(e)},e)},clear:function(){return P(this,function(e){return e.clear()})},update:function(e,t,n){return 1===arguments.length?P(this,e):P(this,function(r){return r.update(e,t,n)},e)},withMutations:function(e){return P(this,function(t){return(t||zt.empty()).withMutations(e)})},cursor:function(e){return Array.isArray(e)&&0===e.length?this:A(this,e)},__iterate:function(e,t,n){var r=this,i=r.deref();return i&&i.__iterate?i.__iterate(function(t,n,i){return e(x(r,n,t),n,i)},t,n):0}},{},Ft),qt.prototype[Tt]=qt.prototype.remove,qt.prototype.getIn=qt.prototype.get;var zt=function(e){var t=Yt.empty();return e?e.constructor===Yt?e:t.merge(e):t},Yt=zt;_t.createClass(zt,{toString:function(){return this.__toString("Map {","}")},get:function(e,t){return this._root?this._root.get(0,u(e),e,t):t},set:function(e,t){return $(this,e,t)},remove:function(e){return $(this,e,It)},update:function(e,t,n){return 1===arguments.length?this.updateIn([],null,e):this.updateIn([e],t,n)},updateIn:function(e,t,n){var r;return n||(r=[t,n],n=r[0],t=r[1],r),Y(this,e,t,n,0)},clear:function(){return 0===this.length?this:this.__ownerID?(this.length=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):Yt.empty()},merge:function(){return K(this,null,arguments)},mergeWith:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return K(this,e,t)},mergeDeep:function(){return K(this,q(null),arguments)},mergeDeepWith:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return K(this,q(e),t)},cursor:function(e,t){return t||"function"!=typeof e?0===arguments.length?e=[]:Array.isArray(e)||(e=[e]):(t=e,e=[]),new qt(this,e,t)},withMutations:function(e){var t=this.asMutable();return e(t),t.wasAltered()?t.__ensureOwner(this.__ownerID):this},asMutable:function(){return this.__ownerID?this:this.__ensureOwner(new o)},asImmutable:function(){return this.__ensureOwner()},wasAltered:function(){return this.__altered},keys:function(){return new an(this,0)},values:function(){return new an(this,1)},entries:function(){return new an(this,2)},__iterator:function(e){return new an(this,2,e)},__iterate:function(e,t){var n=this;if(!n._root)return 0;var r=0;return this._root.iterate(function(t){return e(t[1],t[0],n)===!1?!1:void r++},t),r},__deepEquals:function(e){var t=this;return e.every(function(e,n){return k(t.get(n,It),e)})},__ensureOwner:function(e){return e===this.__ownerID?this:e?j(this.length,this._root,e,this.__hash):(this.__ownerID=e,this.__altered=!1,this)}},{empty:function(){return sn||(sn=j(0))}},Ft);var Xt=zt.prototype;Xt[Tt]=Xt.remove,Xt[Ot]=function(){return this.entries()},zt.from=zt;var Qt=function(e,t,n){this.ownerID=e,this.bitmap=t,this.nodes=n},Jt=Qt;_t.createClass(Qt,{get:function(e,t,n,r){var i=1<<((0===e?t:t>>>e)&St),o=this.bitmap;return 0===(o&i)?r:this.nodes[X(o&i-1)].get(e+Et,t,n,r)},update:function(e,t,n,r,i,o,a){var s=(0===t?n:n>>>t)&St,l=1<<s,c=this.bitmap,u=0!==(c&l);if(!u&&i===It)return this;var d=X(c&l-1),p=this.nodes,h=u?p[d]:null,f=V(h,e,t+Et,n,r,i,o,a);if(f===h)return this;if(!u&&f&&p.length>=ln)return G(e,p,c,s,f);if(u&&!f&&2===p.length&&B(p[1^d]))return p[1^d];if(u&&f&&1===p.length&&B(f))return f;var m=e&&e===this.ownerID,g=u?f?c:c^l:c|l,v=u?f?Q(p,d,f,m):Z(p,d,m):J(p,d,f,m);return m?(this.bitmap=g,this.nodes=v,this):new Jt(e,g,v)},iterate:function(e,t){for(var n=this.nodes,r=0,i=n.length-1;i>=r;r++)if(n[t?i-r:r].iterate(e,t)===!1)return!1}},{});var Zt=function(e,t,n){this.ownerID=e,this.count=t,this.nodes=n},en=Zt;_t.createClass(Zt,{get:function(e,t,n,r){var i=(0===e?t:t>>>e)&St,o=this.nodes[i];return o?o.get(e+Et,t,n,r):r},update:function(e,t,n,r,i,o,a){var s=(0===t?n:n>>>t)&St,l=i===It,c=this.nodes,u=c[s];if(l&&!u)return this;var d=V(u,e,t+Et,n,r,i,o,a);if(d===u)return this;var p=this.count;if(u){if(!d&&(p--,cn>p))return W(e,c,p,s)}else p++;var h=e&&e===this.ownerID,f=Q(c,s,d,h);return h?(this.count=p,this.nodes=f,this):new en(e,p,f)},iterate:function(e,t){for(var n=this.nodes,r=0,i=n.length-1;i>=r;r++){var o=n[t?i-r:r];if(o&&o.iterate(e,t)===!1)return!1}}},{});var tn=function(e,t,n){this.ownerID=e,this.hash=t,this.entries=n},nn=tn;_t.createClass(tn,{get:function(e,t,n,r){for(var i=this.entries,o=0,a=i.length;a>o;o++)if(k(n,i[o][0]))return i[o][1];return r},update:function(e,t,n,r,o,s,l){var c=o===It;if(n!==this.hash)return c?this:(i(l),i(s),H(this,e,t,n,[r,o]));for(var u=this.entries,d=0,p=u.length;p>d&&!k(r,u[d][0]);d++);var h=p>d;if(c&&!h)return this;if(i(l),(c||!h)&&i(s),c&&2===p)return new rn(e,this.hash,u[1^d]);var f=e&&e===this.ownerID,m=f?u:a(u);return h?c?d===p-1?m.pop():m[d]=m.pop():m[d]=[r,o]:m.push([r,o]),f?(this.entries=m,this):new nn(e,this.hash,m)},iterate:function(e,t){for(var n=this.entries,r=0,i=n.length-1;i>=r;r++)if(e(n[t?i-r:r])===!1)return!1}},{});var rn=function(e,t,n){this.ownerID=e,this.hash=t,this.entry=n},on=rn;_t.createClass(rn,{get:function(e,t,n,r){return k(n,this.entry[0])?this.entry[1]:r},update:function(e,t,n,r,o,a,s){var l=o===It,c=k(r,this.entry[0]);return(c?o===this.entry[1]:l)?this:(i(s),l?(i(a),null):c?e&&e===this.ownerID?(this.entry[1]=o,this):new on(e,n,[r,o]):(i(a),H(this,e,t,n,[r,o])))},iterate:function(e){return e(this.entry)}},{});var an=function(e,t,n){this._type=t,this._reverse=n,this._stack=e._root&&U(e._root)};_t.createClass(an,{next:function(){for(var e=this._type,t=this._stack;t;){var n,r=t.node,i=t.index++;if(r.entry){if(0===i)return F(e,r.entry)}else if(r.entries){if(n=r.entries.length-1,n>=i)return F(e,r.entries[this._reverse?n-i:i])}else if(n=r.nodes.length-1,n>=i){var o=r.nodes[this._reverse?n-i:i];if(o){if(o.entry)return F(e,o.entry);t=this._stack=U(o,t)}continue}t=this._stack=this._stack.__prev}return l()}},{},Gt);var sn,ln=bt/2,cn=bt/4,un=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return dn.from(e)},dn=un;_t.createClass(un,{toString:function(){return this.__toString("Vector [","]")},get:function(e,t){if(e=ct(e,this._origin),e>=this._size)return t;var n=at(this,e),r=e&St;return n&&(void 0===t||n.array.hasOwnProperty(r))?n.array[r]:t},first:function(){return this.get(0)},last:function(){return this.get(this.length?this.length-1:0)},set:function(e,t){return rt(this,e,t)},remove:function(e){return rt(this,e,It)},clear:function(){return 0===this.length?this:this.__ownerID?(this.length=this._origin=this._size=0,this._level=Et,this._root=this._tail=null,this.__hash=void 0,this.__altered=!0,this):dn.empty()},push:function(){var e=arguments,t=this.length;return this.withMutations(function(n){st(n,0,t+e.length);for(var r=0;r<e.length;r++)n.set(t+r,e[r])})},pop:function(){return st(this,0,-1)},unshift:function(){var e=arguments;return this.withMutations(function(t){st(t,-e.length);for(var n=0;n<e.length;n++)t.set(n,e[n])})},shift:function(){return st(this,1)},merge:function(){return lt(this,null,arguments)},mergeWith:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return lt(this,e,t)},mergeDeep:function(){return lt(this,q(null),arguments)},mergeDeepWith:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return lt(this,q(e),t)},setLength:function(e){return st(this,0,e)},slice:function(e,t,n){var r=_t.superCall(this,dn.prototype,"slice",[e,t,n]);if(!n&&r!==this){var i=this,o=i.length;r.toVector=function(){return st(i,0>e?Math.max(0,o+e):o?Math.min(o,e):e,null==t?o:0>t?Math.max(0,o+t):o?Math.min(o,t):t)}}return r},keys:function(e){return new mn(this,0,e)},values:function(e){return new mn(this,1,e)},entries:function(e){return new mn(this,2,e)},__iterator:function(e,t,n){return new mn(this,2,n,e,t)},__iterate:function(e,t,n){var r=this,i=0,o=r.length-1;n^=t;var a,s=function(t,a){return e(t,n?o-a:a,r)===!1?!1:(i=a,!0)},l=ut(this._size);return a=t?et(this._tail,0,l-this._origin,this._size-this._origin,s,t)&&et(this._root,this._level,-this._origin,l-this._origin,s,t):et(this._root,this._level,-this._origin,l-this._origin,s,t)&&et(this._tail,0,l-this._origin,this._size-this._origin,s,t),(a?o:t?o-i:i)+1},__deepEquals:function(e){var t=this.entries(!0);return e.every(function(e,n){var r=t.next().value;return r&&r[0]===n&&k(r[1],e)})},__ensureOwner:function(e){return e===this.__ownerID?this:e?nt(this._origin,this._size,this._level,this._root,this._tail,e,this.__hash):(this.__ownerID=e,this)}},{empty:function(){return gn||(gn=nt(0,0,Et))},from:function(e){if(!e||0===e.length)return dn.empty();if(e.constructor===dn)return e;var t=Array.isArray(e);return e.length>0&&e.length<bt?nt(0,e.length,Et,null,new hn(t?a(e):Ft(e).toArray())):(t||(e=Ft(e),e instanceof $t||(e=e.valueSeq())),dn.empty().merge(e))}},$t);var pn=un.prototype;pn[Tt]=pn.remove,pn[Ot]=pn.values,pn.update=Xt.update,pn.updateIn=Xt.updateIn,pn.cursor=Xt.cursor,pn.withMutations=Xt.withMutations,pn.asMutable=Xt.asMutable,pn.asImmutable=Xt.asImmutable,pn.wasAltered=Xt.wasAltered;var hn=function(e,t){this.array=e,this.ownerID=t},fn=hn;_t.createClass(hn,{removeBefore:function(e,t,n){if(n===t?1<<t:0||0===this.array.length)return this;var r=n>>>t&St;if(r>=this.array.length)return new fn([],e);var i,o=0===r;if(t>0){var a=this.array[r];if(i=a&&a.removeBefore(e,t-Et,n),i===a&&o)return this}if(o&&!i)return this;var s=ot(this,e);if(!o)for(var l=0;r>l;l++)delete s.array[l];return i&&(s.array[r]=i),s},removeAfter:function(e,t,n){if(n===t?1<<t:0||0===this.array.length)return this;
var r=n-1>>>t&St;if(r>=this.array.length)return this;var i,o=r===this.array.length-1;if(t>0){var a=this.array[r];if(i=a&&a.removeAfter(e,t-Et,n),i===a&&o)return this}if(o&&!i)return this;var s=ot(this,e);return o||(s.array.length=r+1),i&&(s.array[r]=i),s}},{});var mn=function(e,t,n,r,i){this._type=t,this._sparse=!!n,this._reverse=!!r,this._flipIndices=!!(i^r),this._maxIndex=e.length-1;var o=ut(e._size),a=tt(e._root&&e._root.array,e._level,-e._origin,o-e._origin-1),s=tt(e._tail&&e._tail.array,0,o-e._origin,e._size-e._origin-1);this._stack=r?s:a,this._stack.__prev=r?a:s};_t.createClass(mn,{next:function(){for(var e=this._sparse,t=this._stack;t;){var n=t.array,r=t.index++;if(this._reverse&&(r=St-r,r>t.rawMax&&(r=t.rawMax,t.index=bt-r)),r>=0&&bt>r&&r<=t.rawMax){var i=n&&n[r];if(0===t.level){if(!e||null!=i||n&&r<n.length&&n.hasOwnProperty(r)){var o,a=this._type;return 1!==a&&(o=t.offset+(r<<t.level),this._flipIndices&&(o=this._maxIndex-o)),s(0===a?o:1===a?i:[o,i])}}else e&&null==i||(this._stack=t=tt(i&&i.array,t.level-Et,t.offset+(r<<t.level),t.max,t))}else t=this._stack=this._stack.__prev}return l()}},{},Gt);var gn,vn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return yn.from(e)},yn=vn;_t.createClass(vn,{toString:function(){return this.__toString("Set {","}")},has:function(e){return this._map.has(e)},get:function(e,t){return this.has(e)?e:t},add:function(e){var t=this._map.set(e,null);return this.__ownerID?(this.length=t.length,this._map=t,this):t===this._map?this:dt(t)},remove:function(e){var t=this._map.remove(e);return this.__ownerID?(this.length=t.length,this._map=t,this):t===this._map?this:0===t.length?yn.empty():dt(t)},clear:function(){return 0===this.length?this:this.__ownerID?(this.length=0,this._map.clear(),this):yn.empty()},union:function(){var e=arguments;return 0===e.length?this:this.withMutations(function(t){for(var n=0;n<e.length;n++)Ft(e[n]).forEach(function(e){return t.add(e)})})},intersect:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return this;e=e.map(function(e){return Ft(e)});var n=this;return this.withMutations(function(t){n.forEach(function(n){e.every(function(e){return e.contains(n)})||t.remove(n)})})},subtract:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return this;e=e.map(function(e){return Ft(e)});var n=this;return this.withMutations(function(t){n.forEach(function(n){e.some(function(e){return e.contains(n)})&&t.remove(n)})})},isSubset:function(e){return e=Ft(e),this.every(function(t){return e.contains(t)})},isSuperset:function(e){var t=this;return e=Ft(e),e.every(function(e){return t.contains(e)})},wasAltered:function(){return this._map.wasAltered()},values:function(){return this._map.keys()},entries:function(){return N(this.values(),function(e){return[e,e]})},hashCode:function(){return this._map.hashCode()},__iterate:function(e,t){var n=this;return this._map.__iterate(function(t,r){return e(r,r,n)},t)},__deepEquals:function(e){return this.isSuperset(e)},__ensureOwner:function(e){if(e===this.__ownerID)return this;var t=this._map.__ensureOwner(e);return e?dt(t,e):(this.__ownerID=e,this._map=t,this)}},{empty:function(){return En||(En=dt(zt.empty()))},from:function(e){var t=yn.empty();return e?e.constructor===yn?e:t.union(e):t},fromKeys:function(e){return yn.from(Ft(e).flip())}},Ft);var _n=vn.prototype;_n[Tt]=_n.remove,_n[Ot]=_n.keys=_n.values,_n.contains=_n.has,_n.mergeDeep=_n.merge=_n.union,_n.mergeDeepWith=_n.mergeWith=function(){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return this.merge.apply(this,e)},_n.withMutations=Xt.withMutations,_n.asMutable=Xt.asMutable,_n.asImmutable=Xt.asImmutable,_n.__toJS=Bt.__toJS,_n.__toStringMapper=Bt.__toStringMapper;var En,bn=function(e){var t=Sn.empty();return e?e.constructor===Sn?e:t.merge(e):t},Sn=bn;_t.createClass(bn,{toString:function(){return this.__toString("OrderedMap {","}")},get:function(e,t){var n=this._map.get(e);return null!=n?this._vector.get(n)[1]:t},clear:function(){return 0===this.length?this:this.__ownerID?(this.length=0,this._map.clear(),this._vector.clear(),this):Sn.empty()},set:function(e,t){return ht(this,e,t)},remove:function(e){return ht(this,e,It)},wasAltered:function(){return this._map.wasAltered()||this._vector.wasAltered()},keys:function(){return N(this.entries(),function(e){return e[0]})},values:function(){return N(this.entries(),function(e){return e[1]})},entries:function(){return this._vector.values(!0)},__iterate:function(e,t){return this._vector.fromEntrySeq().__iterate(e,t)},__deepEquals:function(e){var t=this.entries();return e.every(function(e,n){var r=t.next().value;return r&&k(r[0],n)&&k(r[1],e)})},__ensureOwner:function(e){if(e===this.__ownerID)return this;var t=this._map.__ensureOwner(e),n=this._vector.__ensureOwner(e);return e?pt(t,n,e,this.__hash):(this.__ownerID=e,this._map=t,this._vector=n,this)}},{empty:function(){return In||(In=pt(zt.empty(),un.empty()))}},zt),bn.from=bn,bn.prototype[Tt]=bn.prototype.remove;var In,wn=function(e,t){var n=function(e){return this instanceof n?void(this._map=zt(e)):new n(e)};e=Ft(e);var r=n.prototype=Object.create(Dn);r.constructor=n,r._name=t,r._defaultValues=e;var i=Object.keys(e);return n.prototype.length=i.length,Object.defineProperty&&e.forEach(function(e,t){Object.defineProperty(n.prototype,t,{get:function(){return this.get(t)},set:function(e){c(this.__ownerID,"Cannot set on an immutable record."),this.set(t,e)}})}),n},Cn=wn;_t.createClass(wn,{toString:function(){return this.__toString((this._name||"Record")+" {","}")},has:function(e){return this._defaultValues.has(e)},get:function(e,t){return void 0===t||this.has(e)?this._map.get(e,this._defaultValues.get(e)):t},clear:function(){if(this.__ownerID)return this._map.clear(),this;Object.getPrototypeOf(this).constructor;return Cn._empty||(Cn._empty=ft(this,zt.empty()))},set:function(e,t){if(null==e||!this.has(e))return this;var n=this._map.set(e,t);return this.__ownerID||n===this._map?this:ft(this,n)},remove:function(e){if(null==e||!this.has(e))return this;var t=this._map.remove(e);return this.__ownerID||t===this._map?this:ft(this,t)},keys:function(){return this._map.keys()},values:function(){return this._map.values()},entries:function(){return this._map.entries()},wasAltered:function(){return this._map.wasAltered()},__iterate:function(e,t){var n=this;return this._defaultValues.map(function(e,t){return n.get(t)}).__iterate(e,t)},__ensureOwner:function(e){if(e===this.__ownerID)return this;var t=this._map&&this._map.__ensureOwner(e);return e?ft(this,t,e):(this.__ownerID=e,this._map=t,this)}},{},Ft);var Dn=wn.prototype;Dn[Tt]=Dn.remove,Dn[Ot]=Xt[Ot],Dn.merge=Xt.merge,Dn.mergeWith=Xt.mergeWith,Dn.mergeDeep=Xt.mergeDeep,Dn.mergeDeepWith=Xt.mergeDeepWith,Dn.update=Xt.update,Dn.updateIn=Xt.updateIn,Dn.cursor=Xt.cursor,Dn.withMutations=Xt.withMutations,Dn.asMutable=Xt.asMutable,Dn.asImmutable=Xt.asImmutable,Dn.__deepEquals=Xt.__deepEquals;var Tn=function(e,t,n){return this instanceof On?(c(0!==n,"Cannot step a Range by 0"),e=e||0,null==t&&(t=1/0),e===t&&Ln?Ln:(n=null==n?1:Math.abs(n),e>t&&(n=-n),this._start=e,this._end=t,this._step=n,void(this.length=Math.max(0,Math.ceil((t-e)/n-1)+1)))):new On(e,t,n)},On=Tn;_t.createClass(Tn,{toString:function(){return 0===this.length?"Range []":"Range [ "+this._start+"..."+this._end+(this._step>1?" by "+this._step:"")+" ]"},has:function(e){return c(e>=0,"Index out of bounds"),e<this.length},get:function(e,t){return c(e>=0,"Index out of bounds"),1/0===this.length||e<this.length?this._start+e*this._step:t},contains:function(e){var t=(e-this._start)/this._step;return t>=0&&t<this.length&&t===Math.floor(t)},slice:function(e,t,n){return v(e,t,this.length)?this:n?_t.superCall(this,On.prototype,"slice",[e,t,n]):(e=y(e,this.length),t=_(t,this.length),e>=t?Ln:new On(this.get(e,this._end),this.get(t,this._end),this._step))},indexOf:function(e){var t=e-this._start;if(t%this._step===0){var n=t/this._step;if(n>=0&&n<this.length)return n}return-1},lastIndexOf:function(e){return this.indexOf(e)},take:function(e){return this.slice(0,e)},skip:function(e,t){return t?_t.superCall(this,On.prototype,"skip",[e]):this.slice(e)},__iterate:function(e,t,n){for(var r=t^n,i=this.length-1,o=this._step,a=t?this._start+i*o:this._start,s=0;i>=s&&e(a,r?i-s:s,this)!==!1;s++)a+=t?-o:o;return r?this.length:s},__deepEquals:function(e){return this._start===e._start&&this._end===e._end&&this._step===e._step}},{},$t);var Mn=Tn.prototype;Mn.__toJS=Mn.toArray,Mn.first=pn.first,Mn.last=pn.last;var Ln=Tn(0,0),Rn=function(e,t){return 0===t&&An?An:this instanceof Nn?(this._value=e,void(this.length=null==t?1/0:Math.max(0,t))):new Nn(e,t)},Nn=Rn;_t.createClass(Rn,{toString:function(){return 0===this.length?"Repeat []":"Repeat [ "+this._value+" "+this.length+" times ]"},get:function(e,t){return c(e>=0,"Index out of bounds"),1/0===this.length||e<this.length?this._value:t},first:function(){return this._value},contains:function(e){return k(this._value,e)},slice:function(e,t,n){if(n)return _t.superCall(this,Nn.prototype,"slice",[e,t,n]);var r=this.length;return e=0>e?Math.max(0,r+e):Math.min(r,e),t=null==t?r:t>0?Math.min(r,t):Math.max(0,r+t),t>e?new Nn(this._value,t-e):An},reverse:function(e){return e?_t.superCall(this,Nn.prototype,"reverse",[e]):this},indexOf:function(e){return k(this._value,e)?0:-1},lastIndexOf:function(e){return k(this._value,e)?this.length:-1},__iterate:function(e,t,n){var r=t^n;c(!r||this.length<1/0,"Cannot access end of infinite range.");for(var i=this.length-1,o=0;i>=o&&e(this._value,r?i-o:o,this)!==!1;o++);return r?this.length:o},__deepEquals:function(e){return k(this._value,e._value)}},{},$t);var xn=Rn.prototype;xn.last=xn.first,xn.has=Mn.has,xn.take=Mn.take,xn.skip=Mn.skip,xn.__toJS=Mn.__toJS;var An=new Rn(void 0,0),Pn={Sequence:Ft,Map:zt,Vector:un,Set:vn,OrderedMap:bn,Record:wn,Range:Tn,Repeat:Rn,is:k,fromJS:mt};return Pn}require.config({paths:{text:"thirdparty/text/text",i18n:"thirdparty/i18n/i18n",fileSystemImpl:"filesystem/impls/filer/FilerFileSystem"}}),require.config(window.location.search.indexOf("testEnvironment")>-1?{paths:{"preferences/PreferencesImpl":"../test/TestPreferencesImpl"},locale:"en"}:{locale:window.localStorage.getItem("locale")||("undefined"!=typeof brackets?brackets.app.language:navigator.language)}),define("main",["require"],function(e){"use strict";e(["utils/Compatibility"],function(){e(["brackets"])})}),define("utils/Compatibility",[],function(){"use strict";String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(/\s+$/,"")}),String.prototype.trimLeft||(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")})}),!function(e){"use strict";function t(){e(r).each(function(){n(e(this)).removeClass("open")})}function n(t){var n,r=t.attr("data-target");return r||(r=t.attr("href"),r=r&&/#/.test(r)&&r.replace(/.*(?=#[^\s]*$)/,"")),n=r&&e(r),n&&n.length||(n=t.parent()),n}var r="[data-toggle=dropdown]",i=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};i.prototype={constructor:i,toggle:function(){var r,i,o=e(this);if(!o.is(".disabled, :disabled"))return r=n(o),i=r.hasClass("open"),t(),i||r.toggleClass("open"),o.focus(),!1},keydown:function(t){var i,o,a,s,l;if(/(38|40|27)/.test(t.keyCode)&&(i=e(this),t.preventDefault(),t.stopPropagation(),!i.is(".disabled, :disabled"))){if(a=n(i),s=a.hasClass("open"),!s||s&&27==t.keyCode)return 27==t.which&&a.find(r).focus(),i.click();o=e("[role=menu] li:not(.divider):visible a",a),o.length&&(l=o.index(o.filter(":focus")),38==t.keyCode&&l>0&&l--,40==t.keyCode&&l<o.length-1&&l++,~l||(l=0),o.eq(l).focus())}}};var o=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),r=n.data("dropdown");r||n.data("dropdown",r=new i(this)),"string"==typeof t&&r[t].call(n)})},e.fn.dropdown.Constructor=i,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=o,this},e(document).on("click.dropdown.data-api",t).on("click.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown-menu",function(e){e.stopPropagation()}).on("click.dropdown.data-api",r,i.prototype.toggle).on("keydown.dropdown.data-api",r+", [role=menu]",i.prototype.keydown)}(window.jQuery),define("widgets/bootstrap-dropdown",function(){}),!function(e){"use strict";var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n),this.isShown||n.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.backdrop(function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(this.options.selector),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1),t.enforceFocus(),n?t.$element.one(e.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")}))},hide:function(t){t&&t.preventDefault();t=e.Event("hide"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),e(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var t=this;e(document).on("focusin.modal",function(e){t.$element[0]===e.target||t.$element.has(e.target).length||t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(t){27==t.which&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var r=e.support.transition&&n;if(this.$backdrop=e('<div class="modal-backdrop '+n+'" />').appendTo(this.options.selector),this.$backdrop.click("static"==this.options.backdrop?e.proxy(this.$element[0].focus,this.$element[0]):e.proxy(this.hide,this)),r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;r?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,t):t()):t&&t()}};var n=e.fn.modal;e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data("modal"),o=e.extend({},e.fn.modal.defaults,r.data(),"object"==typeof n&&n);i||r.data("modal",i=new t(this,o)),"string"==typeof n?i[n]():o.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0,selector:"body"},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),o=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(o).one("hide",function(){n.focus()})})}(window.jQuery),define("widgets/bootstrap-modal",function(){}),!function(e){"use strict";function t(e,t,n){return"function"==typeof e?e.apply(t,n):e}var n;e(window).focus(function(){n=!0}).blur(function(){n=!1});var r;e(document).ready(function(){e.support.transition=function(){var e=function(){var e,t=document.createElement("bootstrap"),n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};for(e in n)if(void 0!==t.style[e])return n[e]}();return e&&{end:e}}(),e.support.transition&&(r=e.support.transition.end)});var i=function(t,n){this.$element=e(t),this.options=n,this.enabled=!0,this.autoHideTimeout=null,this.fixTitle()};i.prototype={show:function(){var t,r=this;if(this.hasContent()&&this.enabled){if(t=this.tip(),this.setContent(),this.options.animate&&t.addClass("fade"),t.remove().css({top:0,left:0,display:"block"}).prependTo(document.body),this.updatePosition(),e(window).off("resize",this.resizeHandler),this.resizeHandler=function(){r.updatePosition()},e(window).on("resize",this.resizeHandler),this.options.autoHideDelay){var i=function(){window.clearTimeout(r.autoHideTimeout),r.autoHideTimeout=window.setTimeout(function(){r.hide()},r.options.autoHideDelay)};n?i():e(window).one("focus",i)}t.addClass("in")}},updatePosition:function(){var n,r,i,o,a,s,l,c,u,d,p;switch(u=this.tip(),n=e.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),o=parseInt(this.$element.css("padding-left"),10),a=parseInt(this.$element.css("padding-right"),10),n.left+=o,n.width-=o+a,r=u[0].offsetWidth,i=u[0].offsetHeight,c=t(this.options.placement,this,[u[0],this.$element[0]]),u.addClass(c),c){case"below":p={top:n.top+n.height+this.options.offset,left:n.left+n.width/2-r/2};break;case"above":p={top:n.top-i-this.options.offset,left:n.left+n.width/2-r/2};break;case"left":p={top:n.top+n.height+20-i,left:n.left-r-this.options.offset};break;case"right":p={top:n.top+n.height+20-i,left:n.left+n.width+this.options.offset}}l=0,s=p.left+r-e(document.body).width(),s>0?(l=s,p.left-=s):p.left<0&&(l=p.left,p.left=0),s>0&&(d=u.find(".tooltip-arrow"),this.defaultMargin||(this.defaultMargin=parseInt(d.css("margin-left"),10)),d.css("margin-left",this.defaultMargin+l)),u.css(p)},setContent:function(){var e=this.tip();e.find(".tooltip-inner")[this.options.html?"html":"text"](this.getTitle()),e[0].className="tooltip"},hide:function(){function t(){n.remove()}var n=this.tip();n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?n.bind(r,t):t(),window.clearTimeout(this.autoHideTimeout),e(window).off("resize",this.resizeHandler)},fixTitle:function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getTitle:function(){var e,t=this.$element,n=this.options;return this.fixTitle(),"string"==typeof n.title?e=t.attr("title"==n.title?"data-original-title":n.title):"function"==typeof n.title&&(e=n.title.call(t[0])),e=(""+e).replace(/(^\s*|\s*$)/,""),e||n.fallback},tip:function(){return this.$tip=this.$tip||e('<div class="tooltip" />').html(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}},e.fn.twipsy=function(t){return e.fn.twipsy.initWith.call(this,t,i,"twipsy"),this},e.fn.twipsy.initWith=function(t,n,r){function i(i){var o=e.data(i,r);return o||(o=new n(i,e.fn.twipsy.elementOptions(i,t)),e.data(i,r,o)),o}function o(){var e=i(this);e.hoverState="in",0==t.delayIn?e.show():(e.fixTitle(),setTimeout(function(){"in"==e.hoverState&&e.show()},t.delayIn))}function a(){var e=i(this);e.hoverState="out",0==t.delayOut?e.hide():setTimeout(function(){"out"==e.hoverState&&e.hide()},t.delayOut)}var s,l,c,u;return t===!0?this.data(r):"string"==typeof t?(s=this.data(r),s&&s[t](),this):(t=e.extend({},e.fn[r].defaults,t),t.live||this.each(function(){i(this)}),"manual"!=t.trigger&&(l=t.live?"live":"bind",c="hover"==t.trigger?"mouseenter":"focus",u="hover"==t.trigger?"mouseleave":"blur",this[l](c,o)[l](u,a)),this)},e.fn.twipsy.Twipsy=i,e.fn.twipsy.defaults={animate:!0,delayIn:0,delayOut:0,fallback:"",placement:"above",html:!1,live:!1,offset:0,title:"title",trigger:"hover",template:'<div class="tooltip-arrow"></div><div class="tooltip-inner"></div>'},e.fn.twipsy.rejectAttrOptions=["title"],e.fn.twipsy.elementOptions=function(t,n){for(var r=e(t).data(),i=e.fn.twipsy.rejectAttrOptions,o=i.length;o--;)delete r[i[o]];return e.extend({},n,r)}}(window.jQuery||window.ender),define("widgets/bootstrap-twipsy-mod",function(){}),function(e){function t(e){return function(t){return i.parseUrl(t)[e]}}var n,r,i={urlParseRE:/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#\.]*(?:\.[^\?#\.]+)*(\.[^\?#\.]+)|[^\?#]*)))?(\?[^#]+)?)(#.*)?/,parsedUrlPropNames:"href,hrefNoHash,hrefNoSearch,domain,protocol,doubleSlash,authority,userinfo,username,password,host,hostname,port,pathname,directory,filename,filenameExtension,search,hash".split(","),defaultPorts:{http:"80",https:"443",ftp:"20",ftps:"990"},parseUrl:function(e){if(e&&"object"==typeof e)return e;var t,e=i.urlParseRE.exec(e||"")||[],n=i.parsedUrlPropNames,r=n.length,o={};for(t=0;r>t;t++)o[n[t]]=e[t]||"";return o},port:function(e){return e=i.parseUrl(e),e.port||i.defaultPorts[e.protocol]},isSameDomain:function(e,t){return i.parseUrl(e).domain===i.parseUrl(t).domain},isRelativeUrl:function(e){return""===i.parseUrl(e).protocol},isAbsoluteUrl:function(e){return""!==i.parseUrl(e).protocol},makePathAbsolute:function(e,t){if(e&&"/"===e.charAt(0))return e;for(var e=e||"",n=(t=t?t.replace(/^\/|(\/[^\/]*|[^\/]+)$/g,""):"")?t.split("/"):[],r=e.split("/"),i=0;i<r.length;i++){var o=r[i];switch(o){case".":break;case"..":n.length&&n.pop();break;default:n.push(o)}}return"/"+n.join("/")},makePathRelative:function(e,t){for(var t=t?t.replace(/^\/|\/?[^\/]*$/g,""):"",e=e?e.replace(/^\//,""):"",n=t?t.split("/"):[],r=e.split("/"),i=[],o=n.length,a=!1,s=0;o>s;s++)(a=a||r[0]!==n[s])?i.push(".."):r.shift();return i.concat(r).join("/")},makeUrlAbsolute:function(e,t){if(!i.isRelativeUrl(e))return e;var n=i.parseUrl(e),r=i.parseUrl(t),o=n.protocol||r.protocol,a=n.protocol?n.doubleSlash:n.doubleSlash||r.doubleSlash,s=n.authority||r.authority,l=""!==n.pathname,c=i.makePathAbsolute(n.pathname||r.filename,r.pathname);return o+a+s+c+(n.search||!l&&r.search||"")+n.hash}},o=i.parsedUrlPropNames,a=o.length;for(n=0;a>n;n++)r=o[n],i[r]||(i[r]=t(r));e.PathUtils=i}(window),define("thirdparty/path-utils/path-utils.min",function(){}),function(e){e.fn.smartAutoComplete=function(){if(arguments.length<1){var t=this[0];return e(t).data("smart-autocomplete")}var n=function(t,n){var r=new RegExp(t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");return e.grep(n,function(e){return r.test(e)})},r={minCharLimit:1,maxCharLimit:null,maxResults:null,delay:0,disabled:!1,forceSelect:!1,typeAhead:!1,resultElement:"li",resultFormatter:function(e){return"<li>"+e+"</li>"},filter:function(t,r){{var i=this;e(i).data("smart-autocomplete")}if("array"===e.type(r)){var o=n(t,r,i);return o}return"string"===e.type(r)?e.Deferred(function(o){e.ajax({url:r,data:{term:t},dataType:"json"}).done(function(e){o.resolve(n(t,e,i))})}).promise():void 0},alignResultsContainer:!1,clearResults:function(){var t=e(this.context).prev(".smart_autocomplete_type_ahead_field");e(this.context).css({background:t.css("background")}),t.remove(),e(this.resultsContainer).html("")},setCurrentSelectionToContext:function(){this.rawResults.length>0&&this.currentSelection>=0&&e(this.context).val(this.rawResults[this.currentSelection])},setItemSelected:function(e){this.itemSelected=e},autocompleteFocused:!1,setAutocompleteFocused:function(e){this.autocompleteFocused=e}};e.event.special.keyIn={setup:function(){return!1},_default:function(t){var n=t.target,r=e(n).data("smart-autocomplete"),i=(r.source||null,r.filter),o=r.maxCharLimit>0?r.maxCharLimit:Number.POSITIVE_INFINITY,a=t.smartAutocompleteData.query;return r.disabled||a.length>o?(e(n).trigger("lostFocus"),!1):(r.setItemSelected(!1),r.setAutocompleteFocused(!0),void setTimeout(function(){e.when(i.apply(r,[a,r.source])).done(function(t){var i=r.maxResults>0?t.splice(0,r.maxResults):t;e(n).trigger("resultsReady",[i])})},r.delay))}},e.event.special.resultsReady={setup:function(){return!1},_default:function(t){var n=t.target,r=e(n).data("smart-autocomplete"),i=t.smartAutocompleteData.results;if(r.disabled)return!1;if(e(n).smartAutoComplete().clearResults(),r.rawResults=i,i.length<1)return e(n).trigger("noResults"),!1;var o=e.map(i,function(e){return r.resultFormatter.apply(r,[e])}),a=o.join("");r.resultsContainer&&e(r.resultsContainer).append(a),e(n).trigger("showResults",[i])}},e.event.special.showResults={setup:function(){return!1},_default:function(t){var n=t.target,r=e(n).data("smart-autocomplete"),i=e(r.resultsContainer),o=t.smartAutocompleteData.results;if(r.typeAhead&&o[0].substr(0,e(n).val().length)==e(n).val()){var a=o[0];e(n).before("<input class='smart_autocomplete_type_ahead_field' type='text' autocomplete='off' disabled='disabled' value='"+a+"'/>"),e(n).css({position:"relative",zIndex:2,background:"transparent"});var s=e(n).prev("input");s.css({position:"absolute",zIndex:1,overflow:"hidden",background:e(n).css("background"),borderColor:"transparent",width:e(n).width(),color:"silver"}),r.currentSelection=0,i&&e(n).trigger("itemFocus",i.children()[r.currentSelection])}i&&(r.alignResultsContainer&&i.css({position:"absolute",top:function(){return e(n).offset().top+e(n).height()},left:function(){return e(n).offset().left},width:function(){return e(n).width()},zIndex:1e3}),i.show())}},e.event.special.noResults={setup:function(){return!1},_default:function(t){var n=t.target,r=e(n).data("smart-autocomplete"),i=e(r.resultsContainer);i&&r.clearResults()}},e.event.special.itemSelect={setup:function(){return!1},_default:function(t){var n=t.target,r=e(n).data("smart-autocomplete"),i=t.smartAutocompleteData.item,o=e(i).text()||e(i).val();e(n).val(o),r.setItemSelected(!0),r.originalCharCount=e(n).val().length,e(n).trigger("lostFocus")}},e.event.special.itemFocus={setup:function(){return!1},_default:function(t){var n=t.smartAutocompleteData.item;e(n).addClass("smart_autocomplete_highlight")}},e.event.special.itemUnfocus={setup:function(){return!1},_default:function(t){var n=t.smartAutocompleteData.item;e(n).removeClass("smart_autocomplete_highlight")}},e.event.special.lostFocus={setup:function(){return!1},_default:function(t){var n=t.target,r=e(n).data("smart-autocomplete");r.forceSelect&&!r.itemSelected&&e(r.context).val(""),r.setAutocompleteFocused(!1),r.clearResults(),r.resultsContainer&&e(r.resultsContainer).hide(),r.currentSelection=null}};var i=arguments[0];return this.each(function(){var t=e.extend(r,e(this).data("smart-autocomplete"),i);if(t.context=this,"undefined"===e.type(t.resultsContainer)){var n=e("<ul class='smart_autocomplete_container' style='display:none'></ul>");n.appendTo("body"),t.resultsContainer=n,t.alignResultsContainer=!0}e(this).data("smart-autocomplete",t),e(this).on("keyup",function(t){var n=e(this).data("smart-autocomplete");if(38===t.keyCode){if(n.resultsContainer){var r=n.currentSelection||0,i=e(n.resultsContainer).children();r>0?(e(n.context).trigger("itemUnfocus",i[r]),r--):0>r-1&&(e(n.context).trigger("itemUnfocus",i[r]),r=i.length-1),n.currentSelection=r,e(n.context).trigger("itemFocus",[i[r]])}}else if(40===t.keyCode)if(n.resultsContainer&&n.resultsContainer.is(":visible")){var r=n.currentSelection,i=e(n.resultsContainer).children();r>=0&&e(n.context).trigger("itemUnfocus",i[r]),(isNaN(r)||null==r||++r>=i.length)&&(r=0),n.currentSelection=r,e(n.context).trigger("itemFocus",[i[r]])}else e(n.context).trigger("keyIn",[e(this).val()]);else{if(39===t.keyCode||13===t.keyCode){var o=e(n.context).prev(".smart_autocomplete_type_ahead_field");if(n.resultsContainer&&e(n.resultsContainer).is(":visible")){var r=n.currentSelection,i=e(n.resultsContainer).children();e(n.context).trigger("itemSelect",[i[r]])}else n.typeAhead&&o.is(":visible")&&e(n.context).trigger("itemSelect",[o]);return!1}if(255!==t.keyCode){var a=e(n.context).val().length;if(n.originalCharCount==a)return;a>=n.minCharLimit?e(n.context).trigger("keyIn",[e(this).val()]):n.autocompleteFocused&&(n.currentSelection=null,e(n.context).trigger("lostFocus"))}}}),e(this).focus(function(){e(this).closest("form").bind("keydown.block_for_smart_autocomplete",function(n){var r=e(t.context).prev(".smart_autocomplete_type_ahead_field");if(13===n.keyCode){if(t.resultsContainer&&e(t.resultsContainer).is(":visible")){var i=t.currentSelection,o=e(t.resultsContainer).children();return e(t.context).trigger("itemSelect",[o[i]]),!1}if(t.typeAhead&&r.is(":visible"))return e(t.context).trigger("itemSelect",[r]),!1}}),t.forceSelect&&e(this).select()}),e(document).bind("focusin click",function(n){if(t.autocompleteFocused){var r=e.contains(t.resultsContainer[0],n.target);if(n.target==t.resultsContainer[0]||n.target==t.context||r)return;e(t.context).closest("form").unbind("keydown.block_for_smart_autocomplete"),e(t.context).trigger("lostFocus")}}),e(t.resultsContainer).delegate(t.resultElement,"mousedown.smart_autocomplete",function(){return e(t.context).trigger("itemSelect",[this]),!1}),e(this).bind({keyIn:function(e,t){e.smartAutocompleteData={query:t}},resultsReady:function(e,t){e.smartAutocompleteData={results:t}},showResults:function(e,t){e.smartAutocompleteData={results:t}},noResults:function(){},lostFocus:function(){},itemSelect:function(e,t){e.smartAutocompleteData={item:t}},itemFocus:function(e,t){e.smartAutocompleteData={item:t}},itemUnfocus:function(e,t){e.smartAutocompleteData={item:t}}})})}}(jQuery),define("thirdparty/smart-auto-complete-local/jquery.smart_autocomplete",function(){}),function(e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else{if("function"==typeof define&&define.amd)return define("thirdparty/CodeMirror2/lib/codemirror",[],e);this.CodeMirror=e()}}(function(){"use strict";function e(n,r){if(!(this instanceof e))return new e(n,r);this.options=r=r?wo(r):{},wo(ja,r,!1),h(r);var i=r.value;"string"==typeof i&&(i=new cs(i,r.mode)),this.doc=i;var o=this.display=new t(n,i);o.wrapper.CodeMirror=this,c(this),s(this),r.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),r.autofocus&&!ma&&Rn(this),v(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,draggingText:!1,highlight:new vo,keySeq:null},ia&&11>oa&&setTimeout(Co(Ln,this,!0),20),An(this),Fo(),on(this),this.curOp.forceUpdate=!0,Fi(this,i),r.autofocus&&!ma||xo()==o.input?setTimeout(Co(ir,this),20):or(this);for(var a in $a)$a.hasOwnProperty(a)&&$a[a](this,r[a],Va);S(this);for(var l=0;l<Ga.length;++l)Ga[l](this);sn(this)}function t(e,t){var n=this,r=n.input=Mo("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none");aa?r.style.width="1000px":r.setAttribute("wrap","off"),fa&&(r.style.border="1px solid black"),r.setAttribute("autocorrect","off"),r.setAttribute("autocapitalize","off"),r.setAttribute("spellcheck","false"),n.inputDiv=Mo("div",[r],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),n.scrollbarFiller=Mo("div",null,"CodeMirror-scrollbar-filler"),n.scrollbarFiller.setAttribute("not-content","true"),n.gutterFiller=Mo("div",null,"CodeMirror-gutter-filler"),n.gutterFiller.setAttribute("not-content","true"),n.lineDiv=Mo("div",null,"CodeMirror-code"),n.selectionDiv=Mo("div",null,null,"position: relative; z-index: 1"),n.cursorDiv=Mo("div",null,"CodeMirror-cursors"),n.measure=Mo("div",null,"CodeMirror-measure"),n.lineMeasure=Mo("div",null,"CodeMirror-measure"),n.lineSpace=Mo("div",[n.measure,n.lineMeasure,n.selectionDiv,n.cursorDiv,n.lineDiv],null,"position: relative; outline: none"),n.mover=Mo("div",[Mo("div",[n.lineSpace],"CodeMirror-lines")],null,"position: relative"),n.sizer=Mo("div",[n.mover],"CodeMirror-sizer"),n.sizerWidth=null,n.heightForcer=Mo("div",null,null,"position: absolute; height: "+_s+"px; width: 1px;"),n.gutters=Mo("div",null,"CodeMirror-gutters"),n.lineGutter=null,n.scroller=Mo("div",[n.sizer,n.heightForcer,n.gutters],"CodeMirror-scroll"),n.scroller.setAttribute("tabIndex","-1"),n.wrapper=Mo("div",[n.inputDiv,n.scrollbarFiller,n.gutterFiller,n.scroller],"CodeMirror"),ia&&8>oa&&(n.gutters.style.zIndex=-1,n.scroller.style.paddingRight=0),fa&&(r.style.width="0px"),aa||(n.scroller.draggable=!0),da&&(n.inputDiv.style.height="1px",n.inputDiv.style.position="absolute"),e&&(e.appendChild?e.appendChild(n.wrapper):e(n.wrapper)),n.viewFrom=n.viewTo=t.first,n.reportedViewFrom=n.reportedViewTo=t.first,n.view=[],n.renderedView=null,n.externalMeasured=null,n.viewOffset=0,n.lastWrapHeight=n.lastWrapWidth=0,n.updateLineNumbers=null,n.nativeBarWidth=n.barHeight=n.barWidth=0,n.scrollbarsClipped=!1,n.lineNumWidth=n.lineNumInnerWidth=n.lineNumChars=null,n.prevInput="",n.alignWidgets=!1,n.pollingFast=!1,n.poll=new vo,n.cachedCharWidth=n.cachedTextHeight=n.cachedPaddingH=null,n.inaccurateSelection=!1,n.maxLine=null,n.maxLineLength=0,n.maxLineChanged=!1,n.wheelDX=n.wheelDY=n.wheelStartX=n.wheelStartY=null,n.shift=!1,n.selForContextMenu=null
}function n(t){t.doc.mode=e.getMode(t.options,t.doc.modeOption),r(t)}function r(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.frontier=e.doc.first,wt(e,100),e.state.modeGen++,e.curOp&&En(e)}function i(e){e.options.lineWrapping?(As(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(xs(e.display.wrapper,"CodeMirror-wrap"),p(e)),a(e),En(e),Gt(e),setTimeout(function(){y(e)},100)}function o(e){var t=nn(e.display),n=e.options.lineWrapping,r=n&&Math.max(5,e.display.scroller.clientWidth/rn(e.display)-3);return function(i){if(ci(e.doc,i))return 0;var o=0;if(i.widgets)for(var a=0;a<i.widgets.length;a++)i.widgets[a].height&&(o+=i.widgets[a].height);return n?o+(Math.ceil(i.text.length/r)||1)*t:o+t}}function a(e){var t=e.doc,n=o(e);t.iter(function(e){var t=n(e);t!=e.height&&Vi(e,t)})}function s(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Gt(e)}function l(e){c(e),En(e),setTimeout(function(){b(e)},20)}function c(e){var t=e.display.gutters,n=e.options.gutters;Lo(t);for(var r=0;r<n.length;++r){var i=n[r],o=t.appendChild(Mo("div",null,"CodeMirror-gutter "+i));"CodeMirror-linenumbers"==i&&(e.display.lineGutter=o,o.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=r?"":"none",u(e)}function u(e){var t=e.display.gutters.offsetWidth;e.display.sizer.style.marginLeft=t+"px"}function d(e){if(0==e.height)return 0;for(var t,n=e.text.length,r=e;t=ni(r);){var i=t.find(0,!0);r=i.from.line,n+=i.from.ch-i.to.ch}for(r=e;t=ri(r);){var i=t.find(0,!0);n-=r.text.length-i.from.ch,r=i.to.line,n+=r.text.length-i.to.ch}return n}function p(e){var t=e.display,n=e.doc;t.maxLine=Ui(n,n.first),t.maxLineLength=d(t.maxLine),t.maxLineChanged=!0,n.iter(function(e){var n=d(e);n>t.maxLineLength&&(t.maxLineLength=n,t.maxLine=e)})}function h(e){var t=bo(e.gutters,"CodeMirror-linenumbers");-1==t&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):t>-1&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function f(e){var t=e.display,n=t.gutters.offsetWidth,r=Math.round(e.doc.height+Mt(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?n:0,docHeight:r,scrollHeight:r+Rt(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:n}}function m(e,t,n){this.cm=n;var r=this.vert=Mo("div",[Mo("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),i=this.horiz=Mo("div",[Mo("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");e(r),e(i),ms(r,"scroll",function(){r.clientHeight&&t(r.scrollTop,"vertical")}),ms(i,"scroll",function(){i.clientWidth&&t(i.scrollLeft,"horizontal")}),this.checkedOverlay=!1,ia&&8>oa&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function g(){}function v(t){t.display.scrollbars&&(t.display.scrollbars.clear(),t.display.scrollbars.addClass&&xs(t.display.wrapper,t.display.scrollbars.addClass)),t.display.scrollbars=new e.scrollbarModel[t.options.scrollbarStyle](function(e){t.display.wrapper.insertBefore(e,t.display.scrollbarFiller),ms(e,"mousedown",function(){t.state.focused&&setTimeout(Co(Rn,t),0)}),e.setAttribute("not-content","true")},function(e,n){"horizontal"==n?qn(t,e):Kn(t,e)},t),t.display.scrollbars.addClass&&As(t.display.wrapper,t.display.scrollbars.addClass)}function y(e,t){t||(t=f(e));var n=e.display.barWidth,r=e.display.barHeight;_(e,t);for(var i=0;4>i&&n!=e.display.barWidth||r!=e.display.barHeight;i++)n!=e.display.barWidth&&e.options.lineWrapping&&R(e),_(e,f(e)),n=e.display.barWidth,r=e.display.barHeight}function _(e,t){var n=e.display,r=n.scrollbars.update(t);n.sizer.style.paddingRight=(n.barWidth=r.right)+"px",n.sizer.style.paddingBottom=(n.barHeight=r.bottom)+"px",r.right&&r.bottom?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=r.bottom+"px",n.scrollbarFiller.style.width=r.right+"px"):n.scrollbarFiller.style.display="",r.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=r.bottom+"px",n.gutterFiller.style.width=t.gutterWidth+"px"):n.gutterFiller.style.display=""}function E(e,t,n){var r=n&&null!=n.top?Math.max(0,n.top):e.scroller.scrollTop;r=Math.floor(r-Ot(e));var i=n&&null!=n.bottom?n.bottom:r+e.wrapper.clientHeight,o=Hi(t,r),a=Hi(t,i);if(n&&n.ensure){var s=n.ensure.from.line,l=n.ensure.to.line;o>s?(o=s,a=Hi(t,Wi(Ui(t,s))+e.wrapper.clientHeight)):Math.min(l,t.lastLine())>=a&&(o=Hi(t,Wi(Ui(t,l))-e.wrapper.clientHeight),a=l)}return{from:o,to:Math.max(a,o+1)}}function b(e){var t=e.display,n=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var r=w(t)-t.scroller.scrollLeft+e.doc.scrollLeft,i=t.gutters.offsetWidth,o=r+"px",a=0;a<n.length;a++)if(!n[a].hidden){e.options.fixedGutter&&n[a].gutter&&(n[a].gutter.style.left=o);var s=n[a].alignable;if(s)for(var l=0;l<s.length;l++)s[l].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=r+i+"px")}}function S(e){if(!e.options.lineNumbers)return!1;var t=e.doc,n=I(e.options,t.first+t.size-1),r=e.display;if(n.length!=r.lineNumChars){var i=r.measure.appendChild(Mo("div",[Mo("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=i.firstChild.offsetWidth,a=i.offsetWidth-o;return r.lineGutter.style.width="",r.lineNumInnerWidth=Math.max(o,r.lineGutter.offsetWidth-a),r.lineNumWidth=r.lineNumInnerWidth+a,r.lineNumChars=r.lineNumInnerWidth?n.length:-1,r.lineGutter.style.width=r.lineNumWidth+"px",u(e),!0}return!1}function I(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function w(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function C(e,t,n){var r=e.display;this.viewport=t,this.visible=E(r,e.doc,t),this.editorIsHidden=!r.wrapper.offsetWidth,this.wrapperHeight=r.wrapper.clientHeight,this.wrapperWidth=r.wrapper.clientWidth,this.oldDisplayWidth=Nt(e),this.force=n,this.dims=x(e)}function D(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=Rt(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=Rt(e)+"px",t.scrollbarsClipped=!0)}function T(e,t){var n=e.display,r=e.doc;if(t.editorIsHidden)return Sn(e),!1;if(!t.force&&t.visible.from>=n.viewFrom&&t.visible.to<=n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo)&&n.renderedView==n.view&&0==Dn(e))return!1;S(e)&&(Sn(e),t.dims=x(e));var i=r.first+r.size,o=Math.max(t.visible.from-e.options.viewportMargin,r.first),a=Math.min(i,t.visible.to+e.options.viewportMargin);n.viewFrom<o&&o-n.viewFrom<20&&(o=Math.max(r.first,n.viewFrom)),n.viewTo>a&&n.viewTo-a<20&&(a=Math.min(i,n.viewTo)),Sa&&(o=si(e.doc,o),a=li(e.doc,a));var s=o!=n.viewFrom||a!=n.viewTo||n.lastWrapHeight!=t.wrapperHeight||n.lastWrapWidth!=t.wrapperWidth;Cn(e,o,a),n.viewOffset=Wi(Ui(e.doc,n.viewFrom)),e.display.mover.style.top=n.viewOffset+"px";var l=Dn(e);if(!s&&0==l&&!t.force&&n.renderedView==n.view&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo))return!1;var c=xo();return l>4&&(n.lineDiv.style.display="none"),A(e,n.updateLineNumbers,t.dims),l>4&&(n.lineDiv.style.display=""),n.renderedView=n.view,c&&xo()!=c&&c.offsetHeight&&c.focus(),Lo(n.cursorDiv),Lo(n.selectionDiv),n.gutters.style.height=0,s&&(n.lastWrapHeight=t.wrapperHeight,n.lastWrapWidth=t.wrapperWidth,wt(e,400)),n.updateLineNumbers=null,!0}function O(e,t){for(var n=t.force,r=t.viewport,i=!0;;i=!1){if(i&&e.options.lineWrapping&&t.oldDisplayWidth!=Nt(e))n=!0;else if(n=!1,r&&null!=r.top&&(r={top:Math.min(e.doc.height+Mt(e.display)-xt(e),r.top)}),t.visible=E(e.display,e.doc,r),t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)break;if(!T(e,t))break;R(e);var o=f(e);Et(e),L(e,o),y(e,o)}uo(e,"update",e),(e.display.viewFrom!=e.display.reportedViewFrom||e.display.viewTo!=e.display.reportedViewTo)&&(uo(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function M(e,t){var n=new C(e,t);if(T(e,n)){R(e),O(e,n);var r=f(e);Et(e),L(e,r),y(e,r)}}function L(e,t){e.display.sizer.style.minHeight=t.docHeight+"px";var n=t.docHeight+e.display.barHeight;e.display.heightForcer.style.top=n+"px",e.display.gutters.style.height=Math.max(n+Rt(e),t.clientHeight)+"px"}function R(e){for(var t=e.display,n=t.lineDiv.offsetTop,r=0;r<t.view.length;r++){var i,o=t.view[r];if(!o.hidden){if(ia&&8>oa){var a=o.node.offsetTop+o.node.offsetHeight;i=a-n,n=a}else{var s=o.node.getBoundingClientRect();i=s.bottom-s.top}var l=o.line.height-i;if(2>i&&(i=nn(t)),(l>.001||-.001>l)&&(Vi(o.line,i),N(o.line),o.rest))for(var c=0;c<o.rest.length;c++)N(o.rest[c])}}}function N(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t)e.widgets[t].height=e.widgets[t].node.offsetHeight}function x(e){for(var t=e.display,n={},r={},i=t.gutters.clientLeft,o=t.gutters.firstChild,a=0;o;o=o.nextSibling,++a)n[e.options.gutters[a]]=o.offsetLeft+o.clientLeft+i,r[e.options.gutters[a]]=o.clientWidth;return{fixedPos:w(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:r,wrapperWidth:t.wrapper.clientWidth}}function A(e,t,n){function r(t){var n=t.nextSibling;return aa&&ga&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),n}for(var i=e.display,o=e.options.lineNumbers,a=i.lineDiv,s=a.firstChild,l=i.view,c=i.viewFrom,u=0;u<l.length;u++){var d=l[u];if(d.hidden);else if(d.node){for(;s!=d.node;)s=r(s);var p=o&&null!=t&&c>=t&&d.lineNumber;d.changes&&(bo(d.changes,"gutter")>-1&&(p=!1),P(e,d,c,n)),p&&(Lo(d.lineNumber),d.lineNumber.appendChild(document.createTextNode(I(e.options,c)))),s=d.node.nextSibling}else{var h=H(e,d,c,n);a.insertBefore(h,s)}c+=d.size}for(;s;)s=r(s)}function P(e,t,n,r){for(var i=0;i<t.changes.length;i++){var o=t.changes[i];"text"==o?j(e,t):"gutter"==o?V(e,t,n,r):"class"==o?$(t):"widget"==o&&B(t,r)}t.changes=null}function k(e){return e.node==e.text&&(e.node=Mo("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),ia&&8>oa&&(e.node.style.zIndex=2)),e.node}function F(e){var t=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;if(t&&(t+=" CodeMirror-linebackground"),e.background)t?e.background.className=t:(e.background.parentNode.removeChild(e.background),e.background=null);else if(t){var n=k(e);e.background=n.insertBefore(Mo("div",null,t),n.firstChild)}}function U(e,t){var n=e.display.externalMeasured;return n&&n.line==t.line?(e.display.externalMeasured=null,t.measure=n.measure,n.built):Ci(e,t)}function j(e,t){var n=t.text.className,r=U(e,t);t.text==t.node&&(t.node=r.pre),t.text.parentNode.replaceChild(r.pre,t.text),t.text=r.pre,r.bgClass!=t.bgClass||r.textClass!=t.textClass?(t.bgClass=r.bgClass,t.textClass=r.textClass,$(t)):n&&(t.text.className=n)}function $(e){F(e),e.line.wrapClass?k(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className="");var t=e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass;e.text.className=t||""}function V(e,t,n,r){t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null);var i=t.line.gutterMarkers;if(e.options.lineNumbers||i){var o=k(t),a=t.gutter=o.insertBefore(Mo("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px; width: "+r.gutterTotalWidth+"px"),t.text);if(t.line.gutterClass&&(a.className+=" "+t.line.gutterClass),!e.options.lineNumbers||i&&i["CodeMirror-linenumbers"]||(t.lineNumber=a.appendChild(Mo("div",I(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),i)for(var s=0;s<e.options.gutters.length;++s){var l=e.options.gutters[s],c=i.hasOwnProperty(l)&&i[l];c&&a.appendChild(Mo("div",[c],"CodeMirror-gutter-elt","left: "+r.gutterLeft[l]+"px; width: "+r.gutterWidth[l]+"px"))}}}function B(e,t){e.alignable&&(e.alignable=null);for(var n,r=e.node.firstChild;r;r=n){var n=r.nextSibling;"CodeMirror-linewidget"==r.className&&e.node.removeChild(r)}W(e,t)}function H(e,t,n,r){var i=U(e,t);return t.text=t.node=i.pre,i.bgClass&&(t.bgClass=i.bgClass),i.textClass&&(t.textClass=i.textClass),$(t),V(e,t,n,r),W(t,r),t.node}function W(e,t){if(G(e.line,e,t,!0),e.rest)for(var n=0;n<e.rest.length;n++)G(e.rest[n],e,t,!1)}function G(e,t,n,r){if(e.widgets)for(var i=k(t),o=0,a=e.widgets;o<a.length;++o){var s=a[o],l=Mo("div",[s.node],"CodeMirror-linewidget");s.handleMouseEvents||l.setAttribute("cm-ignore-events","true"),K(s,l,t,n),r&&s.above?i.insertBefore(l,t.gutter||t.text):i.appendChild(l),uo(s,"redraw")}}function K(e,t,n,r){if(e.noHScroll){(n.alignable||(n.alignable=[])).push(t);var i=r.wrapperWidth;t.style.left=r.fixedPos+"px",e.coverGutter||(i-=r.gutterTotalWidth,t.style.paddingLeft=r.gutterTotalWidth+"px"),t.style.width=i+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-r.gutterTotalWidth+"px"))}function q(e){return Ia(e.line,e.ch)}function z(e,t){return wa(e,t)<0?t:e}function Y(e,t){return wa(e,t)<0?e:t}function X(e,t){this.ranges=e,this.primIndex=t}function Q(e,t){this.anchor=e,this.head=t}function J(e,t){var n=e[t];e.sort(function(e,t){return wa(e.from(),t.from())}),t=bo(e,n);for(var r=1;r<e.length;r++){var i=e[r],o=e[r-1];if(wa(o.to(),i.from())>=0){var a=Y(o.from(),i.from()),s=z(o.to(),i.to()),l=o.empty()?i.from()==i.head:o.from()==o.head;t>=r&&--t,e.splice(--r,2,new Q(l?s:a,l?a:s))}}return new X(e,t)}function Z(e,t){return new X([new Q(e,t||e)],0)}function et(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function tt(e,t){if(t.line<e.first)return Ia(e.first,0);var n=e.first+e.size-1;return t.line>n?Ia(n,Ui(e,n).text.length):nt(t,Ui(e,t.line).text.length)}function nt(e,t){var n=e.ch;return null==n||n>t?Ia(e.line,t):0>n?Ia(e.line,0):e}function rt(e,t){return t>=e.first&&t<e.first+e.size}function it(e,t){for(var n=[],r=0;r<t.length;r++)n[r]=tt(e,t[r]);return n}function ot(e,t,n,r){if(e.cm&&e.cm.display.shift||e.extend){var i=t.anchor;if(r){var o=wa(n,i)<0;o!=wa(r,i)<0?(i=n,n=r):o!=wa(n,r)<0&&(n=r)}return new Q(i,n)}return new Q(r||n,n)}function at(e,t,n,r){pt(e,new X([ot(e,e.sel.primary(),t,n)],0),r)}function st(e,t,n){for(var r=[],i=0;i<e.sel.ranges.length;i++)r[i]=ot(e,e.sel.ranges[i],t[i],null);var o=J(r,e.sel.primIndex);pt(e,o,n)}function lt(e,t,n,r){var i=e.sel.ranges.slice(0);i[t]=n,pt(e,J(i,e.sel.primIndex),r)}function ct(e,t,n,r){pt(e,Z(t,n),r)}function ut(e,t){var n={ranges:t.ranges,update:function(t){this.ranges=[];for(var n=0;n<t.length;n++)this.ranges[n]=new Q(tt(e,t[n].anchor),tt(e,t[n].head))}};return vs(e,"beforeSelectionChange",e,n),e.cm&&vs(e.cm,"beforeSelectionChange",e.cm,n),n.ranges!=t.ranges?J(n.ranges,n.ranges.length-1):t}function dt(e,t,n){var r=e.history.done,i=Eo(r);i&&i.ranges?(r[r.length-1]=t,ht(e,t,n)):pt(e,t,n)}function pt(e,t,n){ht(e,t,n),Ji(e,e.sel,e.cm?e.cm.curOp.id:0/0,n)}function ht(e,t,n){(mo(e,"beforeSelectionChange")||e.cm&&mo(e.cm,"beforeSelectionChange"))&&(t=ut(e,t));var r=n&&n.bias||(wa(t.primary().head,e.sel.primary().head)<0?-1:1);ft(e,gt(e,t,r,!0)),n&&n.scroll===!1||!e.cm||Cr(e.cm)}function ft(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0,fo(e.cm)),uo(e,"cursorActivity",e))}function mt(e){ft(e,gt(e,e.sel,null,!1),bs)}function gt(e,t,n,r){for(var i,o=0;o<t.ranges.length;o++){var a=t.ranges[o],s=vt(e,a.anchor,n,r),l=vt(e,a.head,n,r);(i||s!=a.anchor||l!=a.head)&&(i||(i=t.ranges.slice(0,o)),i[o]=new Q(s,l))}return i?J(i,t.primIndex):t}function vt(e,t,n,r){var i=!1,o=t,a=n||1;e.cantEdit=!1;e:for(;;){var s=Ui(e,o.line);if(s.markedSpans)for(var l=0;l<s.markedSpans.length;++l){var c=s.markedSpans[l],u=c.marker;if((null==c.from||(u.inclusiveLeft?c.from<=o.ch:c.from<o.ch))&&(null==c.to||(u.inclusiveRight?c.to>=o.ch:c.to>o.ch))){if(r&&(vs(u,"beforeCursorEnter"),u.explicitlyCleared)){if(s.markedSpans){--l;continue}break}if(!u.atomic)continue;var d=u.find(0>a?-1:1);if(0==wa(d,o)&&(d.ch+=a,d.ch<0?d=d.line>e.first?tt(e,Ia(d.line-1)):null:d.ch>s.text.length&&(d=d.line<e.first+e.size-1?Ia(d.line+1,0):null),!d)){if(i)return r?(e.cantEdit=!0,Ia(e.first,0)):vt(e,t,n,!0);i=!0,d=t,a=-a}o=d;continue e}}return o}}function yt(e){for(var t=e.display,n=e.doc,r={},i=r.cursors=document.createDocumentFragment(),o=r.selection=document.createDocumentFragment(),a=0;a<n.sel.ranges.length;a++){var s=n.sel.ranges[a],l=s.empty();(l||e.options.showCursorWhenSelecting)&&bt(e,s,i),l||St(e,s,o)}if(e.options.moveInputWithCursor){var c=Qt(e,n.sel.primary().head,"div"),u=t.wrapper.getBoundingClientRect(),d=t.lineDiv.getBoundingClientRect();r.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,c.top+d.top-u.top)),r.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,c.left+d.left-u.left))}return r}function _t(e,t){Ro(e.display.cursorDiv,t.cursors),Ro(e.display.selectionDiv,t.selection),null!=t.teTop&&(e.display.inputDiv.style.top=t.teTop+"px",e.display.inputDiv.style.left=t.teLeft+"px")}function Et(e){_t(e,yt(e))}function bt(e,t,n){var r=Qt(e,t.head,"div",null,null,!e.options.singleCursorHeightPerLine),i=n.appendChild(Mo("div"," ","CodeMirror-cursor"));if(i.style.left=r.left+"px",i.style.top=r.top+"px",i.style.height=Math.max(0,r.bottom-r.top)*e.options.cursorHeight+"px",r.other){var o=n.appendChild(Mo("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));o.style.display="",o.style.left=r.other.left+"px",o.style.top=r.other.top+"px",o.style.height=.85*(r.other.bottom-r.other.top)+"px"}}function St(e,t,n){function r(e,t,n,r){0>t&&(t=0),t=Math.round(t),r=Math.round(r),s.appendChild(Mo("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(null==n?u-e:n)+"px; height: "+(r-t)+"px"))}function i(t,n,i){function o(n,r){return Xt(e,Ia(t,n),"div",d,r)}var s,l,d=Ui(a,t),p=d.text.length;return Bo(Gi(d),n||0,null==i?p:i,function(e,t,a){var d,h,f,m=o(e,"left");if(e==t)d=m,h=f=m.left;else{if(d=o(t-1,"right"),"rtl"==a){var g=m;m=d,d=g}h=m.left,f=d.right}null==n&&0==e&&(h=c),d.top-m.top>3&&(r(h,m.top,null,m.bottom),h=c,m.bottom<d.top&&r(h,m.bottom,null,d.top)),null==i&&t==p&&(f=u),(!s||m.top<s.top||m.top==s.top&&m.left<s.left)&&(s=m),(!l||d.bottom>l.bottom||d.bottom==l.bottom&&d.right>l.right)&&(l=d),c+1>h&&(h=c),r(h,d.top,f-h,d.bottom)}),{start:s,end:l}}var o=e.display,a=e.doc,s=document.createDocumentFragment(),l=Lt(e.display),c=l.left,u=Math.max(o.sizerWidth,Nt(e)-o.sizer.offsetLeft)-l.right,d=t.from(),p=t.to();if(d.line==p.line)i(d.line,d.ch,p.ch);else{var h=Ui(a,d.line),f=Ui(a,p.line),m=oi(h)==oi(f),g=i(d.line,d.ch,m?h.text.length+1:null).end,v=i(p.line,m?0:null,p.ch).start;m&&(g.top<v.top-2?(r(g.right,g.top,null,g.bottom),r(c,v.top,v.left,v.bottom)):r(g.right,g.top,v.left-g.right,g.bottom)),g.bottom<v.top&&r(c,g.bottom,null,v.top)}n.appendChild(s)}function It(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var n=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){t.cursorDiv.style.visibility=(n=!n)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function wt(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.viewTo&&e.state.highlight.set(t,Co(Ct,e))}function Ct(e){var t=e.doc;if(t.frontier<t.first&&(t.frontier=t.first),!(t.frontier>=e.display.viewTo)){var n=+new Date+e.options.workTime,r=qa(t.mode,Tt(e,t.frontier)),i=[];t.iter(t.frontier,Math.min(t.first+t.size,e.display.viewTo+500),function(o){if(t.frontier>=e.display.viewFrom){var a=o.styles,s=bi(e,o,r,!0);o.styles=s.styles;var l=o.styleClasses,c=s.classes;c?o.styleClasses=c:l&&(o.styleClasses=null);for(var u=!a||a.length!=o.styles.length||l!=c&&(!l||!c||l.bgClass!=c.bgClass||l.textClass!=c.textClass),d=0;!u&&d<a.length;++d)u=a[d]!=o.styles[d];u&&i.push(t.frontier),o.stateAfter=qa(t.mode,r)}else Ii(e,o.text,r),o.stateAfter=t.frontier%5==0?qa(t.mode,r):null;return++t.frontier,+new Date>n?(wt(e,e.options.workDelay),!0):void 0}),i.length&&fn(e,function(){for(var t=0;t<i.length;t++)bn(e,i[t],"text")})}}function Dt(e,t,n){for(var r,i,o=e.doc,a=n?-1:t-(e.doc.mode.innerMode?1e3:100),s=t;s>a;--s){if(s<=o.first)return o.first;var l=Ui(o,s-1);if(l.stateAfter&&(!n||s<=o.frontier))return s;var c=ws(l.text,null,e.options.tabSize);(null==i||r>c)&&(i=s-1,r=c)}return i}function Tt(e,t,n){var r=e.doc,i=e.display;if(!r.mode.startState)return!0;var o=Dt(e,t,n),a=o>r.first&&Ui(r,o-1).stateAfter;return a=a?qa(r.mode,a):za(r.mode),r.iter(o,t,function(n){Ii(e,n.text,a);var s=o==t-1||o%5==0||o>=i.viewFrom&&o<i.viewTo;n.stateAfter=s?qa(r.mode,a):null,++o}),n&&(r.frontier=o),a}function Ot(e){return e.lineSpace.offsetTop}function Mt(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Lt(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=Ro(e.measure,Mo("pre","x")),n=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,r={left:parseInt(n.paddingLeft),right:parseInt(n.paddingRight)};return isNaN(r.left)||isNaN(r.right)||(e.cachedPaddingH=r),r}function Rt(e){return _s-e.display.nativeBarWidth}function Nt(e){return e.display.scroller.clientWidth-Rt(e)-e.display.barWidth}function xt(e){return e.display.scroller.clientHeight-Rt(e)-e.display.barHeight}function At(e,t,n){var r=e.options.lineWrapping,i=r&&Nt(e);if(!t.measure.heights||r&&t.measure.width!=i){var o=t.measure.heights=[];if(r){t.measure.width=i;for(var a=t.text.firstChild.getClientRects(),s=0;s<a.length-1;s++){var l=a[s],c=a[s+1];Math.abs(l.bottom-c.bottom)>2&&o.push((l.bottom+c.top)/2-n.top)}}o.push(n.bottom-n.top)}}function Pt(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var r=0;r<e.rest.length;r++)if(e.rest[r]==t)return{map:e.measure.maps[r],cache:e.measure.caches[r]};for(var r=0;r<e.rest.length;r++)if(Bi(e.rest[r])>n)return{map:e.measure.maps[r],cache:e.measure.caches[r],before:!0}}function kt(e,t){t=oi(t);var n=Bi(t),r=e.display.externalMeasured=new yn(e.doc,t,n);r.lineN=n;var i=r.built=Ci(e,r);return r.text=i.pre,Ro(e.display.lineMeasure,i.pre),r}function Ft(e,t,n,r){return $t(e,jt(e,t),n,r)}function Ut(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[In(e,t)];var n=e.display.externalMeasured;return n&&t>=n.lineN&&t<n.lineN+n.size?n:void 0}function jt(e,t){var n=Bi(t),r=Ut(e,n);r&&!r.text?r=null:r&&r.changes&&P(e,r,n,x(e)),r||(r=kt(e,t));var i=Pt(r,t,n);return{line:t,view:r,rect:null,map:i.map,cache:i.cache,before:i.before,hasHeights:!1}}function $t(e,t,n,r,i){t.before&&(n=-1);var o,a=n+(r||"");return t.cache.hasOwnProperty(a)?o=t.cache[a]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(At(e,t.view,t.rect),t.hasHeights=!0),o=Vt(e,t,n,r),o.bogus||(t.cache[a]=o)),{left:o.left,right:o.right,top:i?o.rtop:o.top,bottom:i?o.rbottom:o.bottom}}function Vt(e,t,n,r){for(var i,o,a,s,l=t.map,c=0;c<l.length;c+=3){var u=l[c],d=l[c+1];if(u>n?(o=0,a=1,s="left"):d>n?(o=n-u,a=o+1):(c==l.length-3||n==d&&l[c+3]>n)&&(a=d-u,o=a-1,n>=d&&(s="right")),null!=o){if(i=l[c+2],u==d&&r==(i.insertLeft?"left":"right")&&(s=r),"left"==r&&0==o)for(;c&&l[c-2]==l[c-3]&&l[c-1].insertLeft;)i=l[(c-=3)+2],s="left";if("right"==r&&o==d-u)for(;c<l.length-3&&l[c+3]==l[c+4]&&!l[c+5].insertLeft;)i=l[(c+=3)+2],s="right";break}}var p;if(3==i.nodeType){for(var c=0;4>c;c++){for(;o&&Oo(t.line.text.charAt(u+o));)--o;for(;d>u+a&&Oo(t.line.text.charAt(u+a));)++a;if(ia&&9>oa&&0==o&&a==d-u)p=i.parentNode.getBoundingClientRect();else if(ia&&e.options.lineWrapping){var h=Ts(i,o,a).getClientRects();p=h.length?h["right"==r?h.length-1:0]:Oa}else p=Ts(i,o,a).getBoundingClientRect()||Oa;if(p.left||p.right||0==o)break;a=o,o-=1,s="right"}ia&&11>oa&&(p=Bt(e.display.measure,p))}else{o>0&&(s=r="right");var h;p=e.options.lineWrapping&&(h=i.getClientRects()).length>1?h["right"==r?h.length-1:0]:i.getBoundingClientRect()}if(ia&&9>oa&&!o&&(!p||!p.left&&!p.right)){var f=i.parentNode.getClientRects()[0];p=f?{left:f.left,right:f.left+rn(e.display),top:f.top,bottom:f.bottom}:Oa}for(var m=p.top-t.rect.top,g=p.bottom-t.rect.top,v=(m+g)/2,y=t.view.measure.heights,c=0;c<y.length-1&&!(v<y[c]);c++);var _=c?y[c-1]:0,E=y[c],b={left:("right"==s?p.right:p.left)-t.rect.left,right:("left"==s?p.left:p.right)-t.rect.left,top:_,bottom:E};return p.left||p.right||(b.bogus=!0),e.options.singleCursorHeightPerLine||(b.rtop=m,b.rbottom=g),b}function Bt(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!Vo(e))return t;var n=screen.logicalXDPI/screen.deviceXDPI,r=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*n,right:t.right*n,top:t.top*r,bottom:t.bottom*r}}function Ht(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function Wt(e){e.display.externalMeasure=null,Lo(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)Ht(e.display.view[t])}function Gt(e){Wt(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function Kt(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function qt(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function zt(e,t,n,r){if(t.widgets)for(var i=0;i<t.widgets.length;++i)if(t.widgets[i].above){var o=pi(t.widgets[i]);n.top+=o,n.bottom+=o}if("line"==r)return n;r||(r="local");var a=Wi(t);if("local"==r?a+=Ot(e.display):a-=e.display.viewOffset,"page"==r||"window"==r){var s=e.display.lineSpace.getBoundingClientRect();a+=s.top+("window"==r?0:qt());var l=s.left+("window"==r?0:Kt());n.left+=l,n.right+=l}return n.top+=a,n.bottom+=a,n}function Yt(e,t,n){if("div"==n)return t;var r=t.left,i=t.top;if("page"==n)r-=Kt(),i-=qt();else if("local"==n||!n){var o=e.display.sizer.getBoundingClientRect();r+=o.left,i+=o.top}var a=e.display.lineSpace.getBoundingClientRect();return{left:r-a.left,top:i-a.top}}function Xt(e,t,n,r,i){return r||(r=Ui(e.doc,t.line)),zt(e,r,Ft(e,r,t.ch,i),n)}function Qt(e,t,n,r,i,o){function a(t,a){var s=$t(e,i,t,a?"right":"left",o);return a?s.left=s.right:s.right=s.left,zt(e,r,s,n)}function s(e,t){var n=l[t],r=n.level%2;return e==Ho(n)&&t&&n.level<l[t-1].level?(n=l[--t],e=Wo(n)-(n.level%2?0:1),r=!0):e==Wo(n)&&t<l.length-1&&n.level<l[t+1].level&&(n=l[++t],e=Ho(n)-n.level%2,r=!1),r&&e==n.to&&e>n.from?a(e-1):a(e,r)}r=r||Ui(e.doc,t.line),i||(i=jt(e,r));var l=Gi(r),c=t.ch;if(!l)return a(c);var u=Qo(l,c),d=s(c,u);return null!=Bs&&(d.other=s(c,Bs)),d}function Jt(e,t){var n=0,t=tt(e.doc,t);e.options.lineWrapping||(n=rn(e.display)*t.ch);var r=Ui(e.doc,t.line),i=Wi(r)+Ot(e.display);return{left:n,right:n,top:i,bottom:i+r.height}}function Zt(e,t,n,r){var i=Ia(e,t);return i.xRel=r,n&&(i.outside=!0),i}function en(e,t,n){var r=e.doc;if(n+=e.display.viewOffset,0>n)return Zt(r.first,0,!0,-1);var i=Hi(r,n),o=r.first+r.size-1;if(i>o)return Zt(r.first+r.size-1,Ui(r,o).text.length,!0,1);0>t&&(t=0);for(var a=Ui(r,i);;){var s=tn(e,a,i,t,n),l=ri(a),c=l&&l.find(0,!0);if(!l||!(s.ch>c.from.ch||s.ch==c.from.ch&&s.xRel>0))return s;i=Bi(a=c.to.line)}}function tn(e,t,n,r,i){function o(r){var i=Qt(e,Ia(n,r),"line",t,c);return s=!0,a>i.bottom?i.left-l:a<i.top?i.left+l:(s=!1,i.left)}var a=i-Wi(t),s=!1,l=2*e.display.wrapper.clientWidth,c=jt(e,t),u=Gi(t),d=t.text.length,p=Go(t),h=Ko(t),f=o(p),m=s,g=o(h),v=s;if(r>g)return Zt(n,h,v,1);for(;;){if(u?h==p||h==Zo(t,p,1):1>=h-p){for(var y=f>r||g-r>=r-f?p:h,_=r-(y==p?f:g);Oo(t.text.charAt(y));)++y;var E=Zt(n,y,y==p?m:v,-1>_?-1:_>1?1:0);return E}var b=Math.ceil(d/2),S=p+b;if(u){S=p;for(var I=0;b>I;++I)S=Zo(t,S,1)}var w=o(S);w>r?(h=S,g=w,(v=s)&&(g+=1e3),d=b):(p=S,f=w,m=s,d-=b)}}function nn(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==Ca){Ca=Mo("pre");for(var t=0;49>t;++t)Ca.appendChild(document.createTextNode("x")),Ca.appendChild(Mo("br"));Ca.appendChild(document.createTextNode("x"))}Ro(e.measure,Ca);var n=Ca.offsetHeight/50;return n>3&&(e.cachedTextHeight=n),Lo(e.measure),n||1}function rn(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=Mo("span","xxxxxxxxxx"),n=Mo("pre",[t]);Ro(e.measure,n);var r=t.getBoundingClientRect(),i=(r.right-r.left)/10;return i>2&&(e.cachedCharWidth=i),i||10}function on(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,id:++La},Ma?Ma.ops.push(e.curOp):e.curOp.ownsGroup=Ma={ops:[e.curOp],delayedCallbacks:[]}}function an(e){var t=e.delayedCallbacks,n=0;do{for(;n<t.length;n++)t[n]();for(var r=0;r<e.ops.length;r++){var i=e.ops[r];if(i.cursorActivityHandlers)for(;i.cursorActivityCalled<i.cursorActivityHandlers.length;)i.cursorActivityHandlers[i.cursorActivityCalled++](i.cm)}}while(n<t.length)}function sn(e){var t=e.curOp,n=t.ownsGroup;if(n)try{an(n)}finally{Ma=null;for(var r=0;r<n.ops.length;r++)n.ops[r].cm.curOp=null;ln(n)}}function ln(e){for(var t=e.ops,n=0;n<t.length;n++)cn(t[n]);for(var n=0;n<t.length;n++)un(t[n]);for(var n=0;n<t.length;n++)dn(t[n]);for(var n=0;n<t.length;n++)pn(t[n]);for(var n=0;n<t.length;n++)hn(t[n])}function cn(e){var t=e.cm,n=t.display;D(t),e.updateMaxLine&&p(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<n.viewFrom||e.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new C(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function un(e){e.updatedDisplay=e.mustUpdate&&T(e.cm,e.update)}function dn(e){var t=e.cm,n=t.display;e.updatedDisplay&&R(t),e.barMeasure=f(t),n.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=Ft(t,n.maxLine,n.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(n.scroller.clientWidth,n.sizer.offsetLeft+e.adjustWidthTo+Rt(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+e.adjustWidthTo-Nt(t))),(e.updatedDisplay||e.selectionChanged)&&(e.newSelectionNodes=yt(t))}function pn(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&qn(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1),e.newSelectionNodes&&_t(t,e.newSelectionNodes),e.updatedDisplay&&L(t,e.barMeasure),(e.updatedDisplay||e.startHeight!=t.doc.height)&&y(t,e.barMeasure),e.selectionChanged&&It(t),t.state.focused&&e.updateInput&&Ln(t,e.typing)}function hn(e){var t=e.cm,n=t.display,r=t.doc;if(e.updatedDisplay&&O(t,e.update),null==n.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(n.wheelStartX=n.wheelStartY=null),null==e.scrollTop||n.scroller.scrollTop==e.scrollTop&&!e.forceScroll||(r.scrollTop=Math.max(0,Math.min(n.scroller.scrollHeight-n.scroller.clientHeight,e.scrollTop)),n.scrollbars.setScrollTop(r.scrollTop),n.scroller.scrollTop=r.scrollTop),null==e.scrollLeft||n.scroller.scrollLeft==e.scrollLeft&&!e.forceScroll||(r.scrollLeft=Math.max(0,Math.min(n.scroller.scrollWidth-Nt(t),e.scrollLeft)),n.scrollbars.setScrollLeft(r.scrollLeft),n.scroller.scrollLeft=r.scrollLeft,b(t)),e.scrollToPos){var i=br(t,tt(r,e.scrollToPos.from),tt(r,e.scrollToPos.to),e.scrollToPos.margin);e.scrollToPos.isCursor&&t.state.focused&&Er(t,i)}var o=e.maybeHiddenMarkers,a=e.maybeUnhiddenMarkers;if(o)for(var s=0;s<o.length;++s)o[s].lines.length||vs(o[s],"hide");if(a)for(var s=0;s<a.length;++s)a[s].lines.length&&vs(a[s],"unhide");n.wrapper.offsetHeight&&(r.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&vs(t,"changes",t,e.changeObjs)}function fn(e,t){if(e.curOp)return t();on(e);try{return t()}finally{sn(e)}}function mn(e,t){return function(){if(e.curOp)return t.apply(e,arguments);
on(e);try{return t.apply(e,arguments)}finally{sn(e)}}}function gn(e){return function(){if(this.curOp)return e.apply(this,arguments);on(this);try{return e.apply(this,arguments)}finally{sn(this)}}}function vn(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);on(t);try{return e.apply(this,arguments)}finally{sn(t)}}}function yn(e,t,n){this.line=t,this.rest=ai(t),this.size=this.rest?Bi(Eo(this.rest))-n+1:1,this.node=this.text=null,this.hidden=ci(e,t)}function _n(e,t,n){for(var r,i=[],o=t;n>o;o=r){var a=new yn(e.doc,Ui(e.doc,o),o);r=o+a.size,i.push(a)}return i}function En(e,t,n,r){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size),r||(r=0);var i=e.display;if(r&&n<i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>t)&&(i.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=i.viewTo)Sa&&si(e.doc,t)<i.viewTo&&Sn(e);else if(n<=i.viewFrom)Sa&&li(e.doc,n+r)>i.viewFrom?Sn(e):(i.viewFrom+=r,i.viewTo+=r);else if(t<=i.viewFrom&&n>=i.viewTo)Sn(e);else if(t<=i.viewFrom){var o=wn(e,n,n+r,1);o?(i.view=i.view.slice(o.index),i.viewFrom=o.lineN,i.viewTo+=r):Sn(e)}else if(n>=i.viewTo){var o=wn(e,t,t,-1);o?(i.view=i.view.slice(0,o.index),i.viewTo=o.lineN):Sn(e)}else{var a=wn(e,t,t,-1),s=wn(e,n,n+r,1);a&&s?(i.view=i.view.slice(0,a.index).concat(_n(e,a.lineN,s.lineN)).concat(i.view.slice(s.index)),i.viewTo+=r):Sn(e)}var l=i.externalMeasured;l&&(n<l.lineN?l.lineN+=r:t<l.lineN+l.size&&(i.externalMeasured=null))}function bn(e,t,n){e.curOp.viewChanged=!0;var r=e.display,i=e.display.externalMeasured;if(i&&t>=i.lineN&&t<i.lineN+i.size&&(r.externalMeasured=null),!(t<r.viewFrom||t>=r.viewTo)){var o=r.view[In(e,t)];if(null!=o.node){var a=o.changes||(o.changes=[]);-1==bo(a,n)&&a.push(n)}}}function Sn(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function In(e,t){if(t>=e.display.viewTo)return null;if(t-=e.display.viewFrom,0>t)return null;for(var n=e.display.view,r=0;r<n.length;r++)if(t-=n[r].size,0>t)return r}function wn(e,t,n,r){var i,o=In(e,t),a=e.display.view;if(!Sa||n==e.doc.first+e.doc.size)return{index:o,lineN:n};for(var s=0,l=e.display.viewFrom;o>s;s++)l+=a[s].size;if(l!=t){if(r>0){if(o==a.length-1)return null;i=l+a[o].size-t,o++}else i=l-t;t+=i,n+=i}for(;si(e.doc,n)!=n;){if(o==(0>r?0:a.length-1))return null;n+=r*a[o-(0>r?1:0)].size,o+=r}return{index:o,lineN:n}}function Cn(e,t,n){var r=e.display,i=r.view;0==i.length||t>=r.viewTo||n<=r.viewFrom?(r.view=_n(e,t,n),r.viewFrom=t):(r.viewFrom>t?r.view=_n(e,t,r.viewFrom).concat(r.view):r.viewFrom<t&&(r.view=r.view.slice(In(e,t))),r.viewFrom=t,r.viewTo<n?r.view=r.view.concat(_n(e,r.viewTo,n)):r.viewTo>n&&(r.view=r.view.slice(0,In(e,n)))),r.viewTo=n}function Dn(e){for(var t=e.display.view,n=0,r=0;r<t.length;r++){var i=t[r];i.hidden||i.node&&!i.changes||++n}return n}function Tn(e){e.display.pollingFast||e.display.poll.set(e.options.pollInterval,function(){Mn(e),e.state.focused&&Tn(e)})}function On(e){function t(){var r=Mn(e);r||n?(e.display.pollingFast=!1,Tn(e)):(n=!0,e.display.poll.set(60,t))}var n=!1;e.display.pollingFast=!0,e.display.poll.set(20,t)}function Mn(e){var t=e.display.input,n=e.display.prevInput,r=e.doc;if(!e.state.focused||Us(t)&&!n||xn(e)||e.options.disableInput||e.state.keySeq)return!1;e.state.pasteIncoming&&e.state.fakedLastChar&&(t.value=t.value.substring(0,t.value.length-1),e.state.fakedLastChar=!1);var i=t.value;if(i==n&&!e.somethingSelected())return!1;if(ia&&oa>=9&&e.display.inputHasSelection===i||ga&&/[\uf700-\uf7ff]/.test(i))return Ln(e),!1;var o=!e.curOp;o&&on(e),e.display.shift=!1,8203!=i.charCodeAt(0)||r.sel!=e.display.selForContextMenu||n||(n="​");for(var a=0,s=Math.min(n.length,i.length);s>a&&n.charCodeAt(a)==i.charCodeAt(a);)++a;var l=i.slice(a),c=Fs(l),u=null;e.state.pasteIncoming&&r.sel.ranges.length>1&&(Ra&&Ra.join("\n")==l?u=r.sel.ranges.length%Ra.length==0&&So(Ra,Fs):c.length==r.sel.ranges.length&&(u=So(c,function(e){return[e]})));for(var d=r.sel.ranges.length-1;d>=0;d--){var p=r.sel.ranges[d],h=p.from(),f=p.to();a<n.length?h=Ia(h.line,h.ch-(n.length-a)):e.state.overwrite&&p.empty()&&!e.state.pasteIncoming&&(f=Ia(f.line,Math.min(Ui(r,f.line).text.length,f.ch+Eo(c).length)));var m=e.curOp.updateInput,g={from:h,to:f,text:u?u[d%u.length]:c,origin:e.state.pasteIncoming?"paste":e.state.cutIncoming?"cut":"+input"};if(hr(e.doc,g),uo(e,"inputRead",e,g),l&&!e.state.pasteIncoming&&e.options.electricChars&&e.options.smartIndent&&p.head.ch<100&&(!d||r.sel.ranges[d-1].head.line!=p.head.line)){var v=e.getModeAt(p.head),y=Ua(g);if(v.electricChars){for(var _=0;_<v.electricChars.length;_++)if(l.indexOf(v.electricChars.charAt(_))>-1){Tr(e,y.line,"smart");break}}else v.electricInput&&v.electricInput.test(Ui(r,y.line).text.slice(0,y.ch))&&Tr(e,y.line,"smart")}}return Cr(e),e.curOp.updateInput=m,e.curOp.typing=!0,i.length>1e3||i.indexOf("\n")>-1?t.value=e.display.prevInput="":e.display.prevInput=i,o&&sn(e),e.state.pasteIncoming=e.state.cutIncoming=!1,!0}function Ln(e,t){if(!e.display.contextMenuPending){var n,r,i=e.doc;if(e.somethingSelected()){e.display.prevInput="";var o=i.sel.primary();n=js&&(o.to().line-o.from().line>100||(r=e.getSelection()).length>1e3);var a=n?"-":r||e.getSelection();e.display.input.value=a,e.state.focused&&Ds(e.display.input),ia&&oa>=9&&(e.display.inputHasSelection=a)}else t||(e.display.prevInput=e.display.input.value="",ia&&oa>=9&&(e.display.inputHasSelection=null));e.display.inaccurateSelection=n}}function Rn(e){"nocursor"==e.options.readOnly||ma&&xo()==e.display.input||e.display.input.focus()}function Nn(e){e.state.focused||(Rn(e),ir(e))}function xn(e){return e.options.readOnly||e.doc.cantEdit}function An(e){function t(t){ho(e,t)||fs(t)}function n(t){if(e.somethingSelected())Ra=e.getSelections(),r.inaccurateSelection&&(r.prevInput="",r.inaccurateSelection=!1,r.input.value=Ra.join("\n"),Ds(r.input));else{for(var n=[],i=[],o=0;o<e.doc.sel.ranges.length;o++){var a=e.doc.sel.ranges[o].head.line,s={anchor:Ia(a,0),head:Ia(a+1,0)};i.push(s),n.push(e.getRange(s.anchor,s.head))}"cut"==t.type?e.setSelections(i,null,bs):(r.prevInput="",r.input.value=n.join("\n"),Ds(r.input)),Ra=n}"cut"==t.type&&(e.state.cutIncoming=!0)}var r=e.display;ms(r.scroller,"mousedown",mn(e,Un)),ia&&11>oa?ms(r.scroller,"dblclick",mn(e,function(t){if(!ho(e,t)){var n=Fn(e,t);if(n&&!Hn(e,t)&&!kn(e.display,t)){ps(t);var r=e.findWordAt(n);at(e.doc,r.anchor,r.head)}}})):ms(r.scroller,"dblclick",function(t){ho(e,t)||ps(t)}),ms(r.lineSpace,"selectstart",function(e){kn(r,e)||ps(e)}),Ea||ms(r.scroller,"contextmenu",function(t){ar(e,t)}),ms(r.scroller,"scroll",function(){r.scroller.clientHeight&&(Kn(e,r.scroller.scrollTop),qn(e,r.scroller.scrollLeft,!0),vs(e,"scroll",e))}),ms(r.scroller,"mousewheel",function(t){zn(e,t)}),ms(r.scroller,"DOMMouseScroll",function(t){zn(e,t)}),ms(r.wrapper,"scroll",function(){r.wrapper.scrollTop=r.wrapper.scrollLeft=0}),ms(r.input,"keyup",function(t){nr.call(e,t)}),ms(r.input,"input",function(){ia&&oa>=9&&e.display.inputHasSelection&&(e.display.inputHasSelection=null),Mn(e)}),ms(r.input,"keydown",mn(e,er)),ms(r.input,"keypress",mn(e,rr)),ms(r.input,"focus",Co(ir,e)),ms(r.input,"blur",Co(or,e)),e.options.dragDrop&&(ms(r.scroller,"dragstart",function(t){Gn(e,t)}),ms(r.scroller,"dragenter",t),ms(r.scroller,"dragover",t),ms(r.scroller,"drop",mn(e,Wn))),ms(r.scroller,"paste",function(t){kn(r,t)||(e.state.pasteIncoming=!0,Rn(e),On(e))}),ms(r.input,"paste",function(){if(aa&&!e.state.fakedLastChar&&!(new Date-e.state.lastMiddleDown<200)){var t=r.input.selectionStart,n=r.input.selectionEnd;r.input.value+="$",r.input.selectionEnd=n,r.input.selectionStart=t,e.state.fakedLastChar=!0}e.state.pasteIncoming=!0,On(e)}),ms(r.input,"cut",n),ms(r.input,"copy",n),da&&ms(r.sizer,"mouseup",function(){xo()==r.input&&r.input.blur(),Rn(e)})}function Pn(e){var t=e.display;(t.lastWrapHeight!=t.wrapper.clientHeight||t.lastWrapWidth!=t.wrapper.clientWidth)&&(t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize())}function kn(e,t){for(var n=lo(t);n!=e.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==e.sizer&&n!=e.mover)return!0}function Fn(e,t,n,r){var i=e.display;if(!n&&"true"==lo(t).getAttribute("not-content"))return null;var o,a,s=i.lineSpace.getBoundingClientRect();try{o=t.clientX-s.left,a=t.clientY-s.top}catch(t){return null}var l,c=en(e,o,a);if(r&&1==c.xRel&&(l=Ui(e.doc,c.line).text).length==c.ch){var u=ws(l,l.length,e.options.tabSize)-l.length;c=Ia(c.line,Math.max(0,Math.round((o-Lt(e.display).left)/rn(e.display))-u))}return c}function Un(e){if(!ho(this,e)){var t=this,n=t.display;if(n.shift=e.shiftKey,kn(n,e))return void(aa||(n.scroller.draggable=!1,setTimeout(function(){n.scroller.draggable=!0},100)));if(!Hn(t,e)){var r=Fn(t,e);switch(window.focus(),co(e)){case 1:r?jn(t,e,r):lo(e)==n.scroller&&ps(e);break;case 2:aa&&(t.state.lastMiddleDown=+new Date),r&&at(t.doc,r),setTimeout(Co(Rn,t),20),ps(e);break;case 3:Ea&&ar(t,e)}}}}function jn(e,t,n){setTimeout(Co(Nn,e),0);var r,i=+new Date;Ta&&Ta.time>i-400&&0==wa(Ta.pos,n)?r="triple":Da&&Da.time>i-400&&0==wa(Da.pos,n)?(r="double",Ta={time:i,pos:n}):(r="single",Da={time:i,pos:n});var o,a=e.doc.sel,s=ga?t.metaKey:t.ctrlKey;e.options.dragDrop&&ks&&!xn(e)&&"single"==r&&(o=a.contains(n))>-1&&!a.ranges[o].empty()?$n(e,t,n,s):Vn(e,t,n,r,s)}function $n(e,t,n,r){var i=e.display,o=mn(e,function(a){aa&&(i.scroller.draggable=!1),e.state.draggingText=!1,gs(document,"mouseup",o),gs(i.scroller,"drop",o),Math.abs(t.clientX-a.clientX)+Math.abs(t.clientY-a.clientY)<10&&(ps(a),r||at(e.doc,n),Rn(e),ia&&9==oa&&setTimeout(function(){document.body.focus(),Rn(e)},20))});aa&&(i.scroller.draggable=!0),e.state.draggingText=o,i.scroller.dragDrop&&i.scroller.dragDrop(),ms(document,"mouseup",o),ms(i.scroller,"drop",o)}function Vn(e,t,n,r,i){function o(t){if(0!=wa(g,t))if(g=t,"rect"==r){for(var i=[],o=e.options.tabSize,a=ws(Ui(c,n.line).text,n.ch,o),s=ws(Ui(c,t.line).text,t.ch,o),l=Math.min(a,s),h=Math.max(a,s),f=Math.min(n.line,t.line),m=Math.min(e.lastLine(),Math.max(n.line,t.line));m>=f;f++){var v=Ui(c,f).text,y=yo(v,l,o);l==h?i.push(new Q(Ia(f,y),Ia(f,y))):v.length>y&&i.push(new Q(Ia(f,y),Ia(f,yo(v,h,o))))}i.length||i.push(new Q(n,n)),pt(c,J(p.ranges.slice(0,d).concat(i),d),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var _=u,E=_.anchor,b=t;if("single"!=r){if("double"==r)var S=e.findWordAt(t);else var S=new Q(Ia(t.line,0),tt(c,Ia(t.line+1,0)));wa(S.anchor,E)>0?(b=S.head,E=Y(_.from(),S.anchor)):(b=S.anchor,E=z(_.to(),S.head))}var i=p.ranges.slice(0);i[d]=new Q(tt(c,E),b),pt(c,J(i,d),Ss)}}function a(t){var n=++y,i=Fn(e,t,!0,"rect"==r);if(i)if(0!=wa(i,g)){Nn(e),o(i);var s=E(l,c);(i.line>=s.to||i.line<s.from)&&setTimeout(mn(e,function(){y==n&&a(t)}),150)}else{var u=t.clientY<v.top?-20:t.clientY>v.bottom?20:0;u&&setTimeout(mn(e,function(){y==n&&(l.scroller.scrollTop+=u,a(t))}),50)}}function s(t){y=1/0,ps(t),Rn(e),gs(document,"mousemove",_),gs(document,"mouseup",b),c.history.lastSelOrigin=null}var l=e.display,c=e.doc;ps(t);var u,d,p=c.sel,h=p.ranges;if(i&&!t.shiftKey?(d=c.sel.contains(n),u=d>-1?h[d]:new Q(n,n)):u=c.sel.primary(),t.altKey)r="rect",i||(u=new Q(n,n)),n=Fn(e,t,!0,!0),d=-1;else if("double"==r){var f=e.findWordAt(n);u=e.display.shift||c.extend?ot(c,u,f.anchor,f.head):f}else if("triple"==r){var m=new Q(Ia(n.line,0),tt(c,Ia(n.line+1,0)));u=e.display.shift||c.extend?ot(c,u,m.anchor,m.head):m}else u=ot(c,u,n);i?-1==d?(d=h.length,pt(c,J(h.concat([u]),d),{scroll:!1,origin:"*mouse"})):h.length>1&&h[d].empty()&&"single"==r?(pt(c,J(h.slice(0,d).concat(h.slice(d+1)),0)),p=c.sel):lt(c,d,u,Ss):(d=0,pt(c,new X([u],0),Ss),p=c.sel);var g=n,v=l.wrapper.getBoundingClientRect(),y=0,_=mn(e,function(e){co(e)?a(e):s(e)}),b=mn(e,s);ms(document,"mousemove",_),ms(document,"mouseup",b)}function Bn(e,t,n,r,i){try{var o=t.clientX,a=t.clientY}catch(t){return!1}if(o>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;r&&ps(t);var s=e.display,l=s.lineDiv.getBoundingClientRect();if(a>l.bottom||!mo(e,n))return so(t);a-=l.top-s.viewOffset;for(var c=0;c<e.options.gutters.length;++c){var u=s.gutters.childNodes[c];if(u&&u.getBoundingClientRect().right>=o){var d=Hi(e.doc,a),p=e.options.gutters[c];return i(e,n,e,d,p,t),so(t)}}}function Hn(e,t){return Bn(e,t,"gutterClick",!0,uo)}function Wn(e){var t=this;if(!ho(t,e)&&!kn(t.display,e)){ps(e),ia&&(Na=+new Date);var n=Fn(t,e,!0),r=e.dataTransfer.files;if(n&&!xn(t))if(r&&r.length&&window.FileReader&&window.File)for(var i=r.length,o=Array(i),a=0,s=function(e,r){var s=new FileReader;s.onload=mn(t,function(){if(o[r]=s.result,++a==i){n=tt(t.doc,n);var e={from:n,to:n,text:Fs(o.join("\n")),origin:"paste"};hr(t.doc,e),dt(t.doc,Z(n,Ua(e)))}}),s.readAsText(e)},l=0;i>l;++l)s(r[l],l);else{if(t.state.draggingText&&t.doc.sel.contains(n)>-1)return t.state.draggingText(e),void setTimeout(Co(Rn,t),20);try{var o=e.dataTransfer.getData("Text");if(o){if(t.state.draggingText&&!(ga?e.metaKey:e.ctrlKey))var c=t.listSelections();if(ht(t.doc,Z(n,n)),c)for(var l=0;l<c.length;++l)_r(t.doc,"",c[l].anchor,c[l].head,"drag");t.replaceSelection(o,"around","paste"),Rn(t)}}catch(e){}}}}function Gn(e,t){if(ia&&(!e.state.draggingText||+new Date-Na<100))return void fs(t);if(!ho(e,t)&&!kn(e.display,t)&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.setDragImage&&!ua)){var n=Mo("img",null,null,"position: fixed; left: 0; top: 0;");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",ca&&(n.width=n.height=1,e.display.wrapper.appendChild(n),n._top=n.offsetTop),t.dataTransfer.setDragImage(n,0,0),ca&&n.parentNode.removeChild(n)}}function Kn(e,t){Math.abs(e.doc.scrollTop-t)<2||(e.doc.scrollTop=t,ta||M(e,{top:t}),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbars.setScrollTop(t),ta&&M(e),wt(e,100))}function qn(e,t,n){(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)||(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,b(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function zn(e,t){var n=Pa(t),r=n.x,i=n.y,o=e.display,a=o.scroller;if(r&&a.scrollWidth>a.clientWidth||i&&a.scrollHeight>a.clientHeight){if(i&&ga&&aa)e:for(var s=t.target,l=o.view;s!=a;s=s.parentNode)for(var c=0;c<l.length;c++)if(l[c].node==s){e.display.currentWheelTarget=s;break e}if(r&&!ta&&!ca&&null!=Aa)return i&&Kn(e,Math.max(0,Math.min(a.scrollTop+i*Aa,a.scrollHeight-a.clientHeight))),qn(e,Math.max(0,Math.min(a.scrollLeft+r*Aa,a.scrollWidth-a.clientWidth))),ps(t),void(o.wheelStartX=null);if(i&&null!=Aa){var u=i*Aa,d=e.doc.scrollTop,p=d+o.wrapper.clientHeight;0>u?d=Math.max(0,d+u-50):p=Math.min(e.doc.height,p+u+50),M(e,{top:d,bottom:p})}20>xa&&(null==o.wheelStartX?(o.wheelStartX=a.scrollLeft,o.wheelStartY=a.scrollTop,o.wheelDX=r,o.wheelDY=i,setTimeout(function(){if(null!=o.wheelStartX){var e=a.scrollLeft-o.wheelStartX,t=a.scrollTop-o.wheelStartY,n=t&&o.wheelDY&&t/o.wheelDY||e&&o.wheelDX&&e/o.wheelDX;o.wheelStartX=o.wheelStartY=null,n&&(Aa=(Aa*xa+n)/(xa+1),++xa)}},200)):(o.wheelDX+=r,o.wheelDY+=i))}}function Yn(e,t,n){if("string"==typeof t&&(t=Ya[t],!t))return!1;e.display.pollingFast&&Mn(e)&&(e.display.pollingFast=!1);var r=e.display.shift,i=!1;try{xn(e)&&(e.state.suppressEdits=!0),n&&(e.display.shift=!1),i=t(e)!=Es}finally{e.display.shift=r,e.state.suppressEdits=!1}return i}function Xn(e,t,n){for(var r=0;r<e.state.keyMaps.length;r++){var i=Qa(t,e.state.keyMaps[r],n,e);if(i)return i}return e.options.extraKeys&&Qa(t,e.options.extraKeys,n,e)||Qa(t,e.options.keyMap,n,e)}function Qn(e,t,n,r){var i=e.state.keySeq;if(i){if(Ja(t))return"handled";ka.set(50,function(){e.state.keySeq==i&&(e.state.keySeq=null,Ln(e))}),t=i+" "+t}var o=Xn(e,t,r);return"multi"==o&&(e.state.keySeq=t),"handled"==o&&uo(e,"keyHandled",e,t,n),("handled"==o||"multi"==o)&&(ps(n),It(e)),i&&!o&&/\'$/.test(t)?(ps(n),!0):!!o}function Jn(e,t){var n=Za(t,!0);return n?t.shiftKey&&!e.state.keySeq?Qn(e,"Shift-"+n,t,function(t){return Yn(e,t,!0)})||Qn(e,n,t,function(t){return("string"==typeof t?/^go[A-Z]/.test(t):t.motion)?Yn(e,t):void 0}):Qn(e,n,t,function(t){return Yn(e,t)}):!1}function Zn(e,t,n){return Qn(e,"'"+n+"'",t,function(t){return Yn(e,t,!0)})}function er(e){var t=this;if(Nn(t),!ho(t,e)){ia&&11>oa&&27==e.keyCode&&(e.returnValue=!1);var n=e.keyCode;t.display.shift=16==n||e.shiftKey;var r=Jn(t,e);ca&&(Fa=r?n:null,!r&&88==n&&!js&&(ga?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),18!=n||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||tr(t)}}function tr(e){function t(e){18!=e.keyCode&&e.altKey||(xs(n,"CodeMirror-crosshair"),gs(document,"keyup",t),gs(document,"mouseover",t))}var n=e.display.lineDiv;As(n,"CodeMirror-crosshair"),ms(document,"keyup",t),ms(document,"mouseover",t)}function nr(e){16==e.keyCode&&(this.doc.sel.shift=!1),ho(this,e)}function rr(e){var t=this;if(!(ho(t,e)||e.ctrlKey&&!e.altKey||ga&&e.metaKey)){var n=e.keyCode,r=e.charCode;if(ca&&n==Fa)return Fa=null,void ps(e);if(!(ca&&(!e.which||e.which<10)||da)||!Jn(t,e)){var i=String.fromCharCode(null==r?n:r);Zn(t,e,i)||(ia&&oa>=9&&(t.display.inputHasSelection=null),On(t))}}}function ir(e){"nocursor"!=e.options.readOnly&&(e.state.focused||(vs(e,"focus",e),e.state.focused=!0,As(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(Ln(e),aa&&setTimeout(Co(Ln,e,!0),0))),Tn(e),It(e))}function or(e){e.state.focused&&(vs(e,"blur",e),e.state.focused=!1,xs(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150)}function ar(e,t){function n(){if(null!=i.input.selectionStart){var t=e.somethingSelected(),n=i.input.value="​"+(t?i.input.value:"");i.prevInput=t?"":"​",i.input.selectionStart=1,i.input.selectionEnd=n.length,i.selForContextMenu=e.doc.sel}}function r(){if(i.contextMenuPending=!1,i.inputDiv.style.position="relative",i.input.style.cssText=l,ia&&9>oa&&i.scrollbars.setScrollTop(i.scroller.scrollTop=a),Tn(e),null!=i.input.selectionStart){(!ia||ia&&9>oa)&&n();var t=0,r=function(){i.selForContextMenu==e.doc.sel&&0==i.input.selectionStart?mn(e,Ya.selectAll)(e):t++<10?i.detectingSelectAll=setTimeout(r,500):Ln(e)};i.detectingSelectAll=setTimeout(r,200)}}if(!ho(e,t,"contextmenu")){var i=e.display;if(!kn(i,t)&&!sr(e,t)){var o=Fn(e,t),a=i.scroller.scrollTop;if(o&&!ca){var s=e.options.resetSelectionOnContextMenu;s&&-1==e.doc.sel.contains(o)&&mn(e,pt)(e.doc,Z(o),bs);var l=i.input.style.cssText;if(i.inputDiv.style.position="absolute",i.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(t.clientY-5)+"px; left: "+(t.clientX-5)+"px; z-index: 1000; background: "+(ia?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",aa)var c=window.scrollY;if(Rn(e),aa&&window.scrollTo(null,c),Ln(e),e.somethingSelected()||(i.input.value=i.prevInput=" "),i.contextMenuPending=!0,i.selForContextMenu=e.doc.sel,clearTimeout(i.detectingSelectAll),ia&&oa>=9&&n(),Ea){fs(t);var u=function(){gs(window,"mouseup",u),setTimeout(r,20)};ms(window,"mouseup",u)}else setTimeout(r,50)}}}}function sr(e,t){return mo(e,"gutterContextMenu")?Bn(e,t,"gutterContextMenu",!1,vs):!1}function lr(e,t){if(wa(e,t.from)<0)return e;if(wa(e,t.to)<=0)return Ua(t);var n=e.line+t.text.length-(t.to.line-t.from.line)-1,r=e.ch;return e.line==t.to.line&&(r+=Ua(t).ch-t.to.ch),Ia(n,r)}function cr(e,t){for(var n=[],r=0;r<e.sel.ranges.length;r++){var i=e.sel.ranges[r];n.push(new Q(lr(i.anchor,t),lr(i.head,t)))}return J(n,e.sel.primIndex)}function ur(e,t,n){return e.line==t.line?Ia(n.line,e.ch-t.ch+n.ch):Ia(n.line+(e.line-t.line),e.ch)}function dr(e,t,n){for(var r=[],i=Ia(e.first,0),o=i,a=0;a<t.length;a++){var s=t[a],l=ur(s.from,i,o),c=ur(Ua(s),i,o);if(i=s.to,o=c,"around"==n){var u=e.sel.ranges[a],d=wa(u.head,u.anchor)<0;r[a]=new Q(d?c:l,d?l:c)}else r[a]=new Q(l,l)}return new X(r,e.sel.primIndex)}function pr(e,t,n){var r={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){this.canceled=!0}};return n&&(r.update=function(t,n,r,i){t&&(this.from=tt(e,t)),n&&(this.to=tt(e,n)),r&&(this.text=r),void 0!==i&&(this.origin=i)}),vs(e,"beforeChange",e,r),e.cm&&vs(e.cm,"beforeChange",e.cm,r),r.canceled?null:{from:r.from,to:r.to,text:r.text,origin:r.origin}}function hr(e,t,n){if(e.cm){if(!e.cm.curOp)return mn(e.cm,hr)(e,t,n);if(e.cm.state.suppressEdits)return}if(!(mo(e,"beforeChange")||e.cm&&mo(e.cm,"beforeChange"))||(t=pr(e,t,!0))){var r=ba&&!n&&Yr(e,t.from,t.to);if(r)for(var i=r.length-1;i>=0;--i)fr(e,{from:r[i].from,to:r[i].to,text:i?[""]:t.text});else fr(e,t)}}function fr(e,t){if(1!=t.text.length||""!=t.text[0]||0!=wa(t.from,t.to)){var n=cr(e,t);Xi(e,t,n,e.cm?e.cm.curOp.id:0/0),vr(e,t,n,Kr(e,t));var r=[];ki(e,function(e,n){n||-1!=bo(r,e.history)||(ao(e.history,t),r.push(e.history)),vr(e,t,null,Kr(e,t))})}}function mr(e,t,n){if(!e.cm||!e.cm.state.suppressEdits){for(var r,i=e.history,o=e.sel,a="undo"==t?i.done:i.undone,s="undo"==t?i.undone:i.done,l=0;l<a.length&&(r=a[l],n?!r.ranges||r.equals(e.sel):r.ranges);l++);if(l!=a.length){for(i.lastOrigin=i.lastSelOrigin=null;r=a.pop(),r.ranges;){if(Zi(r,s),n&&!r.equals(e.sel))return void pt(e,r,{clearRedo:!1});o=r}var c=[];Zi(o,s),s.push({changes:c,generation:i.generation}),i.generation=r.generation||++i.maxGeneration;for(var u=mo(e,"beforeChange")||e.cm&&mo(e.cm,"beforeChange"),l=r.changes.length-1;l>=0;--l){var d=r.changes[l];if(d.origin=t,u&&!pr(e,d,!1))return void(a.length=0);c.push(qi(e,d));var p=l?cr(e,d):Eo(a);vr(e,d,p,zr(e,d)),!l&&e.cm&&e.cm.scrollIntoView({from:d.from,to:Ua(d)});var h=[];ki(e,function(e,t){t||-1!=bo(h,e.history)||(ao(e.history,d),h.push(e.history)),vr(e,d,null,zr(e,d))})}}}}function gr(e,t){if(0!=t&&(e.first+=t,e.sel=new X(So(e.sel.ranges,function(e){return new Q(Ia(e.anchor.line+t,e.anchor.ch),Ia(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){En(e.cm,e.first,e.first-t,t);for(var n=e.cm.display,r=n.viewFrom;r<n.viewTo;r++)bn(e.cm,r,"gutter")}}function vr(e,t,n,r){if(e.cm&&!e.cm.curOp)return mn(e.cm,vr)(e,t,n,r);if(t.to.line<e.first)return void gr(e,t.text.length-1-(t.to.line-t.from.line));if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var i=t.text.length-1-(e.first-t.from.line);gr(e,i),t={from:Ia(e.first,0),to:Ia(t.to.line+i,t.to.ch),text:[Eo(t.text)],origin:t.origin}}var o=e.lastLine();t.to.line>o&&(t={from:t.from,to:Ia(o,Ui(e,o).text.length),text:[t.text[0]],origin:t.origin}),t.removed=ji(e,t.from,t.to),n||(n=cr(e,t)),e.cm?yr(e.cm,t,r):xi(e,t,r),ht(e,n,bs)}}function yr(e,t,n){var r=e.doc,i=e.display,a=t.from,s=t.to,l=!1,c=a.line;e.options.lineWrapping||(c=Bi(oi(Ui(r,a.line))),r.iter(c,s.line+1,function(e){return e==i.maxLine?(l=!0,!0):void 0})),r.sel.contains(t.from,t.to)>-1&&fo(e),xi(r,t,n,o(e)),e.options.lineWrapping||(r.iter(c,a.line+t.text.length,function(e){var t=d(e);t>i.maxLineLength&&(i.maxLine=e,i.maxLineLength=t,i.maxLineChanged=!0,l=!1)}),l&&(e.curOp.updateMaxLine=!0)),r.frontier=Math.min(r.frontier,a.line),wt(e,400);var u=t.text.length-(s.line-a.line)-1;t.full?En(e):a.line!=s.line||1!=t.text.length||Ni(e.doc,t)?En(e,a.line,s.line+1,u):bn(e,a.line,"text");var p=mo(e,"changes"),h=mo(e,"change");if(h||p){var f={from:a,to:s,text:t.text,removed:t.removed,origin:t.origin};h&&uo(e,"change",e,f),p&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(f)}e.display.selForContextMenu=null}function _r(e,t,n,r,i){if(r||(r=n),wa(r,n)<0){var o=r;r=n,n=o}"string"==typeof t&&(t=Fs(t)),hr(e,{from:n,to:r,text:t,origin:i})}function Er(e,t){if(!ho(e,"scrollCursorIntoView")){var n=e.display,r=n.sizer.getBoundingClientRect(),i=null;if(t.top+r.top<0?i=!0:t.bottom+r.top>(window.innerHeight||document.documentElement.clientHeight)&&(i=!1),null!=i&&!ha){var o=Mo("div","​",null,"position: absolute; top: "+(t.top-n.viewOffset-Ot(e.display))+"px; height: "+(t.bottom-t.top+Rt(e)+n.barHeight)+"px; left: "+t.left+"px; width: 2px;");e.display.lineSpace.appendChild(o),o.scrollIntoView(i),e.display.lineSpace.removeChild(o)}}}function br(e,t,n,r){null==r&&(r=0);for(var i=0;5>i;i++){var o=!1,a=Qt(e,t),s=n&&n!=t?Qt(e,n):a,l=Ir(e,Math.min(a.left,s.left),Math.min(a.top,s.top)-r,Math.max(a.left,s.left),Math.max(a.bottom,s.bottom)+r),c=e.doc.scrollTop,u=e.doc.scrollLeft;if(null!=l.scrollTop&&(Kn(e,l.scrollTop),Math.abs(e.doc.scrollTop-c)>1&&(o=!0)),null!=l.scrollLeft&&(qn(e,l.scrollLeft),Math.abs(e.doc.scrollLeft-u)>1&&(o=!0)),!o)break}return a}function Sr(e,t,n,r,i){var o=Ir(e,t,n,r,i);null!=o.scrollTop&&Kn(e,o.scrollTop),null!=o.scrollLeft&&qn(e,o.scrollLeft)}function Ir(e,t,n,r,i){var o=e.display,a=nn(e.display);0>n&&(n=0);var s=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:o.scroller.scrollTop,l=xt(e),c={};i-n>l&&(i=n+l);var u=e.doc.height+Mt(o),d=a>n,p=i>u-a;if(s>n)c.scrollTop=d?0:n;else if(i>s+l){var h=Math.min(n,(p?u:i)-l);h!=s&&(c.scrollTop=h)}var f=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:o.scroller.scrollLeft,m=Nt(e)-(e.options.fixedGutter?o.gutters.offsetWidth:0),g=r-t>m;return g&&(r=t+m),10>t?c.scrollLeft=0:f>t?c.scrollLeft=Math.max(0,t-(g?0:10)):r>m+f-3&&(c.scrollLeft=r+(g?0:10)-m),c}function wr(e,t,n){(null!=t||null!=n)&&Dr(e),null!=t&&(e.curOp.scrollLeft=(null==e.curOp.scrollLeft?e.doc.scrollLeft:e.curOp.scrollLeft)+t),null!=n&&(e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+n)}function Cr(e){Dr(e);var t=e.getCursor(),n=t,r=t;e.options.lineWrapping||(n=t.ch?Ia(t.line,t.ch-1):t,r=Ia(t.line,t.ch+1)),e.curOp.scrollToPos={from:n,to:r,margin:e.options.cursorScrollMargin,isCursor:!0}}function Dr(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var n=Jt(e,t.from),r=Jt(e,t.to),i=Ir(e,Math.min(n.left,r.left),Math.min(n.top,r.top)-t.margin,Math.max(n.right,r.right),Math.max(n.bottom,r.bottom)+t.margin);e.scrollTo(i.scrollLeft,i.scrollTop)}}function Tr(e,t,n,r){var i,o=e.doc;null==n&&(n="add"),"smart"==n&&(o.mode.indent?i=Tt(e,t):n="prev");var a=e.options.tabSize,s=Ui(o,t),l=ws(s.text,null,a);s.stateAfter&&(s.stateAfter=null);var c,u=s.text.match(/^\s*/)[0];if(r||/\S/.test(s.text)){if("smart"==n&&(c=o.mode.indent(i,s.text.slice(u.length),s.text),c==Es||c>150)){if(!r)return;n="prev"}}else c=0,n="not";"prev"==n?c=t>o.first?ws(Ui(o,t-1).text,null,a):0:"add"==n?c=l+e.options.indentUnit:"subtract"==n?c=l-e.options.indentUnit:"number"==typeof n&&(c=l+n),c=Math.max(0,c);var d="",p=0;if(e.options.indentWithTabs)for(var h=Math.floor(c/a);h;--h)p+=a,d+="	";if(c>p&&(d+=_o(c-p)),d!=u)_r(o,d,Ia(t,0),Ia(t,u.length),"+input");else for(var h=0;h<o.sel.ranges.length;h++){var f=o.sel.ranges[h];if(f.head.line==t&&f.head.ch<u.length){var p=Ia(t,u.length);lt(o,h,new Q(p,p));break}}s.stateAfter=null}function Or(e,t,n,r){var i=t,o=t;return"number"==typeof t?o=Ui(e,et(e,t)):i=Bi(t),null==i?null:(r(o,i)&&e.cm&&bn(e.cm,i,n),o)}function Mr(e,t){for(var n=e.doc.sel.ranges,r=[],i=0;i<n.length;i++){for(var o=t(n[i]);r.length&&wa(o.from,Eo(r).to)<=0;){var a=r.pop();if(wa(a.from,o.from)<0){o.from=a.from;break}}r.push(o)}fn(e,function(){for(var t=r.length-1;t>=0;t--)_r(e.doc,"",r[t].from,r[t].to,"+delete");Cr(e)})}function Lr(e,t,n,r,i){function o(){var t=s+n;return t<e.first||t>=e.first+e.size?d=!1:(s=t,u=Ui(e,t))}function a(e){var t=(i?Zo:ea)(u,l,n,!0);if(null==t){if(e||!o())return d=!1;l=i?(0>n?Ko:Go)(u):0>n?u.text.length:0}else l=t;return!0}var s=t.line,l=t.ch,c=n,u=Ui(e,s),d=!0;if("char"==r)a();else if("column"==r)a(!0);else if("word"==r||"group"==r)for(var p=null,h="group"==r,f=e.cm&&e.cm.getHelper(t,"wordChars"),m=!0;!(0>n)||a(!m);m=!1){var g=u.text.charAt(l)||"\n",v=Do(g,f)?"w":h&&"\n"==g?"n":!h||/\s/.test(g)?null:"p";if(!h||m||v||(v="s"),p&&p!=v){0>n&&(n=1,a());break}if(v&&(p=v),n>0&&!a(!m))break}var y=vt(e,Ia(s,l),c,!0);return d||(y.hitSide=!0),y}function Rr(e,t,n,r){var i,o=e.doc,a=t.left;if("page"==r){var s=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);i=t.top+n*(s-(0>n?1.5:.5)*nn(e.display))}else"line"==r&&(i=n>0?t.bottom+3:t.top-3);for(;;){var l=en(e,a,i);if(!l.outside)break;if(0>n?0>=i:i>=o.height){l.hitSide=!0;break}i+=5*n}return l}function Nr(t,n,r,i){e.defaults[t]=n,r&&($a[t]=i?function(e,t,n){n!=Va&&r(e,t,n)}:r)}function xr(e){for(var t,n,r,i,o=e.split(/-(?!$)/),e=o[o.length-1],a=0;a<o.length-1;a++){var s=o[a];if(/^(cmd|meta|m)$/i.test(s))i=!0;else if(/^a(lt)?$/i.test(s))t=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else{if(!/^s(hift)$/i.test(s))throw new Error("Unrecognized modifier name: "+s);r=!0}}return t&&(e="Alt-"+e),n&&(e="Ctrl-"+e),i&&(e="Cmd-"+e),r&&(e="Shift-"+e),e}function Ar(e){return"string"==typeof e?Xa[e]:e}function Pr(e,t,n,r,i){if(r&&r.shared)return kr(e,t,n,r,i);if(e.cm&&!e.cm.curOp)return mn(e.cm,Pr)(e,t,n,r,i);var o=new ts(e,i),a=wa(t,n);if(r&&wo(r,o,!1),a>0||0==a&&o.clearWhenEmpty!==!1)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=Mo("span",[o.replacedWith],"CodeMirror-widget"),r.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),r.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(ii(e,t.line,t,n,o)||t.line!=n.line&&ii(e,n.line,t,n,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");Sa=!0}o.addToHistory&&Xi(e,{from:t,to:n,origin:"markText"},e.sel,0/0);var s,l=t.line,c=e.cm;if(e.iter(l,n.line+1,function(e){c&&o.collapsed&&!c.options.lineWrapping&&oi(e)==c.display.maxLine&&(s=!0),o.collapsed&&l!=t.line&&Vi(e,0),Hr(e,new $r(o,l==t.line?t.ch:null,l==n.line?n.ch:null)),++l}),o.collapsed&&e.iter(t.line,n.line+1,function(t){ci(e,t)&&Vi(t,0)}),o.clearOnEnter&&ms(o,"beforeCursorEnter",function(){o.clear()}),o.readOnly&&(ba=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),o.collapsed&&(o.id=++ns,o.atomic=!0),c){if(s&&(c.curOp.updateMaxLine=!0),o.collapsed)En(c,t.line,n.line+1);else if(o.className||o.title||o.startStyle||o.endStyle||o.css)for(var u=t.line;u<=n.line;u++)bn(c,u,"text");o.atomic&&mt(c.doc),uo(c,"markerAdded",c,o)}return o}function kr(e,t,n,r,i){r=wo(r),r.shared=!1;var o=[Pr(e,t,n,r,i)],a=o[0],s=r.widgetNode;return ki(e,function(e){s&&(r.widgetNode=s.cloneNode(!0)),o.push(Pr(e,tt(e,t),tt(e,n),r,i));for(var l=0;l<e.linked.length;++l)if(e.linked[l].isParent)return;a=Eo(o)}),new rs(o,a)}function Fr(e){return e.findMarks(Ia(e.first,0),e.clipPos(Ia(e.lastLine())),function(e){return e.parent})}function Ur(e,t){for(var n=0;n<t.length;n++){var r=t[n],i=r.find(),o=e.clipPos(i.from),a=e.clipPos(i.to);if(wa(o,a)){var s=Pr(e,o,a,r.primary,r.primary.type);r.markers.push(s),s.parent=r}}}function jr(e){for(var t=0;t<e.length;t++){var n=e[t],r=[n.primary.doc];ki(n.primary.doc,function(e){r.push(e)});for(var i=0;i<n.markers.length;i++){var o=n.markers[i];-1==bo(r,o.doc)&&(o.parent=null,n.markers.splice(i--,1))}}}function $r(e,t,n){this.marker=e,this.from=t,this.to=n}function Vr(e,t){if(e)for(var n=0;n<e.length;++n){var r=e[n];if(r.marker==t)return r}}function Br(e,t){for(var n,r=0;r<e.length;++r)e[r]!=t&&(n||(n=[])).push(e[r]);return n}function Hr(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}function Wr(e,t,n){if(e)for(var r,i=0;i<e.length;++i){var o=e[i],a=o.marker,s=null==o.from||(a.inclusiveLeft?o.from<=t:o.from<t);if(s||o.from==t&&"bookmark"==a.type&&(!n||!o.marker.insertLeft)){var l=null==o.to||(a.inclusiveRight?o.to>=t:o.to>t);(r||(r=[])).push(new $r(a,o.from,l?null:o.to))}}return r}function Gr(e,t,n){if(e)for(var r,i=0;i<e.length;++i){var o=e[i],a=o.marker,s=null==o.to||(a.inclusiveRight?o.to>=t:o.to>t);if(s||o.from==t&&"bookmark"==a.type&&(!n||o.marker.insertLeft)){var l=null==o.from||(a.inclusiveLeft?o.from<=t:o.from<t);(r||(r=[])).push(new $r(a,l?null:o.from-t,null==o.to?null:o.to-t))}}return r}function Kr(e,t){if(t.full)return null;var n=rt(e,t.from.line)&&Ui(e,t.from.line).markedSpans,r=rt(e,t.to.line)&&Ui(e,t.to.line).markedSpans;if(!n&&!r)return null;var i=t.from.ch,o=t.to.ch,a=0==wa(t.from,t.to),s=Wr(n,i,a),l=Gr(r,o,a),c=1==t.text.length,u=Eo(t.text).length+(c?i:0);
if(s)for(var d=0;d<s.length;++d){var p=s[d];if(null==p.to){var h=Vr(l,p.marker);h?c&&(p.to=null==h.to?null:h.to+u):p.to=i}}if(l)for(var d=0;d<l.length;++d){var p=l[d];if(null!=p.to&&(p.to+=u),null==p.from){var h=Vr(s,p.marker);h||(p.from=u,c&&(s||(s=[])).push(p))}else p.from+=u,c&&(s||(s=[])).push(p)}s&&(s=qr(s)),l&&l!=s&&(l=qr(l));var f=[s];if(!c){var m,g=t.text.length-2;if(g>0&&s)for(var d=0;d<s.length;++d)null==s[d].to&&(m||(m=[])).push(new $r(s[d].marker,null,null));for(var d=0;g>d;++d)f.push(m);f.push(l)}return f}function qr(e){for(var t=0;t<e.length;++t){var n=e[t];null!=n.from&&n.from==n.to&&n.marker.clearWhenEmpty!==!1&&e.splice(t--,1)}return e.length?e:null}function zr(e,t){var n=no(e,t),r=Kr(e,t);if(!n)return r;if(!r)return n;for(var i=0;i<n.length;++i){var o=n[i],a=r[i];if(o&&a)e:for(var s=0;s<a.length;++s){for(var l=a[s],c=0;c<o.length;++c)if(o[c].marker==l.marker)continue e;o.push(l)}else a&&(n[i]=a)}return n}function Yr(e,t,n){var r=null;if(e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||r&&-1!=bo(r,n)||(r||(r=[])).push(n)}}),!r)return null;for(var i=[{from:t,to:n}],o=0;o<r.length;++o)for(var a=r[o],s=a.find(0),l=0;l<i.length;++l){var c=i[l];if(!(wa(c.to,s.from)<0||wa(c.from,s.to)>0)){var u=[l,1],d=wa(c.from,s.from),p=wa(c.to,s.to);(0>d||!a.inclusiveLeft&&!d)&&u.push({from:c.from,to:s.from}),(p>0||!a.inclusiveRight&&!p)&&u.push({from:s.to,to:c.to}),i.splice.apply(i,u),l+=u.length-1}}return i}function Xr(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function Qr(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function Jr(e){return e.inclusiveLeft?-1:0}function Zr(e){return e.inclusiveRight?1:0}function ei(e,t){var n=e.lines.length-t.lines.length;if(0!=n)return n;var r=e.find(),i=t.find(),o=wa(r.from,i.from)||Jr(e)-Jr(t);if(o)return-o;var a=wa(r.to,i.to)||Zr(e)-Zr(t);return a?a:t.id-e.id}function ti(e,t){var n,r=Sa&&e.markedSpans;if(r)for(var i,o=0;o<r.length;++o)i=r[o],i.marker.collapsed&&null==(t?i.from:i.to)&&(!n||ei(n,i.marker)<0)&&(n=i.marker);return n}function ni(e){return ti(e,!0)}function ri(e){return ti(e,!1)}function ii(e,t,n,r,i){var o=Ui(e,t),a=Sa&&o.markedSpans;if(a)for(var s=0;s<a.length;++s){var l=a[s];if(l.marker.collapsed){var c=l.marker.find(0),u=wa(c.from,n)||Jr(l.marker)-Jr(i),d=wa(c.to,r)||Zr(l.marker)-Zr(i);if(!(u>=0&&0>=d||0>=u&&d>=0)&&(0>=u&&(wa(c.to,n)>0||l.marker.inclusiveRight&&i.inclusiveLeft)||u>=0&&(wa(c.from,r)<0||l.marker.inclusiveLeft&&i.inclusiveRight)))return!0}}}function oi(e){for(var t;t=ni(e);)e=t.find(-1,!0).line;return e}function ai(e){for(var t,n;t=ri(e);)e=t.find(1,!0).line,(n||(n=[])).push(e);return n}function si(e,t){var n=Ui(e,t),r=oi(n);return n==r?t:Bi(r)}function li(e,t){if(t>e.lastLine())return t;var n,r=Ui(e,t);if(!ci(e,r))return t;for(;n=ri(r);)r=n.find(1,!0).line;return Bi(r)+1}function ci(e,t){var n=Sa&&t.markedSpans;if(n)for(var r,i=0;i<n.length;++i)if(r=n[i],r.marker.collapsed){if(null==r.from)return!0;if(!r.marker.widgetNode&&0==r.from&&r.marker.inclusiveLeft&&ui(e,t,r))return!0}}function ui(e,t,n){if(null==n.to){var r=n.marker.find(1,!0);return ui(e,r.line,Vr(r.line.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(var i,o=0;o<t.markedSpans.length;++o)if(i=t.markedSpans[o],i.marker.collapsed&&!i.marker.widgetNode&&i.from==n.to&&(null==i.to||i.to!=n.from)&&(i.marker.inclusiveLeft||n.marker.inclusiveRight)&&ui(e,t,i))return!0}function di(e,t,n){Wi(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&wr(e,null,n)}function pi(e){if(null!=e.height)return e.height;if(!No(document.body,e.node)){var t="position: relative;";e.coverGutter&&(t+="margin-left: -"+e.cm.getGutterElement().offsetWidth+"px;"),Ro(e.cm.display.measure,Mo("div",[e.node],null,t))}return e.height=e.node.offsetHeight}function hi(e,t,n,r){var i=new is(e,n,r);return i.noHScroll&&(e.display.alignWidgets=!0),Or(e.doc,t,"widget",function(t){var n=t.widgets||(t.widgets=[]);if(null==i.insertAt?n.push(i):n.splice(Math.min(n.length-1,Math.max(0,i.insertAt)),0,i),i.line=t,!ci(e.doc,t)){var r=Wi(t)<e.doc.scrollTop;Vi(t,t.height+pi(i)),r&&wr(e,null,i.height),e.curOp.forceUpdate=!0}return!0}),i}function fi(e,t,n,r){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),Xr(e),Qr(e,n);var i=r?r(e):1;i!=e.height&&Vi(e,i)}function mi(e){e.parent=null,Xr(e)}function gi(e,t){if(e)for(;;){var n=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;e=e.slice(0,n.index)+e.slice(n.index+n[0].length);var r=n[1]?"bgClass":"textClass";null==t[r]?t[r]=n[2]:new RegExp("(?:^|s)"+n[2]+"(?:$|s)").test(t[r])||(t[r]+=" "+n[2])}return e}function vi(t,n){if(t.blankLine)return t.blankLine(n);if(t.innerMode){var r=e.innerMode(t,n);return r.mode.blankLine?r.mode.blankLine(r.state):void 0}}function yi(t,n,r,i){for(var o=0;10>o;o++){i&&(i[0]=e.innerMode(t,r).mode);var a=t.token(n,r);if(n.pos>n.start)return a}throw new Error("Mode "+t.name+" failed to advance stream.")}function _i(e,t,n,r){function i(e){return{start:d.start,end:d.pos,string:d.current(),type:o||null,state:e?qa(a.mode,u):u}}var o,a=e.doc,s=a.mode;t=tt(a,t);var l,c=Ui(a,t.line),u=Tt(e,t.line,n),d=new es(c.text,e.options.tabSize);for(r&&(l=[]);(r||d.pos<t.ch)&&!d.eol();)d.start=d.pos,o=yi(s,d,u),r&&l.push(i(!0));return r?l:i()}function Ei(e,t,n,r,i,o,a){var s=n.flattenSpans;null==s&&(s=e.options.flattenSpans);var l,c=0,u=null,d=new es(t,e.options.tabSize),p=e.options.addModeClass&&[null];for(""==t&&gi(vi(n,r),o);!d.eol();){if(d.pos>e.options.maxHighlightLength?(s=!1,a&&Ii(e,t,r,d.pos),d.pos=t.length,l=null):l=gi(yi(n,d,r,p),o),p){var h=p[0].name;h&&(l="m-"+(l?h+" "+l:h))}if(!s||u!=l){for(;c<d.start;)c=Math.min(d.start,c+5e4),i(c,u);u=l}d.start=d.pos}for(;c<d.pos;){var f=Math.min(d.pos,c+5e4);i(f,u),c=f}}function bi(e,t,n,r){var i=[e.state.modeGen],o={};Ei(e,t.text,e.doc.mode,n,function(e,t){i.push(e,t)},o,r);for(var a=0;a<e.state.overlays.length;++a){var s=e.state.overlays[a],l=1,c=0;Ei(e,t.text,s.mode,!0,function(e,t){for(var n=l;e>c;){var r=i[l];r>e&&i.splice(l,1,e,i[l+1],r),l+=2,c=Math.min(e,r)}if(t)if(s.opaque)i.splice(n,l-n,e,"cm-overlay "+t),l=n+2;else for(;l>n;n+=2){var o=i[n+1];i[n+1]=(o?o+" ":"")+"cm-overlay "+t}},o)}return{styles:i,classes:o.bgClass||o.textClass?o:null}}function Si(e,t,n){if(!t.styles||t.styles[0]!=e.state.modeGen){var r=bi(e,t,t.stateAfter=Tt(e,Bi(t)));t.styles=r.styles,r.classes?t.styleClasses=r.classes:t.styleClasses&&(t.styleClasses=null),n===e.doc.frontier&&e.doc.frontier++}return t.styles}function Ii(e,t,n,r){var i=e.doc.mode,o=new es(t,e.options.tabSize);for(o.start=o.pos=r||0,""==t&&vi(i,n);!o.eol()&&o.pos<=e.options.maxHighlightLength;)yi(i,o,n),o.start=o.pos}function wi(e,t){if(!e||/^\s*$/.test(e))return null;var n=t.addModeClass?ss:as;return n[e]||(n[e]=e.replace(/\S+/g,"cm-$&"))}function Ci(e,t){var n=Mo("span",null,null,aa?"padding-right: .1px":null),r={pre:Mo("pre",[n]),content:n,col:0,pos:0,cm:e};t.measure={};for(var i=0;i<=(t.rest?t.rest.length:0);i++){var o,a=i?t.rest[i-1]:t.line;r.pos=0,r.addToken=Ti,(ia||aa)&&e.getOption("lineWrapping")&&(r.addToken=Oi(r.addToken)),$o(e.display.measure)&&(o=Gi(a))&&(r.addToken=Mi(r.addToken,o)),r.map=[];var s=t!=e.display.externalMeasured&&Bi(a);Ri(a,r,Si(e,a,s)),a.styleClasses&&(a.styleClasses.bgClass&&(r.bgClass=Po(a.styleClasses.bgClass,r.bgClass||"")),a.styleClasses.textClass&&(r.textClass=Po(a.styleClasses.textClass,r.textClass||""))),0==r.map.length&&r.map.push(0,0,r.content.appendChild(jo(e.display.measure))),0==i?(t.measure.map=r.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(r.map),(t.measure.caches||(t.measure.caches=[])).push({}))}return aa&&/\bcm-tab\b/.test(r.content.lastChild.className)&&(r.content.className="cm-tab-wrap-hack"),vs(e,"renderLine",e,t.line,r.pre),r.pre.className&&(r.textClass=Po(r.pre.className,r.textClass||"")),r}function Di(e){var t=Mo("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t}function Ti(e,t,n,r,i,o,a){if(t){var s=e.cm.options.specialChars,l=!1;if(s.test(t))for(var c=document.createDocumentFragment(),u=0;;){s.lastIndex=u;var d=s.exec(t),p=d?d.index-u:t.length-u;if(p){var h=document.createTextNode(t.slice(u,u+p));c.appendChild(ia&&9>oa?Mo("span",[h]):h),e.map.push(e.pos,e.pos+p,h),e.col+=p,e.pos+=p}if(!d)break;if(u+=p+1,"	"==d[0]){var f=e.cm.options.tabSize,m=f-e.col%f,h=c.appendChild(Mo("span",_o(m),"cm-tab"));e.col+=m}else{var h=e.cm.options.specialCharPlaceholder(d[0]);c.appendChild(ia&&9>oa?Mo("span",[h]):h),e.col+=1}e.map.push(e.pos,e.pos+1,h),e.pos++}else{e.col+=t.length;var c=document.createTextNode(t);e.map.push(e.pos,e.pos+t.length,c),ia&&9>oa&&(l=!0),e.pos+=t.length}if(n||r||i||l||a){var g=n||"";r&&(g+=r),i&&(g+=i);var v=Mo("span",[c],g,a);return o&&(v.title=o),e.content.appendChild(v)}e.content.appendChild(c)}}function Oi(e){function t(e){for(var t=" ",n=0;n<e.length-2;++n)t+=n%2?" ":" ";return t+=" "}return function(n,r,i,o,a,s){e(n,r.replace(/ {3,}/g,t),i,o,a,s)}}function Mi(e,t){return function(n,r,i,o,a,s){i=i?i+" cm-force-border":"cm-force-border";for(var l=n.pos,c=l+r.length;;){for(var u=0;u<t.length;u++){var d=t[u];if(d.to>l&&d.from<=l)break}if(d.to>=c)return e(n,r,i,o,a,s);e(n,r.slice(0,d.to-l),i,o,null,s),o=null,r=r.slice(d.to-l),l=d.to}}}function Li(e,t,n,r){var i=!r&&n.widgetNode;i&&(e.map.push(e.pos,e.pos+t,i),e.content.appendChild(i)),e.pos+=t}function Ri(e,t,n){var r=e.markedSpans,i=e.text,o=0;if(r)for(var a,s,l,c,u,d,p,h=i.length,f=0,m=1,g="",v=0;;){if(v==f){l=c=u=d=s="",p=null,v=1/0;for(var y=[],_=0;_<r.length;++_){var E=r[_],b=E.marker;E.from<=f&&(null==E.to||E.to>f)?(null!=E.to&&v>E.to&&(v=E.to,c=""),b.className&&(l+=" "+b.className),b.css&&(s=b.css),b.startStyle&&E.from==f&&(u+=" "+b.startStyle),b.endStyle&&E.to==v&&(c+=" "+b.endStyle),b.title&&!d&&(d=b.title),b.collapsed&&(!p||ei(p.marker,b)<0)&&(p=E)):E.from>f&&v>E.from&&(v=E.from),"bookmark"==b.type&&E.from==f&&b.widgetNode&&y.push(b)}if(p&&(p.from||0)==f&&(Li(t,(null==p.to?h+1:p.to)-f,p.marker,null==p.from),null==p.to))return;if(!p&&y.length)for(var _=0;_<y.length;++_)Li(t,0,y[_])}if(f>=h)break;for(var S=Math.min(h,v);;){if(g){var I=f+g.length;if(!p){var w=I>S?g.slice(0,S-f):g;t.addToken(t,w,a?a+l:l,u,f+w.length==v?c:"",d,s)}if(I>=S){g=g.slice(S-f),f=S;break}f=I,u=""}g=i.slice(o,o=n[m++]),a=wi(n[m++],t.cm.options)}}else for(var m=1;m<n.length;m+=2)t.addToken(t,i.slice(o,o=n[m]),wi(n[m+1],t.cm.options))}function Ni(e,t){return 0==t.from.ch&&0==t.to.ch&&""==Eo(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function xi(e,t,n,r){function i(e){return n?n[e]:null}function o(e,n,i){fi(e,n,i,r),uo(e,"change",e,t)}function a(e,t){for(var n=e,o=[];t>n;++n)o.push(new os(c[n],i(n),r));return o}var s=t.from,l=t.to,c=t.text,u=Ui(e,s.line),d=Ui(e,l.line),p=Eo(c),h=i(c.length-1),f=l.line-s.line;if(t.full)e.insert(0,a(0,c.length)),e.remove(c.length,e.size-c.length);else if(Ni(e,t)){var m=a(0,c.length-1);o(d,d.text,h),f&&e.remove(s.line,f),m.length&&e.insert(s.line,m)}else if(u==d)if(1==c.length)o(u,u.text.slice(0,s.ch)+p+u.text.slice(l.ch),h);else{var m=a(1,c.length-1);m.push(new os(p+u.text.slice(l.ch),h,r)),o(u,u.text.slice(0,s.ch)+c[0],i(0)),e.insert(s.line+1,m)}else if(1==c.length)o(u,u.text.slice(0,s.ch)+c[0]+d.text.slice(l.ch),i(0)),e.remove(s.line+1,f);else{o(u,u.text.slice(0,s.ch)+c[0],i(0)),o(d,p+d.text.slice(l.ch),h);var m=a(1,c.length-1);f>1&&e.remove(s.line+1,f-1),e.insert(s.line+1,m)}uo(e,"change",e,t)}function Ai(e){this.lines=e,this.parent=null;for(var t=0,n=0;t<e.length;++t)e[t].parent=this,n+=e[t].height;this.height=n}function Pi(e){this.children=e;for(var t=0,n=0,r=0;r<e.length;++r){var i=e[r];t+=i.chunkSize(),n+=i.height,i.parent=this}this.size=t,this.height=n,this.parent=null}function ki(e,t,n){function r(e,i,o){if(e.linked)for(var a=0;a<e.linked.length;++a){var s=e.linked[a];if(s.doc!=i){var l=o&&s.sharedHist;(!n||l)&&(t(s.doc,l),r(s.doc,e,l))}}}r(e,null,!0)}function Fi(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,a(e),n(e),e.options.lineWrapping||p(e),e.options.mode=t.modeOption,En(e)}function Ui(e,t){if(t-=e.first,0>t||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var n=e;!n.lines;)for(var r=0;;++r){var i=n.children[r],o=i.chunkSize();if(o>t){n=i;break}t-=o}return n.lines[t]}function ji(e,t,n){var r=[],i=t.line;return e.iter(t.line,n.line+1,function(e){var o=e.text;i==n.line&&(o=o.slice(0,n.ch)),i==t.line&&(o=o.slice(t.ch)),r.push(o),++i}),r}function $i(e,t,n){var r=[];return e.iter(t,n,function(e){r.push(e.text)}),r}function Vi(e,t){var n=t-e.height;if(n)for(var r=e;r;r=r.parent)r.height+=n}function Bi(e){if(null==e.parent)return null;for(var t=e.parent,n=bo(t.lines,e),r=t.parent;r;t=r,r=r.parent)for(var i=0;r.children[i]!=t;++i)n+=r.children[i].chunkSize();return n+t.first}function Hi(e,t){var n=e.first;e:do{for(var r=0;r<e.children.length;++r){var i=e.children[r],o=i.height;if(o>t){e=i;continue e}t-=o,n+=i.chunkSize()}return n}while(!e.lines);for(var r=0;r<e.lines.length;++r){var a=e.lines[r],s=a.height;if(s>t)break;t-=s}return n+r}function Wi(e){e=oi(e);for(var t=0,n=e.parent,r=0;r<n.lines.length;++r){var i=n.lines[r];if(i==e)break;t+=i.height}for(var o=n.parent;o;n=o,o=n.parent)for(var r=0;r<o.children.length;++r){var a=o.children[r];if(a==n)break;t+=a.height}return t}function Gi(e){var t=e.order;return null==t&&(t=e.order=Hs(e.text)),t}function Ki(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function qi(e,t){var n={from:q(t.from),to:Ua(t),text:ji(e,t.from,t.to)};return eo(e,n,t.from.line,t.to.line+1),ki(e,function(e){eo(e,n,t.from.line,t.to.line+1)},!0),n}function zi(e){for(;e.length;){var t=Eo(e);if(!t.ranges)break;e.pop()}}function Yi(e,t){return t?(zi(e.done),Eo(e.done)):e.done.length&&!Eo(e.done).ranges?Eo(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),Eo(e.done)):void 0}function Xi(e,t,n,r){var i=e.history;i.undone.length=0;var o,a=+new Date;if((i.lastOp==r||i.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&i.lastModTime>a-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))&&(o=Yi(i,i.lastOp==r))){var s=Eo(o.changes);0==wa(t.from,t.to)&&0==wa(t.from,s.to)?s.to=Ua(t):o.changes.push(qi(e,t))}else{var l=Eo(i.done);for(l&&l.ranges||Zi(e.sel,i.done),o={changes:[qi(e,t)],generation:i.generation},i.done.push(o);i.done.length>i.undoDepth;)i.done.shift(),i.done[0].ranges||i.done.shift()}i.done.push(n),i.generation=++i.maxGeneration,i.lastModTime=i.lastSelTime=a,i.lastOp=i.lastSelOp=r,i.lastOrigin=i.lastSelOrigin=t.origin,s||vs(e,"historyAdded")}function Qi(e,t,n,r){var i=t.charAt(0);return"*"==i||"+"==i&&n.ranges.length==r.ranges.length&&n.somethingSelected()==r.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function Ji(e,t,n,r){var i=e.history,o=r&&r.origin;n==i.lastSelOp||o&&i.lastSelOrigin==o&&(i.lastModTime==i.lastSelTime&&i.lastOrigin==o||Qi(e,o,Eo(i.done),t))?i.done[i.done.length-1]=t:Zi(t,i.done),i.lastSelTime=+new Date,i.lastSelOrigin=o,i.lastSelOp=n,r&&r.clearRedo!==!1&&zi(i.undone)}function Zi(e,t){var n=Eo(t);n&&n.ranges&&n.equals(e)||t.push(e)}function eo(e,t,n,r){var i=t["spans_"+e.id],o=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,r),function(n){n.markedSpans&&((i||(i=t["spans_"+e.id]={}))[o]=n.markedSpans),++o})}function to(e){if(!e)return null;for(var t,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?t||(t=e.slice(0,n)):t&&t.push(e[n]);return t?t.length?t:null:e}function no(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var r=0,i=[];r<t.text.length;++r)i.push(to(n[r]));return i}function ro(e,t,n){for(var r=0,i=[];r<e.length;++r){var o=e[r];if(o.ranges)i.push(n?X.prototype.deepCopy.call(o):o);else{var a=o.changes,s=[];i.push({changes:s});for(var l=0;l<a.length;++l){var c,u=a[l];if(s.push({from:u.from,to:u.to,text:u.text}),t)for(var d in u)(c=d.match(/^spans_(\d+)$/))&&bo(t,Number(c[1]))>-1&&(Eo(s)[d]=u[d],delete u[d])}}}return i}function io(e,t,n,r){n<e.line?e.line+=r:t<e.line&&(e.line=t,e.ch=0)}function oo(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i],a=!0;if(o.ranges){o.copied||(o=e[i]=o.deepCopy(),o.copied=!0);for(var s=0;s<o.ranges.length;s++)io(o.ranges[s].anchor,t,n,r),io(o.ranges[s].head,t,n,r)}else{for(var s=0;s<o.changes.length;++s){var l=o.changes[s];if(n<l.from.line)l.from=Ia(l.from.line+r,l.from.ch),l.to=Ia(l.to.line+r,l.to.ch);else if(t<=l.to.line){a=!1;break}}a||(e.splice(0,i+1),i=0)}}}function ao(e,t){var n=t.from.line,r=t.to.line,i=t.text.length-(r-n)-1;oo(e.done,n,r,i),oo(e.undone,n,r,i)}function so(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function lo(e){return e.target||e.srcElement}function co(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),ga&&e.ctrlKey&&1==t&&(t=3),t}function uo(e,t){function n(e){return function(){e.apply(null,o)}}var r=e._handlers&&e._handlers[t];if(r){var i,o=Array.prototype.slice.call(arguments,2);Ma?i=Ma.delayedCallbacks:ys?i=ys:(i=ys=[],setTimeout(po,0));for(var a=0;a<r.length;++a)i.push(n(r[a]))}}function po(){var e=ys;ys=null;for(var t=0;t<e.length;++t)e[t]()}function ho(e,t,n){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),vs(e,n||t.type,e,t),so(t)||t.codemirrorIgnore}function fo(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var n=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),r=0;r<t.length;++r)-1==bo(n,t[r])&&n.push(t[r])}function mo(e,t){var n=e._handlers&&e._handlers[t];return n&&n.length>0}function go(e){e.prototype.on=function(e,t){ms(this,e,t)},e.prototype.off=function(e,t){gs(this,e,t)}}function vo(){this.id=null}function yo(e,t,n){for(var r=0,i=0;;){var o=e.indexOf("	",r);-1==o&&(o=e.length);var a=o-r;if(o==e.length||i+a>=t)return r+Math.min(a,t-i);if(i+=o-r,i+=n-i%n,r=o+1,i>=t)return r}}function _o(e){for(;Cs.length<=e;)Cs.push(Eo(Cs)+" ");return Cs[e]}function Eo(e){return e[e.length-1]}function bo(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1}function So(e,t){for(var n=[],r=0;r<e.length;r++)n[r]=t(e[r],r);return n}function Io(e,t){var n;if(Object.create)n=Object.create(e);else{var r=function(){};r.prototype=e,n=new r}return t&&wo(t,n),n}function wo(e,t,n){t||(t={});for(var r in e)!e.hasOwnProperty(r)||n===!1&&t.hasOwnProperty(r)||(t[r]=e[r]);return t}function Co(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function Do(e,t){return t?t.source.indexOf("\\w")>-1&&Ms(e)?!0:t.test(e):Ms(e)}function To(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function Oo(e){return e.charCodeAt(0)>=768&&Ls.test(e)}function Mo(e,t,n,r){var i=document.createElement(e);if(n&&(i.className=n),r&&(i.style.cssText=r),"string"==typeof t)i.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)i.appendChild(t[o]);return i}function Lo(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function Ro(e,t){return Lo(e).appendChild(t)}function No(e,t){if(e.contains)return e.contains(t);for(;t=t.parentNode;)if(t==e)return!0}function xo(){return document.activeElement}function Ao(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}function Po(e,t){for(var n=e.split(" "),r=0;r<n.length;r++)n[r]&&!Ao(n[r]).test(t)&&(t+=" "+n[r]);return t}function ko(e){if(document.body.getElementsByClassName)for(var t=document.body.getElementsByClassName("CodeMirror"),n=0;n<t.length;n++){var r=t[n].CodeMirror;r&&e(r)}}function Fo(){Ps||(Uo(),Ps=!0)}function Uo(){var e;ms(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,ko(Pn)},100))}),ms(window,"blur",function(){ko(or)})}function jo(e){if(null==Rs){var t=Mo("span","​");Ro(e,Mo("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Rs=t.offsetWidth<=1&&t.offsetHeight>2&&!(ia&&8>oa))}return Rs?Mo("span","​"):Mo("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px")}function $o(e){if(null!=Ns)return Ns;var t=Ro(e,document.createTextNode("AخA")),n=Ts(t,0,1).getBoundingClientRect();if(!n||n.left==n.right)return!1;var r=Ts(t,1,2).getBoundingClientRect();return Ns=r.right-n.right<3}function Vo(e){if(null!=$s)return $s;var t=Ro(e,Mo("span","x")),n=t.getBoundingClientRect(),r=Ts(t,0,1).getBoundingClientRect();return $s=Math.abs(n.left-r.left)>1}function Bo(e,t,n,r){if(!e)return r(t,n,"ltr");for(var i=!1,o=0;o<e.length;++o){var a=e[o];(a.from<n&&a.to>t||t==n&&a.to==t)&&(r(Math.max(a.from,t),Math.min(a.to,n),1==a.level?"rtl":"ltr"),i=!0)}i||r(t,n,"ltr")}function Ho(e){return e.level%2?e.to:e.from}function Wo(e){return e.level%2?e.from:e.to}function Go(e){var t=Gi(e);return t?Ho(t[0]):0}function Ko(e){var t=Gi(e);return t?Wo(Eo(t)):e.text.length}function qo(e,t){var n=Ui(e.doc,t),r=oi(n);r!=n&&(t=Bi(r));var i=Gi(r),o=i?i[0].level%2?Ko(r):Go(r):0;return Ia(t,o)}function zo(e,t){for(var n,r=Ui(e.doc,t);n=ri(r);)r=n.find(1,!0).line,t=null;var i=Gi(r),o=i?i[0].level%2?Go(r):Ko(r):r.text.length;return Ia(null==t?Bi(r):t,o)}function Yo(e,t){var n=qo(e,t.line),r=Ui(e.doc,n.line),i=Gi(r);if(!i||0==i[0].level){var o=Math.max(0,r.text.search(/\S/)),a=t.line==n.line&&t.ch<=o&&t.ch;return Ia(n.line,a?0:o)}return n}function Xo(e,t,n){var r=e[0].level;return t==r?!0:n==r?!1:n>t}function Qo(e,t){Bs=null;for(var n,r=0;r<e.length;++r){var i=e[r];if(i.from<t&&i.to>t)return r;if(i.from==t||i.to==t){if(null!=n)return Xo(e,i.level,e[n].level)?(i.from!=i.to&&(Bs=n),r):(i.from!=i.to&&(Bs=r),n);n=r}}return n}function Jo(e,t,n,r){if(!r)return t+n;do t+=n;while(t>0&&Oo(e.text.charAt(t)));return t}function Zo(e,t,n,r){var i=Gi(e);if(!i)return ea(e,t,n,r);for(var o=Qo(i,t),a=i[o],s=Jo(e,t,a.level%2?-n:n,r);;){if(s>a.from&&s<a.to)return s;if(s==a.from||s==a.to)return Qo(i,s)==o?s:(a=i[o+=n],n>0==a.level%2?a.to:a.from);if(a=i[o+=n],!a)return null;s=n>0==a.level%2?Jo(e,a.to,-1,r):Jo(e,a.from,1,r)}}function ea(e,t,n,r){var i=t+n;if(r)for(;i>0&&Oo(e.text.charAt(i));)i+=n;return 0>i||i>e.text.length?null:i}var ta=/gecko\/\d/i.test(navigator.userAgent),na=/MSIE \d/.test(navigator.userAgent),ra=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),ia=na||ra,oa=ia&&(na?document.documentMode||6:ra[1]),aa=/WebKit\//.test(navigator.userAgent),sa=aa&&/Qt\/\d+\.\d+/.test(navigator.userAgent),la=/Chrome\//.test(navigator.userAgent),ca=/Opera\//.test(navigator.userAgent),ua=/Apple Computer/.test(navigator.vendor),da=/KHTML\//.test(navigator.userAgent),pa=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),ha=/PhantomJS/.test(navigator.userAgent),fa=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),ma=fa||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),ga=fa||/Mac/.test(navigator.platform),va=/win/i.test(navigator.platform),ya=ca&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);ya&&(ya=Number(ya[1])),ya&&ya>=15&&(ca=!1,aa=!0);var _a=ga&&(sa||ca&&(null==ya||12.11>ya)),Ea=ta||ia&&oa>=9,ba=!1,Sa=!1;m.prototype=wo({update:function(e){var t=e.scrollWidth>e.clientWidth+1,n=e.scrollHeight>e.clientHeight+1,r=e.nativeBarWidth;if(n){this.vert.style.display="block",this.vert.style.bottom=t?r+"px":"0";var i=e.viewHeight-(t?r:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+i)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=n?r+"px":"0",this.horiz.style.left=e.barLeft+"px";var o=e.viewWidth-e.barLeft-(n?r:0);this.horiz.firstChild.style.width=e.scrollWidth-e.clientWidth+o+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedOverlay&&e.clientHeight>0&&(0==r&&this.overlayHack(),this.checkedOverlay=!0),{right:n?r:0,bottom:t?r:0}},setScrollLeft:function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e)},setScrollTop:function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e)},overlayHack:function(){var e=ga&&!pa?"12px":"18px";this.horiz.style.minHeight=this.vert.style.minWidth=e;var t=this,n=function(e){lo(e)!=t.vert&&lo(e)!=t.horiz&&mn(t.cm,Un)(e)};ms(this.vert,"mousedown",n),ms(this.horiz,"mousedown",n)},clear:function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)}},m.prototype),g.prototype=wo({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},g.prototype),e.scrollbarModel={"native":m,"null":g};var Ia=e.Pos=function(e,t){return this instanceof Ia?(this.line=e,void(this.ch=t)):new Ia(e,t)},wa=e.cmpPos=function(e,t){return e.line-t.line||e.ch-t.ch};X.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var n=this.ranges[t],r=e.ranges[t];if(0!=wa(n.anchor,r.anchor)||0!=wa(n.head,r.head))return!1}return!0},deepCopy:function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new Q(q(this.ranges[t].anchor),q(this.ranges[t].head));return new X(e,this.primIndex)},somethingSelected:function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},contains:function(e,t){t||(t=e);for(var n=0;n<this.ranges.length;n++){var r=this.ranges[n];if(wa(t,r.from())>=0&&wa(e,r.to())<=0)return n}return-1}},Q.prototype={from:function(){return Y(this.anchor,this.head)},to:function(){return z(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var Ca,Da,Ta,Oa={left:0,right:0,top:0,bottom:0},Ma=null,La=0,Ra=null,Na=0,xa=0,Aa=null;ia?Aa=-.53:ta?Aa=15:la?Aa=-.7:ua&&(Aa=-1/3);var Pa=function(e){var t=e.wheelDeltaX,n=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==n&&e.detail&&e.axis==e.VERTICAL_AXIS?n=e.detail:null==n&&(n=e.wheelDelta),{x:t,y:n}};e.wheelEventPixels=function(e){var t=Pa(e);return t.x*=Aa,t.y*=Aa,t};var ka=new vo,Fa=null,Ua=e.changeEnd=function(e){return e.text?Ia(e.from.line+e.text.length-1,Eo(e.text).length+(1==e.text.length?e.from.ch:0)):e.to};e.prototype={constructor:e,focus:function(){window.focus(),Rn(this),On(this)},setOption:function(e,t){var n=this.options,r=n[e];(n[e]!=t||"mode"==e)&&(n[e]=t,$a.hasOwnProperty(e)&&mn(this,$a[e])(this,t,r))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](Ar(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(t[n]==e||t[n].name==e)return t.splice(n,1),!0},addOverlay:gn(function(t,n){var r=t.token?t:e.getMode(this.options,t);if(r.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:r,modeSpec:t,opaque:n&&n.opaque}),this.state.modeGen++,En(this)}),removeOverlay:gn(function(e){for(var t=this.state.overlays,n=0;n<t.length;++n){var r=t[n].modeSpec;if(r==e||"string"==typeof e&&r.name==e)return t.splice(n,1),this.state.modeGen++,void En(this)}}),indentLine:gn(function(e,t,n){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),rt(this.doc,e)&&Tr(this,e,t,n)}),indentSelection:gn(function(e){for(var t=this.doc.sel.ranges,n=-1,r=0;r<t.length;r++){var i=t[r];if(i.empty())i.head.line>n&&(Tr(this,i.head.line,e,!0),n=i.head.line,r==this.doc.sel.primIndex&&Cr(this));else{var o=i.from(),a=i.to(),s=Math.max(n,o.line);n=Math.min(this.lastLine(),a.line-(a.ch?0:1))+1;for(var l=s;n>l;++l)Tr(this,l,e);var c=this.doc.sel.ranges;0==o.ch&&t.length==c.length&&c[r].from().ch>0&&lt(this.doc,r,new Q(o,c[r].to()),bs)}}}),getTokenAt:function(e,t){return _i(this,e,t)},getLineTokens:function(e,t){return _i(this,Ia(e),t,!0)},getTokenTypeAt:function(e){e=tt(this.doc,e);var t,n=Si(this,Ui(this.doc,e.line)),r=0,i=(n.length-1)/2,o=e.ch;if(0==o)t=n[2];else for(;;){var a=r+i>>1;if((a?n[2*a-1]:0)>=o)i=a;else{if(!(n[2*a+1]<o)){t=n[2*a+2];break}r=a+1}}var s=t?t.indexOf("cm-overlay "):-1;return 0>s?t:0==s?null:t.slice(0,s-1)},getModeAt:function(t){var n=this.doc.mode;return n.innerMode?e.innerMode(n,this.getTokenAt(t).state).mode:n},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var n=[];if(!Ka.hasOwnProperty(t))return Ka;var r=Ka[t],i=this.getModeAt(e);if("string"==typeof i[t])r[i[t]]&&n.push(r[i[t]]);else if(i[t])for(var o=0;o<i[t].length;o++){var a=r[i[t][o]];a&&n.push(a)}else i.helperType&&r[i.helperType]?n.push(r[i.helperType]):r[i.name]&&n.push(r[i.name]);for(var o=0;o<r._global.length;o++){var s=r._global[o];s.pred(i,this)&&-1==bo(n,s.val)&&n.push(s.val)}return n},getStateAfter:function(e,t){var n=this.doc;return e=et(n,null==e?n.first+n.size-1:e),Tt(this,e+1,t)},cursorCoords:function(e,t){var n,r=this.doc.sel.primary();return n=null==e?r.head:"object"==typeof e?tt(this.doc,e):e?r.from():r.to(),Qt(this,n,t||"page")},charCoords:function(e,t){return Xt(this,tt(this.doc,e),t||"page")},coordsChar:function(e,t){return e=Yt(this,e,t||"page"),en(this,e.left,e.top)},lineAtHeight:function(e,t){return e=Yt(this,{top:e,left:0},t||"page").top,Hi(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t){var n=!1,r=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>r&&(e=r,n=!0);var i=Ui(this.doc,e);return zt(this,i,{top:0,left:0},t||"page").top+(n?this.doc.height-Wi(i):0)},defaultTextHeight:function(){return nn(this.display)},defaultCharWidth:function(){return rn(this.display)},setGutterMarker:gn(function(e,t,n){return Or(this.doc,e,"gutter",function(e){var r=e.gutterMarkers||(e.gutterMarkers={});return r[t]=n,!n&&To(r)&&(e.gutterMarkers=null),!0})}),clearGutter:gn(function(e){var t=this,n=t.doc,r=n.first;n.iter(function(n){n.gutterMarkers&&n.gutterMarkers[e]&&(n.gutterMarkers[e]=null,bn(t,r,"gutter"),To(n.gutterMarkers)&&(n.gutterMarkers=null)),++r})}),addLineWidget:gn(function(e,t,n){return hi(this,e,t,n)}),removeLineWidget:function(e){e.clear()},lineInfo:function(e){if("number"==typeof e){if(!rt(this.doc,e))return null;var t=e;if(e=Ui(this.doc,e),!e)return null}else{var t=Bi(e);if(null==t)return null}return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,n,r,i){var o=this.display;e=Qt(this,tt(this.doc,e));var a=e.bottom,s=e.left;if(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),o.sizer.appendChild(t),"over"==r)a=e.top;else if("above"==r||"near"==r){var l=Math.max(o.wrapper.clientHeight,this.doc.height),c=Math.max(o.sizer.clientWidth,o.lineSpace.clientWidth);("above"==r||e.bottom+t.offsetHeight>l)&&e.top>t.offsetHeight?a=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=l&&(a=e.bottom),s+t.offsetWidth>c&&(s=c-t.offsetWidth)}t.style.top=a+"px",t.style.left=t.style.right="","right"==i?(s=o.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==i?s=0:"middle"==i&&(s=(o.sizer.clientWidth-t.offsetWidth)/2),t.style.left=s+"px"),n&&Sr(this,s,a,s+t.offsetWidth,a+t.offsetHeight)},triggerOnKeyDown:gn(er),triggerOnKeyPress:gn(rr),triggerOnKeyUp:nr,execCommand:function(e){return Ya.hasOwnProperty(e)?Ya[e](this):void 0},findPosH:function(e,t,n,r){var i=1;0>t&&(i=-1,t=-t);for(var o=0,a=tt(this.doc,e);t>o&&(a=Lr(this.doc,a,i,n,r),!a.hitSide);++o);return a},moveH:gn(function(e,t){var n=this;n.extendSelectionsBy(function(r){return n.display.shift||n.doc.extend||r.empty()?Lr(n.doc,r.head,e,t,n.options.rtlMoveVisually):0>e?r.from():r.to()},Is)}),deleteH:gn(function(e,t){var n=this.doc.sel,r=this.doc;n.somethingSelected()?r.replaceSelection("",null,"+delete"):Mr(this,function(n){var i=Lr(r,n.head,e,t,!1);
return 0>e?{from:i,to:n.head}:{from:n.head,to:i}})}),findPosV:function(e,t,n,r){var i=1,o=r;0>t&&(i=-1,t=-t);for(var a=0,s=tt(this.doc,e);t>a;++a){var l=Qt(this,s,"div");if(null==o?o=l.left:l.left=o,s=Rr(this,l,i,n),s.hitSide)break}return s},moveV:gn(function(e,t){var n=this,r=this.doc,i=[],o=!n.display.shift&&!r.extend&&r.sel.somethingSelected();if(r.extendSelectionsBy(function(a){if(o)return 0>e?a.from():a.to();var s=Qt(n,a.head,"div");null!=a.goalColumn&&(s.left=a.goalColumn),i.push(s.left);var l=Rr(n,s,e,t);return"page"==t&&a==r.sel.primary()&&wr(n,null,Xt(n,l,"div").top-s.top),l},Is),i.length)for(var a=0;a<r.sel.ranges.length;a++)r.sel.ranges[a].goalColumn=i[a]}),findWordAt:function(e){var t=this.doc,n=Ui(t,e.line).text,r=e.ch,i=e.ch;if(n){var o=this.getHelper(e,"wordChars");(e.xRel<0||i==n.length)&&r?--r:++i;for(var a=n.charAt(r),s=Do(a,o)?function(e){return Do(e,o)}:/\s/.test(a)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!Do(e)};r>0&&s(n.charAt(r-1));)--r;for(;i<n.length&&s(n.charAt(i));)++i}return new Q(Ia(e.line,r),Ia(e.line,i))},toggleOverwrite:function(e){(null==e||e!=this.state.overwrite)&&((this.state.overwrite=!this.state.overwrite)?As(this.display.cursorDiv,"CodeMirror-overwrite"):xs(this.display.cursorDiv,"CodeMirror-overwrite"),vs(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return xo()==this.display.input},scrollTo:gn(function(e,t){(null!=e||null!=t)&&Dr(this),null!=e&&(this.curOp.scrollLeft=e),null!=t&&(this.curOp.scrollTop=t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-Rt(this)-this.display.barHeight,width:e.scrollWidth-Rt(this)-this.display.barWidth,clientHeight:xt(this),clientWidth:Nt(this)}},scrollIntoView:gn(function(e,t){if(null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:Ia(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line)Dr(this),this.curOp.scrollToPos=e;else{var n=Ir(this,Math.min(e.from.left,e.to.left),Math.min(e.from.top,e.to.top)-e.margin,Math.max(e.from.right,e.to.right),Math.max(e.from.bottom,e.to.bottom)+e.margin);this.scrollTo(n.scrollLeft,n.scrollTop)}}),setSize:gn(function(e,t){function n(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}var r=this;null!=e&&(r.display.wrapper.style.width=n(e)),null!=t&&(r.display.wrapper.style.height=n(t)),r.options.lineWrapping&&Wt(this);var i=r.display.viewFrom;r.doc.iter(i,r.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){bn(r,i,"widget");break}++i}),r.curOp.forceUpdate=!0,vs(r,"refresh",this)}),operation:function(e){return fn(this,e)},refresh:gn(function(){var e=this.display.cachedTextHeight;En(this),this.curOp.forceUpdate=!0,Gt(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),u(this),(null==e||Math.abs(e-nn(this.display))>.5)&&a(this),vs(this,"refresh",this)}),swapDoc:gn(function(e){var t=this.doc;return t.cm=null,Fi(this,e),Gt(this),Ln(this),this.scrollTo(e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,uo(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},go(e);var ja=e.defaults={},$a=e.optionHandlers={},Va=e.Init={toString:function(){return"CodeMirror.Init"}};Nr("value","",function(e,t){e.setValue(t)},!0),Nr("mode",null,function(e,t){e.doc.modeOption=t,n(e)},!0),Nr("indentUnit",2,n,!0),Nr("indentWithTabs",!1),Nr("smartIndent",!0),Nr("tabSize",4,function(e){r(e),Gt(e),En(e)},!0),Nr("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(e,t){e.options.specialChars=new RegExp(t.source+(t.test("	")?"":"|	"),"g"),e.refresh()},!0),Nr("specialCharPlaceholder",Di,function(e){e.refresh()},!0),Nr("electricChars",!0),Nr("rtlMoveVisually",!va),Nr("wholeLineUpdateBefore",!0),Nr("theme","default",function(e){s(e),l(e)},!0),Nr("keyMap","default",function(t,n,r){var i=Ar(n),o=r!=e.Init&&Ar(r);o&&o.detach&&o.detach(t,i),i.attach&&i.attach(t,o||null)}),Nr("extraKeys",null),Nr("lineWrapping",!1,i,!0),Nr("gutters",[],function(e){h(e.options),l(e)},!0),Nr("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?w(e.display)+"px":"0",e.refresh()},!0),Nr("coverGutterNextToScrollbar",!1,function(e){y(e)},!0),Nr("scrollbarStyle","native",function(e){v(e),y(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),Nr("lineNumbers",!1,function(e){h(e.options),l(e)},!0),Nr("firstLineNumber",1,l,!0),Nr("lineNumberFormatter",function(e){return e},l,!0),Nr("showCursorWhenSelecting",!1,Et,!0),Nr("resetSelectionOnContextMenu",!0),Nr("readOnly",!1,function(e,t){"nocursor"==t?(or(e),e.display.input.blur(),e.display.disabled=!0):(e.display.disabled=!1,t||Ln(e))}),Nr("disableInput",!1,function(e,t){t||Ln(e)},!0),Nr("dragDrop",!0),Nr("cursorBlinkRate",530),Nr("cursorScrollMargin",0),Nr("cursorHeight",1,Et,!0),Nr("singleCursorHeightPerLine",!0,Et,!0),Nr("workTime",100),Nr("workDelay",100),Nr("flattenSpans",!0,r,!0),Nr("addModeClass",!1,r,!0),Nr("pollInterval",100),Nr("undoDepth",200,function(e,t){e.doc.history.undoDepth=t}),Nr("historyEventDelay",1250),Nr("viewportMargin",10,function(e){e.refresh()},!0),Nr("maxHighlightLength",1e4,r,!0),Nr("moveInputWithCursor",!0,function(e,t){t||(e.display.inputDiv.style.top=e.display.inputDiv.style.left=0)}),Nr("tabindex",null,function(e,t){e.display.input.tabIndex=t||""}),Nr("autofocus",null);var Ba=e.modes={},Ha=e.mimeModes={};e.defineMode=function(t,n){e.defaults.mode||"null"==t||(e.defaults.mode=t),arguments.length>2&&(n.dependencies=Array.prototype.slice.call(arguments,2)),Ba[t]=n},e.defineMIME=function(e,t){Ha[e]=t},e.resolveMode=function(t){if("string"==typeof t&&Ha.hasOwnProperty(t))t=Ha[t];else if(t&&"string"==typeof t.name&&Ha.hasOwnProperty(t.name)){var n=Ha[t.name];"string"==typeof n&&(n={name:n}),t=Io(n,t),t.name=n.name}else if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return e.resolveMode("application/xml");return"string"==typeof t?{name:t}:t||{name:"null"}},e.getMode=function(t,n){var n=e.resolveMode(n),r=Ba[n.name];if(!r)return e.getMode(t,"text/plain");var i=r(t,n);if(Wa.hasOwnProperty(n.name)){var o=Wa[n.name];for(var a in o)o.hasOwnProperty(a)&&(i.hasOwnProperty(a)&&(i["_"+a]=i[a]),i[a]=o[a])}if(i.name=n.name,n.helperType&&(i.helperType=n.helperType),n.modeProps)for(var a in n.modeProps)i[a]=n.modeProps[a];return i},e.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),e.defineMIME("text/plain","null");var Wa=e.modeExtensions={};e.extendMode=function(e,t){var n=Wa.hasOwnProperty(e)?Wa[e]:Wa[e]={};wo(t,n)},e.defineExtension=function(t,n){e.prototype[t]=n},e.defineDocExtension=function(e,t){cs.prototype[e]=t},e.defineOption=Nr;var Ga=[];e.defineInitHook=function(e){Ga.push(e)};var Ka=e.helpers={};e.registerHelper=function(t,n,r){Ka.hasOwnProperty(t)||(Ka[t]=e[t]={_global:[]}),Ka[t][n]=r},e.registerGlobalHelper=function(t,n,r,i){e.registerHelper(t,n,i),Ka[t]._global.push({pred:r,val:i})};var qa=e.copyState=function(e,t){if(t===!0)return t;if(e.copyState)return e.copyState(t);var n={};for(var r in t){var i=t[r];i instanceof Array&&(i=i.concat([])),n[r]=i}return n},za=e.startState=function(e,t,n){return e.startState?e.startState(t,n):!0};e.innerMode=function(e,t){for(;e.innerMode;){var n=e.innerMode(t);if(!n||n.mode==e)break;t=n.state,e=n.mode}return n||{mode:e,state:t}};var Ya=e.commands={selectAll:function(e){e.setSelection(Ia(e.firstLine(),0),Ia(e.lastLine()),bs)},singleSelection:function(e){e.setSelection(e.getCursor("anchor"),e.getCursor("head"),bs)},killLine:function(e){Mr(e,function(t){if(t.empty()){var n=Ui(e.doc,t.head.line).text.length;return t.head.ch==n&&t.head.line<e.lastLine()?{from:t.head,to:Ia(t.head.line+1,0)}:{from:t.head,to:Ia(t.head.line,n)}}return{from:t.from(),to:t.to()}})},deleteLine:function(e){Mr(e,function(t){return{from:Ia(t.from().line,0),to:tt(e.doc,Ia(t.to().line+1,0))}})},delLineLeft:function(e){Mr(e,function(e){return{from:Ia(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(e){Mr(e,function(t){var n=e.charCoords(t.head,"div").top+5,r=e.coordsChar({left:0,top:n},"div");return{from:r,to:t.from()}})},delWrappedLineRight:function(e){Mr(e,function(t){var n=e.charCoords(t.head,"div").top+5,r=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div");return{from:t.from(),to:r}})},undo:function(e){e.undo()},redo:function(e){e.redo()},undoSelection:function(e){e.undoSelection()},redoSelection:function(e){e.redoSelection()},goDocStart:function(e){e.extendSelection(Ia(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(Ia(e.lastLine()))},goLineStart:function(e){e.extendSelectionsBy(function(t){return qo(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){e.extendSelectionsBy(function(t){return Yo(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){e.extendSelectionsBy(function(t){return zo(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div")},Is)},goLineLeft:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:n},"div")},Is)},goLineLeftSmart:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5,r=e.coordsChar({left:0,top:n},"div");return r.ch<e.getLine(r.line).search(/\S/)?Yo(e,t.head):r},Is)},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goGroupRight:function(e){e.moveH(1,"group")},goGroupLeft:function(e){e.moveH(-1,"group")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},delGroupBefore:function(e){e.deleteH(-1,"group")},delGroupAfter:function(e){e.deleteH(1,"group")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("	")},insertSoftTab:function(e){for(var t=[],n=e.listSelections(),r=e.options.tabSize,i=0;i<n.length;i++){var o=n[i].from(),a=ws(e.getLine(o.line),o.ch,r);t.push(new Array(r-a%r+1).join(" "))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){fn(e,function(){for(var t=e.listSelections(),n=[],r=0;r<t.length;r++){var i=t[r].head,o=Ui(e.doc,i.line).text;if(o)if(i.ch==o.length&&(i=new Ia(i.line,i.ch-1)),i.ch>0)i=new Ia(i.line,i.ch+1),e.replaceRange(o.charAt(i.ch-1)+o.charAt(i.ch-2),Ia(i.line,i.ch-2),i,"+transpose");else if(i.line>e.doc.first){var a=Ui(e.doc,i.line-1).text;a&&e.replaceRange(o.charAt(0)+"\n"+a.charAt(a.length-1),Ia(i.line-1,a.length-1),Ia(i.line,1),"+transpose")}n.push(new Q(i,i))}e.setSelections(n)})},newlineAndIndent:function(e){fn(e,function(){for(var t=e.listSelections().length,n=0;t>n;n++){var r=e.listSelections()[n];e.replaceRange("\n",r.anchor,r.head,"+input"),e.indentLine(r.from().line+1,null,!0),Cr(e)}})},toggleOverwrite:function(e){e.toggleOverwrite()}},Xa=e.keyMap={};Xa.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},Xa.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},Xa.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},Xa.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},Xa["default"]=ga?Xa.macDefault:Xa.pcDefault,e.normalizeKeyMap=function(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];if(/^(name|fallthrough|(de|at)tach)$/.test(n))continue;if("..."==r){delete e[n];continue}for(var i=So(n.split(" "),xr),o=0;o<i.length;o++){var a,s;o==i.length-1?(s=n,a=r):(s=i.slice(0,o+1).join(" "),a="...");var l=t[s];if(l){if(l!=a)throw new Error("Inconsistent bindings for "+s)}else t[s]=a}delete e[n]}for(var c in t)e[c]=t[c];return e};var Qa=e.lookupKey=function(e,t,n,r){t=Ar(t);var i=t.call?t.call(e,r):t[e];if(i===!1)return"nothing";if("..."===i)return"multi";if(null!=i&&n(i))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return Qa(e,t.fallthrough,n,r);for(var o=0;o<t.fallthrough.length;o++){var a=Qa(e,t.fallthrough[o],n,r);if(a)return a}}},Ja=e.isModifierKey=function(e){var t="string"==typeof e?e:Vs[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t},Za=e.keyName=function(e,t){if(ca&&34==e.keyCode&&e["char"])return!1;var n=Vs[e.keyCode],r=n;return null==r||e.altGraphKey?!1:(e.altKey&&"Alt"!=n&&(r="Alt-"+r),(_a?e.metaKey:e.ctrlKey)&&"Ctrl"!=n&&(r="Ctrl-"+r),(_a?e.ctrlKey:e.metaKey)&&"Cmd"!=n&&(r="Cmd-"+r),!t&&e.shiftKey&&"Shift"!=n&&(r="Shift-"+r),r)};e.fromTextArea=function(t,n){function r(){t.value=c.getValue()}if(n||(n={}),n.value=t.value,!n.tabindex&&t.tabindex&&(n.tabindex=t.tabindex),!n.placeholder&&t.placeholder&&(n.placeholder=t.placeholder),null==n.autofocus){var i=xo();n.autofocus=i==t||null!=t.getAttribute("autofocus")&&i==document.body}if(t.form&&(ms(t.form,"submit",r),!n.leaveSubmitMethodAlone)){var o=t.form,a=o.submit;try{var s=o.submit=function(){r(),o.submit=a,o.submit(),o.submit=s}}catch(l){}}t.style.display="none";var c=e(function(e){t.parentNode.insertBefore(e,t.nextSibling)},n);return c.save=r,c.getTextArea=function(){return t},c.toTextArea=function(){c.toTextArea=isNaN,r(),t.parentNode.removeChild(c.getWrapperElement()),t.style.display="",t.form&&(gs(t.form,"submit",r),"function"==typeof t.form.submit&&(t.form.submit=a))},c};var es=e.StringStream=function(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};es.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var n=t==e;else var n=t&&(e.test?e.test(t):e(t));return n?(++this.pos,t):void 0},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);return t>-1?(this.pos=t,!0):void 0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=ws(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?ws(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return ws(this.string,null,this.tabSize)-(this.lineStart?ws(this.string,this.lineStart,this.tabSize):0)},match:function(e,t,n){if("string"!=typeof e){var r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&t!==!1&&(this.pos+=r[0].length),r)}var i=function(e){return n?e.toLowerCase():e},o=this.string.substr(this.pos,e.length);return i(o)==i(e)?(t!==!1&&(this.pos+=e.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}};var ts=e.TextMarker=function(e,t){this.lines=[],this.type=t,this.doc=e};go(ts),ts.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&on(e),mo(this,"clear")){var n=this.find();n&&uo(this,"clear",n.from,n.to)}for(var r=null,i=null,o=0;o<this.lines.length;++o){var a=this.lines[o],s=Vr(a.markedSpans,this);e&&!this.collapsed?bn(e,Bi(a),"text"):e&&(null!=s.to&&(i=Bi(a)),null!=s.from&&(r=Bi(a))),a.markedSpans=Br(a.markedSpans,s),null==s.from&&this.collapsed&&!ci(this.doc,a)&&e&&Vi(a,nn(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var o=0;o<this.lines.length;++o){var l=oi(this.lines[o]),c=d(l);c>e.display.maxLineLength&&(e.display.maxLine=l,e.display.maxLineLength=c,e.display.maxLineChanged=!0)}null!=r&&e&&this.collapsed&&En(e,r,i+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&mt(e.doc)),e&&uo(e,"markerCleared",e,this),t&&sn(e),this.parent&&this.parent.clear()}},ts.prototype.find=function(e,t){null==e&&"bookmark"==this.type&&(e=1);for(var n,r,i=0;i<this.lines.length;++i){var o=this.lines[i],a=Vr(o.markedSpans,this);if(null!=a.from&&(n=Ia(t?o:Bi(o),a.from),-1==e))return n;if(null!=a.to&&(r=Ia(t?o:Bi(o),a.to),1==e))return r}return n&&{from:n,to:r}},ts.prototype.changed=function(){var e=this.find(-1,!0),t=this,n=this.doc.cm;e&&n&&fn(n,function(){var r=e.line,i=Bi(e.line),o=Ut(n,i);if(o&&(Ht(o),n.curOp.selectionChanged=n.curOp.forceUpdate=!0),n.curOp.updateMaxLine=!0,!ci(t.doc,r)&&null!=t.height){var a=t.height;t.height=null;var s=pi(t)-a;s&&Vi(r,r.height+s)}})},ts.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=bo(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},ts.prototype.detachLine=function(e){if(this.lines.splice(bo(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}};var ns=0,rs=e.SharedTextMarker=function(e,t){this.markers=e,this.primary=t;for(var n=0;n<e.length;++n)e[n].parent=this};go(rs),rs.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();uo(this,"clear")}},rs.prototype.find=function(e,t){return this.primary.find(e,t)};var is=e.LineWidget=function(e,t,n){if(n)for(var r in n)n.hasOwnProperty(r)&&(this[r]=n[r]);this.cm=e,this.node=t};go(is),is.prototype.clear=function(){var e=this.cm,t=this.line.widgets,n=this.line,r=Bi(n);if(null!=r&&t){for(var i=0;i<t.length;++i)t[i]==this&&t.splice(i--,1);t.length||(n.widgets=null);var o=pi(this);fn(e,function(){di(e,n,-o),bn(e,r,"widget"),Vi(n,Math.max(0,n.height-o))})}},is.prototype.changed=function(){var e=this.height,t=this.cm,n=this.line;this.height=null;var r=pi(this)-e;r&&fn(t,function(){t.curOp.forceUpdate=!0,di(t,n,r),Vi(n,n.height+r)})};var os=e.Line=function(e,t,n){this.text=e,Qr(this,t),this.height=n?n(this):1};go(os),os.prototype.lineNo=function(){return Bi(this)};var as={},ss={};Ai.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n=e,r=e+t;r>n;++n){var i=this.lines[n];this.height-=i.height,mi(i),uo(i,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var r=0;r<t.length;++r)t[r].parent=this},iterN:function(e,t,n){for(var r=e+t;r>e;++e)if(n(this.lines[e]))return!0}},Pi.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n=0;n<this.children.length;++n){var r=this.children[n],i=r.chunkSize();if(i>e){var o=Math.min(t,i-e),a=r.height;if(r.removeInner(e,o),this.height-=a-r.height,i==o&&(this.children.splice(n--,1),r.parent=null),0==(t-=o))break;e=0}else e-=i}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof Ai))){var s=[];this.collapse(s),this.children=[new Ai(s)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var r=0;r<this.children.length;++r){var i=this.children[r],o=i.chunkSize();if(o>=e){if(i.insertInner(e,t,n),i.lines&&i.lines.length>50){for(;i.lines.length>50;){var a=i.lines.splice(i.lines.length-25,25),s=new Ai(a);i.height-=s.height,this.children.splice(r+1,0,s),s.parent=this}this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=e.children.splice(e.children.length-5,5),n=new Pi(t);if(e.parent){e.size-=n.size,e.height-=n.height;var r=bo(e.parent.children,e);e.parent.children.splice(r+1,0,n)}else{var i=new Pi(e.children);i.parent=e,e.children=[i,n],e=i}n.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var r=0;r<this.children.length;++r){var i=this.children[r],o=i.chunkSize();if(o>e){var a=Math.min(t,o-e);if(i.iterN(e,a,n))return!0;if(0==(t-=a))break;e=0}else e-=o}}};var ls=0,cs=e.Doc=function(e,t,n){if(!(this instanceof cs))return new cs(e,t,n);null==n&&(n=0),Pi.call(this,[new Ai([new os("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=n;var r=Ia(n,0);this.sel=Z(r),this.history=new Ki(null),this.id=++ls,this.modeOption=t,"string"==typeof e&&(e=Fs(e)),xi(this,{from:r,to:r,text:e}),pt(this,Z(r),bs)};cs.prototype=Io(Pi.prototype,{constructor:cs,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,r=0;r<t.length;++r)n+=t[r].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=$i(this,this.first,this.first+this.size);return e===!1?t:t.join(e||"\n")},setValue:vn(function(e){var t=Ia(this.first,0),n=this.first+this.size-1;hr(this,{from:t,to:Ia(n,Ui(this,n).text.length),text:Fs(e),origin:"setValue",full:!0},!0),pt(this,Z(t))}),replaceRange:function(e,t,n,r){t=tt(this,t),n=n?tt(this,n):t,_r(this,e,t,n,r)},getRange:function(e,t,n){var r=ji(this,tt(this,e),tt(this,t));return n===!1?r:r.join(n||"\n")},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){return rt(this,e)?Ui(this,e):void 0},getLineNumber:function(e){return Bi(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=Ui(this,e)),oi(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return tt(this,e)},getCursor:function(e){var t,n=this.sel.primary();return t=null==e||"head"==e?n.head:"anchor"==e?n.anchor:"end"==e||"to"==e||e===!1?n.to():n.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:vn(function(e,t,n){ct(this,tt(this,"number"==typeof e?Ia(e,t||0):e),null,n)}),setSelection:vn(function(e,t,n){ct(this,tt(this,e),tt(this,t||e),n)}),extendSelection:vn(function(e,t,n){at(this,tt(this,e),t&&tt(this,t),n)}),extendSelections:vn(function(e,t){st(this,it(this,e,t))}),extendSelectionsBy:vn(function(e,t){st(this,So(this.sel.ranges,e),t)}),setSelections:vn(function(e,t,n){if(e.length){for(var r=0,i=[];r<e.length;r++)i[r]=new Q(tt(this,e[r].anchor),tt(this,e[r].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),pt(this,J(i,t),n)}}),addSelection:vn(function(e,t,n){var r=this.sel.ranges.slice(0);r.push(new Q(tt(this,e),tt(this,t||e))),pt(this,J(r,r.length-1),n)}),getSelection:function(e){for(var t,n=this.sel.ranges,r=0;r<n.length;r++){var i=ji(this,n[r].from(),n[r].to());t=t?t.concat(i):i}return e===!1?t:t.join(e||"\n")},getSelections:function(e){for(var t=[],n=this.sel.ranges,r=0;r<n.length;r++){var i=ji(this,n[r].from(),n[r].to());e!==!1&&(i=i.join(e||"\n")),t[r]=i}return t},replaceSelection:function(e,t,n){for(var r=[],i=0;i<this.sel.ranges.length;i++)r[i]=e;this.replaceSelections(r,t,n||"+input")},replaceSelections:vn(function(e,t,n){for(var r=[],i=this.sel,o=0;o<i.ranges.length;o++){var a=i.ranges[o];r[o]={from:a.from(),to:a.to(),text:Fs(e[o]),origin:n}}for(var s=t&&"end"!=t&&dr(this,r,t),o=r.length-1;o>=0;o--)hr(this,r[o]);s?dt(this,s):this.cm&&Cr(this.cm)}),undo:vn(function(){mr(this,"undo")}),redo:vn(function(){mr(this,"redo")}),undoSelection:vn(function(){mr(this,"undo",!0)}),redoSelection:vn(function(){mr(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,n=0,r=0;r<e.done.length;r++)e.done[r].ranges||++t;for(var r=0;r<e.undone.length;r++)e.undone[r].ranges||++n;return{undo:t,redo:n}},clearHistory:function(){this.history=new Ki(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:ro(this.history.done),undone:ro(this.history.undone)}},setHistory:function(e){var t=this.history=new Ki(this.history.maxGeneration);t.done=ro(e.done.slice(0),null,!0),t.undone=ro(e.undone.slice(0),null,!0)},addLineClass:vn(function(e,t,n){return Or(this,e,"gutter"==t?"gutter":"class",function(e){var r="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass";if(e[r]){if(Ao(n).test(e[r]))return!1;e[r]+=" "+n}else e[r]=n;return!0})}),removeLineClass:vn(function(e,t,n){return Or(this,e,"gutter"==t?"gutter":"class",function(e){var r="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass",i=e[r];if(!i)return!1;if(null==n)e[r]=null;else{var o=i.match(Ao(n));if(!o)return!1;var a=o.index+o[0].length;e[r]=i.slice(0,o.index)+(o.index&&a!=i.length?" ":"")+i.slice(a)||null}return!0})}),markText:function(e,t,n){return Pr(this,tt(this,e),tt(this,t),n,"range")},setBookmark:function(e,t){var n={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared};return e=tt(this,e),Pr(this,e,e,n,"bookmark")},findMarksAt:function(e){e=tt(this,e);var t=[],n=Ui(this,e.line).markedSpans;if(n)for(var r=0;r<n.length;++r){var i=n[r];(null==i.from||i.from<=e.ch)&&(null==i.to||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},findMarks:function(e,t,n){e=tt(this,e),t=tt(this,t);var r=[],i=e.line;return this.iter(e.line,t.line+1,function(o){var a=o.markedSpans;if(a)for(var s=0;s<a.length;s++){var l=a[s];i==e.line&&e.ch>l.to||null==l.from&&i!=e.line||i==t.line&&l.from>t.ch||n&&!n(l.marker)||r.push(l.marker.parent||l.marker)}++i}),r},getAllMarks:function(){var e=[];return this.iter(function(t){var n=t.markedSpans;if(n)for(var r=0;r<n.length;++r)null!=n[r].from&&e.push(n[r].marker)}),e},posFromIndex:function(e){var t,n=this.first;return this.iter(function(r){var i=r.text.length+1;return i>e?(t=e,!0):(e-=i,void++n)}),tt(this,Ia(n,t))},indexFromPos:function(e){e=tt(this,e);var t=e.ch;return e.line<this.first||e.ch<0?0:(this.iter(this.first,e.line,function(e){t+=e.text.length+1}),t)},copy:function(e){var t=new cs($i(this,this.first,this.first+this.size),this.modeOption,this.first);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,n=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to);var r=new cs($i(this,t,n),e.mode||this.modeOption,t);return e.sharedHist&&(r.history=this.history),(this.linked||(this.linked=[])).push({doc:r,sharedHist:e.sharedHist}),r.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],Ur(r,Fr(this)),r},unlinkDoc:function(t){if(t instanceof e&&(t=t.doc),this.linked)for(var n=0;n<this.linked.length;++n){var r=this.linked[n];if(r.doc==t){this.linked.splice(n,1),t.unlinkDoc(this),jr(Fr(this));break}}if(t.history==this.history){var i=[t.id];ki(t,function(e){i.push(e.id)},!0),t.history=new Ki(null),t.history.done=ro(this.history.done,i),t.history.undone=ro(this.history.undone,i)}},iterLinkedDocs:function(e){ki(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),cs.prototype.eachLine=cs.prototype.iter;var us="iter insert remove copy getEditor".split(" ");for(var ds in cs.prototype)cs.prototype.hasOwnProperty(ds)&&bo(us,ds)<0&&(e.prototype[ds]=function(e){return function(){return e.apply(this.doc,arguments)}}(cs.prototype[ds]));go(cs);var ps=e.e_preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},hs=e.e_stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},fs=e.e_stop=function(e){ps(e),hs(e)},ms=e.on=function(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent)e.attachEvent("on"+t,n);else{var r=e._handlers||(e._handlers={}),i=r[t]||(r[t]=[]);i.push(n)}},gs=e.off=function(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else{var r=e._handlers&&e._handlers[t];if(!r)return;for(var i=0;i<r.length;++i)if(r[i]==n){r.splice(i,1);break}}},vs=e.signal=function(e,t){var n=e._handlers&&e._handlers[t];if(n)for(var r=Array.prototype.slice.call(arguments,2),i=0;i<n.length;++i)n[i].apply(null,r)},ys=null,_s=30,Es=e.Pass={toString:function(){return"CodeMirror.Pass"}},bs={scroll:!1},Ss={origin:"*mouse"},Is={origin:"+move"};vo.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var ws=e.countColumn=function(e,t,n,r,i){null==t&&(t=e.search(/[^\s\u00a0]/),-1==t&&(t=e.length));for(var o=r||0,a=i||0;;){var s=e.indexOf("	",o);if(0>s||s>=t)return a+(t-o);a+=s-o,a+=n-a%n,o=s+1}},Cs=[""],Ds=function(e){e.select()};fa?Ds=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:ia&&(Ds=function(e){try{e.select()}catch(t){}});var Ts,Os=/[\u00df\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Ms=e.isWordChar=function(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||Os.test(e))
},Ls=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;Ts=document.createRange?function(e,t,n){var r=document.createRange();return r.setEnd(e,n),r.setStart(e,t),r}:function(e,t,n){var r=document.body.createTextRange();try{r.moveToElementText(e.parentNode)}catch(i){return r}return r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",t),r},ia&&11>oa&&(xo=function(){try{return document.activeElement}catch(e){return document.body}});var Rs,Ns,xs=e.rmClass=function(e,t){var n=e.className,r=Ao(t).exec(n);if(r){var i=n.slice(r.index+r[0].length);e.className=n.slice(0,r.index)+(i?r[1]+i:"")}},As=e.addClass=function(e,t){var n=e.className;Ao(t).test(n)||(e.className+=(n?" ":"")+t)},Ps=!1,ks=function(){if(ia&&9>oa)return!1;var e=Mo("div");return"draggable"in e||"dragDrop"in e}(),Fs=e.splitLines=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],r=e.length;r>=t;){var i=e.indexOf("\n",t);-1==i&&(i=e.length);var o=e.slice(t,"\r"==e.charAt(i-1)?i-1:i),a=o.indexOf("\r");-1!=a?(n.push(o.slice(0,a)),t+=a+1):(n.push(o),t=i+1)}return n}:function(e){return e.split(/\r\n?|\n/)},Us=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(n){}return t&&t.parentElement()==e?0!=t.compareEndPoints("StartToEnd",t):!1},js=function(){var e=Mo("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),$s=null,Vs={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",107:"=",109:"-",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};e.keyNames=Vs,function(){for(var e=0;10>e;e++)Vs[e+48]=Vs[e+96]=String(e);for(var e=65;90>=e;e++)Vs[e]=String.fromCharCode(e);for(var e=1;12>=e;e++)Vs[e+111]=Vs[e+63235]="F"+e}();var Bs,Hs=function(){function e(e){return 247>=e?n.charAt(e):e>=1424&&1524>=e?"R":e>=1536&&1773>=e?r.charAt(e-1536):e>=1774&&2220>=e?"r":e>=8192&&8203>=e?"w":8204==e?"b":"L"}function t(e,t,n){this.level=e,this.from=t,this.to=n}var n="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",r="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",i=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,o=/[stwN]/,a=/[LRr]/,s=/[Lb1n]/,l=/[1n]/,c="L";return function(n){if(!i.test(n))return!1;for(var r,u=n.length,d=[],p=0;u>p;++p)d.push(r=e(n.charCodeAt(p)));for(var p=0,h=c;u>p;++p){var r=d[p];"m"==r?d[p]=h:h=r}for(var p=0,f=c;u>p;++p){var r=d[p];"1"==r&&"r"==f?d[p]="n":a.test(r)&&(f=r,"r"==r&&(d[p]="R"))}for(var p=1,h=d[0];u-1>p;++p){var r=d[p];"+"==r&&"1"==h&&"1"==d[p+1]?d[p]="1":","!=r||h!=d[p+1]||"1"!=h&&"n"!=h||(d[p]=h),h=r}for(var p=0;u>p;++p){var r=d[p];if(","==r)d[p]="N";else if("%"==r){for(var m=p+1;u>m&&"%"==d[m];++m);for(var g=p&&"!"==d[p-1]||u>m&&"1"==d[m]?"1":"N",v=p;m>v;++v)d[v]=g;p=m-1}}for(var p=0,f=c;u>p;++p){var r=d[p];"L"==f&&"1"==r?d[p]="L":a.test(r)&&(f=r)}for(var p=0;u>p;++p)if(o.test(d[p])){for(var m=p+1;u>m&&o.test(d[m]);++m);for(var y="L"==(p?d[p-1]:c),_="L"==(u>m?d[m]:c),g=y||_?"L":"R",v=p;m>v;++v)d[v]=g;p=m-1}for(var E,b=[],p=0;u>p;)if(s.test(d[p])){var S=p;for(++p;u>p&&s.test(d[p]);++p);b.push(new t(0,S,p))}else{var I=p,w=b.length;for(++p;u>p&&"L"!=d[p];++p);for(var v=I;p>v;)if(l.test(d[v])){v>I&&b.splice(w,0,new t(1,I,v));var C=v;for(++v;p>v&&l.test(d[v]);++v);b.splice(w,0,new t(2,C,v)),I=v}else++v;p>I&&b.splice(w,0,new t(1,I,p))}return 1==b[0].level&&(E=n.match(/^\s+/))&&(b[0].from=E[0].length,b.unshift(new t(0,0,E[0].length))),1==Eo(b).level&&(E=n.match(/\s+$/))&&(Eo(b).to-=E[0].length,b.push(new t(0,u-E[0].length,u))),b[0].level!=Eo(b).level&&b.push(new t(b[0].level,u,u)),b}}();return e.version="4.11.1",e}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("thirdparty/CodeMirror2/addon/fold/xml-fold",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){return e.line-t.line||e.ch-t.ch}function n(e,t,n,r){this.line=t,this.ch=n,this.cm=e,this.text=e.getLine(t),this.min=r?r.from:e.firstLine(),this.max=r?r.to-1:e.lastLine()}function r(e,t){var n=e.cm.getTokenTypeAt(p(e.line,t));return n&&/\btag\b/.test(n)}function i(e){return e.line>=e.max?void 0:(e.ch=0,e.text=e.cm.getLine(++e.line),!0)}function o(e){return e.line<=e.min?void 0:(e.text=e.cm.getLine(--e.line),e.ch=e.text.length,!0)}function a(e){for(;;){var t=e.text.indexOf(">",e.ch);if(-1==t){if(i(e))continue;return}{if(r(e,t+1)){var n=e.text.lastIndexOf("/",t),o=n>-1&&!/\S/.test(e.text.slice(n+1,t));return e.ch=t+1,o?"selfClose":"regular"}e.ch=t+1}}}function s(e){for(;;){var t=e.ch?e.text.lastIndexOf("<",e.ch-1):-1;if(-1==t){if(o(e))continue;return}if(r(e,t+1)){m.lastIndex=t,e.ch=t;var n=m.exec(e.text);if(n&&n.index==t)return n}else e.ch=t}}function l(e){for(;;){m.lastIndex=e.ch;var t=m.exec(e.text);if(!t){if(i(e))continue;return}{if(r(e,t.index+1))return e.ch=t.index+t[0].length,t;e.ch=t.index+1}}}function c(e){for(;;){var t=e.ch?e.text.lastIndexOf(">",e.ch-1):-1;if(-1==t){if(o(e))continue;return}{if(r(e,t+1)){var n=e.text.lastIndexOf("/",t),i=n>-1&&!/\S/.test(e.text.slice(n+1,t));return e.ch=t+1,i?"selfClose":"regular"}e.ch=t}}}function u(e,t){for(var n=[];;){var r,i=l(e),o=e.line,s=e.ch-(i?i[0].length:0);if(!i||!(r=a(e)))return;if("selfClose"!=r)if(i[1]){for(var c=n.length-1;c>=0;--c)if(n[c]==i[2]){n.length=c;break}if(0>c&&(!t||t==i[2]))return{tag:i[2],from:p(o,s),to:p(e.line,e.ch)}}else n.push(i[2])}}function d(e,t){for(var n=[];;){var r=c(e);if(!r)return;if("selfClose"!=r){var i=e.line,o=e.ch,a=s(e);if(!a)return;if(a[1])n.push(a[2]);else{for(var l=n.length-1;l>=0;--l)if(n[l]==a[2]){n.length=l;break}if(0>l&&(!t||t==a[2]))return{tag:a[2],from:p(e.line,e.ch),to:p(i,o)}}}else s(e)}}var p=e.Pos,h="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",f=h+"-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",m=new RegExp("<(/?)(["+h+"]["+f+"]*)","g");e.registerHelper("fold","xml",function(e,t){for(var r=new n(e,t.line,0);;){var i,o=l(r);if(!o||r.line!=t.line||!(i=a(r)))return;if(!o[1]&&"selfClose"!=i){var t=p(r.line,r.ch),s=u(r,o[2]);return s&&{from:t,to:s.from}}}}),e.findMatchingTag=function(e,r,i){var o=new n(e,r.line,r.ch,i);if(-1!=o.text.indexOf(">")||-1!=o.text.indexOf("<")){var l=a(o),c=l&&p(o.line,o.ch),h=l&&s(o);if(l&&h&&!(t(o,r)>0)){var f={from:p(o.line,o.ch),to:c,tag:h[2]};return"selfClose"==l?{open:f,close:null,at:"open"}:h[1]?{open:d(o,h[2]),close:f,at:"close"}:(o=new n(e,c.line,c.ch,i),{open:f,close:u(o,h[2]),at:"open"})}}},e.findEnclosingTag=function(e,t,r){for(var i=new n(e,t.line,t.ch,r);;){var o=d(i);if(!o)break;var a=new n(e,t.line,t.ch,r),s=u(a,o.tag);if(s)return{open:o,close:s}}},e.scanForClosingTag=function(e,t,r,i){var o=new n(e,t.line,t.ch,i?{from:0,to:i}:null);return u(o,r)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define("thirdparty/CodeMirror2/addon/edit/matchtags",["../../lib/codemirror","../fold/xml-fold"],e):e(CodeMirror)}(function(e){"use strict";function t(e){e.state.tagHit&&e.state.tagHit.clear(),e.state.tagOther&&e.state.tagOther.clear(),e.state.tagHit=e.state.tagOther=null}function n(n){n.state.failedTagMatch=!1,n.operation(function(){if(t(n),!n.somethingSelected()){var r=n.getCursor(),i=n.getViewport();i.from=Math.min(i.from,r.line),i.to=Math.max(r.line+1,i.to);var o=e.findMatchingTag(n,r,i);if(o){if(n.state.matchBothTags){var a="open"==o.at?o.open:o.close;a&&(n.state.tagHit=n.markText(a.from,a.to,{className:"CodeMirror-matchingtag"}))}var s="close"==o.at?o.open:o.close;s?n.state.tagOther=n.markText(s.from,s.to,{className:"CodeMirror-matchingtag"}):n.state.failedTagMatch=!0}}})}function r(e){e.state.failedTagMatch&&n(e)}e.defineOption("matchTags",!1,function(i,o,a){a&&a!=e.Init&&(i.off("cursorActivity",n),i.off("viewportChange",r),t(i)),o&&(i.state.matchBothTags="object"==typeof o&&o.bothTags,i.on("cursorActivity",n),i.on("viewportChange",r),n(i))}),e.commands.toMatchingTag=function(t){var n=e.findMatchingTag(t,t.getCursor());if(n){var r="close"==n.at?n.open:n.close;r&&t.extendSelection(r.to,r.from)}}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("thirdparty/CodeMirror2/addon/edit/matchbrackets",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t,r,i){var o=e.getLineHandle(t.line),l=t.ch-1,c=l>=0&&s[o.text.charAt(l)]||s[o.text.charAt(++l)];if(!c)return null;var u=">"==c.charAt(1)?1:-1;if(r&&u>0!=(l==t.ch))return null;var d=e.getTokenTypeAt(a(t.line,l+1)),p=n(e,a(t.line,l+(u>0?1:0)),u,d||null,i);return null==p?null:{from:a(t.line,l),to:p&&p.pos,match:p&&p.ch==c.charAt(0),forward:u>0}}function n(e,t,n,r,i){for(var o=i&&i.maxScanLineLength||1e4,l=i&&i.maxScanLines||1e3,c=[],u=i&&i.bracketRegex?i.bracketRegex:/[(){}[\]]/,d=n>0?Math.min(t.line+l,e.lastLine()+1):Math.max(e.firstLine()-1,t.line-l),p=t.line;p!=d;p+=n){var h=e.getLine(p);if(h){var f=n>0?0:h.length-1,m=n>0?h.length:-1;if(!(h.length>o))for(p==t.line&&(f=t.ch-(0>n?1:0));f!=m;f+=n){var g=h.charAt(f);if(u.test(g)&&(void 0===r||e.getTokenTypeAt(a(p,f+1))==r)){var v=s[g];if(">"==v.charAt(1)==n>0)c.push(g);else{if(!c.length)return{pos:a(p,f),ch:g};c.pop()}}}}}return p-n==(n>0?e.lastLine():e.firstLine())?!1:null}function r(e,n,r){for(var i=e.state.matchBrackets.maxHighlightLineLength||1e3,s=[],l=e.listSelections(),c=0;c<l.length;c++){var u=l[c].empty()&&t(e,l[c].head,!1,r);if(u&&e.getLine(u.from.line).length<=i){var d=u.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";s.push(e.markText(u.from,a(u.from.line,u.from.ch+1),{className:d})),u.to&&e.getLine(u.to.line).length<=i&&s.push(e.markText(u.to,a(u.to.line,u.to.ch+1),{className:d}))}}if(s.length){o&&e.state.focused&&e.display.input.focus();var p=function(){e.operation(function(){for(var e=0;e<s.length;e++)s[e].clear()})};if(!n)return p;setTimeout(p,800)}}function i(e){e.operation(function(){l&&(l(),l=null),l=r(e,!1,e.state.matchBrackets)})}var o=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),a=e.Pos,s={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},l=null;e.defineOption("matchBrackets",!1,function(t,n,r){r&&r!=e.Init&&t.off("cursorActivity",i),n&&(t.state.matchBrackets="object"==typeof n?n:{},t.on("cursorActivity",i))}),e.defineExtension("matchBrackets",function(){r(this,!0)}),e.defineExtension("findMatchingBracket",function(e,n,r){return t(this,e,n,r)}),e.defineExtension("scanForBracket",function(e,t,r,i){return n(this,e,t,r,i)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("thirdparty/CodeMirror2/addon/edit/closebrackets",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t){var n=e.getRange(l(t.line,t.ch-1),l(t.line,t.ch+1));return 2==n.length?n:null}function n(t,n,r){var i=t.getLine(n.line),o=t.getTokenAt(n);if(/\bstring2?\b/.test(o.type))return!1;var a=new e.StringStream(i.slice(0,n.ch)+r+i.slice(n.ch),4);for(a.pos=a.start=o.start;;){var s=t.getMode().token(a,o.state);if(a.pos>=n.ch+1)return/\bstring2?\b/.test(s);a.start=a.pos}}function r(r){for(var i={name:"autoCloseBrackets",Backspace:function(n){if(n.getOption("disableInput"))return e.Pass;for(var i=n.listSelections(),o=0;o<i.length;o++){if(!i[o].empty())return e.Pass;var a=t(n,i[o].head);if(!a||r.indexOf(a)%2!=0)return e.Pass}for(var o=i.length-1;o>=0;o--){var s=i[o].head;n.replaceRange("",l(s.line,s.ch-1),l(s.line,s.ch+1))}}},o="",a=0;a<r.length;a+=2)(function(t,r){o+=r,i["'"+t+"'"]=function(i){if(i.getOption("disableInput"))return e.Pass;for(var a,c,u=i.listSelections(),d=0;d<u.length;d++){var p,h=u[d],f=h.head,c=i.getRange(f,l(f.line,f.ch+1));if(h.empty())if(t==r&&c==r)p=i.getRange(f,l(f.line,f.ch+3))==t+t+t?"skipThree":"skip";else if(t==r&&f.ch>1&&i.getRange(l(f.line,f.ch-2),f)==t+t&&(f.ch<=2||i.getRange(l(f.line,f.ch-3),l(f.line,f.ch-2))!=t))p="addFour";else if('"'==t||"'"==t){if(e.isWordChar(c)||!n(i,f,t))return e.Pass;p="both"}else{if(!(i.getLine(f.line).length==f.ch||o.indexOf(c)>=0||s.test(c)))return e.Pass;p="both"}else p="surround";if(a){if(a!=p)return e.Pass}else a=p}i.operation(function(){if("skip"==a)i.execCommand("goCharRight");else if("skipThree"==a)for(var e=0;3>e;e++)i.execCommand("goCharRight");else if("surround"==a){for(var n=i.getSelections(),e=0;e<n.length;e++)n[e]=t+n[e]+r;i.replaceSelections(n,"around")}else"both"==a?(i.replaceSelection(t+r,null),i.execCommand("goCharLeft")):"addFour"==a&&(i.replaceSelection(t+t+t+t,"before"),i.execCommand("goCharRight"))})},t!=r&&(i["'"+r+"'"]=function(t){for(var n=t.listSelections(),i=0;i<n.length;i++){var o=n[i];if(!o.empty()||t.getRange(o.head,l(o.head.line,o.head.ch+1))!=r)return e.Pass}t.execCommand("goCharRight")})})(r.charAt(a),r.charAt(a+1));return i}function i(n){return function(r){if(r.getOption("disableInput"))return e.Pass;for(var i=r.listSelections(),o=0;o<i.length;o++){if(!i[o].empty())return e.Pass;var a=t(r,i[o].head);if(!a||n.indexOf(a)%2!=0)return e.Pass}r.operation(function(){r.replaceSelection("\n\n",null),r.execCommand("goCharLeft"),i=r.listSelections();for(var e=0;e<i.length;e++){var t=i[e].head.line;r.indentLine(t,null,!0),r.indentLine(t+1,null,!0)}})}}var o="()[]{}''\"\"",a="[]{}",s=/\s/,l=e.Pos;e.defineOption("autoCloseBrackets",!1,function(t,n,s){if(s!=e.Init&&s&&t.removeKeyMap("autoCloseBrackets"),n){var l=o,c=a;"string"==typeof n?l=n:"object"==typeof n&&(null!=n.pairs&&(l=n.pairs),null!=n.explode&&(c=n.explode));var u=r(l);c&&(u.Enter=i(c)),t.addKeyMap(u)}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define("thirdparty/CodeMirror2/addon/edit/closetag",["../../lib/codemirror","../fold/xml-fold"],e):e(CodeMirror)}(function(e){function t(t){if(t.getOption("disableInput"))return e.Pass;for(var n=t.listSelections(),s=[],l=0;l<n.length;l++){if(!n[l].empty())return e.Pass;var c=n[l].head,u=t.getTokenAt(c),d=e.innerMode(t.getMode(),u.state),p=d.state;if("xml"!=d.mode.name||!p.tagName)return e.Pass;var h=t.getOption("autoCloseTags"),f="html"==d.mode.configuration,m="object"==typeof h&&h.dontCloseTags||f&&o,g="object"==typeof h&&h.indentTags||f&&a,v=p.tagName;u.end>c.ch&&(v=v.slice(0,v.length-u.end+c.ch));var y=v.toLowerCase();if(!v||"string"==u.type&&(u.end!=c.ch||!/[\"\']/.test(u.string.charAt(u.string.length-1))||1==u.string.length)||"tag"==u.type&&"closeTag"==p.type||u.string.indexOf("/")==u.string.length-1||m&&r(m,y)>-1||i(t,v,c,p,!0))return e.Pass;var _=g&&r(g,y)>-1;s[l]={indent:_,text:">"+(_?"\n\n":"")+"</"+v+">",newPos:_?e.Pos(c.line+1,0):e.Pos(c.line,c.ch+1)}}for(var l=n.length-1;l>=0;l--){var E=s[l];t.replaceRange(E.text,n[l].head,n[l].anchor,"+insert");var b=t.listSelections().slice(0);b[l]={head:E.newPos,anchor:E.newPos},t.setSelections(b),E.indent&&(t.indentLine(E.newPos.line,null,!0),t.indentLine(E.newPos.line+1,null,!0))}}function n(t){if(t.getOption("disableInput"))return e.Pass;for(var n=t.listSelections(),r=[],o=0;o<n.length;o++){if(!n[o].empty())return e.Pass;var a=n[o].head,s=t.getTokenAt(a),l=e.innerMode(t.getMode(),s.state),c=l.state;if("string"==s.type||"<"!=s.string.charAt(0)||s.start!=a.ch-1)return e.Pass;if("xml"!=l.mode.name)if("htmlmixed"==t.getMode().name&&"javascript"==l.mode.name)r[o]="/script>";else{if("htmlmixed"!=t.getMode().name||"css"!=l.mode.name)return e.Pass;r[o]="/style>"}else{if(!c.context||!c.context.tagName||i(t,c.context.tagName,a,c))return e.Pass;r[o]="/"+c.context.tagName+">"}}t.replaceSelections(r),n=t.listSelections();for(var o=0;o<n.length;o++)(o==n.length-1||n[o].head.line<n[o+1].head.line)&&t.indentLine(n[o].head.line)}function r(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;r>n;++n)if(e[n]==t)return n;return-1}function i(t,n,r,i,o){if(!e.scanForClosingTag)return!1;var a=Math.min(t.lastLine()+1,r.line+500),s=e.scanForClosingTag(t,r,null,a);if(!s||s.tag!=n)return!1;for(var l=i.context,c=o?1:0;l&&l.tagName==n;l=l.prev)++c;r=s.to;for(var u=1;c>u;u++){var d=e.scanForClosingTag(t,r,null,a);if(!d||d.tag!=n)return!1;r=d.to}return!0}e.defineOption("autoCloseTags",!1,function(r,i,o){if(o!=e.Init&&o&&r.removeKeyMap("autoCloseTags"),i){var a={name:"autoCloseTags"};("object"!=typeof i||i.whenClosing)&&(a["'/'"]=function(e){return n(e)}),("object"!=typeof i||i.whenOpening)&&(a["'>'"]=function(e){return t(e)}),r.addKeyMap(a)}});var o=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],a=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"]}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("thirdparty/CodeMirror2/addon/scroll/scrollpastend",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(t,r){e.changeEnd(r).line==t.lastLine()&&n(t)}function n(e){var t="";if(e.lineCount()>1){var n=e.display.scroller.clientHeight-30,r=e.getLineHandle(e.lastLine()).height;t=n-r+"px"}e.state.scrollPastEndPadding!=t&&(e.state.scrollPastEndPadding=t,e.display.lineSpace.parentNode.style.paddingBottom=t,e.setSize())}e.defineOption("scrollPastEnd",!1,function(r,i,o){o&&o!=e.Init&&(r.off("change",t),r.off("refresh",n),r.display.lineSpace.parentNode.style.paddingBottom="",r.state.scrollPastEndPadding=null),i&&(r.on("change",t),r.on("refresh",n),n(r))})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("thirdparty/CodeMirror2/addon/selection/active-line",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e){for(var t=0;t<e.state.activeLines.length;t++)e.removeLineClass(e.state.activeLines[t],"wrap",o),e.removeLineClass(e.state.activeLines[t],"background",a)}function n(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function r(e,r){for(var i=[],s=0;s<r.length;s++){var l=r[s];if(l.empty()){var c=e.getLineHandleVisualStart(l.head.line);i[i.length-1]!=c&&i.push(c)}}n(e.state.activeLines,i)||e.operation(function(){t(e);for(var n=0;n<i.length;n++)e.addLineClass(i[n],"wrap",o),e.addLineClass(i[n],"background",a);e.state.activeLines=i})}function i(e,t){r(e,t.ranges)}var o="CodeMirror-activeline",a="CodeMirror-activeline-background";e.defineOption("styleActiveLine",!1,function(n,o,a){var s=a&&a!=e.Init;o&&!s?(n.state.activeLines=[],r(n,n.listSelections()),n.on("beforeSelectionChange",i)):!o&&s&&(n.off("beforeSelectionChange",i),t(n),delete n.state.activeLines)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("thirdparty/CodeMirror2/addon/selection/mark-selection",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e){e.operation(function(){a(e)})}function n(e){e.state.markedSelection.length&&e.operation(function(){i(e)})}function r(e,t,n,r){if(0!=c(t,n))for(var i=e.state.markedSelection,o=e.state.markedSelectionStyle,a=t.line;;){var u=a==t.line?t:l(a,0),d=a+s,p=d>=n.line,h=p?n:l(d,0),f=e.markText(u,h,{className:o});if(null==r?i.push(f):i.splice(r++,0,f),p)break;a=d}}function i(e){for(var t=e.state.markedSelection,n=0;n<t.length;++n)t[n].clear();t.length=0}function o(e){i(e);for(var t=e.listSelections(),n=0;n<t.length;n++)r(e,t[n].from(),t[n].to())}function a(e){if(!e.somethingSelected())return i(e);if(e.listSelections().length>1)return o(e);var t=e.getCursor("start"),n=e.getCursor("end"),a=e.state.markedSelection;if(!a.length)return r(e,t,n);var l=a[0].find(),u=a[a.length-1].find();if(!l||!u||n.line-t.line<s||c(t,u.to)>=0||c(n,l.from)<=0)return o(e);for(;c(t,l.from)>0;)a.shift().clear(),l=a[0].find();for(c(t,l.from)<0&&(l.to.line-t.line<s?(a.shift().clear(),r(e,t,l.to,0)):r(e,t,l.from,0));c(n,u.to)<0;)a.pop().clear(),u=a[a.length-1].find();c(n,u.to)>0&&(n.line-u.from.line<s?(a.pop().clear(),r(e,u.from,n)):r(e,u.to,n))}e.defineOption("styleSelectedText",!1,function(r,a,s){var l=s&&s!=e.Init;a&&!l?(r.state.markedSelection=[],r.state.markedSelectionStyle="string"==typeof a?a:"CodeMirror-selectedtext",o(r),r.on("cursorActivity",t),r.on("change",n)):!a&&l&&(r.off("cursorActivity",t),r.off("change",n),i(r),r.state.markedSelection=r.state.markedSelectionStyle=null)});var s=8,l=e.Pos,c=e.cmpPos}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("thirdparty/CodeMirror2/addon/mode/multiplex",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.multiplexingMode=function(t){function n(e,t,n){if("string"==typeof t)return e.indexOf(t,n);var r=t.exec(n?e.slice(n):e);return r?r.index+n:-1}var r=Array.prototype.slice.call(arguments,1),i=r.length;return{startState:function(){return{outer:e.startState(t),innerActive:null,inner:null}},copyState:function(n){return{outer:e.copyState(t,n.outer),innerActive:n.innerActive,inner:n.innerActive&&e.copyState(n.innerActive.mode,n.inner)}},token:function(o,a){if(a.innerActive){var s=a.innerActive,l=o.string;if(!s.close&&o.sol())return a.innerActive=a.inner=null,this.token(o,a);var c=s.close?n(l,s.close,o.pos):-1;if(c==o.pos)return o.match(s.close),a.innerActive=a.inner=null,s.delimStyle;c>-1&&(o.string=l.slice(0,c));var u=s.mode.token(o,a.inner);return c>-1&&(o.string=l),s.innerStyle&&(u=u?u+" "+s.innerStyle:s.innerStyle),u}for(var d=1/0,l=o.string,p=0;i>p;++p){var h=r[p],c=n(l,h.open,o.pos);if(c==o.pos)return o.match(h.open),a.innerActive=h,a.inner=e.startState(h.mode,t.indent?t.indent(a.outer,""):0),h.delimStyle;-1!=c&&d>c&&(d=c)}1/0!=d&&(o.string=l.slice(0,d));var f=t.token(o,a.outer);return 1/0!=d&&(o.string=l),f},indent:function(n,r){var i=n.innerActive?n.innerActive.mode:t;return i.indent?i.indent(n.innerActive?n.inner:n.outer,r):e.Pass},blankLine:function(n){var o=n.innerActive?n.innerActive.mode:t;if(o.blankLine&&o.blankLine(n.innerActive?n.inner:n.outer),n.innerActive)"\n"===n.innerActive.close&&(n.innerActive=n.inner=null);else for(var a=0;i>a;++a){var s=r[a];"\n"===s.open&&(n.innerActive=s,n.inner=e.startState(s.mode,o.indent?o.indent(n.outer,""):0))}},electricChars:t.electricChars,innerMode:function(e){return e.inner?{state:e.inner,mode:e.innerActive.mode}:{state:e.outer,mode:t}}}}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("thirdparty/CodeMirror2/addon/mode/overlay",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.overlayMode=function(t,n,r){return{startState:function(){return{base:e.startState(t),overlay:e.startState(n),basePos:0,baseCur:null,overlayPos:0,overlayCur:null,streamSeen:null}},copyState:function(r){return{base:e.copyState(t,r.base),overlay:e.copyState(n,r.overlay),basePos:r.basePos,baseCur:null,overlayPos:r.overlayPos,overlayCur:null}},token:function(e,i){return(e!=i.streamSeen||Math.min(i.basePos,i.overlayPos)<e.start)&&(i.streamSeen=e,i.basePos=i.overlayPos=e.start),e.start==i.basePos&&(i.baseCur=t.token(e,i.base),i.basePos=e.pos),e.start==i.overlayPos&&(e.pos=e.start,i.overlayCur=n.token(e,i.overlay),i.overlayPos=e.pos),e.pos=Math.min(i.basePos,i.overlayPos),null==i.overlayCur?i.baseCur:null!=i.baseCur&&i.overlay.combineTokens||r&&null==i.overlay.combineTokens?i.baseCur+" "+i.overlayCur:i.overlayCur},indent:t.indent&&function(e,n){return t.indent(e.base,n)},electricChars:t.electricChars,innerMode:function(e){return{state:e.base,mode:t}},blankLine:function(e){t.blankLine&&t.blankLine(e.base),n.blankLine&&n.blankLine(e.overlay)}}}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("thirdparty/CodeMirror2/addon/search/match-highlighter",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e){"object"==typeof e&&(this.minChars=e.minChars,this.style=e.style,this.showToken=e.showToken,this.delay=e.delay,this.wordsOnly=e.wordsOnly),null==this.style&&(this.style=l),null==this.minChars&&(this.minChars=s),null==this.delay&&(this.delay=c),null==this.wordsOnly&&(this.wordsOnly=u),this.overlay=this.timeout=null}function n(e){var t=e.state.matchHighlighter;clearTimeout(t.timeout),t.timeout=setTimeout(function(){r(e)},t.delay)}function r(e){e.operation(function(){var t=e.state.matchHighlighter;if(t.overlay&&(e.removeOverlay(t.overlay),t.overlay=null),!e.somethingSelected()&&t.showToken){for(var n=t.showToken===!0?/[\w$]/:t.showToken,r=e.getCursor(),o=e.getLine(r.line),s=r.ch,l=s;s&&n.test(o.charAt(s-1));)--s;for(;l<o.length&&n.test(o.charAt(l));)++l;return void(l>s&&e.addOverlay(t.overlay=a(o.slice(s,l),n,t.style)))}var c=e.getCursor("from"),u=e.getCursor("to");if(c.line==u.line&&(!t.wordsOnly||i(e,c,u))){var d=e.getRange(c,u).replace(/^\s+|\s+$/g,"");d.length>=t.minChars&&e.addOverlay(t.overlay=a(d,!1,t.style))}})}function i(e,t,n){var r=e.getRange(t,n);if(null!==r.match(/^\w+$/)){if(t.ch>0){var i={line:t.line,ch:t.ch-1},o=e.getRange(i,t);if(null===o.match(/\W/))return!1}if(n.ch<e.getLine(t.line).length){var i={line:n.line,ch:n.ch+1},o=e.getRange(n,i);if(null===o.match(/\W/))return!1}return!0}return!1}function o(e,t){return!(e.start&&t.test(e.string.charAt(e.start-1))||e.pos!=e.string.length&&t.test(e.string.charAt(e.pos)))}function a(e,t,n){return{token:function(r){return!r.match(e)||t&&!o(r,t)?(r.next(),void(r.skipTo(e.charAt(0))||r.skipToEnd())):n}}}var s=2,l="matchhighlight",c=100,u=!1;e.defineOption("highlightSelectionMatches",!1,function(i,o,a){if(a&&a!=e.Init){var s=i.state.matchHighlighter.overlay;s&&i.removeOverlay(s),clearTimeout(i.state.matchHighlighter.timeout),i.state.matchHighlighter=null,i.off("cursorActivity",n)}o&&(i.state.matchHighlighter=new t(o),r(i),i.on("cursorActivity",n))})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("thirdparty/CodeMirror2/addon/search/searchcursor",["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t,i,o){if(this.atOccurrence=!1,this.doc=e,null==o&&"string"==typeof t&&(o=!1),i=i?e.clipPos(i):r(0,0),this.pos={from:i,to:i},"string"!=typeof t)t.global||(t=new RegExp(t.source,t.ignoreCase?"ig":"g")),this.matches=function(n,i){if(n){t.lastIndex=0;for(var o,a,s=e.getLine(i.line).slice(0,i.ch),l=0;;){t.lastIndex=l;var c=t.exec(s);if(!c)break;if(o=c,a=o.index,l=o.index+(o[0].length||1),l==s.length)break}var u=o&&o[0].length||0;u||(0==a&&0==s.length?o=void 0:a!=e.getLine(i.line).length&&u++)}else{t.lastIndex=i.ch;var s=e.getLine(i.line),o=t.exec(s),u=o&&o[0].length||0,a=o&&o.index;a+u==s.length||u||(u=1)}return o&&u?{from:r(i.line,a),to:r(i.line,a+u),match:o}:void 0};else{var a=t;o&&(t=t.toLowerCase());var s=o?function(e){return e.toLowerCase()}:function(e){return e},l=t.split("\n");if(1==l.length)this.matches=t.length?function(i,o){if(i){var l=e.getLine(o.line).slice(0,o.ch),c=s(l),u=c.lastIndexOf(t);if(u>-1)return u=n(l,c,u),{from:r(o.line,u),to:r(o.line,u+a.length)}}else{var l=e.getLine(o.line).slice(o.ch),c=s(l),u=c.indexOf(t);if(u>-1)return u=n(l,c,u)+o.ch,{from:r(o.line,u),to:r(o.line,u+a.length)}}}:function(){};else{var c=a.split("\n");this.matches=function(t,n){var i=l.length-1;if(t){if(n.line-(l.length-1)<e.firstLine())return;if(s(e.getLine(n.line).slice(0,c[i].length))!=l[l.length-1])return;for(var o=r(n.line,c[i].length),a=n.line-1,u=i-1;u>=1;--u,--a)if(l[u]!=s(e.getLine(a)))return;var d=e.getLine(a),p=d.length-c[0].length;if(s(d.slice(p))!=l[0])return;return{from:r(a,p),to:o}}if(!(n.line+(l.length-1)>e.lastLine())){var d=e.getLine(n.line),p=d.length-c[0].length;if(s(d.slice(p))==l[0]){for(var h=r(n.line,p),a=n.line+1,u=1;i>u;++u,++a)if(l[u]!=s(e.getLine(a)))return;if(s(e.getLine(a).slice(0,c[i].length))==l[i])return{from:h,to:r(a,c[i].length)}}}}}}}function n(e,t,n){if(e.length==t.length)return n;for(var r=Math.min(n,e.length);;){var i=e.slice(0,r).toLowerCase().length;if(n>i)++r;else{if(!(i>n))return r;--r}}}var r=e.Pos;t.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(e){function t(e){var t=r(e,0);return n.pos={from:t,to:t},n.atOccurrence=!1,!1}for(var n=this,i=this.doc.clipPos(e?this.pos.from:this.pos.to);;){if(this.pos=this.matches(e,i))return this.atOccurrence=!0,this.pos.match||!0;if(e){if(!i.line)return t(0);i=r(i.line-1,this.doc.getLine(i.line-1).length)}else{var o=this.doc.lineCount();if(i.line==o-1)return t(o);i=r(i.line+1,0)}}},from:function(){return this.atOccurrence?this.pos.from:void 0},to:function(){return this.atOccurrence?this.pos.to:void 0},replace:function(t){if(this.atOccurrence){var n=e.splitLines(t);this.doc.replaceRange(n,this.pos.from,this.pos.to),this.pos.to=r(this.pos.from.line+n.length-1,n[n.length-1].length+(1==n.length?this.pos.from.ch:0))}}},e.defineExtension("getSearchCursor",function(e,n,r){return new t(this.doc,e,n,r)
}),e.defineDocExtension("getSearchCursor",function(e,n,r){return new t(this,e,n,r)}),e.defineExtension("selectMatches",function(t,n){for(var r,i=[],o=this.getSearchCursor(t,this.getCursor("from"),n);(r=o.findNext())&&!(e.cmpPos(o.to(),this.getCursor("to"))>0);)i.push({anchor:o.from(),head:o.to()});i.length&&this.setSelections(i,0)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/edit/matchbrackets")):"function"==typeof define&&define.amd?define("thirdparty/CodeMirror2/keymap/sublime",["../lib/codemirror","../addon/search/searchcursor","../addon/edit/matchbrackets"],e):e(CodeMirror)}(function(e){"use strict";function t(t,n,r){if(0>r&&0==n.ch)return t.clipPos(p(n.line-1));var i=t.getLine(n.line);if(r>0&&n.ch>=i.length)return t.clipPos(p(n.line+1,0));for(var o,a="start",s=n.ch,l=0>r?0:i.length,c=0;s!=l;s+=r,c++){var u=i.charAt(0>r?s-1:s),d="_"!=u&&e.isWordChar(u)?"w":"o";if("w"==d&&u.toUpperCase()==u&&(d="W"),"start"==a)"o"!=d&&(a="in",o=d);else if("in"==a&&o!=d){if("w"==o&&"W"==d&&0>r&&s--,"W"==o&&"w"==d&&r>0){o="w";continue}break}}return p(n.line,s)}function n(e,n){e.extendSelectionsBy(function(r){return e.display.shift||e.doc.extend||r.empty()?t(e.doc,r.head,n):0>n?r.from():r.to()})}function r(e,t){e.operation(function(){for(var n=e.listSelections().length,r=[],i=-1,o=0;n>o;o++){var a=e.listSelections()[o].head;if(!(a.line<=i)){var s=p(a.line+(t?0:1),0);e.replaceRange("\n",s,null,"+insertLine"),e.indentLine(s.line,null,!0),r.push({head:s,anchor:s}),i=a.line+1}}e.setSelections(r)})}function i(t,n){for(var r=n.ch,i=r,o=t.getLine(n.line);r&&e.isWordChar(o.charAt(r-1));)--r;for(;i<o.length&&e.isWordChar(o.charAt(i));)++i;return{from:p(n.line,r),to:p(n.line,i),word:o.slice(r,i)}}function o(e){var t=e.getCursor(),n=e.scanForBracket(t,-1);if(n)for(;;){var r=e.scanForBracket(t,1);if(!r)return;if(r.ch==m.charAt(m.indexOf(n.ch)+1))return e.setSelection(p(n.pos.line,n.pos.ch+1),r.pos,!1),!0;t=p(r.pos.line,r.pos.ch+1)}}function a(e,t){for(var n,r=e.listSelections(),i=[],o=0;o<r.length;o++){var a=r[o];if(!a.empty()){for(var s=a.from().line,l=a.to().line;o<r.length-1&&r[o+1].from().line==l;)l=a[++o].to().line;i.push(s,l)}}i.length?n=!0:i.push(e.firstLine(),e.lastLine()),e.operation(function(){for(var r=[],o=0;o<i.length;o+=2){var a=i[o],s=i[o+1],l=p(a,0),c=p(s),u=e.getRange(l,c,!1);t?u.sort():u.sort(function(e,t){var n=e.toUpperCase(),r=t.toUpperCase();return n!=r&&(e=n,t=r),t>e?-1:e==t?0:1}),e.replaceRange(u,l,c),n&&r.push({anchor:l,head:c})}n&&e.setSelections(r,0)})}function s(t,n){t.operation(function(){for(var r=t.listSelections(),o=[],a=[],s=0;s<r.length;s++){var l=r[s];l.empty()?(o.push(s),a.push("")):a.push(n(t.getRange(l.from(),l.to())))}t.replaceSelections(a,"around","case");for(var c,s=o.length-1;s>=0;s--){var l=r[o[s]];if(!(c&&e.cmpPos(l.head,c)>0)){var u=i(t,l.head);c=u.from,t.replaceRange(n(u.word),u.from,u.to)}}})}function l(t){var n=t.getCursor("from"),r=t.getCursor("to");if(0==e.cmpPos(n,r)){var o=i(t,n);if(!o.word)return;n=o.from,r=o.to}return{from:n,to:r,query:t.getRange(n,r),word:o}}function c(e,t){var n=l(e);if(n){var r=n.query,i=e.getSearchCursor(r,t?n.to:n.from);(t?i.findNext():i.findPrevious())?e.setSelection(i.from(),i.to()):(i=e.getSearchCursor(r,t?p(e.firstLine(),0):e.clipPos(p(e.lastLine()))),(t?i.findNext():i.findPrevious())?e.setSelection(i.from(),i.to()):n.word&&e.setSelection(n.from,n.to))}}var u=e.keyMap.sublime={fallthrough:"default"},d=e.commands,p=e.Pos,h=e.keyMap["default"]==e.keyMap.macDefault,f=h?"Cmd-":"Ctrl-";d[u["Alt-Left"]="goSubwordLeft"]=function(e){n(e,-1)},d[u["Alt-Right"]="goSubwordRight"]=function(e){n(e,1)},d[u[f+"Up"]="scrollLineUp"]=function(e){var t=e.getScrollInfo();if(!e.somethingSelected()){var n=e.lineAtHeight(t.top+t.clientHeight,"local");e.getCursor().line>=n&&e.execCommand("goLineUp")}e.scrollTo(null,t.top-e.defaultTextHeight())},d[u[f+"Down"]="scrollLineDown"]=function(e){var t=e.getScrollInfo();if(!e.somethingSelected()){var n=e.lineAtHeight(t.top,"local")+1;e.getCursor().line<=n&&e.execCommand("goLineDown")}e.scrollTo(null,t.top+e.defaultTextHeight())},d[u["Shift-"+f+"L"]="splitSelectionByLine"]=function(e){for(var t=e.listSelections(),n=[],r=0;r<t.length;r++)for(var i=t[r].from(),o=t[r].to(),a=i.line;a<=o.line;++a)o.line>i.line&&a==o.line&&0==o.ch||n.push({anchor:a==i.line?i:p(a,0),head:a==o.line?o:p(a)});e.setSelections(n,0)},u["Shift-Tab"]="indentLess",d[u.Esc="singleSelectionTop"]=function(e){var t=e.listSelections()[0];e.setSelection(t.anchor,t.head,{scroll:!1})},d[u[f+"L"]="selectLine"]=function(e){for(var t=e.listSelections(),n=[],r=0;r<t.length;r++){var i=t[r];n.push({anchor:p(i.from().line,0),head:p(i.to().line+1,0)})}e.setSelections(n)},u["Shift-"+f+"K"]="deleteLine",d[u[f+"Enter"]="insertLineAfter"]=function(e){r(e,!1)},d[u["Shift-"+f+"Enter"]="insertLineBefore"]=function(e){r(e,!0)},d[u[f+"D"]="selectNextOccurrence"]=function(t){var n=t.getCursor("from"),r=t.getCursor("to"),o=t.state.sublimeFindFullWord==t.doc.sel;if(0==e.cmpPos(n,r)){var a=i(t,n);if(!a.word)return;t.setSelection(a.from,a.to),o=!0}else{var s=t.getRange(n,r),l=o?new RegExp("\\b"+s+"\\b"):s,c=t.getSearchCursor(l,r);c.findNext()?t.addSelection(c.from(),c.to()):(c=t.getSearchCursor(l,p(t.firstLine(),0)),c.findNext()&&t.addSelection(c.from(),c.to()))}o&&(t.state.sublimeFindFullWord=t.doc.sel)};var m="(){}[]";d[u["Shift-"+f+"Space"]="selectScope"]=function(e){o(e)||e.execCommand("selectAll")},d[u["Shift-"+f+"M"]="selectBetweenBrackets"]=function(t){return o(t)?void 0:e.Pass},d[u[f+"M"]="goToBracket"]=function(t){t.extendSelectionsBy(function(n){var r=t.scanForBracket(n.head,1);if(r&&0!=e.cmpPos(r.pos,n.head))return r.pos;var i=t.scanForBracket(n.head,-1);return i&&p(i.pos.line,i.pos.ch+1)||n.head})};var g=h?"Cmd-Ctrl-":"Shift-Ctrl-";d[u[g+"Up"]="swapLineUp"]=function(e){for(var t=e.listSelections(),n=[],r=e.firstLine()-1,i=[],o=0;o<t.length;o++){var a=t[o],s=a.from().line-1,l=a.to().line;i.push({anchor:p(a.anchor.line-1,a.anchor.ch),head:p(a.head.line-1,a.head.ch)}),0!=a.to().ch||a.empty()||--l,s>r?n.push(s,l):n.length&&(n[n.length-1]=l),r=l}e.operation(function(){for(var t=0;t<n.length;t+=2){var r=n[t],o=n[t+1],a=e.getLine(r);e.replaceRange("",p(r,0),p(r+1,0),"+swapLine"),o>e.lastLine()?e.replaceRange("\n"+a,p(e.lastLine()),null,"+swapLine"):e.replaceRange(a+"\n",p(o,0),null,"+swapLine")}e.setSelections(i),e.scrollIntoView()})},d[u[g+"Down"]="swapLineDown"]=function(e){for(var t=e.listSelections(),n=[],r=e.lastLine()+1,i=t.length-1;i>=0;i--){var o=t[i],a=o.to().line+1,s=o.from().line;0!=o.to().ch||o.empty()||a--,r>a?n.push(a,s):n.length&&(n[n.length-1]=s),r=s}e.operation(function(){for(var t=n.length-2;t>=0;t-=2){var r=n[t],i=n[t+1],o=e.getLine(r);r==e.lastLine()?e.replaceRange("",p(r-1),p(r),"+swapLine"):e.replaceRange("",p(r,0),p(r+1,0),"+swapLine"),e.replaceRange(o+"\n",p(i,0),null,"+swapLine")}e.scrollIntoView()})},u[f+"/"]="toggleComment",d[u[f+"J"]="joinLines"]=function(e){for(var t=e.listSelections(),n=[],r=0;r<t.length;r++){for(var i=t[r],o=i.from(),a=o.line,s=i.to().line;r<t.length-1&&t[r+1].from().line==s;)s=t[++r].to().line;n.push({start:a,end:s,anchor:!i.empty()&&o})}e.operation(function(){for(var t=0,r=[],i=0;i<n.length;i++){for(var o,a=n[i],s=a.anchor&&p(a.anchor.line-t,a.anchor.ch),l=a.start;l<=a.end;l++){var c=l-t;l==a.end&&(o=p(c,e.getLine(c).length+1)),c<e.lastLine()&&(e.replaceRange(" ",p(c),p(c+1,/^\s*/.exec(e.getLine(c+1))[0].length)),++t)}r.push({anchor:s||o,head:o})}e.setSelections(r,0)})},d[u["Shift-"+f+"D"]="duplicateLine"]=function(e){e.operation(function(){for(var t=e.listSelections().length,n=0;t>n;n++){var r=e.listSelections()[n];r.empty()?e.replaceRange(e.getLine(r.head.line)+"\n",p(r.head.line,0)):e.replaceRange(e.getRange(r.from(),r.to()),r.from())}e.scrollIntoView()})},u[f+"T"]="transposeChars",d[u.F9="sortLines"]=function(e){a(e,!0)},d[u[f+"F9"]="sortLinesInsensitive"]=function(e){a(e,!1)},d[u.F2="nextBookmark"]=function(e){var t=e.state.sublimeBookmarks;if(t)for(;t.length;){var n=t.shift(),r=n.find();if(r)return t.push(n),e.setSelection(r.from,r.to)}},d[u["Shift-F2"]="prevBookmark"]=function(e){var t=e.state.sublimeBookmarks;if(t)for(;t.length;){t.unshift(t.pop());var n=t[t.length-1].find();if(n)return e.setSelection(n.from,n.to);t.pop()}},d[u[f+"F2"]="toggleBookmark"]=function(e){for(var t=e.listSelections(),n=e.state.sublimeBookmarks||(e.state.sublimeBookmarks=[]),r=0;r<t.length;r++){for(var i=t[r].from(),o=t[r].to(),a=e.findMarks(i,o),s=0;s<a.length;s++)if(a[s].sublimeBookmark){a[s].clear();for(var l=0;l<n.length;l++)n[l]==a[s]&&n.splice(l--,1);break}s==a.length&&n.push(e.markText(i,o,{sublimeBookmark:!0,clearWhenEmpty:!1}))}},d[u["Shift-"+f+"F2"]="clearBookmarks"]=function(e){var t=e.state.sublimeBookmarks;if(t)for(var n=0;n<t.length;n++)t[n].clear();t.length=0},d[u["Alt-F2"]="selectBookmarks"]=function(e){var t=e.state.sublimeBookmarks,n=[];if(t)for(var r=0;r<t.length;r++){var i=t[r].find();i?n.push({anchor:i.from,head:i.to}):t.splice(r--,0)}n.length&&e.setSelections(n,0)},u["Alt-Q"]="wrapLines";var v=f+"K ";u[v+f+"Backspace"]="delLineLeft",d[u[v+f+"K"]="delLineRight"]=function(e){e.operation(function(){for(var t=e.listSelections(),n=t.length-1;n>=0;n--)e.replaceRange("",t[n].anchor,p(t[n].to().line),"+delete");e.scrollIntoView()})},d[u[v+f+"U"]="upcaseAtCursor"]=function(e){s(e,function(e){return e.toUpperCase()})},d[u[v+f+"L"]="downcaseAtCursor"]=function(e){s(e,function(e){return e.toLowerCase()})},d[u[v+f+"Space"]="setSublimeMark"]=function(e){e.state.sublimeMark&&e.state.sublimeMark.clear(),e.state.sublimeMark=e.setBookmark(e.getCursor())},d[u[v+f+"A"]="selectToSublimeMark"]=function(e){var t=e.state.sublimeMark&&e.state.sublimeMark.find();t&&e.setSelection(e.getCursor(),t)},d[u[v+f+"W"]="deleteToSublimeMark"]=function(t){var n=t.state.sublimeMark&&t.state.sublimeMark.find();if(n){var r=t.getCursor(),i=n;if(e.cmpPos(r,i)>0){var o=i;i=r,r=o}t.state.sublimeKilled=t.getRange(r,i),t.replaceRange("",r,i)}},d[u[v+f+"X"]="swapWithSublimeMark"]=function(e){var t=e.state.sublimeMark&&e.state.sublimeMark.find();t&&(e.state.sublimeMark.clear(),e.state.sublimeMark=e.setBookmark(e.getCursor()),e.setCursor(t))},d[u[v+f+"Y"]="sublimeYank"]=function(e){null!=e.state.sublimeKilled&&e.replaceSelection(e.state.sublimeKilled,null,"paste")},u[v+f+"G"]="clearBookmarks",d[u[v+f+"C"]="showInCenter"]=function(e){var t=e.cursorCoords(null,"local");e.scrollTo(null,(t.top+t.bottom)/2-e.getScrollInfo().clientHeight/2)},d[u["Shift-Alt-Up"]="selectLinesUpward"]=function(e){e.operation(function(){for(var t=e.listSelections(),n=0;n<t.length;n++){var r=t[n];r.head.line>e.firstLine()&&e.addSelection(p(r.head.line-1,r.head.ch))}})},d[u["Shift-Alt-Down"]="selectLinesDownward"]=function(e){e.operation(function(){for(var t=e.listSelections(),n=0;n<t.length;n++){var r=t[n];r.head.line<e.lastLine()&&e.addSelection(p(r.head.line+1,r.head.ch))}})},d[u[f+"F3"]="findUnder"]=function(e){c(e,!0)},d[u["Shift-"+f+"F3"]="findUnderPrevious"]=function(e){c(e,!1)},d[u["Alt-F3"]="findAllUnder"]=function(e){var t=l(e);if(t){for(var n=e.getSearchCursor(t.query),r=[],i=-1;n.findNext();)r.push({anchor:n.from(),head:n.to()}),n.from().line<=t.from.line&&n.from().ch<=t.from.ch&&i++;e.setSelections(r,i)}},u["Shift-"+f+"["]="fold",u["Shift-"+f+"]"]="unfold",u[v+f+"0"]=u[v+f+"j"]="unfoldAll",u[f+"I"]="findIncremental",u["Shift-"+f+"I"]="findIncrementalReverse",u[f+"H"]="replace",u.F3="findNext",u["Shift-F3"]="findPrev",e.normalizeKeyMap(u)}),define("utils/AppInit",["require","exports","module"],function(e,t){"use strict";function n(e){try{e()}catch(t){console.error("Exception when calling a 'brackets done loading' handler: "+t),console.log(t.stack)}}function r(e){var t,r=p[e];for(d[e]=!0,t=0;t<r.length;t++)n(r[t]);p[e]=[]}function i(e,t){d[e]?n(t):p[e].push(t)}function o(e){i(c,e)}function a(e){i(l,e)}function s(e){i(u,e)}var l="htmlReady",c="appReady",u="extensionsLoaded",d={HTML_READY:!1,APP_READY:!1,EXTENSIONS_LOADED:!1},p={};p[l]=[],p[c]=[],p[u]=[],t.appReady=o,t.htmlReady=a,t.extensionsLoaded=s,t.HTML_READY=l,t.APP_READY=c,t.EXTENSIONS_LOADED=u,t._dispatchReady=r}),function(){function e(e,t,n){n=(n||0)-1;for(var r=e?e.length:0;++n<r;)if(e[n]===t)return n;return-1}function t(t,n){var r=typeof n;if(t=t.l,"boolean"==r||null==n)return t[n]?0:-1;"number"!=r&&"string"!=r&&(r="object");var i="number"==r?n:v+n;return t=(t=t[r])&&t[i],"object"==r?t&&-1<e(t,n)?0:-1:t?0:-1}function n(e){var t=this.l,n=typeof e;if("boolean"==n||null==e)t[e]=!0;else{"number"!=n&&"string"!=n&&(n="object");var r="number"==n?e:v+e,t=t[n]||(t[n]={});"object"==n?(t[r]||(t[r]=[])).push(e):t[r]=!0}}function r(e){return e.charCodeAt(0)}function i(e,t){for(var n=e.m,r=t.m,i=-1,o=n.length;++i<o;){var a=n[i],s=r[i];if(a!==s){if(a>s||"undefined"==typeof a)return 1;if(s>a||"undefined"==typeof s)return-1}}return e.n-t.n}function o(e){var t=-1,r=e.length,i=e[0],o=e[r/2|0],a=e[r-1];if(i&&"object"==typeof i&&o&&"object"==typeof o&&a&&"object"==typeof a)return!1;for(i=l(),i["false"]=i["null"]=i["true"]=i.undefined=!1,o=l(),o.k=e,o.l=i,o.push=n;++t<r;)o.push(e[t]);return o}function a(e){return"\\"+K[e]}function s(){return f.pop()||[]}function l(){return m.pop()||{k:null,l:null,m:null,"false":!1,n:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,o:null}}function c(e){e.length=0,f.length<_&&f.push(e)}function u(e){var t=e.l;t&&u(t),e.k=e.l=e.m=e.object=e.number=e.string=e.o=null,m.length<_&&m.push(e)}function d(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);var r=-1;n=n-t||0;for(var i=Array(0>n?0:n);++r<n;)i[r]=e[t+r];return i}function p(n){function f(e,t,n){if(!e||!G[typeof e])return e;t=t&&"undefined"==typeof n?t:tt(t,n,3);for(var r=-1,i=G[typeof e]&&Fn(e),o=i?i.length:0;++r<o&&(n=i[r],!1!==t(e[n],n,e)););return e}function m(e,t,n){var r;if(!e||!G[typeof e])return e;t=t&&"undefined"==typeof n?t:tt(t,n,3);for(r in e)if(!1===t(e[r],r,e))break;return e}function _(e,t,n){var r,i=e,o=i;if(!i)return o;for(var a=arguments,s=0,l="number"==typeof n?2:a.length;++s<l;)if((i=a[s])&&G[typeof i])for(var c=-1,u=G[typeof i]&&Fn(i),d=u?u.length:0;++c<d;)r=u[c],"undefined"==typeof o[r]&&(o[r]=i[r]);return o}function K(e,t,n){var r,i=e,o=i;if(!i)return o;var a=arguments,s=0,l="number"==typeof n?2:a.length;if(l>3&&"function"==typeof a[l-2])var c=tt(a[--l-1],a[l--],2);else l>2&&"function"==typeof a[l-1]&&(c=a[--l]);for(;++s<l;)if((i=a[s])&&G[typeof i])for(var u=-1,d=G[typeof i]&&Fn(i),p=d?d.length:0;++u<p;)r=d[u],o[r]=c?c(o[r],i[r]):i[r];return o}function z(e){var t,n=[];if(!e||!G[typeof e])return n;for(t in e)yn.call(e,t)&&n.push(t);return n}function X(e){return e&&"object"==typeof e&&!kn(e)&&yn.call(e,"__wrapped__")?e:new Q(e)}function Q(e,t){this.__chain__=!!t,this.__wrapped__=e}function J(e){function t(){if(r){var e=d(r);_n.apply(e,arguments)}if(this instanceof t){var o=et(n.prototype),e=n.apply(o,e||arguments);return bt(e)?e:o}return n.apply(i,e||arguments)}var n=e[0],r=e[2],i=e[4];return Pn(t,e),t}function Z(e,t,n,r,i){if(n){var o=n(e);if("undefined"!=typeof o)return o}if(!bt(e))return e;var a=dn.call(e);if(!B[a])return e;var l=xn[a];switch(a){case P:case k:return new l(+e);case U:case V:return new l(e);case $:return o=l(e.source,C.exec(e)),o.lastIndex=e.lastIndex,o}if(a=kn(e),t){var u=!r;r||(r=s()),i||(i=s());for(var p=r.length;p--;)if(r[p]==e)return i[p];o=a?l(e.length):{}}else o=a?d(e):K({},e);return a&&(yn.call(e,"index")&&(o.index=e.index),yn.call(e,"input")&&(o.input=e.input)),t?(r.push(e),i.push(o),(a?Mt:f)(e,function(e,a){o[a]=Z(e,t,n,r,i)}),u&&(c(r),c(i)),o):o}function et(e){return bt(e)?wn(e):{}}function tt(e,t,n){if("function"!=typeof e)return Kt;if("undefined"==typeof t||!("prototype"in e))return e;var r=e.__bindData__;if("undefined"==typeof r&&(An.funcNames&&(r=!e.name),r=r||!An.funcDecomp,!r)){var i=gn.call(e);An.funcNames||(r=!D.test(i)),r||(r=L.test(i),Pn(e,r))}if(!1===r||!0!==r&&1&r[1])return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,o){return e.call(t,n,r,i,o)}}return Wt(e,t)}function nt(e){function t(){var e=l?a:this;if(i){var f=d(i);_n.apply(f,arguments)}return(o||u)&&(f||(f=d(arguments)),o&&_n.apply(f,o),u&&f.length<s)?(r|=16,nt([n,p?r:-4&r,f,null,a,s])):(f||(f=arguments),c&&(n=e[h]),this instanceof t?(e=et(n.prototype),f=n.apply(e,f),bt(f)?f:e):n.apply(e,f))}var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=1&r,c=2&r,u=4&r,p=8&r,h=n;return Pn(t,e),t}function rt(n,r){var i=-1,a=pt(),s=n?n.length:0,l=s>=y&&a===e,c=[];if(l){var d=o(r);d?(a=t,r=d):l=!1}for(;++i<s;)d=n[i],0>a(r,d)&&c.push(d);return l&&u(r),c}function it(e,t,n,r){r=(r||0)-1;for(var i=e?e.length:0,o=[];++r<i;){var a=e[r];if(a&&"object"==typeof a&&"number"==typeof a.length&&(kn(a)||gt(a))){t||(a=it(a,t,n));var s=-1,l=a.length,c=o.length;for(o.length+=l;++s<l;)o[c++]=a[s]}else n||o.push(a)}return o}function ot(e,t,n,r,i,o){if(n){var a=n(e,t);if("undefined"!=typeof a)return!!a}if(e===t)return 0!==e||1/e==1/t;if(e===e&&!(e&&G[typeof e]||t&&G[typeof t]))return!1;if(null==e||null==t)return e===t;var l=dn.call(e),u=dn.call(t);if(l==x&&(l=j),u==x&&(u=j),l!=u)return!1;switch(l){case P:case k:return+e==+t;case U:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case $:case V:return e==an(t)}if(u=l==A,!u){var d=yn.call(e,"__wrapped__"),p=yn.call(t,"__wrapped__");if(d||p)return ot(d?e.__wrapped__:e,p?t.__wrapped__:t,n,r,i,o);if(l!=j)return!1;if(l=e.constructor,d=t.constructor,l!=d&&!(Et(l)&&l instanceof l&&Et(d)&&d instanceof d)&&"constructor"in e&&"constructor"in t)return!1}for(l=!i,i||(i=s()),o||(o=s()),d=i.length;d--;)if(i[d]==e)return o[d]==t;var h=0,a=!0;if(i.push(e),o.push(t),u){if(d=e.length,h=t.length,(a=h==d)||r)for(;h--;)if(u=d,p=t[h],r)for(;u--&&!(a=ot(e[u],p,n,r,i,o)););else if(!(a=ot(e[h],p,n,r,i,o)))break}else m(t,function(t,s,l){return yn.call(l,s)?(h++,a=yn.call(e,s)&&ot(e[s],t,n,r,i,o)):void 0}),a&&!r&&m(e,function(e,t,n){return yn.call(n,t)?a=-1<--h:void 0});return i.pop(),o.pop(),l&&(c(i),c(o)),a}function at(e,t,n,r,i){(kn(t)?Mt:f)(t,function(t,o){var a,s,l=t,c=e[o];if(t&&((s=kn(t))||Bn(t))){for(l=r.length;l--;)if(a=r[l]==t){c=i[l];break}if(!a){var u;n&&(l=n(c,t),u="undefined"!=typeof l)&&(c=l),u||(c=s?kn(c)?c:[]:Bn(c)?c:{}),r.push(t),i.push(c),u||at(c,t,n,r,i)}}else n&&(l=n(c,t),"undefined"==typeof l&&(l=t)),"undefined"!=typeof l&&(c=l);e[o]=c})}function st(e,t){return e+mn(Nn()*(t-e+1))}function lt(n,r,i){var a=-1,l=pt(),d=n?n.length:0,p=[],h=!r&&d>=y&&l===e,f=i||h?s():p;for(h&&(f=o(f),l=t);++a<d;){var m=n[a],g=i?i(m,a,n):m;(r?!a||f[f.length-1]!==g:0>l(f,g))&&((i||h)&&f.push(g),p.push(m))}return h?(c(f.k),u(f)):i&&c(f),p}function ct(e){return function(t,n,r){var i={};n=X.createCallback(n,r,3),r=-1;var o=t?t.length:0;if("number"==typeof o)for(;++r<o;){var a=t[r];e(i,a,n(a,r,t),t)}else f(t,function(t,r,o){e(i,t,n(t,r,o),o)});return i}}function ut(e,t,n,r,i,o){var a=1&t,s=4&t,l=16&t,c=32&t;if(!(2&t||Et(e)))throw new sn;l&&!n.length&&(t&=-17,l=n=!1),c&&!r.length&&(t&=-33,c=r=!1);var u=e&&e.__bindData__;return u&&!0!==u?(u=d(u),u[2]&&(u[2]=d(u[2])),u[3]&&(u[3]=d(u[3])),!a||1&u[1]||(u[4]=i),!a&&1&u[1]&&(t|=8),!s||4&u[1]||(u[5]=o),l&&_n.apply(u[2]||(u[2]=[]),n),c&&Sn.apply(u[3]||(u[3]=[]),r),u[1]|=t,ut.apply(null,u)):(1==t||17===t?J:nt)([e,t,n,r,i,o])}function dt(e){return Un[e]}function pt(){var t=(t=X.indexOf)===Ut?e:t;return t}function ht(e){return"function"==typeof e&&pn.test(e)}function ft(e){var t,n;return e&&dn.call(e)==j&&(t=e.constructor,!Et(t)||t instanceof t)?(m(e,function(e,t){n=t}),"undefined"==typeof n||yn.call(e,n)):!1}function mt(e){return jn[e]}function gt(e){return e&&"object"==typeof e&&"number"==typeof e.length&&dn.call(e)==x||!1}function vt(e,t,n){var r=Fn(e),i=r.length;for(t=tt(t,n,3);i--&&(n=r[i],!1!==t(e[n],n,e)););return e}function yt(e){var t=[];return m(e,function(e,n){Et(e)&&t.push(n)}),t.sort()}function _t(e){for(var t=-1,n=Fn(e),r=n.length,i={};++t<r;){var o=n[t];i[e[o]]=o}return i}function Et(e){return"function"==typeof e}function bt(e){return!(!e||!G[typeof e])}function St(e){return"number"==typeof e||e&&"object"==typeof e&&dn.call(e)==U||!1}function It(e){return"string"==typeof e||e&&"object"==typeof e&&dn.call(e)==V||!1}function wt(e){for(var t=-1,n=Fn(e),r=n.length,i=Qt(r);++t<r;)i[t]=e[n[t]];return i}function Ct(e,t,n){var r=-1,i=pt(),o=e?e.length:0,a=!1;return n=(0>n?Mn(0,o+n):n)||0,kn(e)?a=-1<i(e,t,n):"number"==typeof o?a=-1<(It(e)?e.indexOf(t,n):i(e,t,n)):f(e,function(e){return++r<n?void 0:!(a=e===t)}),a}function Dt(e,t,n){var r=!0;t=X.createCallback(t,n,3),n=-1;var i=e?e.length:0;if("number"==typeof i)for(;++n<i&&(r=!!t(e[n],n,e)););else f(e,function(e,n,i){return r=!!t(e,n,i)});return r}function Tt(e,t,n){var r=[];t=X.createCallback(t,n,3),n=-1;var i=e?e.length:0;if("number"==typeof i)for(;++n<i;){var o=e[n];t(o,n,e)&&r.push(o)}else f(e,function(e,n,i){t(e,n,i)&&r.push(e)});return r}function Ot(e,t,n){t=X.createCallback(t,n,3),n=-1;var r=e?e.length:0;if("number"!=typeof r){var i;return f(e,function(e,n,r){return t(e,n,r)?(i=e,!1):void 0}),i}for(;++n<r;){var o=e[n];if(t(o,n,e))return o}}function Mt(e,t,n){var r=-1,i=e?e.length:0;if(t=t&&"undefined"==typeof n?t:tt(t,n,3),"number"==typeof i)for(;++r<i&&!1!==t(e[r],r,e););else f(e,t);return e}function Lt(e,t,n){var r=e?e.length:0;if(t=t&&"undefined"==typeof n?t:tt(t,n,3),"number"==typeof r)for(;r--&&!1!==t(e[r],r,e););else{var i=Fn(e),r=i.length;f(e,function(e,n,o){return n=i?i[--r]:--r,t(o[n],n,o)})}return e}function Rt(e,t,n){var r=-1,i=e?e.length:0;if(t=X.createCallback(t,n,3),"number"==typeof i)for(var o=Qt(i);++r<i;)o[r]=t(e[r],r,e);else o=[],f(e,function(e,n,i){o[++r]=t(e,n,i)});return o}function Nt(e,t,n){var i=-1/0,o=i;if("function"!=typeof t&&n&&n[t]===e&&(t=null),null==t&&kn(e)){n=-1;for(var a=e.length;++n<a;){var s=e[n];s>o&&(o=s)}}else t=null==t&&It(e)?r:X.createCallback(t,n,3),Mt(e,function(e,n,r){n=t(e,n,r),n>i&&(i=n,o=e)});return o}function xt(e,t,n,r){if(!e)return n;var i=3>arguments.length;t=X.createCallback(t,r,4);var o=-1,a=e.length;if("number"==typeof a)for(i&&(n=e[++o]);++o<a;)n=t(n,e[o],o,e);else f(e,function(e,r,o){n=i?(i=!1,e):t(n,e,r,o)});return n}function At(e,t,n,r){var i=3>arguments.length;return t=X.createCallback(t,r,4),Lt(e,function(e,r,o){n=i?(i=!1,e):t(n,e,r,o)}),n}function Pt(e){var t=-1,n=e?e.length:0,r=Qt("number"==typeof n?n:0);return Mt(e,function(e){var n=st(0,++t);r[t]=r[n],r[n]=e}),r}function kt(e,t,n){var r;t=X.createCallback(t,n,3),n=-1;var i=e?e.length:0;if("number"==typeof i)for(;++n<i&&!(r=t(e[n],n,e)););else f(e,function(e,n,i){return!(r=t(e,n,i))});return!!r}function Ft(e,t,n){var r=0,i=e?e.length:0;if("number"!=typeof t&&null!=t){var o=-1;for(t=X.createCallback(t,n,3);++o<i&&t(e[o],o,e);)r++}else if(r=t,null==r||n)return e?e[0]:h;return d(e,0,Ln(Mn(0,r),i))}function Ut(t,n,r){if("number"==typeof r){var i=t?t.length:0;r=0>r?Mn(0,i+r):r||0}else if(r)return r=$t(t,n),t[r]===n?r:-1;return e(t,n,r)}function jt(e,t,n){if("number"!=typeof t&&null!=t){var r=0,i=-1,o=e?e.length:0;for(t=X.createCallback(t,n,3);++i<o&&t(e[i],i,e);)r++}else r=null==t||n?1:Mn(0,t);return d(e,r)}function $t(e,t,n,r){var i=0,o=e?e.length:i;for(n=n?X.createCallback(n,r,1):Kt,t=n(t);o>i;)r=i+o>>>1,n(e[r])<t?i=r+1:o=r;return i}function Vt(e,t,n,r){return"boolean"!=typeof t&&null!=t&&(r=n,n="function"!=typeof t&&r&&r[t]===e?null:t,t=!1),null!=n&&(n=X.createCallback(n,r,3)),lt(e,t,n)}function Bt(){for(var e=1<arguments.length?arguments:arguments[0],t=-1,n=e?Nt(Kn(e,"length")):0,r=Qt(0>n?0:n);++t<n;)r[t]=Kn(e,t);return r}function Ht(e,t){var n=-1,r=e?e.length:0,i={};for(t||!r||kn(e[0])||(t=[]);++n<r;){var o=e[n];t?i[o]=t[n]:o&&(i[o[0]]=o[1])}return i}function Wt(e,t){return 2<arguments.length?ut(e,17,d(arguments,2),null,t):ut(e,1,null,null,t)}function Gt(e,t,n){function r(){u&&fn(u),a=u=d=h,(m||f!==t)&&(p=qn(),s=e.apply(c,o),u||a||(o=c=null))}function i(){var n=t-(qn()-l);n>0?u=En(i,n):(a&&fn(a),n=d,a=u=d=h,n&&(p=qn(),s=e.apply(c,o),u||a||(o=c=null)))}var o,a,s,l,c,u,d,p=0,f=!1,m=!0;if(!Et(e))throw new sn;if(t=Mn(0,t)||0,!0===n)var g=!0,m=!1;else bt(n)&&(g=n.leading,f="maxWait"in n&&(Mn(t,n.maxWait)||0),m="trailing"in n?n.trailing:m);return function(){if(o=arguments,l=qn(),c=this,d=m&&(u||!g),!1===f)var n=g&&!u;else{a||g||(p=l);var h=f-(l-p),v=0>=h;v?(a&&(a=fn(a)),p=l,s=e.apply(c,o)):a||(a=En(r,h))}return v&&u?u=fn(u):u||t===f||(u=En(i,t)),n&&(v=!0,s=e.apply(c,o)),!v||u||a||(o=c=null),s}}function Kt(e){return e}function qt(e,t,n){var r=!0,i=t&&yt(t);t&&(n||i.length)||(null==n&&(n=t),o=Q,t=e,e=X,i=yt(t)),!1===n?r=!1:bt(n)&&"chain"in n&&(r=n.chain);var o=e,a=Et(o);Mt(i,function(n){var i=e[n]=t[n];a&&(o.prototype[n]=function(){var t=this.__chain__,n=this.__wrapped__,a=[n];if(_n.apply(a,arguments),a=i.apply(e,a),r||t){if(n===a&&bt(a))return this;a=new o(a),a.__chain__=t}return a})})}function zt(){}function Yt(e){return function(t){return t[e]}}function Xt(){return this.__wrapped__}n=n?Y.defaults(q.Object(),n,Y.pick(q,N)):q;var Qt=n.Array,Jt=n.Boolean,Zt=n.Date,en=n.Function,tn=n.Math,nn=n.Number,rn=n.Object,on=n.RegExp,an=n.String,sn=n.TypeError,ln=[],cn=rn.prototype,un=n._,dn=cn.toString,pn=on("^"+an(dn).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),hn=tn.ceil,fn=n.clearTimeout,mn=tn.floor,gn=en.prototype.toString,vn=ht(vn=rn.getPrototypeOf)&&vn,yn=cn.hasOwnProperty,_n=ln.push,En=n.setTimeout,bn=ln.splice,Sn=ln.unshift,In=function(){try{var e={},t=ht(t=rn.defineProperty)&&t,n=t(e,e,e)&&t}catch(r){}return n}(),wn=ht(wn=rn.create)&&wn,Cn=ht(Cn=Qt.isArray)&&Cn,Dn=n.isFinite,Tn=n.isNaN,On=ht(On=rn.keys)&&On,Mn=tn.max,Ln=tn.min,Rn=n.parseInt,Nn=tn.random,xn={};xn[A]=Qt,xn[P]=Jt,xn[k]=Zt,xn[F]=en,xn[j]=rn,xn[U]=nn,xn[$]=on,xn[V]=an,Q.prototype=X.prototype;var An=X.support={};An.funcDecomp=!ht(n.a)&&L.test(p),An.funcNames="string"==typeof en.name,X.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:T,variable:"",imports:{_:X}},wn||(et=function(){function e(){}return function(t){if(bt(t)){e.prototype=t;var r=new e;e.prototype=null}return r||n.Object()}}());var Pn=In?function(e,t){W.value=t,In(e,"__bindData__",W)}:zt,kn=Cn||function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&dn.call(e)==A||!1},Fn=On?function(e){return bt(e)?On(e):[]}:z,Un={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},jn=_t(Un),$n=on("("+Fn(jn).join("|")+")","g"),Vn=on("["+Fn(Un).join("")+"]","g"),Bn=vn?function(e){if(!e||dn.call(e)!=j)return!1;var t=e.valueOf,n=ht(t)&&(n=vn(t))&&vn(n);return n?e==n||vn(e)==n:ft(e)}:ft,Hn=ct(function(e,t,n){yn.call(e,n)?e[n]++:e[n]=1}),Wn=ct(function(e,t,n){(yn.call(e,n)?e[n]:e[n]=[]).push(t)}),Gn=ct(function(e,t,n){e[n]=t}),Kn=Rt,qn=ht(qn=Zt.now)&&qn||function(){return(new Zt).getTime()},zn=8==Rn(E+"08")?Rn:function(e,t){return Rn(It(e)?e.replace(O,""):e,t||0)};return X.after=function(e,t){if(!Et(t))throw new sn;return function(){return 1>--e?t.apply(this,arguments):void 0}},X.assign=K,X.at=function(e){for(var t=arguments,n=-1,r=it(t,!0,!1,1),t=t[2]&&t[2][t[1]]===e?1:r.length,i=Qt(t);++n<t;)i[n]=e[r[n]];return i},X.bind=Wt,X.bindAll=function(e){for(var t=1<arguments.length?it(arguments,!0,!1,1):yt(e),n=-1,r=t.length;++n<r;){var i=t[n];e[i]=ut(e[i],1,null,null,e)}return e},X.bindKey=function(e,t){return 2<arguments.length?ut(t,19,d(arguments,2),null,e):ut(t,3,null,null,e)},X.chain=function(e){return e=new Q(e),e.__chain__=!0,e},X.compact=function(e){for(var t=-1,n=e?e.length:0,r=[];++t<n;){var i=e[t];i&&r.push(i)}return r},X.compose=function(){for(var e=arguments,t=e.length;t--;)if(!Et(e[t]))throw new sn;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}},X.constant=function(e){return function(){return e}},X.countBy=Hn,X.create=function(e,t){var n=et(e);return t?K(n,t):n},X.createCallback=function(e,t,n){var r=typeof e;if(null==e||"function"==r)return tt(e,t,n);if("object"!=r)return Yt(e);var i=Fn(e),o=i[0],a=e[o];return 1!=i.length||a!==a||bt(a)?function(t){for(var n=i.length,r=!1;n--&&(r=ot(t[i[n]],e[i[n]],null,!0)););return r}:function(e){return e=e[o],a===e&&(0!==a||1/a==1/e)}},X.curry=function(e,t){return t="number"==typeof t?t:+t||e.length,ut(e,4,null,null,null,t)},X.debounce=Gt,X.defaults=_,X.defer=function(e){if(!Et(e))throw new sn;var t=d(arguments,1);return En(function(){e.apply(h,t)},1)},X.delay=function(e,t){if(!Et(e))throw new sn;var n=d(arguments,2);return En(function(){e.apply(h,n)},t)},X.difference=function(e){return rt(e,it(arguments,!0,!0,1))},X.filter=Tt,X.flatten=function(e,t,n,r){return"boolean"!=typeof t&&null!=t&&(r=n,n="function"!=typeof t&&r&&r[t]===e?null:t,t=!1),null!=n&&(e=Rt(e,n,r)),it(e,t)},X.forEach=Mt,X.forEachRight=Lt,X.forIn=m,X.forInRight=function(e,t,n){var r=[];m(e,function(e,t){r.push(t,e)});var i=r.length;for(t=tt(t,n,3);i--&&!1!==t(r[i--],r[i],e););return e},X.forOwn=f,X.forOwnRight=vt,X.functions=yt,X.groupBy=Wn,X.indexBy=Gn,X.initial=function(e,t,n){var r=0,i=e?e.length:0;if("number"!=typeof t&&null!=t){var o=i;for(t=X.createCallback(t,n,3);o--&&t(e[o],o,e);)r++}else r=null==t||n?1:t||r;return d(e,0,Ln(Mn(0,i-r),i))},X.intersection=function(){for(var n=[],r=-1,i=arguments.length,a=s(),l=pt(),d=l===e,p=s();++r<i;){var h=arguments[r];(kn(h)||gt(h))&&(n.push(h),a.push(d&&h.length>=y&&o(r?n[r]:p)))}var d=n[0],f=-1,m=d?d.length:0,g=[];e:for(;++f<m;){var v=a[0],h=d[f];if(0>(v?t(v,h):l(p,h))){for(r=i,(v||p).push(h);--r;)if(v=a[r],0>(v?t(v,h):l(n[r],h)))continue e;g.push(h)}}for(;i--;)(v=a[i])&&u(v);return c(a),c(p),g},X.invert=_t,X.invoke=function(e,t){var n=d(arguments,2),r=-1,i="function"==typeof t,o=e?e.length:0,a=Qt("number"==typeof o?o:0);return Mt(e,function(e){a[++r]=(i?t:e[t]).apply(e,n)}),a},X.keys=Fn,X.map=Rt,X.mapValues=function(e,t,n){var r={};return t=X.createCallback(t,n,3),f(e,function(e,n,i){r[n]=t(e,n,i)}),r},X.max=Nt,X.memoize=function(e,t){function n(){var r=n.cache,i=t?t.apply(this,arguments):v+arguments[0];return yn.call(r,i)?r[i]:r[i]=e.apply(this,arguments)}if(!Et(e))throw new sn;return n.cache={},n},X.merge=function(e){var t=arguments,n=2;if(!bt(e))return e;if("number"!=typeof t[2]&&(n=t.length),n>3&&"function"==typeof t[n-2])var r=tt(t[--n-1],t[n--],2);else n>2&&"function"==typeof t[n-1]&&(r=t[--n]);for(var t=d(arguments,1,n),i=-1,o=s(),a=s();++i<n;)at(e,t[i],r,o,a);return c(o),c(a),e},X.min=function(e,t,n){var i=1/0,o=i;if("function"!=typeof t&&n&&n[t]===e&&(t=null),null==t&&kn(e)){n=-1;for(var a=e.length;++n<a;){var s=e[n];o>s&&(o=s)}}else t=null==t&&It(e)?r:X.createCallback(t,n,3),Mt(e,function(e,n,r){n=t(e,n,r),i>n&&(i=n,o=e)});return o},X.omit=function(e,t,n){var r={};if("function"!=typeof t){var i=[];m(e,function(e,t){i.push(t)});for(var i=rt(i,it(arguments,!0,!1,1)),o=-1,a=i.length;++o<a;){var s=i[o];r[s]=e[s]}}else t=X.createCallback(t,n,3),m(e,function(e,n,i){t(e,n,i)||(r[n]=e)});return r},X.once=function(e){var t,n;if(!Et(e))throw new sn;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},X.pairs=function(e){for(var t=-1,n=Fn(e),r=n.length,i=Qt(r);++t<r;){var o=n[t];i[t]=[o,e[o]]}return i},X.partial=function(e){return ut(e,16,d(arguments,1))},X.partialRight=function(e){return ut(e,32,null,d(arguments,1))},X.pick=function(e,t,n){var r={};if("function"!=typeof t)for(var i=-1,o=it(arguments,!0,!1,1),a=bt(e)?o.length:0;++i<a;){var s=o[i];s in e&&(r[s]=e[s])}else t=X.createCallback(t,n,3),m(e,function(e,n,i){t(e,n,i)&&(r[n]=e)});return r},X.pluck=Kn,X.property=Yt,X.pull=function(e){for(var t=arguments,n=0,r=t.length,i=e?e.length:0;++n<r;)for(var o=-1,a=t[n];++o<i;)e[o]===a&&(bn.call(e,o--,1),i--);return e},X.range=function(e,t,n){e=+e||0,n="number"==typeof n?n:+n||1,null==t&&(t=e,e=0);var r=-1;t=Mn(0,hn((t-e)/(n||1)));for(var i=Qt(t);++r<t;)i[r]=e,e+=n;return i},X.reject=function(e,t,n){return t=X.createCallback(t,n,3),Tt(e,function(e,n,r){return!t(e,n,r)})},X.remove=function(e,t,n){var r=-1,i=e?e.length:0,o=[];
for(t=X.createCallback(t,n,3);++r<i;)n=e[r],t(n,r,e)&&(o.push(n),bn.call(e,r--,1),i--);return o},X.rest=jt,X.shuffle=Pt,X.sortBy=function(e,t,n){var r=-1,o=kn(t),a=e?e.length:0,d=Qt("number"==typeof a?a:0);for(o||(t=X.createCallback(t,n,3)),Mt(e,function(e,n,i){var a=d[++r]=l();o?a.m=Rt(t,function(t){return e[t]}):(a.m=s())[0]=t(e,n,i),a.n=r,a.o=e}),a=d.length,d.sort(i);a--;)e=d[a],d[a]=e.o,o||c(e.m),u(e);return d},X.tap=function(e,t){return t(e),e},X.throttle=function(e,t,n){var r=!0,i=!0;if(!Et(e))throw new sn;return!1===n?r=!1:bt(n)&&(r="leading"in n?n.leading:r,i="trailing"in n?n.trailing:i),H.leading=r,H.maxWait=t,H.trailing=i,Gt(e,t,H)},X.times=function(e,t,n){e=-1<(e=+e)?e:0;var r=-1,i=Qt(e);for(t=tt(t,n,1);++r<e;)i[r]=t(r);return i},X.toArray=function(e){return e&&"number"==typeof e.length?d(e):wt(e)},X.transform=function(e,t,n,r){var i=kn(e);if(null==n)if(i)n=[];else{var o=e&&e.constructor;n=et(o&&o.prototype)}return t&&(t=X.createCallback(t,r,4),(i?Mt:f)(e,function(e,r,i){return t(n,e,r,i)})),n},X.union=function(){return lt(it(arguments,!0,!0))},X.uniq=Vt,X.values=wt,X.where=Tt,X.without=function(e){return rt(e,d(arguments,1))},X.wrap=function(e,t){return ut(t,16,[e])},X.xor=function(){for(var e=-1,t=arguments.length;++e<t;){var n=arguments[e];if(kn(n)||gt(n))var r=r?lt(rt(r,n).concat(rt(n,r))):n}return r||[]},X.zip=Bt,X.zipObject=Ht,X.collect=Rt,X.drop=jt,X.each=Mt,X.eachRight=Lt,X.extend=K,X.methods=yt,X.object=Ht,X.select=Tt,X.tail=jt,X.unique=Vt,X.unzip=Bt,qt(X),X.clone=function(e,t,n,r){return"boolean"!=typeof t&&null!=t&&(r=n,n=t,t=!1),Z(e,t,"function"==typeof n&&tt(n,r,1))},X.cloneDeep=function(e,t,n){return Z(e,!0,"function"==typeof t&&tt(t,n,1))},X.contains=Ct,X.escape=function(e){return null==e?"":an(e).replace(Vn,dt)},X.every=Dt,X.find=Ot,X.findIndex=function(e,t,n){var r=-1,i=e?e.length:0;for(t=X.createCallback(t,n,3);++r<i;)if(t(e[r],r,e))return r;return-1},X.findKey=function(e,t,n){var r;return t=X.createCallback(t,n,3),f(e,function(e,n,i){return t(e,n,i)?(r=n,!1):void 0}),r},X.findLast=function(e,t,n){var r;return t=X.createCallback(t,n,3),Lt(e,function(e,n,i){return t(e,n,i)?(r=e,!1):void 0}),r},X.findLastIndex=function(e,t,n){var r=e?e.length:0;for(t=X.createCallback(t,n,3);r--;)if(t(e[r],r,e))return r;return-1},X.findLastKey=function(e,t,n){var r;return t=X.createCallback(t,n,3),vt(e,function(e,n,i){return t(e,n,i)?(r=n,!1):void 0}),r},X.has=function(e,t){return e?yn.call(e,t):!1},X.identity=Kt,X.indexOf=Ut,X.isArguments=gt,X.isArray=kn,X.isBoolean=function(e){return!0===e||!1===e||e&&"object"==typeof e&&dn.call(e)==P||!1},X.isDate=function(e){return e&&"object"==typeof e&&dn.call(e)==k||!1},X.isElement=function(e){return e&&1===e.nodeType||!1},X.isEmpty=function(e){var t=!0;if(!e)return t;var n=dn.call(e),r=e.length;return n==A||n==V||n==x||n==j&&"number"==typeof r&&Et(e.splice)?!r:(f(e,function(){return t=!1}),t)},X.isEqual=function(e,t,n,r){return ot(e,t,"function"==typeof n&&tt(n,r,2))},X.isFinite=function(e){return Dn(e)&&!Tn(parseFloat(e))},X.isFunction=Et,X.isNaN=function(e){return St(e)&&e!=+e},X.isNull=function(e){return null===e},X.isNumber=St,X.isObject=bt,X.isPlainObject=Bn,X.isRegExp=function(e){return e&&"object"==typeof e&&dn.call(e)==$||!1},X.isString=It,X.isUndefined=function(e){return"undefined"==typeof e},X.lastIndexOf=function(e,t,n){var r=e?e.length:0;for("number"==typeof n&&(r=(0>n?Mn(0,r+n):Ln(n,r-1))+1);r--;)if(e[r]===t)return r;return-1},X.mixin=qt,X.noConflict=function(){return n._=un,this},X.noop=zt,X.now=qn,X.parseInt=zn,X.random=function(e,t,n){var r=null==e,i=null==t;return null==n&&("boolean"==typeof e&&i?(n=e,e=1):i||"boolean"!=typeof t||(n=t,i=!0)),r&&i&&(t=1),e=+e||0,i?(t=e,e=0):t=+t||0,n||e%1||t%1?(n=Nn(),Ln(e+n*(t-e+parseFloat("1e-"+((n+"").length-1))),t)):st(e,t)},X.reduce=xt,X.reduceRight=At,X.result=function(e,t){if(e){var n=e[t];return Et(n)?e[t]():n}},X.runInContext=p,X.size=function(e){var t=e?e.length:0;return"number"==typeof t?t:Fn(e).length},X.some=kt,X.sortedIndex=$t,X.template=function(e,t,n){var r=X.templateSettings;e=an(e||""),n=_({},n,r);var i,o=_({},n.imports,r.imports),r=Fn(o),o=wt(o),s=0,l=n.interpolate||M,c="__p+='",l=on((n.escape||M).source+"|"+l.source+"|"+(l===T?w:M).source+"|"+(n.evaluate||M).source+"|$","g");e.replace(l,function(t,n,r,o,l,u){return r||(r=o),c+=e.slice(s,u).replace(R,a),n&&(c+="'+__e("+n+")+'"),l&&(i=!0,c+="';"+l+";\n__p+='"),r&&(c+="'+((__t=("+r+"))==null?'':__t)+'"),s=u+t.length,t}),c+="';",l=n=n.variable,l||(n="obj",c="with("+n+"){"+c+"}"),c=(i?c.replace(b,""):c).replace(S,"$1").replace(I,"$1;"),c="function("+n+"){"+(l?"":n+"||("+n+"={});")+"var __t,__p='',__e=_.escape"+(i?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+c+"return __p}";try{var u=en(r,"return "+c).apply(h,o)}catch(d){throw d.source=c,d}return t?u(t):(u.source=c,u)},X.unescape=function(e){return null==e?"":an(e).replace($n,mt)},X.uniqueId=function(e){var t=++g;return an(null==e?"":e)+t},X.all=Dt,X.any=kt,X.detect=Ot,X.findWhere=Ot,X.foldl=xt,X.foldr=At,X.include=Ct,X.inject=xt,qt(function(){var e={};return f(X,function(t,n){X.prototype[n]||(e[n]=t)}),e}(),!1),X.first=Ft,X.last=function(e,t,n){var r=0,i=e?e.length:0;if("number"!=typeof t&&null!=t){var o=i;for(t=X.createCallback(t,n,3);o--&&t(e[o],o,e);)r++}else if(r=t,null==r||n)return e?e[i-1]:h;return d(e,Mn(0,i-r))},X.sample=function(e,t,n){return e&&"number"!=typeof e.length&&(e=wt(e)),null==t||n?e?e[st(0,e.length-1)]:h:(e=Pt(e),e.length=Ln(Mn(0,t),e.length),e)},X.take=Ft,X.head=Ft,f(X,function(e,t){var n="sample"!==t;X.prototype[t]||(X.prototype[t]=function(t,r){var i=this.__chain__,o=e(this.__wrapped__,t,r);return i||null!=t&&(!r||n&&"function"==typeof t)?new Q(o,i):o})}),X.VERSION="2.4.1",X.prototype.chain=function(){return this.__chain__=!0,this},X.prototype.toString=function(){return an(this.__wrapped__)},X.prototype.value=Xt,X.prototype.valueOf=Xt,Mt(["join","pop","shift"],function(e){var t=ln[e];X.prototype[e]=function(){var e=this.__chain__,n=t.apply(this.__wrapped__,arguments);return e?new Q(n,e):n}}),Mt(["push","reverse","sort","unshift"],function(e){var t=ln[e];X.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),Mt(["concat","slice","splice"],function(e){var t=ln[e];X.prototype[e]=function(){return new Q(t.apply(this.__wrapped__,arguments),this.__chain__)}}),X}var h,f=[],m=[],g=0,v=+new Date+"",y=75,_=40,E=" 	\f \n\r\u2028\u2029 ᠎             　",b=/\b__p\+='';/g,S=/\b(__p\+=)''\+/g,I=/(__e\(.*?\)|\b__t\))\+'';/g,w=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,C=/\w*$/,D=/^\s*function[ \n\r\t]+\w/,T=/<%=([\s\S]+?)%>/g,O=RegExp("^["+E+"]*0+(?=.$)"),M=/($^)/,L=/\bthis\b/,R=/['\n\r\t\u2028\u2029\\]/g,N="Array Boolean Date Function Math Number Object RegExp String _ attachEvent clearTimeout isFinite isNaN parseInt setTimeout".split(" "),x="[object Arguments]",A="[object Array]",P="[object Boolean]",k="[object Date]",F="[object Function]",U="[object Number]",j="[object Object]",$="[object RegExp]",V="[object String]",B={};B[F]=!1,B[x]=B[A]=B[P]=B[k]=B[U]=B[j]=B[$]=B[V]=!0;var H={leading:!1,maxWait:0,trailing:!1},W={configurable:!1,enumerable:!1,value:null,writable:!1},G={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},K={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},q=G[typeof window]&&window||this,z=G[typeof global]&&global;!z||z.global!==z&&z.window!==z||(q=z);var Y=p();"function"==typeof define&&"object"==typeof define.amd&&define.amd&&define("thirdparty/lodash",[],function(){return Y})}.call(this),define("utils/EventDispatcher",["require","exports","module","thirdparty/lodash"],function(e,t){"use strict";function n(e){var t=e.indexOf(".");return-1===t?{eventName:e}:{eventName:e.substring(0,t),ns:e.substring(t)}}function r(e){$.extend(e,{on:l,off:c,one:u,trigger:d,_EventDispatcher:!0})}function i(e,t,n){var r=[t].concat(n);e.trigger.apply(e,r)}function o(e,t,n){l.call(e,t,n)}function a(e,t,n){e._deprecatedEvents||(e._deprecatedEvents={}),e._deprecatedEvents[t]=n||!0}var s=e("thirdparty/lodash"),l=function(e,t){var r,i=e.split(/\s+/).map(n);if(this._deprecatedEvents)for(r=0;r<i.length;r++){var o=this._deprecatedEvents[i[r].eventName];if(o){var a="Registering for deprecated event '"+i[r].eventName+"'.";"string"==typeof o&&(a+=" Instead, use "+o+"."),console.warn(a,(new Error).stack)}}for(r=0;r<i.length;r++){var s=i[r].eventName;this._eventHandlers||(this._eventHandlers={}),this._eventHandlers[s]||(this._eventHandlers[s]=[]),i[r].handler=t,this._eventHandlers[s].push(i[r])}return this},c=function(e,t){if(!this._eventHandlers)return this;var r,i=e.split(/\s+/).map(n),o=function(e,n){var r,i=this._eventHandlers[n];if(i){for(r=i.length-1;r>=0;r--)if(!e.ns||e.ns===i[r].ns){var o=i[r].handler;t&&t!==o&&t._eventOnceWrapper!==o||i.splice(r,1)}i.length||delete this._eventHandlers[n]}}.bind(this),a=function(e){e.eventName?o(e,e.eventName):s.forEach(this._eventHandlers,function(t,n){o(e,n)})}.bind(this);for(r=0;r<i.length;r++)a(i[r]);return this},u=function(e,t){return t._eventOnceWrapper||(t._eventOnceWrapper=function(e){e.target.off(e.type,t._eventOnceWrapper),t.apply(this,arguments)}),this.on(e,t._eventOnceWrapper)},d=function(e){var t,n={type:e,target:this},r=this._eventHandlers&&this._eventHandlers[e];if(r){r=r.slice();var i=Array.prototype.slice.call(arguments,1);for(i.unshift(n),t=0;t<r.length;t++)try{r[t].handler.apply(null,i)}catch(o){console.error("Exception in '"+e+"' listener on",this,String(o),o.stack),console.assert()}}};t.makeEventDispatcher=r,t.triggerWithArray=i,t.on_duringInit=o,t.markDeprecated=a}),define("utils/Async",["require","exports","module"],function(e,t){"use strict";function n(e,t,n){var r=[],i=new $.Deferred;if(0===e.length)i.resolve();else{var o=0,a=!1;e.forEach(function(s,l){var c=t(s,l);r.push(c),c.fail(function(){n?i.reject():a=!0}),c.always(function(){o++,o===e.length&&(a?i.reject():i.resolve())})})}return i.promise()}function r(e,t,n){function r(a){if(a>=e.length)return void(o?i.reject():i.resolve());var s=t(e[a],a);s.done(function(){r(a+1)}),s.fail(function(){n?i.reject():(o=!0,r(a+1))})}var i=new $.Deferred,o=!1;return r(0),i.promise()}function i(e,t,n,i){n=n||15,i=i||30;var o=(new Date).getTime();return r(e,function(e,r){var a=new $.Deferred;return t(e,r),(new Date).getTime()-o>=n?window.setTimeout(function(){o=(new Date).getTime(),a.resolve()},i):a.resolve(),a},!1)}function o(e,t){function n(i){return i>=e.length?void r.reject():void t(e[i],i).fail(function(){n(i+1)}).done(function(){r.resolve(e[i])})}var r=new $.Deferred;return n(0),r.promise()}function a(e,t){var r=[],i=new $.Deferred,o=n(e,function(e,n){var i=t(e,n);return i.fail(function(t){r.push({item:e,error:t})}),i},!1);return o.done(function(){i.resolve()}).fail(function(){i.reject(r)}),i.promise()}function s(e,t,n){var r=new $.Deferred,i=window.setTimeout(function(){n?r.resolve():r.reject(p)},t);return e.always(function(){window.clearTimeout(i)}),e.then(r.resolve,r.reject),r.promise()}function l(e,t,n){var r=new $.Deferred,i=[],o=0,a=!1;return e&&0!==e.length?(t=void 0===t?!1:!0,void 0!==n&&s(r,n),e.forEach(function(n){n.fail(function(){a=!0}).done(function(e){i.push(e)}).always(function(){o++,o===e.length&&(t&&a?r.reject():r.resolve(i))})}),r.promise()):(r.resolve(),r.promise())}function c(e,t){function n(t,i){if(e.length===t)r.resolveWith(null,i);else{var o=e[t++];try{var a=o.apply(null,i);a.hasOwnProperty("done")&&a.hasOwnProperty("fail")?(a.done(function(){n(t,arguments)}),a.fail(function(){r.rejectWith(null,arguments)})):n(t,[a])}catch(s){r.reject(s)}}}var r=$.Deferred();return n(0,t||[]),r.promise()}function u(e,t){var n=new $.Deferred,r=Array.prototype.slice.call(arguments,2);return r.push(function(e){e?n.reject(e):n.resolve.apply(n,Array.prototype.slice.call(arguments,1))}),e[t].apply(e,r),n.promise()}function d(){this._queue=[]}var p={};d.prototype._queue=null,d.prototype._curPromise=null,Object.defineProperties(d.prototype,{length:{get:function(){return this._queue.length},set:function(){throw new Error("Cannot set length")}}}),d.prototype.add=function(e){this._queue.push(e),this._curPromise||this._doNext()},d.prototype.removeAll=function(){this._queue=[]},d.prototype._doNext=function(){var e=this;if(this._queue.length){var t=this._queue.shift();this._curPromise=t(),this._curPromise.always(function(){e._curPromise=null,e._doNext()})}},t.doInParallel=n,t.doSequentially=r,t.doSequentiallyInBackground=i,t.doInParallel_aggregateErrors=a,t.firstSequentially=o,t.withTimeout=s,t.waitForAll=l,t.ERROR_TIMEOUT=p,t.chain=c,t.promisify=u,t.PromiseQueue=d}),define("utils/UrlParams",["require","exports","module","thirdparty/lodash"],function(e,t){"use strict";function n(){this._store={}}var r=e("thirdparty/lodash");n.prototype.parse=function(e){var t,n,r="",i=this;i._store={},e?-1!==e.indexOf("?")&&(r=e.substring(e.indexOf("?")+1)):r=window.document.location.search.substring(1),r=r.trimRight(),r&&(t=r.split("&"),t.forEach(function(e){n=e.split("="),n[1]=n[1]||"",i._store[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}))},n.prototype.put=function(e,t){this._store[e]=t},n.prototype.get=function(e){return this._store[e]},n.prototype.remove=function(e){delete this._store[e]},n.prototype.isEmpty=function(){return r.isEmpty(this._store)},n.prototype.toString=function(){var e=[],t=this;return r.forEach(t._store,function(t,n){e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))}),e.join("&")},t.UrlParams=n}),define("command/CommandManager",["require","exports","module","utils/EventDispatcher"],function(e,t){"use strict";function n(e,t,n){this._name=e,this._id=t,this._commandFn=n,this._checked=void 0,this._enabled=!0}function r(e,r,i){if(d[r])return console.log("Attempting to register an already-registered command: "+r),null;if(!e||!r||!i)return console.error("Attempting to register a command with a missing name, id, or command function:"+e+" "+r),null;var o=new n(e,r,i);return d[r]=o,t.trigger("commandRegistered",o),o}function i(e,r){if(d[e])return console.log("Attempting to register an already-registered command: "+e),null;if(!e||!r)return console.error("Attempting to register an internal command with a missing id, or command function: "+e),null;var i=new n(null,e,r);return d[e]=i,t.trigger("commandRegistered",i),i}function o(){p=d,d={}}function a(){d=p,p={}}function s(e){return d[e]}function l(){return Object.keys(d)}function c(e){var n=d[e];if(n){try{t.trigger("beforeExecuteCommand",e)}catch(r){console.error(r)}return n.execute.apply(n,Array.prototype.slice.call(arguments,1))}return(new $.Deferred).reject().promise()}var u=e("utils/EventDispatcher"),d={},p={};u.makeEventDispatcher(n.prototype),n.prototype.getID=function(){return this._id},n.prototype.execute=function(){if(!this._enabled)return(new $.Deferred).reject().promise();var e=this._commandFn.apply(this,arguments);return e?e:(new $.Deferred).resolve().promise()},n.prototype.getEnabled=function(){return this._enabled},n.prototype.setEnabled=function(e){var t=this._enabled!==e;this._enabled=e,t&&this.trigger("enabledStateChange")},n.prototype.setChecked=function(e){var t=this._checked!==e;this._checked=e,t&&this.trigger("checkedStateChange")},n.prototype.getChecked=function(){return this._checked},n.prototype.setName=function(e){var t=this._name!==e;this._name=e,t&&this.trigger("nameChange")},n.prototype.getName=function(){return this._name},u.makeEventDispatcher(t),t.register=r,t.registerInternal=i,t.execute=c,t.get=s,t.getAll=l,t._testReset=o,t._testRestore=a}),define("utils/DeprecationWarning",["require","exports","module","utils/EventDispatcher"],function(e,t){"use strict";function n(e){var t;return e=e.substr(e.indexOf(")\n")+2),t=e.indexOf("requirejs/require.js"),-1!==t&&(t=e.lastIndexOf(")",t)+1,e=e.substr(0,t)),e}function r(e,t,r){if(e&&(t||!s[e])){var i=(new Error).stack,o=i.split("\n")[r||3];t&&s[e]&&s[e][o]||(console.warn(e+"\n"+n(i)),s[e]||(s[e]={}),s[e][o]=!0)}}function i(e,t,n,r,i,o){a.markDeprecated(e,n,o),t.on(r,function(){a.triggerWithArray(e,n,Array.prototype.slice.call(arguments,1))})}function o(e,t,n){var i="Use Menus."+n+" instead of Menus."+t,o=e[n];Object.defineProperty(e,t,{get:function(){return r(i,!0),o}})}var a=e("utils/EventDispatcher"),s={};t.deprecationWarning=r,t.deprecateEvent=i,t.deprecateConstant=o}),define("command/Commands",["require","exports","module","utils/DeprecationWarning"],function(e,t){"use strict";var n=e("utils/DeprecationWarning");t.FILE_NEW_UNTITLED="file.newDoc",t.FILE_NEW="file.newFile",t.FILE_NEW_FOLDER="file.newFolder",t.FILE_OPEN="file.open",t.FILE_OPEN_FOLDER="file.openFolder",t.FILE_SAVE="file.save",t.FILE_SAVE_ALL="file.saveAll",t.FILE_SAVE_AS="file.saveAs",t.FILE_CLOSE="file.close",t.FILE_CLOSE_ALL="file.close_all",t.FILE_CLOSE_LIST="file.close_list",t.FILE_OPEN_DROPPED_FILES="file.openDroppedFiles",t.FILE_LIVE_FILE_PREVIEW="file.liveFilePreview",t.TOGGLE_LIVE_PREVIEW_MB_MODE="file.toggleLivePreviewMB",t.CMD_RELOAD_LIVE_PREVIEW="file.reloadLivePreview",t.FILE_LIVE_HIGHLIGHT="file.previewHighlight",t.FILE_PROJECT_SETTINGS="file.projectSettings",t.FILE_RENAME="file.rename",t.FILE_DELETE="file.delete",t.FILE_EXTENSION_MANAGER="file.extensionManager",t.FILE_REFRESH="file.refresh",t.FILE_OPEN_PREFERENCES="file.openPreferences",t.FILE_OPEN_KEYMAP="file.openKeyMap",t.FILE_CLOSE_WINDOW="file.close_window",t.FILE_QUIT="file.quit",t.EDIT_UNDO="edit.undo",t.EDIT_REDO="edit.redo",t.EDIT_CUT="edit.cut",t.EDIT_COPY="edit.copy",t.EDIT_PASTE="edit.paste",t.EDIT_SELECT_ALL="edit.selectAll",t.EDIT_SELECT_LINE="edit.selectLine",t.EDIT_SPLIT_SEL_INTO_LINES="edit.splitSelIntoLines",t.EDIT_ADD_CUR_TO_NEXT_LINE="edit.addCursorToNextLine",t.EDIT_ADD_CUR_TO_PREV_LINE="edit.addCursorToPrevLine",t.EDIT_INDENT="edit.indent",t.EDIT_UNINDENT="edit.unindent",t.EDIT_DUPLICATE="edit.duplicate",t.EDIT_DELETE_LINES="edit.deletelines",t.EDIT_LINE_COMMENT="edit.lineComment",t.EDIT_BLOCK_COMMENT="edit.blockComment",t.EDIT_LINE_UP="edit.lineUp",t.EDIT_LINE_DOWN="edit.lineDown",t.EDIT_OPEN_LINE_ABOVE="edit.openLineAbove",t.EDIT_OPEN_LINE_BELOW="edit.openLineBelow",t.TOGGLE_CLOSE_BRACKETS="edit.autoCloseBrackets",t.SHOW_CODE_HINTS="edit.showCodeHints",t.CMD_FIND="cmd.find",t.CMD_FIND_IN_FILES="cmd.findInFiles",t.CMD_FIND_IN_SELECTED="cmd.findInSelected",t.CMD_FIND_IN_SUBTREE="cmd.findInSubtree",t.CMD_FIND_NEXT="cmd.findNext",t.CMD_FIND_PREVIOUS="cmd.findPrevious",t.CMD_FIND_ALL_AND_SELECT="cmd.findAllAndSelect",t.CMD_ADD_NEXT_MATCH="cmd.addNextMatch",t.CMD_SKIP_CURRENT_MATCH="cmd.skipCurrentMatch",t.CMD_REPLACE="cmd.replace",t.CMD_REPLACE_IN_FILES="cmd.replaceInFiles",t.CMD_REPLACE_IN_SELECTED="cmd.replaceInSelected",t.CMD_REPLACE_IN_SUBTREE="cmd.replaceInSubtree",t.CMD_THEMES_OPEN_SETTINGS="view.themesOpenSetting",t.VIEW_HIDE_SIDEBAR="view.hideSidebar",t.VIEW_INCREASE_FONT_SIZE="view.increaseFontSize",t.VIEW_DECREASE_FONT_SIZE="view.decreaseFontSize",t.VIEW_RESTORE_FONT_SIZE="view.restoreFontSize",t.VIEW_SCROLL_LINE_UP="view.scrollLineUp",t.VIEW_SCROLL_LINE_DOWN="view.scrollLineDown",t.VIEW_TOGGLE_INSPECTION="view.toggleCodeInspection",t.TOGGLE_LINE_NUMBERS="view.toggleLineNumbers",t.TOGGLE_ACTIVE_LINE="view.toggleActiveLine",t.TOGGLE_WORD_WRAP="view.toggleWordWrap",t.CMD_OPEN="cmd.open",t.CMD_ADD_TO_WORKINGSET_AND_OPEN="cmd.addToWorkingSetAndOpen",t.NAVIGATE_NEXT_DOC="navigate.nextDoc",t.NAVIGATE_PREV_DOC="navigate.prevDoc",t.NAVIGATE_SHOW_IN_FILE_TREE="navigate.showInFileTree",t.NAVIGATE_SHOW_IN_OS="navigate.showInOS",t.NAVIGATE_QUICK_OPEN="navigate.quickOpen",t.NAVIGATE_JUMPTO_DEFINITION="navigate.jumptoDefinition",t.NAVIGATE_GOTO_DEFINITION="navigate.gotoDefinition",t.NAVIGATE_GOTO_LINE="navigate.gotoLine",t.NAVIGATE_GOTO_FIRST_PROBLEM="navigate.gotoFirstProblem",t.TOGGLE_QUICK_EDIT="navigate.toggleQuickEdit",t.TOGGLE_QUICK_DOCS="navigate.toggleQuickDocs",t.QUICK_EDIT_NEXT_MATCH="navigate.nextMatch",t.QUICK_EDIT_PREV_MATCH="navigate.previousMatch",t.CSS_QUICK_EDIT_NEW_RULE="navigate.newRule",t.HELP_CHECK_FOR_UPDATE="help.checkForUpdate",t.HELP_HOW_TO_USE_BRACKETS="help.howToUseBrackets",t.HELP_SUPPORT="help.support",t.HELP_SUGGEST="help.suggest",t.HELP_RELEASE_NOTES="help.releaseNotes",t.HELP_GET_INVOLVED="help.getInvolved",t.HELP_SHOW_EXT_FOLDER="help.showExtensionsFolder",t.HELP_HOMEPAGE="help.homepage",t.HELP_TWITTER="help.twitter",t.CMD_WORKINGSET_SORT_BY_ADDED="cmd.sortWorkingSetByAdded",t.CMD_WORKINGSET_SORT_BY_NAME="cmd.sortWorkingSetByName",t.CMD_WORKINGSET_SORT_BY_TYPE="cmd.sortWorkingSetByType",t.CMD_WORKING_SORT_TOGGLE_AUTO="cmd.sortWorkingSetToggleAuto",t.CMD_SPLITVIEW_NONE="cmd.splitViewNone",t.CMD_SPLITVIEW_VERTICAL="cmd.splitViewVertical",t.CMD_SPLITVIEW_HORIZONTAL="cmd.splitViewHorizontal",t.HELP_ABOUT="help.about",t.APP_RELOAD="app.reload",t.APP_RELOAD_WITHOUT_EXTS="app.reload_without_exts",t.APP_ABORT_QUIT="app.abort_quit",t.APP_BEFORE_MENUPOPUP="app.before_menupopup",t.FILE_ADD_TO_WORKING_SET="file.addToWorkingSet",n.deprecateConstant(t,"SORT_WORKINGSET_BY_ADDED","CMD_WORKINGSET_SORT_BY_ADDED"),n.deprecateConstant(t,"SORT_WORKINGSET_BY_NAME","CMD_WORKINGSET_SORT_BY_NAME"),n.deprecateConstant(t,"SORT_WORKINGSET_BY_TYPE","CMD_WORKINGSET_SORT_BY_TYPE"),n.deprecateConstant(t,"SORT_WORKINGSET_AUTO","CMD_WORKING_SORT_TOGGLE_AUTO")}),define("utils/ShellAPI",["require","exports","module","utils/AppInit","command/CommandManager","command/Commands"],function(e,t){"use strict";function n(e){if($(".modal.instance").length||!a)return window.isBracketsTestWindow?!1:e===o.FILE_CLOSE_WINDOW;var t,n=Error,r=new n,s=r.stack.split("\n").length;return 3>s?t=i.execute(e):console.error("Skipping command "+e+" because it looks like you are at a breakpoint. If you are NOT at a breakpoint, please file a bug and mention this comment. Stack depth = "+s+"."),t&&"rejected"===t.state()?!1:!0}var r=e("utils/AppInit"),i=e("command/CommandManager"),o=e("command/Commands"),a=!1;r.appReady(function(){a=!0}),t.executeCommand=n}),define("utils/Global",["require","exports","module","text!config.json","utils/UrlParams","utils/ShellAPI"],function(e,t){"use strict";var n=e("text!config.json"),r=e("utils/UrlParams").UrlParams,i=Function,o=new i("return this")();o.brackets||(o.brackets={});var a=new r;a.parse();try{o.brackets.metadata=JSON.parse(n),o.brackets.config=o.brackets.metadata.config}catch(s){console.log(s)}o.brackets.shellAPI=e("utils/ShellAPI"),o.brackets.platform="MacIntel"===o.navigator.platform||"MacPPC"===o.navigator.platform?"mac":o.navigator.platform.indexOf("Linux")>=0?"linux":"win",o.brackets.inBrowser=!o.brackets.hasOwnProperty("fs");var l=a.get("hasNativeMenus");o.brackets.nativeMenus=l?"true"===l:!o.brackets.inBrowser&&"linux"!==o.brackets.platform,o.brackets.isLocaleDefault=function(){return!o.localStorage.getItem("locale")},o.brackets.getLocale=function(){return a.get("testEnvironment")?"en":o.localStorage.getItem("locale")||o.require.s.contexts._.config.locale},o.brackets.setLocale=function(e){e?o.localStorage.setItem("locale",e):o.localStorage.removeItem("locale")},o.brackets.app||(o.brackets.app={}),o.brackets.libRequire=o.require,o.brackets.getModule=e,t.global=o}),define("filesystem/FileSystemError",["require","exports","module"],function(e,t,n){"use strict";n.exports={UNKNOWN:"Unknown",INVALID_PARAMS:"InvalidParams",NOT_FOUND:"NotFound",NOT_READABLE:"NotReadable",UNSUPPORTED_ENCODING:"UnsupportedEncoding",NOT_SUPPORTED:"NotSupported",NOT_WRITABLE:"NotWritable",OUT_OF_SPACE:"OutOfSpace",TOO_MANY_ENTRIES:"TooManyEntries",ALREADY_EXISTS:"AlreadyExists",CONTENTS_MODIFIED:"ContentsModified",ROOT_NOT_WATCHED:"RootNotBeingWatched",EXCEEDS_MAX_FILE_SIZE:"ExceedsMaxFileSize"}}),define("utils/PerfUtils",["require","exports","module","thirdparty/lodash","utils/Global"],function(e,t){"use strict";function n(e,t,n){this.name=t,this.reent=n,this.id=e?e:n?"[reent "+this.reent+"] "+t:t}function r(e,r){var i=new n(e,r);return t[e]=i,i}function i(e){var t,r=Array.isArray(e)?e:[e];for(t=0;t<r.length;t++)r[t]instanceof n||(void 0===E[r[t]]?E[r[t]]=0:E[r[t]]++,r[t]=new n(void 0,r[t],E[r[t]]));return r}function o(e,t){y[e.id]&&console.error("Recursive tests with the same id are not supported. Timer id: "+e.id),y[e.id]={startTime:t}}function a(e){if(g){var t,n=brackets.app.getElapsedMilliseconds(),r=i(e);for(t=0;t<r.length;t++)o(r[t],n);return r.length>1?r:r[0]}}function s(e){if(g){e instanceof n||(e=new n(e,e));var t=brackets.app.getElapsedMilliseconds();y[e.id]&&(t-=y[e.id].startTime,delete y[e.id]),v[e]?Array.isArray(v[e])?v[e].push(t):v[e]=[v[e],t]:v[e]=t,void 0!==e.reent&&(0===E[e]?delete E[e]:E[e]--)}}function l(e){var t=brackets.app.getElapsedMilliseconds();_[e.id]?(t-=_[e].startTime,v[e]&&Array.isArray(v[e])?v[e][v[e].length-1]=t:v[e]=t):(y[e.id]&&(_[e.id]={startTime:y[e.id].startTime}),s(e))}function c(e){y[e.id]&&delete y[e.id],_[e.id]&&delete _[e.id]}function u(e){return y[e.id]?!0:!1}function d(){var e=function(e){if(Array.isArray(e)){var t,n="";for(t=0;t<e.length;t++)n+=e[t],t<e.length-1&&(n+=", ");return n}return e},t="";return m.forEach(v,function(n,r){t+=e(n)+"	"+r+"\n"}),t}function p(e){return e?v[e]:v}function h(e){var t=Object.keys(v).filter(function(t){return e.test(t)}),n=[];return t.forEach(function(e){n.push(v[e])}),n}function f(){v={},y={},_={},E={}}var m=e("thirdparty/lodash");e("utils/Global");var g=brackets&&!!brackets.app.getElapsedMilliseconds,v={},y={},_={},E={};n.prototype.toString=function(){return this.name},r("INLINE_WIDGET_OPEN","Open inline editor or docs"),r("INLINE_WIDGET_CLOSE","Close inline editor or docs"),t.addMeasurement=s,t.finalizeMeasurement=c,t.isActive=u,t.markStart=a,t.getData=p,t.searchData=h,t.updateMeasurement=l,t.getDelimitedPerfData=d,t.createPerfMeasurement=r,t.clear=f}),function(){"use strict";function e(e,t,n,r,i,o){t[e]&&(n.push(e),(t[e]===!0||1===t[e])&&r.push(i+e+"/"+o))}function t(e,t,n,r,i){var o=r+t+"/"+i;require._fileExists(e.toUrl(o+".js"))&&n.push(o)}function n(e,t,r){var i;for(i in t)!t.hasOwnProperty(i)||e.hasOwnProperty(i)&&!r?"object"==typeof t[i]&&n(e[i],t[i],r):e[i]=t[i]}var r=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(i){var o=i.config?i.config():{};return{version:"2.0.1+",load:function(i,a,s,l){l=l||{},l.locale&&(o.locale=l.locale);var c,u,d,p=r.exec(i),h=p[1],f=p[4],m=p[5],g=f.split("-"),v=[],y={},_="";if(p[5]?(h=p[1],c=h+m):(c=i,m=p[4],f=o.locale,f||(f=o.locale="undefined"==typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),g=f.split("-")),l.isBuild){for(v.push(c),t(a,"root",v,h,m),u=0;u<g.length;u++)d=g[u],_+=(_?"-":"")+d,t(a,_,v,h,m);a(v,function(){s()})}else a([c],function(t){var r,i=[];for(e("root",t,i,v,h,m),u=0;u<g.length;u++)r=g[u],_+=(_?"-":"")+r,e(_,t,i,v,h,m);a(v,function(){var e,r,o;for(e=i.length-1;e>-1&&i[e];e--)o=i[e],r=t[o],(r===!0||1===r)&&(r=a(h+o+"/"+m)),n(y,r);s(y)})})}}})}(),define("nls/strings",["require","exports","module"],function(e,t,n){"use strict";n.exports={root:!0,cs:!0,da:!0,de:!0,el:!0,"en-gb":!0,es:!0,"fa-ir":!0,fi:!0,fr:!0,gl:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,nb:!0,nl:!0,pl:!0,"pt-br":!0,"pt-pt":!0,ro:!0,ru:!0,sk:!0,sr:!0,sv:!0,tr:!0,uk:!0,"zh-cn":!0,"zh-tw":!0}}),define("nls/root/strings",{GENERIC_ERROR:"(error {0})",NOT_FOUND_ERR:"The file/directory could not be found.",NOT_READABLE_ERR:"The file/directory could not be read.",EXCEEDS_MAX_FILE_SIZE:"Files larger than {0} MB cannot be opened in {APP_NAME}.",NO_MODIFICATION_ALLOWED_ERR:"The target directory cannot be modified.",NO_MODIFICATION_ALLOWED_ERR_FILE:"The permissions do not allow you to make modifications.",CONTENTS_MODIFIED_ERR:"The file has been modified outside of {APP_NAME}.",UNSUPPORTED_ENCODING_ERR:"{APP_NAME} currently only supports UTF-8 encoded text files.",FILE_EXISTS_ERR:"The file or directory already exists.",FILE:"file",FILE_TITLE:"File",DIRECTORY:"directory",DIRECTORY_TITLE:"Directory",DIRECTORY_NAMES_LEDE:"Directory names",FILENAMES_LEDE:"Filenames",FILENAME:"Filename",DIRECTORY_NAME:"Directory Name",ERROR_LOADING_PROJECT:"Error Loading Project",OPEN_DIALOG_ERROR:"An error occurred when showing the open file dialog. (error {0})",REQUEST_NATIVE_FILE_SYSTEM_ERROR:"An error occurred when trying to load the directory <span class='dialog-filename'>{0}</span>. (error {1})",READ_DIRECTORY_ENTRIES_ERROR:"An error occurred when reading the contents of the directory <span class='dialog-filename'>{0}</span>. (error {1})",ERROR_OPENING_FILE_TITLE:"Error Opening File",ERROR_OPENING_FILE:"An error occurred when trying to open the file <span class='dialog-filename'>{0}</span>. {1}",ERROR_OPENING_FILES:"An error occurred when trying to open the following files:",ERROR_RELOADING_FILE_TITLE:"Error Reloading Changes From Disk",ERROR_RELOADING_FILE:"An error occurred when trying to reload the file <span class='dialog-filename'>{0}</span>. {1}",ERROR_SAVING_FILE_TITLE:"Error Saving File",ERROR_SAVING_FILE:"An error occurred when trying to save the file <span class='dialog-filename'>{0}</span>. {1}",ERROR_RENAMING_FILE_TITLE:"Error Renaming {0}",ERROR_RENAMING_FILE:"An error occurred when trying to rename the {2} <span class='dialog-filename'>{0}</span>. {1}",ERROR_DELETING_FILE_TITLE:"Error Deleting {0}",ERROR_DELETING_FILE:"An error occurred when trying to delete the {2} <span class='dialog-filename'>{0}</span>. {1}",INVALID_FILENAME_TITLE:"Invalid {0}",INVALID_FILENAME_MESSAGE:"{0} cannot use any system reserved words, end with dots (.) or use any of the following characters: <code class='emphasized'>{1}</code>",ENTRY_WITH_SAME_NAME_EXISTS:"A file or directory with the name <span class='dialog-filename'>{0}</span> already exists.",ERROR_CREATING_FILE_TITLE:"Error Creating {0}",ERROR_CREATING_FILE:"An error occurred when trying to create the {0} <span class='dialog-filename'>{1}</span>. {2}",ERROR_MIXED_DRAGDROP:"Cannot open a folder at the same time as opening other files.",ERROR_KEYMAP_TITLE:"Error Reading User Key Map",ERROR_KEYMAP_CORRUPT:"Your key map file is not valid JSON. The file will be opened so that you can correct the format.",ERROR_LOADING_KEYMAP:"Your key map file is not a valid UTF-8 encoded text file and cannot be loaded",ERROR_RESTRICTED_COMMANDS:"You cannot reassign shortcuts to these commands: {0}",ERROR_RESTRICTED_SHORTCUTS:"You cannot reassign these shortcuts: {0}",ERROR_MULTIPLE_SHORTCUTS:"You are reassigning multiple shortcuts to these commands: {0}",ERROR_DUPLICATE_SHORTCUTS:"You have multiple bindings of these shortcuts: {0}",ERROR_INVALID_SHORTCUTS:"These shortcuts are invalid: {0}",ERROR_NONEXISTENT_COMMANDS:"You are assigning shortcuts to nonexistent commands: {0}",ERROR_PREFS_CORRUPT_TITLE:"Error Reading Preferences",ERROR_PREFS_CORRUPT:"Your preferences file is not valid JSON. The file will be opened so that you can correct the format. You will need to restart {APP_NAME} for the changes to take effect.",ERROR_IN_BROWSER_TITLE:"Oops! {APP_NAME} Doesn't Run in Browsers Yet.",ERROR_IN_BROWSER:"{APP_NAME} is built in HTML, but right now it runs as a desktop app so you can use it to edit local files. Please use the application shell in the <b>github.com/adobe/brackets-shell</b> repo to run {APP_NAME}.",ERROR_MAX_FILES_TITLE:"Error Indexing Files",ERROR_MAX_FILES:"This project contains more than 30,000 files. Features that operate across multiple files may be disabled or behave as if the project is empty. <a href='https://github.com/adobe/brackets/wiki/Large-Projects'>Read more about working with large projects</a>.",ERROR_LAUNCHING_BROWSER_TITLE:"Error Launching Browser",ERROR_CANT_FIND_CHROME:"The Google Chrome browser could not be found. Please make sure it is installed.",ERROR_LAUNCHING_BROWSER:"An error occurred when launching the browser. (error {0})",LIVE_DEVELOPMENT_ERROR_TITLE:"Live Preview Error",LIVE_DEVELOPMENT_RELAUNCH_TITLE:"Connecting to Browser",LIVE_DEVELOPMENT_ERROR_MESSAGE:"In order for Live Preview to connect, Chrome needs to be relaunched with remote debugging enabled.<br /><br />Would you like to relaunch Chrome and enable remote debugging?<br /><br />",LIVE_DEV_LOADING_ERROR_MESSAGE:"Unable to load Live Preview page.",LIVE_DEV_NEED_HTML_MESSAGE:"Open an HTML file or make sure there is an index.html file in your project in order to launch live preview.",LIVE_DEV_NEED_BASEURL_MESSAGE:"To launch live preview with a server-side file, you need to specify a Base URL for this project.",LIVE_DEV_SERVER_NOT_READY_MESSAGE:"Error starting up the HTTP server for live preview files. Please try again.",LIVE_DEVELOPMENT_INFO_TITLE:"Welcome to Live Preview!",LIVE_DEVELOPMENT_INFO_MESSAGE:"Live Preview connects {APP_NAME} to your browser. It launches a preview of your HTML file in the browser, then updates the preview instantly as you edit your code.<br /><br />In this early version of {APP_NAME}, Live Preview only works with <strong>Google Chrome</strong> and updates live as you edit <strong>CSS or HTML files</strong>. Changes to JavaScript files are automatically reloaded when you save.<br /><br />(You'll only see this message once.)",LIVE_DEVELOPMENT_TROUBLESHOOTING:"For more information, see <a href='{0}' title='{0}'>Troubleshooting Live Preview connection errors</a>.",LIVE_DEV_STATUS_TIP_NOT_CONNECTED:"Live Preview",LIVE_DEV_STATUS_TIP_PROGRESS1:"Live Preview: Connecting…",LIVE_DEV_STATUS_TIP_PROGRESS2:"Live Preview: Initializing…",LIVE_DEV_STATUS_TIP_CONNECTED:"Disconnect Live Preview",LIVE_DEV_STATUS_TIP_OUT_OF_SYNC:"Live Preview (save file to refresh)",LIVE_DEV_STATUS_TIP_SYNC_ERROR:"Live Preview (not updating due to syntax error)",LIVE_DEV_DETACHED_REPLACED_WITH_DEVTOOLS:"Live Preview was cancelled because the browser's developer tools were opened",LIVE_DEV_DETACHED_TARGET_CLOSED:"Live Preview was cancelled because the page was closed in the browser",LIVE_DEV_NAVIGATED_AWAY:"Live Preview was cancelled because the browser navigated to a page that is not part of the current project",LIVE_DEV_CLOSED_UNKNOWN_REASON:"Live Preview was cancelled for an unknown reason ({0})",SAVE_CLOSE_TITLE:"Save Changes",SAVE_CLOSE_MESSAGE:"Do you want to save the changes you made in the document <span class='dialog-filename'>{0}</span>?",SAVE_CLOSE_MULTI_MESSAGE:"Do you want to save your changes to the following files?",EXT_MODIFIED_TITLE:"External Changes",CONFIRM_FOLDER_DELETE_TITLE:"Confirm Delete",CONFIRM_FOLDER_DELETE:"Are you sure you want to delete the folder <span class='dialog-filename'>{0}</span>?",FILE_DELETED_TITLE:"File Deleted",EXT_MODIFIED_WARNING:"<span class='dialog-filename'>{0}</span> has been modified on disk.<br /><br />Do you want to save the file and overwrite those changes?",EXT_MODIFIED_MESSAGE:"<span class='dialog-filename'>{0}</span> has been modified on disk, but also has unsaved changes in {APP_NAME}.<br /><br />Which version do you want to keep?",EXT_DELETED_MESSAGE:"<span class='dialog-filename'>{0}</span> has been deleted on disk, but has unsaved changes in {APP_NAME}.<br /><br />Do you want to keep your changes?",DONE:"Done",OK:"OK",CANCEL:"Cancel",DONT_SAVE:"Don't Save",SAVE:"Save",SAVE_AS:"Save As…",SAVE_AND_OVERWRITE:"Overwrite",DELETE:"Delete",BUTTON_YES:"Yes",BUTTON_NO:"No",FIND_MATCH_INDEX:"{0} of {1}",FIND_NO_RESULTS:"No results",FIND_QUERY_PLACEHOLDER:"Find…",REPLACE_PLACEHOLDER:"Replace with…",BUTTON_REPLACE_ALL:"Batch…",BUTTON_REPLACE_ALL_IN_FILES:"Replace…",BUTTON_REPLACE:"Replace",BUTTON_NEXT:"▶",BUTTON_PREV:"◀",BUTTON_NEXT_HINT:"Next Match",BUTTON_PREV_HINT:"Previous Match",BUTTON_CASESENSITIVE_HINT:"Match Case",BUTTON_REGEXP_HINT:"Regular Expression",REPLACE_WITHOUT_UNDO_WARNING_TITLE:"Replace Without Undo",REPLACE_WITHOUT_UNDO_WARNING:"Because more than {0} files need to be changed, {APP_NAME} will modify unopened files on disk.<br />You won't be able to undo replacements in those files.",BUTTON_REPLACE_WITHOUT_UNDO:"Replace Without Undo",OPEN_FILE:"Open File",SAVE_FILE_AS:"Save File",CHOOSE_FOLDER:"Choose a folder",RELEASE_NOTES:"Release Notes",NO_UPDATE_TITLE:"You're Up to Date!",NO_UPDATE_MESSAGE:"You are running the latest version of {APP_NAME}.",FIND_REPLACE_TITLE_LABEL:"Replace",FIND_REPLACE_TITLE_WITH:"with",FIND_TITLE_LABEL:"Found",FIND_TITLE_SUMMARY:"&mdash; {0} {1} {2} in {3}",FIND_NUM_FILES:"{0} {1}",FIND_IN_FILES_SCOPED:"in <span class='dialog-filename'>{0}</span>",FIND_IN_FILES_NO_SCOPE:"in project",FIND_IN_FILES_ZERO_FILES:"Filter excludes all files {0}",FIND_IN_FILES_FILE:"file",FIND_IN_FILES_FILES:"files",FIND_IN_FILES_MATCH:"match",FIND_IN_FILES_MATCHES:"matches",FIND_IN_FILES_MORE_THAN:"Over ",FIND_IN_FILES_PAGING:"{0}&mdash;{1}",FIND_IN_FILES_FILE_PATH:"<span class='dialog-filename'>{0}</span> {2} <span class='dialog-path'>{1}</span>",FIND_IN_FILES_EXPAND_COLLAPSE:"Ctrl/Cmd click to expand/collapse all",REPLACE_IN_FILES_ERRORS_TITLE:"Replace Errors",REPLACE_IN_FILES_ERRORS:"The following files weren't modified because they changed after the search or couldn't be written.",ERROR_FETCHING_UPDATE_INFO_TITLE:"Error Getting Update Info",ERROR_FETCHING_UPDATE_INFO_MSG:"There was a problem getting the latest update information from the server. Please make sure you are connected to the internet and try again.",NEW_FILE_FILTER:"New Exclusion Set…",CLEAR_FILE_FILTER:"Don't Exclude Files",NO_FILE_FILTER:"No Files Excluded",EXCLUDE_FILE_FILTER:"Exclude {0}",EDIT_FILE_FILTER:"Edit…",FILE_FILTER_DIALOG:"Edit Exclusion Set",FILE_FILTER_INSTRUCTIONS:"Exclude files and folders matching any of the following strings / substrings or <a href='{0}' title='{0}'>wildcards</a>. Enter each string on a new line.",FILTER_NAME_PLACEHOLDER:"Name this exclusion set (optional)",FILE_FILTER_CLIPPED_SUFFIX:"and {0} more",FILTER_COUNTING_FILES:"Counting files…",FILTER_FILE_COUNT:"Allows {0} of {1} files {2}",FILTER_FILE_COUNT_ALL:"Allows all {0} files {1}",ERROR_QUICK_EDIT_PROVIDER_NOT_FOUND:"No Quick Edit available for current cursor position",ERROR_CSSQUICKEDIT_BETWEENCLASSES:"CSS Quick Edit: place cursor on a single class name",ERROR_CSSQUICKEDIT_CLASSNOTFOUND:"CSS Quick Edit: incomplete class attribute",ERROR_CSSQUICKEDIT_IDNOTFOUND:"CSS Quick Edit: incomplete id attribute",ERROR_CSSQUICKEDIT_UNSUPPORTEDATTR:"CSS Quick Edit: place cursor in tag, class, or id",ERROR_TIMINGQUICKEDIT_INVALIDSYNTAX:"CSS Timing Function Quick Edit: invalid syntax",ERROR_JSQUICKEDIT_FUNCTIONNOTFOUND:"JS Quick Edit: place cursor in function name",ERROR_QUICK_DOCS_PROVIDER_NOT_FOUND:"No Quick Docs available for current cursor position",PROJECT_LOADING:"Loading…",UNTITLED:"Untitled",WORKING_FILES:"Working Files",TOP:"Top",BOTTOM:"Bottom",LEFT:"Left",RIGHT:"Right",CMD_SPLITVIEW_NONE:"No Split",CMD_SPLITVIEW_VERTICAL:"Vertical Split",CMD_SPLITVIEW_HORIZONTAL:"Horizontal Split",SPLITVIEW_MENU_TOOLTIP:"Split the editor vertically or horizontally",GEAR_MENU_TOOLTIP:"Configure Working Set",SPLITVIEW_INFO_TITLE:"Already Open",SPLITVIEW_MULTIPANE_WARNING:"The file is already open in another pane. {APP_NAME} will soon support opening the same file in more than one pane. Until then, the file will be shown in the pane it's already open in.<br /><br />(You'll only see this message once.)",KEYBOARD_CTRL:"Ctrl",KEYBOARD_SHIFT:"Shift",KEYBOARD_SPACE:"Space",STATUSBAR_CURSOR_POSITION:"Line {0}, Column {1}",STATUSBAR_SELECTION_CH_SINGULAR:" — Selected {0} column",STATUSBAR_SELECTION_CH_PLURAL:" — Selected {0} columns",STATUSBAR_SELECTION_LINE_SINGULAR:" — Selected {0} line",STATUSBAR_SELECTION_LINE_PLURAL:" — Selected {0} lines",STATUSBAR_SELECTION_MULTIPLE:" — {0} selections",STATUSBAR_INDENT_TOOLTIP_SPACES:"Click to switch indentation to spaces",STATUSBAR_INDENT_TOOLTIP_TABS:"Click to switch indentation to tabs",STATUSBAR_INDENT_SIZE_TOOLTIP_SPACES:"Click to change number of spaces used when indenting",STATUSBAR_INDENT_SIZE_TOOLTIP_TABS:"Click to change tab character width",STATUSBAR_SPACES:"Spaces:",STATUSBAR_TAB_SIZE:"Tab Size:",STATUSBAR_LINE_COUNT_SINGULAR:"— {0} Line",STATUSBAR_LINE_COUNT_PLURAL:"— {0} Lines",STATUSBAR_USER_EXTENSIONS_DISABLED:"Extensions Disabled",STATUSBAR_INSERT:"INS",STATUSBAR_OVERWRITE:"OVR",STATUSBAR_INSOVR_TOOLTIP:"Click to toggle cursor between Insert (INS) and Overwrite (OVR) modes",STATUSBAR_LANG_TOOLTIP:"Click to change file type",STATUSBAR_CODE_INSPECTION_TOOLTIP:"{0}. Click to toggle report panel.",STATUSBAR_DEFAULT_LANG:"(default)",STATUSBAR_SET_DEFAULT_LANG:"Set as Default for .{0} Files",ERRORS_PANEL_TITLE_MULTIPLE:"{0} Problems",SINGLE_ERROR:"1 {0} Problem",MULTIPLE_ERRORS:"{1} {0} Problems",NO_ERRORS:"No {0} problems found - good job!",NO_ERRORS_MULTIPLE_PROVIDER:"No problems found - good job!",LINT_DISABLED:"Linting is disabled",NO_LINT_AVAILABLE:"No linter available for {0}",NOTHING_TO_LINT:"Nothing to lint",LINTER_TIMED_OUT:"{0} has timed out after waiting for {1} ms",LINTER_FAILED:"{0} terminated with error: {1}",FILE_MENU:"File",CMD_FILE_NEW_UNTITLED:"New",CMD_FILE_NEW:"New File",CMD_FILE_NEW_FOLDER:"New Folder",CMD_FILE_OPEN:"Open…",CMD_ADD_TO_WORKING_SET:"Open To Working Set",CMD_OPEN_DROPPED_FILES:"Open Dropped Files",CMD_OPEN_FOLDER:"Open Folder…",CMD_FILE_CLOSE:"Close",CMD_FILE_CLOSE_ALL:"Close All",CMD_FILE_CLOSE_LIST:"Close List",CMD_FILE_CLOSE_OTHERS:"Close Others",CMD_FILE_CLOSE_ABOVE:"Close Others Above",CMD_FILE_CLOSE_BELOW:"Close Others Below",CMD_FILE_SAVE:"Save",CMD_FILE_SAVE_ALL:"Save All",CMD_FILE_SAVE_AS:"Save As…",CMD_LIVE_FILE_PREVIEW:"Live Preview",CMD_TOGGLE_LIVE_PREVIEW_MB_MODE:"Enable Experimental Live Preview",CMD_RELOAD_LIVE_PREVIEW:"Force Reload Live Preview",CMD_PROJECT_SETTINGS:"Project Settings…",CMD_FILE_RENAME:"Rename",CMD_FILE_DELETE:"Delete",CMD_INSTALL_EXTENSION:"Install Extension…",CMD_EXTENSION_MANAGER:"Extension Manager…",CMD_FILE_REFRESH:"Refresh File Tree",CMD_QUIT:"Quit",CMD_EXIT:"Exit",EDIT_MENU:"Edit",CMD_UNDO:"Undo",CMD_REDO:"Redo",CMD_CUT:"Cut",CMD_COPY:"Copy",CMD_PASTE:"Paste",CMD_SELECT_ALL:"Select All",CMD_SELECT_LINE:"Select Line",CMD_SPLIT_SEL_INTO_LINES:"Split Selection into Lines",CMD_ADD_CUR_TO_NEXT_LINE:"Add Cursor to Next Line",CMD_ADD_CUR_TO_PREV_LINE:"Add Cursor to Previous Line",CMD_INDENT:"Indent",CMD_UNINDENT:"Unindent",CMD_DUPLICATE:"Duplicate",CMD_DELETE_LINES:"Delete Line",CMD_COMMENT:"Toggle Line Comment",CMD_BLOCK_COMMENT:"Toggle Block Comment",CMD_LINE_UP:"Move Line Up",CMD_LINE_DOWN:"Move Line Down",CMD_OPEN_LINE_ABOVE:"Open Line Above",CMD_OPEN_LINE_BELOW:"Open Line Below",CMD_TOGGLE_CLOSE_BRACKETS:"Auto Close Braces",CMD_SHOW_CODE_HINTS:"Show Code Hints",FIND_MENU:"Find",CMD_FIND:"Find",CMD_FIND_NEXT:"Find Next",CMD_FIND_PREVIOUS:"Find Previous",CMD_FIND_ALL_AND_SELECT:"Find All and Select",CMD_ADD_NEXT_MATCH:"Add Next Match to Selection",CMD_SKIP_CURRENT_MATCH:"Skip and Add Next Match",CMD_FIND_IN_FILES:"Find in Files",CMD_FIND_IN_SELECTED:"Find in Selected File/Folder",CMD_FIND_IN_SUBTREE:"Find in…",CMD_REPLACE:"Replace",CMD_REPLACE_IN_FILES:"Replace in Files",CMD_REPLACE_IN_SELECTED:"Replace in Selected File/Folder",CMD_REPLACE_IN_SUBTREE:"Replace in…",VIEW_MENU:"View",CMD_HIDE_SIDEBAR:"Hide Sidebar",CMD_SHOW_SIDEBAR:"Show Sidebar",CMD_INCREASE_FONT_SIZE:"Increase Font Size",CMD_DECREASE_FONT_SIZE:"Decrease Font Size",CMD_RESTORE_FONT_SIZE:"Restore Font Size",CMD_SCROLL_LINE_UP:"Scroll Line Up",CMD_SCROLL_LINE_DOWN:"Scroll Line Down",CMD_TOGGLE_LINE_NUMBERS:"Line Numbers",CMD_TOGGLE_ACTIVE_LINE:"Highlight Active Line",CMD_TOGGLE_WORD_WRAP:"Word Wrap",CMD_LIVE_HIGHLIGHT:"Live Preview Highlight",CMD_VIEW_TOGGLE_INSPECTION:"Lint Files on Save",CMD_WORKINGSET_SORT_BY_ADDED:"Sort by Added",CMD_WORKINGSET_SORT_BY_NAME:"Sort by Name",CMD_WORKINGSET_SORT_BY_TYPE:"Sort by Type",CMD_WORKING_SORT_TOGGLE_AUTO:"Automatic Sort",CMD_THEMES:"Themes…",NAVIGATE_MENU:"Navigate",CMD_QUICK_OPEN:"Quick Open",CMD_GOTO_LINE:"Go to Line",CMD_GOTO_DEFINITION:"Quick Find Definition",CMD_GOTO_FIRST_PROBLEM:"Go to First Problem",CMD_TOGGLE_QUICK_EDIT:"Quick Edit",CMD_TOGGLE_QUICK_DOCS:"Quick Docs",CMD_QUICK_EDIT_PREV_MATCH:"Previous Match",CMD_QUICK_EDIT_NEXT_MATCH:"Next Match",CMD_CSS_QUICK_EDIT_NEW_RULE:"New Rule",CMD_NEXT_DOC:"Next Document",CMD_PREV_DOC:"Previous Document",CMD_SHOW_IN_TREE:"Show in File Tree",CMD_SHOW_IN_EXPLORER:"Show in Explorer",CMD_SHOW_IN_FINDER:"Show in Finder",CMD_SHOW_IN_OS:"Show in OS",HELP_MENU:"Help",CMD_CHECK_FOR_UPDATE:"Check for Updates",CMD_HOW_TO_USE_BRACKETS:"How to Use {APP_NAME}",CMD_SUPPORT:"{APP_NAME} Support",CMD_SUGGEST:"Suggest a Feature",CMD_RELEASE_NOTES:"Release Notes",CMD_GET_INVOLVED:"Get Involved",CMD_SHOW_EXTENSIONS_FOLDER:"Show Extensions Folder",CMD_HOMEPAGE:"{APP_TITLE} Homepage",CMD_TWITTER:"{TWITTER_NAME} on Twitter",CMD_ABOUT:"About {APP_TITLE}",CMD_OPEN_PREFERENCES:"Open Preferences File",CMD_OPEN_KEYMAP:"Open User Key Map",EXPERIMENTAL_BUILD:"experimental build",RELEASE_BUILD:"build",DEVELOPMENT_BUILD:"development build",RELOAD_FROM_DISK:"Reload from Disk",KEEP_CHANGES_IN_EDITOR:"Keep Changes in Editor",CLOSE_DONT_SAVE:"Close (Don't Save)",RELAUNCH_CHROME:"Relaunch Chrome",ABOUT:"About",CLOSE:"Close",ABOUT_TEXT_LINE1:"Release {VERSION_MAJOR}.{VERSION_MINOR} {BUILD_TYPE} {VERSION}",ABOUT_TEXT_BUILD_TIMESTAMP:"build timestamp: ",ABOUT_TEXT_LINE3:"Notices, terms and conditions pertaining to third party software are located at <a href='{ADOBE_THIRD_PARTY}'>{ADOBE_THIRD_PARTY}</a> and incorporated by reference herein.",ABOUT_TEXT_LINE4:"Documentation and source at <a href='https://github.com/adobe/brackets/'>https://github.com/adobe/brackets/</a>",ABOUT_TEXT_LINE5:"Made with ❤ and JavaScript by:",ABOUT_TEXT_LINE6:"Lots of people (but we're having trouble loading that data right now).",ABOUT_TEXT_WEB_PLATFORM_DOCS:"Web Platform Docs and the Web Platform graphical logo are licensed under a Creative Commons Attribution license, <a href='{WEB_PLATFORM_DOCS_LICENSE}'>CC-BY 3.0 Unported</a>.",UPDATE_NOTIFICATION_TOOLTIP:"There's a new build of {APP_NAME} available! Click here for details.",UPDATE_AVAILABLE_TITLE:"Update Available",UPDATE_MESSAGE:"Hey, there's a new build of {APP_NAME} available. Here are some of the new features:",GET_IT_NOW:"Get it now!",PROJECT_SETTINGS_TITLE:"Project Settings for: {0}",PROJECT_SETTING_BASE_URL:"Live Preview Base URL",PROJECT_SETTING_BASE_URL_HINT:"To use a local server, enter a url like http://localhost:8000/",BASEURL_ERROR_INVALID_PROTOCOL:"The {0} protocol isn't supported by Live Preview&mdash;please use http: or https: .",BASEURL_ERROR_SEARCH_DISALLOWED:'The base URL can\'t contain search parameters like "{0}".',BASEURL_ERROR_HASH_DISALLOWED:'The base URL can\'t contain hashes like "{0}".',BASEURL_ERROR_INVALID_CHAR:"Special characters like '{0}' must be %-encoded.",BASEURL_ERROR_UNKNOWN_ERROR:"Unknown error parsing Base URL",EMPTY_VIEW_HEADER:"<em>Open a file while this pane has focus</em>",CURRENT_THEME:"Current Theme",USE_THEME_SCROLLBARS:"Use Theme Scrollbars",FONT_SIZE:"Font Size",FONT_FAMILY:"Font Family",THEMES_SETTINGS:"Themes Settings",BUTTON_NEW_RULE:"New Rule",INSTALL:"Install",UPDATE:"Update",REMOVE:"Remove",OVERWRITE:"Overwrite",CANT_REMOVE_DEV:'Extensions in the "dev" folder must be manually deleted.',CANT_UPDATE:"The update isn't compatible with this version of {APP_NAME}.",CANT_UPDATE_DEV:'Extensions in the "dev" folder can\'t be updated automatically.',INSTALL_EXTENSION_TITLE:"Install Extension",UPDATE_EXTENSION_TITLE:"Update Extension",INSTALL_EXTENSION_LABEL:"Extension URL",INSTALL_EXTENSION_HINT:"URL of the extension's zip file or GitHub repo",INSTALLING_FROM:"Installing extension from {0}…",INSTALL_SUCCEEDED:"Installation successful!",INSTALL_FAILED:"Installation failed.",CANCELING_INSTALL:"Canceling…",CANCELING_HUNG:"Canceling the install is taking a long time. An internal error may have occurred.",INSTALL_CANCELED:"Installation canceled.",VIEW_COMPLETE_DESCRIPTION:"View complete description",VIEW_TRUNCATED_DESCRIPTION:"View truncated description",INVALID_ZIP_FILE:"The downloaded content is not a valid zip file.",INVALID_PACKAGE_JSON:"The package.json file is not valid (error was: {0}).",MISSING_PACKAGE_NAME:"The package.json file doesn't specify a package name.",BAD_PACKAGE_NAME:"{0} is an invalid package name.",MISSING_PACKAGE_VERSION:"The package.json file doesn't specify a package version.",INVALID_VERSION_NUMBER:"The package version number ({0}) is invalid.",INVALID_BRACKETS_VERSION:"The {APP_NAME} compatibility string ({0}) is invalid.",DISALLOWED_WORDS:"The words ({1}) are not allowed in the {0} field.",API_NOT_COMPATIBLE:"The extension isn't compatible with this version of {APP_NAME}. It's installed in your disabled extensions folder.",MISSING_MAIN:"The package has no main.js file.",EXTENSION_ALREADY_INSTALLED:"Installing this package will overwrite a previously installed extension. Overwrite the old extension?",EXTENSION_SAME_VERSION:"This package is the same version as the one that is currently installed. Overwrite the existing installation?",EXTENSION_OLDER_VERSION:"This package is version {0} which is older than the currently installed ({1}). Overwrite the existing installation?",DOWNLOAD_ID_IN_USE:"Internal error: download ID already in use.",NO_SERVER_RESPONSE:"Cannot connect to server.",BAD_HTTP_STATUS:"File not found on server (HTTP {0}).",CANNOT_WRITE_TEMP:"Unable to save download to temp file.",ERROR_LOADING:"The extension encountered an error while starting up.",MALFORMED_URL:"The URL is invalid. Please check that you entered it correctly.",UNSUPPORTED_PROTOCOL:"The URL must be an http or https URL.",UNKNOWN_ERROR:"Unknown internal error.",EXTENSION_MANAGER_TITLE:"Extension Manager",EXTENSION_MANAGER_ERROR_LOAD:"Unable to access the extension registry. Please try again later.",INSTALL_EXTENSION_DRAG:"Drag .zip here or",INSTALL_EXTENSION_DROP:"Drop .zip to install",INSTALL_EXTENSION_DROP_ERROR:"Install/Update aborted due to the following errors:",INSTALL_FROM_URL:"Install from URL…",INSTALL_EXTENSION_VALIDATING:"Validating…",EXTENSION_AUTHOR:"Author",EXTENSION_DATE:"Date",EXTENSION_INCOMPATIBLE_NEWER:"This extension requires a newer version of {APP_NAME}.",EXTENSION_INCOMPATIBLE_OLDER:"This extension currently only works with older versions of {APP_NAME}.",EXTENSION_LATEST_INCOMPATIBLE_NEWER:"Version {0} of this extension requires a newer version of {APP_NAME}. But you can install the earlier version {1}.",EXTENSION_LATEST_INCOMPATIBLE_OLDER:"Version {0} of this extension only works with older versions of {APP_NAME}. But you can install the earlier version {1}.",EXTENSION_NO_DESCRIPTION:"No description",EXTENSION_MORE_INFO:"More info...",EXTENSION_ERROR:"Extension error",EXTENSION_KEYWORDS:"Keywords",EXTENSION_TRANSLATED_USER_LANG:"Translated into {0} languages, including yours",EXTENSION_TRANSLATED_GENERAL:"Translated into {0} languages",EXTENSION_TRANSLATED_LANGS:"This extension has been translated into these languages: {0}",EXTENSION_INSTALLED:"Installed",EXTENSION_UPDATE_INSTALLED:"This extension update has been downloaded and will be installed after {APP_NAME} reloads.",EXTENSION_SEARCH_PLACEHOLDER:"Search",EXTENSION_MORE_INFO_LINK:"More",BROWSE_EXTENSIONS:"Browse Extensions",EXTENSION_MANAGER_REMOVE:"Remove Extension",EXTENSION_MANAGER_REMOVE_ERROR:"Unable to remove one or more extensions: {0}. {APP_NAME} will still reload.",EXTENSION_MANAGER_UPDATE:"Update Extension",EXTENSION_MANAGER_UPDATE_ERROR:"Unable to update one or more extensions: {0}. {APP_NAME} will still reload.",MARKED_FOR_REMOVAL:"Marked for removal",UNDO_REMOVE:"Undo",MARKED_FOR_UPDATE:"Marked for update",UNDO_UPDATE:"Undo",CHANGE_AND_RELOAD_TITLE:"Change Extensions",CHANGE_AND_RELOAD_MESSAGE:"To update or remove the marked extensions, {APP_NAME} will need to reload. You'll be prompted to save unsaved changes.",REMOVE_AND_RELOAD:"Remove Extensions and Reload",CHANGE_AND_RELOAD:"Change Extensions and Reload",UPDATE_AND_RELOAD:"Update Extensions and Reload",PROCESSING_EXTENSIONS:"Processing extension changes…",EXTENSION_NOT_INSTALLED:"Couldn't remove extension {0} because it wasn't installed.",NO_EXTENSIONS:"No extensions installed yet.<br>Click on the Available tab above to get started.",NO_EXTENSION_MATCHES:"No extensions match your search.",REGISTRY_SANITY_CHECK_WARNING:"NOTE: These extensions may come from different authors than {APP_NAME} itself. Extensions are not reviewed and have full local privileges. Be cautious when installing extensions from an unknown source.",EXTENSIONS_INSTALLED_TITLE:"Installed",EXTENSIONS_AVAILABLE_TITLE:"Available",EXTENSIONS_THEMES_TITLE:"Themes",EXTENSIONS_UPDATES_TITLE:"Updates",INLINE_EDITOR_NO_MATCHES:"No matches available.",INLINE_EDITOR_HIDDEN_MATCHES:"All matches are collapsed. Expand the files listed at right to view matches.",CSS_QUICK_EDIT_NO_MATCHES:'There are no existing CSS rules that match your selection.<br> Click "New Rule" to create one.',CSS_QUICK_EDIT_NO_STYLESHEETS:"There are no stylesheets in your project.<br>Create one to add CSS rules.",IMAGE_VIEWER_LARGEST_ICON:"largest",UNIT_PIXELS:"pixels",DEBUG_MENU:"Debug",ERRORS:"Errors",CMD_SHOW_DEV_TOOLS:"Show Developer Tools",CMD_REFRESH_WINDOW:"Reload With Extensions",CMD_RELOAD_WITHOUT_USER_EXTS:"Reload Without Extensions",CMD_NEW_BRACKETS_WINDOW:"New {APP_NAME} Window",CMD_SWITCH_LANGUAGE:"Switch Language",CMD_RUN_UNIT_TESTS:"Run Tests",CMD_SHOW_PERF_DATA:"Show Performance Data",CMD_ENABLE_NODE_DEBUGGER:"Enable Node Debugger",CMD_LOG_NODE_STATE:"Log Node State to Console",CMD_RESTART_NODE:"Restart Node",CMD_SHOW_ERRORS_IN_STATUS_BAR:"Show Errors in Status Bar",CMD_OPEN_BRACKETS_SOURCE:"Open Brackets Source",LANGUAGE_TITLE:"Switch Language",LANGUAGE_MESSAGE:"Language:",LANGUAGE_SUBMIT:"Reload {APP_NAME}",LANGUAGE_CANCEL:"Cancel",LANGUAGE_SYSTEM_DEFAULT:"System Default",INLINE_TIMING_EDITOR_TIME:"Time",INLINE_TIMING_EDITOR_PROGRESSION:"Progression",BEZIER_EDITOR_INFO:"<kbd>↑</kbd><kbd>↓</kbd><kbd>←</kbd><kbd>→</kbd> Move selected point<br><kbd class='text'>Shift</kbd> Move by ten units<br><kbd class='text'>Tab</kbd> Switch points",STEPS_EDITOR_INFO:"<kbd>↑</kbd><kbd>↓</kbd> Increase or decrease steps<br><kbd>←</kbd><kbd>→</kbd> 'Start' or 'End'",INLINE_TIMING_EDITOR_INVALID:"The old value <code>{0}</code> is not valid, so the displayed function was changed to <code>{1}</code>. The document will be updated with the first edit.",COLOR_EDITOR_CURRENT_COLOR_SWATCH_TIP:"Current Color",COLOR_EDITOR_ORIGINAL_COLOR_SWATCH_TIP:"Original Color",COLOR_EDITOR_RGBA_BUTTON_TIP:"RGBa Format",COLOR_EDITOR_HEX_BUTTON_TIP:"Hex Format",COLOR_EDITOR_HSLA_BUTTON_TIP:"HSLa Format",COLOR_EDITOR_USED_COLOR_TIP_SINGULAR:"{0} (Used {1} time)",COLOR_EDITOR_USED_COLOR_TIP_PLURAL:"{0} (Used {1} times)",CMD_JUMPTO_DEFINITION:"Jump to Definition",CMD_SHOW_PARAMETER_HINT:"Show Parameter Hint",NO_ARGUMENTS:"<no parameters>",DETECTED_EXCLUSION_TITLE:"JavaScript File Inference Problem",DETECTED_EXCLUSION_INFO:"Brackets ran into trouble processing <span class='dialog-filename'>{0}</span>.<br><br>This file will no longer be processed for code hints, Jump to Definition or Quick Edit. To reenable this file, open <code>.brackets.json</code> in your project and edit <code>jscodehints.detectedExclusions</code>.<br><br>This is likely a Brackets bug. If you can provide a copy of this file, please <a href='https://github.com/adobe/brackets/wiki/How-to-Report-an-Issue'>file a bug</a> with a link to the file named here.",JSLINT_NAME:"JSLint",CMD_ENABLE_QUICK_VIEW:"Quick View on Hover",CMD_TOGGLE_RECENT_PROJECTS:"Recent Projects",DOCS_MORE_LINK:"Read more"}),define("nls/urls",["require","exports","module"],function(e,t,n){"use strict";
n.exports={root:!0,cs:!0,da:!0,de:!0,es:!0,"fa-ir":!0,fi:!0,fr:!0,hr:!0,id:!0,it:!0,ja:!0,ko:!0,nb:!0,pl:!0,"pt-br":!0,"pt-pt":!0,ru:!0,sv:!0,"zh-cn":!0,tr:!0}}),define("nls/root/urls",{GETTING_STARTED:"root/Getting Started",ADOBE_THIRD_PARTY:"http://www.adobe.com/go/thirdparty/",WEB_PLATFORM_DOCS_LICENSE:"http://creativecommons.org/licenses/by/3.0/"}),define("nls/strings-app",["require","exports","module"],function(e,t,n){"use strict";n.exports={root:!0}}),define("nls/root/strings-app",{APP_NAME:"Brackets",LOCALE_CS:"čeština",LOCALE_DA:"Dansk",LOCALE_DE:"Deutsch",LOCALE_EL:"Ελληνικά",LOCALE_EN:"English (US)",LOCALE_EN_GB:"English (UK)",LOCALE_ES:"español",LOCALE_FA_IR:"فارسی",LOCALE_FI:"suomi",LOCALE_FR:"français",LOCALE_GL:"galego",LOCALE_HR:"hrvatski",LOCALE_HU:"magyar",LOCALE_ID:"Bahasa Indonesia",LOCALE_IT:"italiano",LOCALE_JA:"日本語",LOCALE_KO:"한국어",LOCALE_NB:"norsk",LOCALE_NL:"Nederlands",LOCALE_PL:"polski",LOCALE_PT_BR:"português (BR)",LOCALE_PT_PT:"português (PT)",LOCALE_RO:"română",LOCALE_RU:"русский",LOCALE_SK:"slovenčina",LOCALE_SR:"Српски",LOCALE_SV:"svenska",LOCALE_TR:"Türkçe",LOCALE_UK:"Українська",LOCALE_ZH_CN:"简体中文",LOCALE_ZH_TW:"繁體中文"}),define("utils/StringUtils",["require","exports","module","thirdparty/lodash"],function(e,t){"use strict";function n(e){var t=[].slice.call(arguments,1);return e.replace(/\{(\d+)\}/g,function(e,n){return"undefined"!=typeof t[n]?t[n]:e})}function r(e){return e.replace(/([.?*+\^$\[\]\\(){}|\-])/g,"\\$1")}function i(e){return e.replace(/\./g,"\\.")}function o(e){return e.split("\n")}function a(e,t){if(Array.isArray(e)){var n,r=e,i=0;for(n=0;n<r.length;n++){if(!(t>i))return i===t?n:n-1;i+=r[n].length+1}return i>=t?n-1:void 0}return e.substr(0,t).split("\n").length-1}function s(e,t){return-1!==e.indexOf(t,e.length-t.length)}function l(e,t){function n(e){return e.lastIndexOf("/")+1<e.length}var r,i;return"win"===brackets.platform?(r=(n(e)?"1":"0")+e.toLowerCase(),i=(n(t)?"1":"0")+t.toLowerCase()):(r=e.toLowerCase(),i=t.toLowerCase()),r===i?0:r>i?1:-1}function c(e){var t=p.escape(e);return t.replace(new RegExp(r("/"),"g"),"/&#8203;")}function u(e,t){var n=1024,r=1024*n,i=1024*r,o=1024*i,a=e;if(e>=0&&n>e)a=e+" B";else if(r>e)a=(e/n).toFixed(t)+" KB";else if(i>e)a=(e/r).toFixed(t)+" MB";else if(o>e)a=(e/i).toFixed(t)+" GB";else if(e>=o)return(e/o).toFixed(t)+" TB";return a}function d(e,t){if(e.length>t){e=e.substr(0,t);var n=e.lastIndexOf(" ");return t>n&&n>-1&&(e=e.substr(0,n)),e}}var p=e("thirdparty/lodash");t.format=n,t.regexEscape=r,t.jQueryIdEscape=i,t.getLines=o,t.offsetToLineNum=a,t.urlSort=l,t.breakableUrl=c,t.endsWith=s,t.prettyPrintBytes=u,t.truncate=d}),define("strings",["require","exports","module","thirdparty/lodash","i18n!nls/strings","i18n!nls/urls","i18n!nls/strings-app","utils/StringUtils","utils/Global"],function(e,t,n){"use strict";var r=e("thirdparty/lodash"),i=e("i18n!nls/strings"),o=e("i18n!nls/urls"),a=e("i18n!nls/strings-app"),s=e("utils/StringUtils");e("utils/Global");var l=$.extend({},o),c=/([0-9]+)\.([0-9]+)\.([0-9]+)/.exec(brackets.metadata.version);l.APP_NAME=brackets.metadata.name||i.APP_NAME,l.APP_TITLE=brackets.config.app_title||i.APP_NAME,l.TWITTER_NAME=brackets.config.twitter_name,l.VERSION=brackets.metadata.version,l.VERSION_MAJOR=c[1],l.VERSION_MINOR=c[2],l.VERSION_PATCH=c[3];var u=!s.endsWith(decodeURI(window.location.pathname),"/www/index.html");if(u)l.BUILD_TYPE=i.DEVELOPMENT_BUILD;else{var d="mac"===brackets.platform||"win"===brackets.platform;l.BUILD_TYPE=d?i.RELEASE_BUILD:i.EXPERIMENTAL_BUILD}r.forEach(i,function(e,t){r.forEach(l,function(e,n){i[t]=i[t].replace(new RegExp("{"+n+"}","g"),l[n])})}),r.forEach(a,function(e,t){r.forEach(l,function(e,n){a[t]=a[t].replace(new RegExp("{"+n+"}","g"),l[n])}),i[t]=a[t]}),n.exports=i}),define("file/FileUtils",["require","exports","module","utils/Global","filesystem/FileSystemError","utils/DeprecationWarning","language/LanguageManager","utils/PerfUtils","strings","utils/StringUtils"],function(e,t){"use strict";function n(e){var t=new $.Deferred,n=R.markStart("readAsText:	"+e.fullPath);return t.always(function(){R.addMeasurement(n)}),e.read(function(e,n,r){e?t.reject(e):t.resolve(n,r.mtime)}),t.promise()}function r(e,t,n){var r=new $.Deferred,i={};return n&&(i.blind=!0),e.write(t,i,function(e){e?r.reject(e):r.resolve()}),r.promise()}function i(){return"win"===brackets.platform?k:F}function o(e){var t=e.substr(0,1e3),n=/\r\n/.test(t),r=/[^\r]\n/.test(t);return n&&r||!n&&!r?null:n?k:F}function a(e,t){t!==k&&t!==F&&(t=i());var n=t===k?"\r\n":"\n",r=/\r\n|\r|\n/g;return e.replace(r,n)}function s(e){var t;return t=e===O.NOT_FOUND?N.NOT_FOUND_ERR:e===O.NOT_READABLE?N.NOT_READABLE_ERR:e===O.NOT_WRITABLE?N.NO_MODIFICATION_ALLOWED_ERR_FILE:e===O.CONTENTS_MODIFIED?N.CONTENTS_MODIFIED_ERR:e===O.UNSUPPORTED_ENCODING?N.UNSUPPORTED_ENCODING_ERR:e===O.EXCEEDS_MAX_FILE_SIZE?x.format(N.EXCEEDS_MAX_FILE_SIZE,A):x.format(N.GENERIC_ERROR,e)}function l(e,t){return M.deprecationWarning("FileUtils.showFileOpenError() has been deprecated. Please use DocumentCommandHandlers.showFileOpenError() instead."),D.showFileOpenError(e,t)}function c(e){var t="<ul class='dialog-list'>";return e.forEach(function(e){t+="<li><span class='dialog-filename'>",t+=x.breakableUrl(e),t+="</span></li>"}),t+="</ul>"}function u(e){return e=unescape(e),-1!==e.indexOf(":")&&"/"===e[0]?e.substr(1):e}function d(e){return"win"===brackets.platform&&(e=e.replace(/\\/g,"/")),e}function p(e){return e&&"/"===e[e.length-1]?e.slice(0,-1):e}function h(e){var t=e.lastIndexOf("/");return t===e.length-1?e.slice(e.lastIndexOf("/",e.length-2)+1,-1):e.slice(t+1)}function f(){var e=decodeURI(window.location.pathname),t=e.substr(0,e.lastIndexOf("/"));return u(t)}function m(e){var t;return e&&e.uri&&(t=decodeURI(e.uri),t=t.substr(0,t.lastIndexOf("/"))),t}function g(e){var t=h(e),n=t.lastIndexOf(".");return-1===n?"":t.substr(n+1)}function v(e){return M.deprecationWarning("FileUtils.getSmartFileExtension() has been deprecated. Please use LanguageManager.getCompoundFileExtension() instead."),L.getCompoundFileExtension(e)}function y(e,t){return t&&t.substr(0,e.length)===e?t.substr(e.length):void 0}function _(e){return M.deprecationWarning("FileUtils.isStaticHtmlFileExt() has been deprecated. Please use LiveDevelopmentUtils.isStaticHtmlFileExt() instead."),T.isStaticHtmlFileExt(e)}function E(e){return e.substr(0,e.lastIndexOf("/")+1)}function b(e){return"/"===e?"":e.substring(0,e.lastIndexOf("/",e.length-2)+1)}function S(e){var t=e.lastIndexOf(".");return-1===t?e:e.slice(0,t)}function I(e,t,n){var r,i=g(e),o=g(t),a=brackets.getLocale(),s=i.toLocaleLowerCase().localeCompare(o.toLocaleLowerCase(),a,{numeric:!0});return"win"===brackets.platform&&(e=S(e),t=S(t)),r=e.toLocaleLowerCase().localeCompare(t.toLocaleLowerCase(),a,{numeric:!0}),n?s||r:r||s}function w(e,t){for(var n,r,i=e.split("/"),o=t.split("/"),a=Math.min(i.length,o.length),s=i.length-1,l=o.length-1,c=0;a>c;){if(n=i[c],r=o[c],n!==r)return s>c&&l>c?n.toLocaleLowerCase().localeCompare(r.toLocaleLowerCase()):c>=s&&c>=l?I(n,r):c>=s&&l>c?-1:1;c++}return 0}function C(e){var t=e.split("/");return t=t.map(function(e){return encodeURIComponent(e)}),t.join("/")}e("utils/Global");var D,T,O=e("filesystem/FileSystemError"),M=e("utils/DeprecationWarning"),L=e("language/LanguageManager"),R=e("utils/PerfUtils"),N=e("strings"),x=e("utils/StringUtils"),A=16,P=1024*A*1024,k="CRLF",F="LF";e(["document/DocumentCommandHandlers"],function(e){D=e}),e(["LiveDevelopment/LiveDevelopmentUtils"],function(e){T=e}),t.LINE_ENDINGS_CRLF=k,t.LINE_ENDINGS_LF=F,t.getPlatformLineEndings=i,t.sniffLineEndings=o,t.translateLineEndings=a,t.showFileOpenError=l,t.getFileErrorString=s,t.makeDialogFileList=c,t.readAsText=n,t.writeText=r,t.convertToNativePath=u,t.convertWindowsPathToUnixPath=d,t.getNativeBracketsDirectoryPath=f,t.getNativeModuleDirectoryPath=m,t.stripTrailingSlash=p,t.isStaticHtmlFileExt=_,t.getDirectoryPath=E,t.getParentPath=b,t.getBaseName=h,t.getRelativeFilename=y,t.getFilenameWithoutExtension=S,t.getFileExtension=g,t.getSmartFileExtension=v,t.compareFilenames=I,t.comparePaths=w,t.MAX_FILE_SIZE=P,t.encodeFilePath=C}),define("text!language/languages.json",[],function(){return'{\n    "unknown": {\n        "name": "Text",\n        "mode": ["null", "text/plain"]\n    },\n\n    "css": {\n        "name": "CSS",\n        "mode": "css",\n        "fileExtensions": ["css", "css.erb"],\n        "blockComment": ["/*", "*/"]\n    },\n\n    "html": {\n        "name": "HTML",\n        "mode": ["htmlmixed", "text/x-brackets-html"],\n        "fileExtensions": ["html", "htm", "shtm", "shtml", "xhtml", "cfm", "cfml", "cfc", "dhtml", "xht", "tpl", "twig", "hbs", "handlebars", "kit", "jsp", "aspx", "ascx", "asp", "master", "cshtml", "vbhtml"],\n        "blockComment": ["<!--", "-->"]\n    },\n    \n    "javascript": {\n        "name": "JavaScript",\n        "mode": "javascript",\n        "fileExtensions": ["js", "jsx", "js.erb", "jsm", "_js"],\n        "blockComment": ["/*", "*/"],\n        "lineComment": ["//"]\n    },\n\n    "json": {\n        "name": "JSON",\n        "mode": ["javascript", "application/json"],\n        "fileExtensions": ["json"],\n        "fileNames": [".jshintrc", ".bowerrc"]\n    },\n\n    "markdown": {\n        "name": "Markdown",\n        "mode": "markdown",\n        "fileExtensions": ["md", "markdown", "mdown", "mkdn"],\n        "blockComment": ["<!--", "-->"]\n    },\n  \n    "image": {\n        "name": "Image",\n        "fileExtensions": ["gif", "png", "jpe", "jpeg", "jpg", "ico", "bmp"],\n        "isBinary": true\n    },\n    \n    "audio": {\n        "name": "Audio",\n        "fileExtensions": ["mp3", "wav", "aif", "aiff", "ogg"],\n        "isBinary": true\n    },\n    \n    "binary": {\n        "name": "Other Binary",\n        "fileExtensions": [\n            "a", "ai", "avi", "bin", "cab", "com", "db", "dll", "dmg",\n            "doc", "docx", "dot", "dotx", "dsym", "dylib", "egg", "epub", "eot",\n            "exe", "flv", "gz", "gzip", "htmz", "htmlz", "ipch", "iso", "jar",\n            "jsz", "lib", "mpeg", "mpg", "mp4", "msi", "node", "o", "obj", "odc",\n            "odb", "odf", "odg", "odp", "ods", "odt", "otf", "pak", "pdb", "pdf",\n            "pdi", "ppt", "pptx", "psd", "rar", "sdf", "so", "sqlite", "suo", "svgz",\n            "swf", "tar", "tif", "tiff", "ttf", "woff", "xls", "xlsx", "zip"\n        ],\n        "isBinary": true\n    }\n}\n'}),define("language/LanguageManager",["require","exports","module","thirdparty/CodeMirror2/lib/codemirror","utils/EventDispatcher","utils/Async","file/FileUtils","text!language/languages.json","thirdparty/lodash"],function(e,t){"use strict";function n(e,t,n){var r=n?n.reject:console.error;return"[object String]"!==Object.prototype.toString.call(e)?(r(t+" must be a string"),!1):""===e?(r(t+" must not be empty"),!1):!0}function r(){function e(e){return b.modes[e]?void console.error('There already is a CodeMirror mode with the name "'+e+'"'):void t.apply(b,arguments)}var t=b.defineMode;b.defineMode=e}function i(e,t){return A[e]?void console.warn('CodeMirror mode "'+e+'" is already used by language '+A[e]._name+" - cannot fully register language "+t._name+" using the same mode. Some features will treat all content with this mode as language "+A[e]._name):void(A[e]=t)}function o(e){return M[e]}function a(e){return R[e.toLowerCase()]}function s(e,t){var n,r,i,o=x[e];if(!t&&o)return o;if(n=w.getBaseName(e).toLowerCase(),o=N[n],!o)for(i=n.split("."),""===i[0]&&i.shift(),i.shift();!o&&i.length;)r=i.join("."),o=R[r],i.shift();return o||T}function l(){return $.extend({},M)}function c(e){var t=A[e];return t?t:(console.log("Called LanguageManager._getLanguageForMode with a mode for which no language has been registered:",e),T)}function u(e){M[e.getId()]=e,t.trigger("languageAdded",e)}function d(e){t.trigger("languageModified",e)}function p(e,t){var n=s(e);t?x[e]=t:delete x[e];var r=s(e);d(n),d(r)}function h(){x={}}function f(e){var t=w.getBaseName(e),n=t.split(".");n.shift(),"."===t[0]&&n.shift();for(var r=[n.pop()],i=n.length;i--&&a(n[i]);)r.unshift(n[i]);return r.join(".")}function m(){this._fileExtensions=[],this._fileNames=[],this._modeToLanguageMap={},this._lineCommentSyntax=[]}function g(e,t){function n(){if(c)for(o=0,a=c.length;a>o;o++)s.addFileExtension(c[o]);if(d)for(o=0,a=d.length;a>o;o++)s.addFileName(d[o]);s._setBinary(!!t.isBinary),M[s.getId()]=s}var r=new $.Deferred;if(O[e])return r.reject('Language "'+e+'" is waiting to be resolved.'),r.promise();if(M[e])return r.reject('Language "'+e+'" is already defined'),r.promise();var o,a,s=new m,l=t.name,c=t.fileExtensions,d=t.fileNames,p=t.blockComment,h=t.lineComment;return!s._setId(e)||!s._setName(l)||p&&!s.setBlockCommentSyntax(p[0],p[1])||h&&!s.setLineCommentSyntax(h)?(r.reject(),r.promise()):(t.isBinary?(n(),r.resolve(s)):(O[e]=s,s._loadAndSetMode(t.mode).done(function(){i(s.getMode(),s),n(),u(s),r.resolve(s)}).fail(function(e){console.error(e),r.reject(e)}).always(function(){delete O[e]})),r.promise())}function v(e,t){if(t.overridden[e]){var n=o(t.overridden[e]);n[t.add](e),delete t.overridden[e]}}function y(e){var n=_.get(e),r=Object.keys(n),i=F[e],a=i.last,s=i.overridden;r.forEach(function(e){var r;n[e]!==a[e]&&(a[e]&&(r=o(a[e]),r&&(r[i.remove](e),v(e,i))),r=t[i.get](e),r&&(r[i.remove](e),s[e]||(s[e]=r.getId())),r=o(n[e]),r&&r[i.add](e))}),D.difference(Object.keys(a),r).forEach(function(e){var t=o(a[e]);t&&(t[i.remove](e),v(e,i))}),i.last=n}var _,E,b=e("thirdparty/CodeMirror2/lib/codemirror"),S=e("utils/EventDispatcher"),I=e("utils/Async"),w=e("file/FileUtils"),C=e("text!language/languages.json"),D=e("thirdparty/lodash"),T=null,O={},M={},L={},R=Object.create(L),N={},x={},A={},P="language.fileExtensions",k="language.fileNames",F={};F[P]={last:{},overridden:{},add:"addFileExtension",remove:"removeFileExtension",get:"getLanguageForExtension"},F[k]={last:{},overridden:{},add:"addFileName",remove:"removeFileName",get:"getLanguageForPath"},m.prototype._id=null,m.prototype._name=null,m.prototype._mode=null,m.prototype._fileExtensions=null,m.prototype._fileNames=null,m.prototype._lineCommentSyntax=null,m.prototype._modeToLanguageMap=null,m.prototype._blockCommentSyntax=null,m.prototype._isBinary=!1,m.prototype.getId=function(){return this._id},m.prototype._setId=function(e){return n(e,"Language ID")?e.match(/^[a-z0-9]+(_[a-z0-9]+)*$/)?(this._id=e,!0):(console.error('Invalid language ID "'+e+'": Only groups of lower case letters and numbers are allowed, separated by underscores.'),!1):!1},m.prototype.getName=function(){return this._name},m.prototype._setName=function(e){return n(e,"name")?(this._name=e,!0):!1},m.prototype.getMode=function(){return this._mode},m.prototype._loadAndSetMode=function(t){var r,i=new $.Deferred,o=this;if(Array.isArray(t)){if(2!==t.length)return i.reject("Mode must either be a string or an array containing two strings"),i.promise();r=t[1],t=t[0]}if(!n(t,"mode",i))return i.reject(),i.promise();var a=function(){if(!b.modes[t])return void i.reject('CodeMirror mode "'+t+'" is not loaded');if(r){var e=b.mimeModes[r];if(!e)return void i.reject('CodeMirror MIME mode "'+r+'" not found')}o._mode=r||t,o._wasModified(),i.resolve(o)};return b.modes[t]?a():e(["thirdparty/CodeMirror2/mode/"+t+"/"+t],a),i.promise()},m.prototype.getFileExtensions=function(){return this._fileExtensions.concat()},m.prototype.getFileNames=function(){return this._fileNames.concat()},m.prototype.addFileExtension=function(e){Array.isArray(e)?e.forEach(this._addFileExtension.bind(this)):this._addFileExtension(e)},m.prototype._addFileExtension=function(e){if("."===e.charAt(0)&&(e=e.substr(1)),e=e.toLowerCase(),-1===this._fileExtensions.indexOf(e)){this._fileExtensions.push(e);var t=R[e];t?console.warn('Cannot register file extension "'+e+'" for '+this._name+", it already belongs to "+t._name):R[e]=this,this._wasModified()}},m.prototype.removeFileExtension=function(e){Array.isArray(e)?e.forEach(this._removeFileExtension.bind(this)):this._removeFileExtension(e)},m.prototype._removeFileExtension=function(e){"."===e.charAt(0)&&(e=e.substr(1)),e=e.toLowerCase();var t=this._fileExtensions.indexOf(e);-1!==t&&(this._fileExtensions.splice(t,1),delete R[e],this._wasModified())},m.prototype.addFileName=function(e){Array.isArray(e)?e.forEach(this._addFileName.bind(this)):this._addFileName(e)},m.prototype._addFileName=function(e){if(e=e.toLowerCase(),-1===this._fileNames.indexOf(e)){this._fileNames.push(e);var t=N[e];t?console.warn('Cannot register file name "'+e+'" for '+this._name+", it already belongs to "+t._name):N[e]=this,this._wasModified()}},m.prototype.removeFileName=function(e){Array.isArray(e)?e.forEach(this._removeFileName.bind(this)):this._removeFileName(e)},m.prototype._removeFileName=function(e){e=e.toLowerCase();var t=this._fileNames.indexOf(e);-1!==t&&(this._fileNames.splice(t,1),delete N[e],this._wasModified())},m.prototype.hasLineCommentSyntax=function(){return this._lineCommentSyntax.length>0},m.prototype.getLineCommentPrefixes=function(){return this._lineCommentSyntax},m.prototype.setLineCommentSyntax=function(e){var t,r=Array.isArray(e)?e:[e];if(r.length){for(this._lineCommentSyntax=[],t=0;t<r.length;t++)n(String(r[t]),Array.isArray(e)?"prefix["+t+"]":"prefix"),this._lineCommentSyntax.push(r[t]);this._wasModified()}else console.error("The prefix array should not be empty");return!0},m.prototype.hasBlockCommentSyntax=function(){return Boolean(this._blockCommentSyntax)},m.prototype.getBlockCommentPrefix=function(){return this._blockCommentSyntax&&this._blockCommentSyntax.prefix},m.prototype.getBlockCommentSuffix=function(){return this._blockCommentSyntax&&this._blockCommentSyntax.suffix},m.prototype.setBlockCommentSyntax=function(e,t){return n(e,"prefix")&&n(t,"suffix")?(this._blockCommentSyntax={prefix:e,suffix:t},this._wasModified(),!0):!1},m.prototype.getLanguageForMode=function(e){return e===this._mode?this:this._modeToLanguageMap[e]||c(e)},m.prototype._setLanguageForMode=function(e,t){return e===this._mode&&t!==this?(console.error("A language must always map its mode to itself"),!1):(this._modeToLanguageMap[e]=t,this._wasModified(),!0)},m.prototype.isFallbackLanguage=function(){return this===T},m.prototype._wasModified=function(){M[this._id]&&d(this)},m.prototype.isBinary=function(){return this._isBinary},m.prototype._setBinary=function(e){this._isBinary=e},S.makeEventDispatcher(t),r(),b.defineMIME("text/x-brackets-html",{name:"htmlmixed",scriptTypes:[{matches:/\/x-handlebars|\/x-mustache|\/ng-template$|^text\/html$/i,mode:null}]}),b.defineMIME("image/svg+xml","xml"),C=JSON.parse(C),E=I.doInParallel(Object.keys(C),function(e){return g(e,C[e])},!1),E.always(function(){var t=o("html");t._setLanguageForMode("xml",t),i("html",t),T=o("unknown"),e(["preferences/PreferencesManager"],function(e){_=e,e.definePreference(P,"object",{}).on("change",function(){y(P)}),e.definePreference(k,"object",{}).on("change",function(){y(k)}),y(P),y(k)})}),t._EXTENSION_MAP_PREF=P,t._NAME_MAP_PREF=k,t._resetPathLanguageOverrides=h,t.ready=E,t.defineLanguage=g,t.getLanguage=o,t.getLanguageForExtension=a,t.getLanguageForPath=s,t.getLanguages=l,t.setLanguageOverrideForPath=p,t.getCompoundFileExtension=f}),define("widgets/DefaultDialogs",["require","exports","module"],function(e,t){"use strict";t.DIALOG_ID_ERROR="error-dialog",t.DIALOG_ID_INFO="error-dialog",t.DIALOG_ID_SAVE_CLOSE="save-close-dialog",t.DIALOG_ID_EXT_CHANGED="ext-changed-dialog",t.DIALOG_ID_EXT_DELETED="ext-deleted-dialog",t.DIALOG_ID_LIVE_DEVELOPMENT="live-development-error-dialog",t.DIALOG_ID_CHANGE_EXTENSIONS="change-marked-extensions"}),define("filesystem/WatchedRoot",["require","exports","module"],function(e,t,n){"use strict";function r(e,t){this.entry=e,this.filter=t}r.INACTIVE=0,r.STARTING=1,r.ACTIVE=2,r.prototype.entry=null,r.prototype.filter=null,r.prototype.status=r.INACTIVE,n.exports=r}),define("filesystem/FileSystemEntry",["require","exports","module","filesystem/FileSystemError","filesystem/WatchedRoot"],function(e,t,n){"use strict";function r(e,t){this._setPath(e),this._fileSystem=t,this._id=l++}var i=e("filesystem/FileSystemError"),o=e("filesystem/WatchedRoot"),a=100,s=3e4,l=0;Object.defineProperties(r.prototype,{fullPath:{get:function(){return this._path},set:function(){throw new Error("Cannot set fullPath")}},name:{get:function(){return this._name},set:function(){throw new Error("Cannot set name")}},parentPath:{get:function(){return this._parentPath},set:function(){throw new Error("Cannot set parentPath")}},id:{get:function(){return this._id},set:function(){throw new Error("Cannot set id")}},isFile:{get:function(){return this._isFile},set:function(){throw new Error("Cannot set isFile")}},isDirectory:{get:function(){return this._isDirectory},set:function(){throw new Error("Cannot set isDirectory")}},_impl:{get:function(){return this._fileSystem._impl},set:function(){throw new Error("Cannot set _impl")}}}),r.prototype._stat=null,r.prototype._fileSystem=null,r.prototype._path=null,r.prototype._name=null,r.prototype._parentPath=null,r.prototype._isFile=!1,r.prototype._isDirectory=!1,r.prototype._watchedRoot=null,r.prototype._watchedRootFilterResult=!1,r.prototype._isWatched=function(e){var t=this._watchedRoot,n=this._watchedRootFilterResult;if(t||(t=this._fileSystem._findWatchedRootForPath(this._path),t&&(this._watchedRoot=t,n=t.filter(this._name,this._parentPath),this._watchedRootFilterResult=n)),t){if(t.status===o.ACTIVE||e&&t.status===o.STARTING)return n;this._watchedRoot=void 0,this._watchedRootFilterResult=!1,this._clearCachedData()}return!1},r.prototype._setPath=function(e){var t=e.split("/");this.isDirectory&&t.pop(),this._name=t[t.length-1],t.pop(),this._parentPath=t.length>0?t.join("/")+"/":null,this._path=e;var n=this._watchedRoot;n&&(0===e.indexOf(n.entry.fullPath)?this._watchedRootFilterResult=n.filter(this._name,this._parentPath):(this._watchedRoot=null,this._watchedRootFilterResult=!1))},r.prototype._clearCachedData=function(){this._stat=void 0},r.prototype.toString=function(){return"["+(this.isDirectory?"Directory ":"File ")+this._path+"]"},r.prototype.exists=function(e){return this._stat?void e(null,!0):void this._impl.exists(this._path,function(t,n){return t?(this._clearCachedData(),void e(t)):(n||this._clearCachedData(),void e(null,n))}.bind(this))},r.prototype.stat=function(e){return this._stat?void e(null,this._stat):void this._impl.stat(this._path,function(t,n){return t?(this._clearCachedData(),void e(t)):(this._isWatched()&&(this._stat=n),void e(null,n))}.bind(this))},r.prototype.rename=function(e,t){t=t||function(){},this._fileSystem._beginChange(),this._impl.rename(this._path,e,function(n){var r=this._path;try{if(n)return this._clearCachedData(),void t(n);this._fileSystem._handleRename(this._path,e,this.isDirectory);try{t(null)}finally{this._fileSystem._fireRenameEvent(r,e)}}finally{this._fileSystem._endChange()}}.bind(this))},r.prototype.unlink=function(e){e=e||function(){},this._fileSystem._beginChange(),this._clearCachedData(),this._impl.unlink(this._path,function(t){var n=this._fileSystem.getDirectoryForPath(this.parentPath);this._fileSystem._handleDirectoryChange(n,function(r,i){try{e(t)}finally{this._fileSystem._fireChangeEvent(n,r,i),this._fileSystem._endChange()}}.bind(this))}.bind(this))},r.prototype.moveToTrash=function(e){return this._impl.moveToTrash?(e=e||function(){},this._fileSystem._beginChange(),this._clearCachedData(),void this._impl.moveToTrash(this._path,function(t){var n=this._fileSystem.getDirectoryForPath(this.parentPath);this._fileSystem._handleDirectoryChange(n,function(r,i){try{e(t)}finally{this._fileSystem._fireChangeEvent(n,r,i),this._fileSystem._endChange()}}.bind(this))}.bind(this))):void this.unlink(e)},r.prototype._visitHelper=function(e,t,n,r,i){var o=r.maxDepth,a=r.maxEntriesCounter;if(a.value--<=0||o--<0)return void i(null);if(this.isDirectory){var s=e.realPath||this.fullPath;if(t.hasOwnProperty(s))return void i(null);t[s]=!0}return!n(this)||this.isFile?void i(null):void this.getContents(function(e,r,s){function l(){0===--c&&i(null)}if(e)return void i(e);var c=r.length;if(0===c)return void i(null);var u={maxDepth:o,maxEntriesCounter:a};r.forEach(function(e,r){var i=s[r];e._visitHelper(i,t,n,u,l)})}.bind(this))},r.prototype.visit=function(e,t,n){"function"==typeof t?(n=t,t={}):(void 0===t&&(t={}),n=n||function(){}),void 0===t.maxDepth&&(t.maxDepth=a),void 0===t.maxEntries&&(t.maxEntries=s),t.maxEntriesCounter={value:t.maxEntries},this.stat(function(r,o){return r?void n(r):void this._visitHelper(o,{},e,t,function(e){if(n){if(e)return void n(e);if(t.maxEntriesCounter.value<0)return void n(i.TOO_MANY_ENTRIES);n(null)}}.bind(this))}.bind(this))},n.exports=r}),define("filesystem/Directory",["require","exports","module","filesystem/FileSystemEntry"],function(e,t,n){"use strict";function r(e,t){this._isDirectory=!0,o.call(this,e,t)}function i(e,t){if(e.length>0){var n=e.pop();try{n.apply(void 0,t)}finally{i(e,t)}}}var o=e("filesystem/FileSystemEntry");r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.parentClass=o.prototype,r.prototype._contents=null,r.prototype._contentsStats=null,r.prototype._contentsStatsErrors=null,r.prototype._clearCachedData=function(e){if(o.prototype._clearCachedData.apply(this),!e)if(this._contents)this._contents.forEach(function(e){e._clearCachedData(!0)});else{var t=this.fullPath;this._fileSystem._index.visitAll(function(e){e.parentPath===t&&e._clearCachedData(!0)})}this._contents=void 0,this._contentsStats=void 0,this._contentsStatsErrors=void 0},r.prototype.getContents=function(e){return this._contentsCallbacks?void this._contentsCallbacks.push(e):this._contents?void e(null,this._contents,this._contentsStats,this._contentsStatsErrors):(this._contentsCallbacks=[e],void this._impl.readdir(this.fullPath,function(e,t,n){var r,o=[],a=[];if(e)this._clearCachedData();else{var s=this._isWatched(!0);t.forEach(function(e,t){var i=this.fullPath+e;if(this._fileSystem._indexFilter(i,e)){var l,c=n[t];"string"==typeof c?(void 0===r&&(r={}),r[i]=c):(l=c.isFile?this._fileSystem.getFileForPath(i):this._fileSystem.getDirectoryForPath(i),s&&(l._stat=c),o.push(l),a.push(c))}},this),s&&(this._contents=o,this._contentsStats=a,this._contentsStatsErrors=r)}var l=this._contentsCallbacks;this._contentsCallbacks=null;var c=[e,o,a,r];i(l,c)}.bind(this)))},r.prototype.create=function(e){e=e||function(){},this._fileSystem._beginChange(),this._impl.mkdir(this._path,function(t,n){if(t){this._clearCachedData();try{return void e(t)}finally{this._fileSystem._endChange()}}var r=this._fileSystem.getDirectoryForPath(this.parentPath);this._isWatched()&&(this._stat=n),this._fileSystem._handleDirectoryChange(r,function(t,i){try{e(null,n)}finally{this._fileSystem._fireChangeEvent(r,t,i),this._fileSystem._endChange()}}.bind(this))}.bind(this))},n.exports=r}),define("filesystem/File",["require","exports","module","filesystem/FileSystemEntry"],function(e,t,n){"use strict";function r(e,t){this._isFile=!0,i.call(this,e,t)}var i=e("filesystem/FileSystemEntry");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.parentClass=i.prototype,r.prototype._contents=null,r.prototype._hash=null,r.prototype._clearCachedData=function(){i.prototype._clearCachedData.apply(this),this._contents=null},r.prototype.read=function(e,t){if("function"==typeof e&&(t=e,e={}),null!==this._contents&&this._stat)return void t(null,this._contents,this._stat);var n=this._isWatched();n&&(e.stat=this._stat),this._impl.readFile(this._path,e,function(e,r,i){return e?(this._clearCachedData(),void t(e)):(this._hash=i._hash,n&&(this._stat=i,this._contents=r),void t(e,r,i))}.bind(this))},r.prototype.write=function(e,t,n){"function"==typeof t?(n=t,t={}):(void 0===t&&(t={}),n=n||function(){}),t.blind||(t.expectedHash=this._hash,t.expectedContents=this._contents),this._fileSystem._beginChange(),this._impl.writeFile(this._path,e,t,function(t,r,i){if(t){this._clearCachedData();try{return void n(t)}finally{this._fileSystem._endChange()}}if(this._hash=r._hash,this._isWatched()&&(this._stat=r,this._contents=e),i){var o=this._fileSystem.getDirectoryForPath(this.parentPath);this._fileSystem._handleDirectoryChange(o,function(e,t){try{n(null,r)}finally{this._fileSystem._fireChangeEvent(o,e,t),this._fileSystem._endChange()}}.bind(this))}else try{n(null,r)}finally{this._fileSystem._fireChangeEvent(this),this._fileSystem._endChange()}}.bind(this))},n.exports=r}),define("filesystem/FileIndex",["require","exports","module"],function(e,t,n){"use strict";function r(){this._index={}}r.prototype._index=null,r.prototype.clear=function(){this._index={}},r.prototype.visitAll=function(e){var t;for(t in this._index)this._index.hasOwnProperty(t)&&e(this._index[t],t)},r.prototype.addEntry=function(e){this._index[e.fullPath]=e},r.prototype.removeEntry=function(e){function t(t){var n=e[t];"function"==typeof n&&(e[t]=function(){return console.warn("FileSystemEntry used after being removed from index: ",r),n.apply(e,arguments)})}var n,r=e.fullPath;delete this._index[r];for(n in e)e.hasOwnProperty(n)&&t(n)},r.prototype.entryRenamed=function(e,t,n){var r,i={};for(r in this._index)this._index.hasOwnProperty(r)&&(n?0===r.indexOf(e):r===e)&&(i[r]=t+r.substr(e.length));for(r in i)if(i.hasOwnProperty(r)){var o=this._index[r];console.assert(o.fullPath===r),delete this._index[r],this._index[i[r]]=o,o._setPath(i[r])}},r.prototype.getEntry=function(e){return this._index[e]},n.exports=r}),define("filesystem/FileSystemStats",["require","exports","module"],function(e,t,n){"use strict";function r(e){var t=e.isFile;this._isFile=t,this._isDirectory=!t,this._mtime=e.mtime,this._size=e.size,this._hash=e.hash;var n=e.realPath;n&&(t||"/"===n[n.length-1]||(n+="/"),this._realPath=n)}Object.defineProperties(r.prototype,{isFile:{get:function(){return this._isFile},set:function(){throw new Error("Cannot set isFile")}},isDirectory:{get:function(){return this._isDirectory},set:function(){throw new Error("Cannot set isDirectory")}},mtime:{get:function(){return this._mtime},set:function(){throw new Error("Cannot set mtime")}},size:{get:function(){return this._size},set:function(){throw new Error("Cannot set size")}},realPath:{get:function(){return this._realPath},set:function(){throw new Error("Cannot set realPath")}}}),r.prototype._isFile=!1,r.prototype._isDirectory=!1,r.prototype._mtime=null,r.prototype._size=null,r.prototype._hash=null,r.prototype._realPath=null,n.exports=r}),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("thirdparty/filer/dist/filer",[],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.Filer=e()}}(function(){var e;return function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return i(n?n:t)},c,c.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,n){(function(t){!function(){var r={};"undefined"!=typeof t&&t.nextTick?(r.nextTick=t.nextTick,r.setImmediate="undefined"!=typeof setImmediate?function(e){setImmediate(e)}:r.nextTick):"function"==typeof setImmediate?(r.nextTick=function(e){setImmediate(e)},r.setImmediate=r.nextTick):(r.nextTick=function(e){setTimeout(e,0)},r.setImmediate=r.nextTick),r.eachSeries=function(e,t,n){if(n=n||function(){},!e.length)return n();var r=0,i=function(){t(e[r],function(t){t?(n(t),n=function(){}):(r+=1,r>=e.length?n():i())})};i()},r.forEachSeries=r.eachSeries,"undefined"!=typeof e&&e.amd?e([],function(){return r}):"undefined"!=typeof n&&n.exports?n.exports=r:root.async=r}()}).call(this,t("JkpR2F"))},{JkpR2F:10}],2:[function(e,t){function n(e,t){for(var n=t.length-1;n>=0;n--)t[n]===e&&t.splice(n,1);
return t}var r=function(){};r.createInterface=function(e){var t={};return t.on=function(t,n){"undefined"==typeof this[e]&&(this[e]={}),this[e].hasOwnProperty(t)||(this[e][t]=[]),this[e][t].push(n)},t.off=function(t,r){"undefined"!=typeof this[e]&&this[e].hasOwnProperty(t)&&n(r,this[e][t])},t.trigger=function(t){if("undefined"!=typeof this[e]&&this[e].hasOwnProperty(t))for(var n=Array.prototype.slice.call(arguments,1),r=0;r<this[e][t].length;r++)this[e][t][r].apply(this[e][t][r],n)},t.removeAllListeners=function(t){if("undefined"!=typeof this[e]){var n=this;n[e][t].forEach(function(e){n.off(t,e)})}},t};var i=r.createInterface("_handlers");r.prototype._on=i.on,r.prototype._off=i.off,r.prototype._trigger=i.trigger;var o=r.createInterface("handlers");r.prototype.on=function(){o.on.apply(this,arguments),Array.prototype.unshift.call(arguments,"on"),this._trigger.apply(this,arguments)},r.prototype.off=o.off,r.prototype.trigger=o.trigger,r.prototype.removeAllListeners=o.removeAllListeners,t.exports=r},{}],3:[function(e,t){(function(n){function r(e,t){var n=0;return function(){var r=Date.now();r-n>e&&(n=r,t.apply(this,arguments))}}function i(e,t){if("undefined"!=typeof e&&e||(e={}),"object"==typeof t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function o(){var e=this,t=Date.now();this.origin=s(),this.lastMessage=t,this.receivedIDs={},this.previousValues={};var r=function(){e._onStorageEvent.apply(e,arguments)};"undefined"!=typeof document&&(document.attachEvent?document.attachEvent("onstorage",r):n.addEventListener("storage",r,!1))}var a=e("./eventemitter.js"),s=e("../src/shared.js").guid,l=function(e){return"undefined"==typeof e||"undefined"==typeof e.localStorage?{getItem:function(){},setItem:function(){},removeItem:function(){}}:e.localStorage}(n);o.prototype._transaction=function(e){function t(){if(!a){var u=Date.now(),p=0|l.getItem(d);if(p&&r>u-p)return s||(o._on("storage",t),s=!0),void(c=setTimeout(t,i));a=!0,l.setItem(d,u),e(),n()}}function n(){s&&o._off("storage",t),c&&clearTimeout(c),l.removeItem(d)}var r=1e3,i=20,o=this,a=!1,s=!1,c=null;t()},o.prototype._cleanup_emit=r(100,function(){var e=this;e._transaction(function(){var e,t=Date.now(),n=t-p,r=0;try{e=JSON.parse(l.getItem(c)||"[]")}catch(i){e=[]}for(var o=e.length-1;o>=0;o--)e[o].timestamp<n&&(e.splice(o,1),r++);r>0&&l.setItem(c,JSON.stringify(e))})}),o.prototype._cleanup_once=r(100,function(){var e=this;e._transaction(function(){var t,n,r=(Date.now(),0);try{n=JSON.parse(l.getItem(u)||"{}")}catch(i){n={}}for(t in n)e._once_expired(t,n)&&(delete n[t],r++);r>0&&l.setItem(u,JSON.stringify(n))})}),o.prototype._once_expired=function(e,t){if(!t)return!0;if(!t.hasOwnProperty(e))return!0;if("object"!=typeof t[e])return!0;var n=t[e].ttl||h,r=Date.now(),i=t[e].timestamp;return r-n>i},o.prototype._localStorageChanged=function(e,t){if(e&&e.key)return e.key===t;var n=l.getItem(t);return n===this.previousValues[t]?!1:(this.previousValues[t]=n,!0)},o.prototype._onStorageEvent=function(e){e=e||n.event;var t=this;this._localStorageChanged(e,c)&&this._transaction(function(){var e,n=Date.now(),r=l.getItem(c);try{e=JSON.parse(r||"[]")}catch(i){e=[]}for(var o=0;o<e.length;o++)if(e[o].origin!==t.origin&&!(e[o].timestamp<t.lastMessage)){if(e[o].id){if(t.receivedIDs.hasOwnProperty(e[o].id))continue;t.receivedIDs[e[o].id]=!0}t.trigger(e[o].name,e[o].payload)}t.lastMessage=n}),this._trigger("storage",e)},o.prototype._emit=function(e,t,n){if(n="string"==typeof n||"number"==typeof n?String(n):null,n&&n.length){if(this.receivedIDs.hasOwnProperty(n))return;this.receivedIDs[n]=!0}var r={id:n,name:e,origin:this.origin,timestamp:Date.now(),payload:t},i=this;this._transaction(function(){var n=l.getItem(c)||"[]",o="[]"===n?"":",";n=[n.substring(0,n.length-1),o,JSON.stringify(r),"]"].join(""),l.setItem(c,n),i.trigger(e,t),setTimeout(function(){i._cleanup_emit()},50)})},o.prototype.emit=function(e,t){this._emit.apply(this,arguments),this._trigger("emit",e,t)},o.prototype.once=function(e,t,n){if(o.supported){var r=this;this._transaction(function(){var i;try{i=JSON.parse(l.getItem(u)||"{}")}catch(o){i={}}r._once_expired(e,i)&&(i[e]={},i[e].timestamp=Date.now(),"number"==typeof n&&(i[e].ttl=1e3*n),l.setItem(u,JSON.stringify(i)),t(),setTimeout(function(){r._cleanup_once()},50))})}},i(o.prototype,a.prototype),o.supported="undefined"!=typeof l;var c="intercom",u="intercom_once",d="intercom_lock",p=5e4,h=36e5;o.destroy=function(){l.removeItem(d),l.removeItem(c),l.removeItem(u)},o.getInstance=function(){var e;return function(){return e||(e=new o),e}}(),t.exports=o}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../src/shared.js":30,"./eventemitter.js":2}],4:[function(e,t){function n(e,t){return m.call(e,t)}function r(e){return null==e?0:e.length===+e.length?e.length:y(e).length}function i(e){return e}function o(e,t,n){var r,i;if(null!=e)if(d&&e.forEach===d)e.forEach(t,n);else if(e.length===+e.length){for(r=0,i=e.length;i>r;r++)if(t.call(n,e[r],r,e)===v)return}else{var o=o(e);for(r=0,i=o.length;i>r;r++)if(t.call(n,e[o[r]],o[r],e)===v)return}}function a(e,t,n){t||(t=i);var r=!1;return null==e?r:h&&e.some===h?e.some(t,n):(o(e,function(e,i,o){return r||(r=t.call(n,e,i,o))?v:void 0}),!!r)}function s(e,t){return null==e?!1:p&&e.indexOf===p?-1!=e.indexOf(t):a(e,function(e){return e===t})}function l(e){this.value=e}function c(e){return e&&"object"==typeof e&&!Array.isArray(e)&&m.call(e,"__wrapped__")?e:new l(e)}var u=Array.prototype,d=u.forEach,p=u.indexOf,h=u.some,f=Object.prototype,m=f.hasOwnProperty,g=Object.keys,v={},y=g||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var r in e)n(e,r)&&t.push(r);return t};l.prototype.has=function(e){return n(this.value,e)},l.prototype.contains=function(e){return s(this.value,e)},l.prototype.size=function(){return r(this.value)},t.exports=c},{}],5:[function(e,t,n){!function(e){"use strict";n.encode=function(t){var n,r=new Uint8Array(t),i=r.length,o="";for(n=0;i>n;n+=3)o+=e[r[n]>>2],o+=e[(3&r[n])<<4|r[n+1]>>4],o+=e[(15&r[n+1])<<2|r[n+2]>>6],o+=e[63&r[n+2]];return i%3===2?o=o.substring(0,o.length-1)+"=":i%3===1&&(o=o.substring(0,o.length-2)+"=="),o},n.decode=function(t){var n,r,i,o,a,s=.75*t.length,l=t.length,c=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var u=new ArrayBuffer(s),d=new Uint8Array(u);for(n=0;l>n;n+=4)r=e.indexOf(t[n]),i=e.indexOf(t[n+1]),o=e.indexOf(t[n+2]),a=e.indexOf(t[n+3]),d[c++]=r<<2|i>>4,d[c++]=(15&i)<<4|o>>2,d[c++]=(3&o)<<6|63&a;return u}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],6:[function(e,t,n){function r(e,t,n){if(!(this instanceof r))return new r(e,t,n);var i=typeof e;"base64"===t&&"string"===i&&(e=O(e));var o;if("number"===i)o=R(e);else if("string"===i)o=r.byteLength(e,t);else{if("object"!==i)throw new Error("First argument needs to be a number, array or string.");o=R(e.length)}var a;r._useTypedArrays?a=r._augment(new Uint8Array(o)):(a=this,a.length=o,a._isBuffer=!0);var s;if(r._useTypedArrays&&"number"==typeof e.byteLength)a._set(e);else if(x(e))if(r.isBuffer(e))for(s=0;o>s;s++)a[s]=e.readUInt8(s);else for(s=0;o>s;s++)a[s]=(e[s]%256+256)%256;else if("string"===i)a.write(e,0,t);else if("number"===i&&!r._useTypedArrays&&!n)for(s=0;o>s;s++)a[s]=0;return a}function i(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;var o=t.length;W(o%2===0,"Invalid hex string"),r>o/2&&(r=o/2);for(var a=0;r>a;a++){var s=parseInt(t.substr(2*a,2),16);W(!isNaN(s),"Invalid hex string"),e[n+a]=s}return a}function o(e,t,n,r){var i=j(P(t),e,n,r);return i}function a(e,t,n,r){var i=j(k(t),e,n,r);return i}function s(e,t,n,r){return a(e,t,n,r)}function l(e,t,n,r){var i=j(U(t),e,n,r);return i}function c(e,t,n,r){var i=j(F(t),e,n,r);return i}function u(e,t,n){return G.fromByteArray(0===t&&n===e.length?e:e.slice(t,n))}function d(e,t,n){var r="",i="";n=Math.min(e.length,n);for(var o=t;n>o;o++)e[o]<=127?(r+=$(i)+String.fromCharCode(e[o]),i=""):i+="%"+e[o].toString(16);return r+$(i)}function p(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;n>i;i++)r+=String.fromCharCode(e[i]);return r}function h(e,t,n){return p(e,t,n)}function f(e,t,n){var r=e.length;(!t||0>t)&&(t=0),(!n||0>n||n>r)&&(n=r);for(var i="",o=t;n>o;o++)i+=A(e[o]);return i}function m(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function g(e,t,n,r){r||(W("boolean"==typeof n,"missing or invalid endian"),W(void 0!==t&&null!==t,"missing offset"),W(t+1<e.length,"Trying to read beyond buffer length"));var i=e.length;if(!(t>=i)){var o;return n?(o=e[t],i>t+1&&(o|=e[t+1]<<8)):(o=e[t]<<8,i>t+1&&(o|=e[t+1])),o}}function v(e,t,n,r){r||(W("boolean"==typeof n,"missing or invalid endian"),W(void 0!==t&&null!==t,"missing offset"),W(t+3<e.length,"Trying to read beyond buffer length"));var i=e.length;if(!(t>=i)){var o;return n?(i>t+2&&(o=e[t+2]<<16),i>t+1&&(o|=e[t+1]<<8),o|=e[t],i>t+3&&(o+=e[t+3]<<24>>>0)):(i>t+1&&(o=e[t+1]<<16),i>t+2&&(o|=e[t+2]<<8),i>t+3&&(o|=e[t+3]),o+=e[t]<<24>>>0),o}}function y(e,t,n,r){r||(W("boolean"==typeof n,"missing or invalid endian"),W(void 0!==t&&null!==t,"missing offset"),W(t+1<e.length,"Trying to read beyond buffer length"));var i=e.length;if(!(t>=i)){var o=g(e,t,n,!0),a=32768&o;return a?-1*(65535-o+1):o}}function _(e,t,n,r){r||(W("boolean"==typeof n,"missing or invalid endian"),W(void 0!==t&&null!==t,"missing offset"),W(t+3<e.length,"Trying to read beyond buffer length"));var i=e.length;if(!(t>=i)){var o=v(e,t,n,!0),a=2147483648&o;return a?-1*(4294967295-o+1):o}}function E(e,t,n,r){return r||(W("boolean"==typeof n,"missing or invalid endian"),W(t+3<e.length,"Trying to read beyond buffer length")),K.read(e,t,n,23,4)}function b(e,t,n,r){return r||(W("boolean"==typeof n,"missing or invalid endian"),W(t+7<e.length,"Trying to read beyond buffer length")),K.read(e,t,n,52,8)}function S(e,t,n,r,i){i||(W(void 0!==t&&null!==t,"missing value"),W("boolean"==typeof r,"missing or invalid endian"),W(void 0!==n&&null!==n,"missing offset"),W(n+1<e.length,"trying to write beyond buffer length"),V(t,65535));var o=e.length;if(!(n>=o)){for(var a=0,s=Math.min(o-n,2);s>a;a++)e[n+a]=(t&255<<8*(r?a:1-a))>>>8*(r?a:1-a);return n+2}}function I(e,t,n,r,i){i||(W(void 0!==t&&null!==t,"missing value"),W("boolean"==typeof r,"missing or invalid endian"),W(void 0!==n&&null!==n,"missing offset"),W(n+3<e.length,"trying to write beyond buffer length"),V(t,4294967295));var o=e.length;if(!(n>=o)){for(var a=0,s=Math.min(o-n,4);s>a;a++)e[n+a]=t>>>8*(r?a:3-a)&255;return n+4}}function w(e,t,n,r,i){i||(W(void 0!==t&&null!==t,"missing value"),W("boolean"==typeof r,"missing or invalid endian"),W(void 0!==n&&null!==n,"missing offset"),W(n+1<e.length,"Trying to write beyond buffer length"),B(t,32767,-32768));var o=e.length;if(!(n>=o))return t>=0?S(e,t,n,r,i):S(e,65535+t+1,n,r,i),n+2}function C(e,t,n,r,i){i||(W(void 0!==t&&null!==t,"missing value"),W("boolean"==typeof r,"missing or invalid endian"),W(void 0!==n&&null!==n,"missing offset"),W(n+3<e.length,"Trying to write beyond buffer length"),B(t,2147483647,-2147483648));var o=e.length;if(!(n>=o))return t>=0?I(e,t,n,r,i):I(e,4294967295+t+1,n,r,i),n+4}function D(e,t,n,r,i){i||(W(void 0!==t&&null!==t,"missing value"),W("boolean"==typeof r,"missing or invalid endian"),W(void 0!==n&&null!==n,"missing offset"),W(n+3<e.length,"Trying to write beyond buffer length"),H(t,3.4028234663852886e38,-3.4028234663852886e38));var o=e.length;if(!(n>=o))return K.write(e,t,n,r,23,4),n+4}function T(e,t,n,r,i){i||(W(void 0!==t&&null!==t,"missing value"),W("boolean"==typeof r,"missing or invalid endian"),W(void 0!==n&&null!==n,"missing offset"),W(n+7<e.length,"Trying to write beyond buffer length"),H(t,1.7976931348623157e308,-1.7976931348623157e308));var o=e.length;if(!(n>=o))return K.write(e,t,n,r,52,8),n+8}function O(e){for(e=M(e).replace(z,"");e.length%4!==0;)e+="=";return e}function M(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function L(e,t,n){return"number"!=typeof e?n:(e=~~e,e>=t?t:e>=0?e:(e+=t,e>=0?e:0))}function R(e){return e=~~Math.ceil(+e),0>e?0:e}function N(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function x(e){return N(e)||r.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}function A(e){return 16>e?"0"+e.toString(16):e.toString(16)}function P(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(127>=r)t.push(r);else{var i=n;r>=55296&&57343>=r&&n++;for(var o=encodeURIComponent(e.slice(i,n+1)).substr(1).split("%"),a=0;a<o.length;a++)t.push(parseInt(o[a],16))}}return t}function k(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}function F(e){for(var t,n,r,i=[],o=0;o<e.length;o++)t=e.charCodeAt(o),n=t>>8,r=t%256,i.push(r),i.push(n);return i}function U(e){return G.toByteArray(e)}function j(e,t,n,r){for(var i=0;r>i&&!(i+n>=t.length||i>=e.length);i++)t[i+n]=e[i];return i}function $(e){try{return decodeURIComponent(e)}catch(t){return String.fromCharCode(65533)}}function V(e,t){W("number"==typeof e,"cannot write a non-number as a number"),W(e>=0,"specified a negative value for writing an unsigned value"),W(t>=e,"value is larger than maximum value for type"),W(Math.floor(e)===e,"value has a fractional component")}function B(e,t,n){W("number"==typeof e,"cannot write a non-number as a number"),W(t>=e,"value larger than maximum allowed value"),W(e>=n,"value smaller than minimum allowed value"),W(Math.floor(e)===e,"value has a fractional component")}function H(e,t,n){W("number"==typeof e,"cannot write a non-number as a number"),W(t>=e,"value larger than maximum allowed value"),W(e>=n,"value smaller than minimum allowed value")}function W(e,t){if(!e)throw new Error(t||"Failed assertion")}var G=e("base64-js"),K=e("ieee754");n.Buffer=r,n.SlowBuffer=r,n.INSPECT_MAX_BYTES=50,r.poolSize=8192,r._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray}catch(n){return!1}}(),r.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.isBuffer=function(e){return!(null===e||void 0===e||!e._isBuffer)},r.byteLength=function(e,t){var n;switch(e=e.toString(),t||"utf8"){case"hex":n=e.length/2;break;case"utf8":case"utf-8":n=P(e).length;break;case"ascii":case"binary":case"raw":n=e.length;break;case"base64":n=U(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*e.length;break;default:throw new Error("Unknown encoding")}return n},r.concat=function(e,t){if(W(N(e),"Usage: Buffer.concat(list[, length])"),0===e.length)return new r(0);if(1===e.length)return e[0];var n;if(void 0===t)for(t=0,n=0;n<e.length;n++)t+=e[n].length;var i=new r(t),o=0;for(n=0;n<e.length;n++){var a=e[n];a.copy(i,o),o+=a.length}return i},r.compare=function(e,t){W(r.isBuffer(e)&&r.isBuffer(t),"Arguments must be Buffers");for(var n=e.length,i=t.length,o=0,a=Math.min(n,i);a>o&&e[o]===t[o];o++);return o!==a&&(n=e[o],i=t[o]),i>n?-1:n>i?1:0},r.prototype.write=function(e,t,n,r){if(isFinite(t))isFinite(n)||(r=n,n=void 0);else{var u=r;r=t,t=n,n=u}t=Number(t)||0;var d=this.length-t;n?(n=Number(n),n>d&&(n=d)):n=d,r=String(r||"utf8").toLowerCase();var p;switch(r){case"hex":p=i(this,e,t,n);break;case"utf8":case"utf-8":p=o(this,e,t,n);break;case"ascii":p=a(this,e,t,n);break;case"binary":p=s(this,e,t,n);break;case"base64":p=l(this,e,t,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":p=c(this,e,t,n);break;default:throw new Error("Unknown encoding")}return p},r.prototype.toString=function(e,t,n){var r=this;if(e=String(e||"utf8").toLowerCase(),t=Number(t)||0,n=void 0===n?r.length:Number(n),n===t)return"";var i;switch(e){case"hex":i=f(r,t,n);break;case"utf8":case"utf-8":i=d(r,t,n);break;case"ascii":i=p(r,t,n);break;case"binary":i=h(r,t,n);break;case"base64":i=u(r,t,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":i=m(r,t,n);break;default:throw new Error("Unknown encoding")}return i},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},r.prototype.equals=function(e){return W(r.isBuffer(e),"Argument must be a Buffer"),0===r.compare(this,e)},r.prototype.compare=function(e){return W(r.isBuffer(e),"Argument must be a Buffer"),r.compare(this,e)},r.prototype.copy=function(e,t,n,i){var o=this;if(n||(n=0),i||0===i||(i=this.length),t||(t=0),i!==n&&0!==e.length&&0!==o.length){W(i>=n,"sourceEnd < sourceStart"),W(t>=0&&t<e.length,"targetStart out of bounds"),W(n>=0&&n<o.length,"sourceStart out of bounds"),W(i>=0&&i<=o.length,"sourceEnd out of bounds"),i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var a=i-n;if(100>a||!r._useTypedArrays)for(var s=0;a>s;s++)e[s+t]=this[s+n];else e._set(this.subarray(n,n+a),t)}},r.prototype.slice=function(e,t){var n=this.length;if(e=L(e,n,0),t=L(t,n,n),r._useTypedArrays)return r._augment(this.subarray(e,t));for(var i=t-e,o=new r(i,void 0,!0),a=0;i>a;a++)o[a]=this[a+e];return o},r.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},r.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},r.prototype.readUInt8=function(e,t){return t||(W(void 0!==e&&null!==e,"missing offset"),W(e<this.length,"Trying to read beyond buffer length")),e>=this.length?void 0:this[e]},r.prototype.readUInt16LE=function(e,t){return g(this,e,!0,t)},r.prototype.readUInt16BE=function(e,t){return g(this,e,!1,t)},r.prototype.readUInt32LE=function(e,t){return v(this,e,!0,t)},r.prototype.readUInt32BE=function(e,t){return v(this,e,!1,t)},r.prototype.readInt8=function(e,t){if(t||(W(void 0!==e&&null!==e,"missing offset"),W(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length)){var n=128&this[e];return n?-1*(255-this[e]+1):this[e]}},r.prototype.readInt16LE=function(e,t){return y(this,e,!0,t)},r.prototype.readInt16BE=function(e,t){return y(this,e,!1,t)},r.prototype.readInt32LE=function(e,t){return _(this,e,!0,t)},r.prototype.readInt32BE=function(e,t){return _(this,e,!1,t)},r.prototype.readFloatLE=function(e,t){return E(this,e,!0,t)},r.prototype.readFloatBE=function(e,t){return E(this,e,!1,t)},r.prototype.readDoubleLE=function(e,t){return b(this,e,!0,t)},r.prototype.readDoubleBE=function(e,t){return b(this,e,!1,t)},r.prototype.writeUInt8=function(e,t,n){return n||(W(void 0!==e&&null!==e,"missing value"),W(void 0!==t&&null!==t,"missing offset"),W(t<this.length,"trying to write beyond buffer length"),V(e,255)),t>=this.length?void 0:(this[t]=e,t+1)},r.prototype.writeUInt16LE=function(e,t,n){return S(this,e,t,!0,n)},r.prototype.writeUInt16BE=function(e,t,n){return S(this,e,t,!1,n)},r.prototype.writeUInt32LE=function(e,t,n){return I(this,e,t,!0,n)},r.prototype.writeUInt32BE=function(e,t,n){return I(this,e,t,!1,n)},r.prototype.writeInt8=function(e,t,n){return n||(W(void 0!==e&&null!==e,"missing value"),W(void 0!==t&&null!==t,"missing offset"),W(t<this.length,"Trying to write beyond buffer length"),B(e,127,-128)),t>=this.length?void 0:(e>=0?this.writeUInt8(e,t,n):this.writeUInt8(255+e+1,t,n),t+1)},r.prototype.writeInt16LE=function(e,t,n){return w(this,e,t,!0,n)},r.prototype.writeInt16BE=function(e,t,n){return w(this,e,t,!1,n)},r.prototype.writeInt32LE=function(e,t,n){return C(this,e,t,!0,n)},r.prototype.writeInt32BE=function(e,t,n){return C(this,e,t,!1,n)},r.prototype.writeFloatLE=function(e,t,n){return D(this,e,t,!0,n)},r.prototype.writeFloatBE=function(e,t,n){return D(this,e,t,!1,n)},r.prototype.writeDoubleLE=function(e,t,n){return T(this,e,t,!0,n)},r.prototype.writeDoubleBE=function(e,t,n){return T(this,e,t,!1,n)},r.prototype.fill=function(e,t,n){if(e||(e=0),t||(t=0),n||(n=this.length),W(n>=t,"end < start"),n!==t&&0!==this.length){W(t>=0&&t<this.length,"start out of bounds"),W(n>=0&&n<=this.length,"end out of bounds");var r;if("number"==typeof e)for(r=t;n>r;r++)this[r]=e;else{var i=P(e.toString()),o=i.length;for(r=t;n>r;r++)this[r]=i[r%o]}return this}},r.prototype.inspect=function(){for(var e=[],t=this.length,r=0;t>r;r++)if(e[r]=A(this[r]),r===n.INSPECT_MAX_BYTES){e[r+1]="...";break}return"<Buffer "+e.join(" ")+">"},r.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(r._useTypedArrays)return new r(this).buffer;for(var e=new Uint8Array(this.length),t=0,n=e.length;n>t;t+=1)e[t]=this[t];return e.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var q=r.prototype;r._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=q.get,e.set=q.set,e.write=q.write,e.toString=q.toString,e.toLocaleString=q.toString,e.toJSON=q.toJSON,e.equals=q.equals,e.compare=q.compare,e.copy=q.copy,e.slice=q.slice,e.readUInt8=q.readUInt8,e.readUInt16LE=q.readUInt16LE,e.readUInt16BE=q.readUInt16BE,e.readUInt32LE=q.readUInt32LE,e.readUInt32BE=q.readUInt32BE,e.readInt8=q.readInt8,e.readInt16LE=q.readInt16LE,e.readInt16BE=q.readInt16BE,e.readInt32LE=q.readInt32LE,e.readInt32BE=q.readInt32BE,e.readFloatLE=q.readFloatLE,e.readFloatBE=q.readFloatBE,e.readDoubleLE=q.readDoubleLE,e.readDoubleBE=q.readDoubleBE,e.writeUInt8=q.writeUInt8,e.writeUInt16LE=q.writeUInt16LE,e.writeUInt16BE=q.writeUInt16BE,e.writeUInt32LE=q.writeUInt32LE,e.writeUInt32BE=q.writeUInt32BE,e.writeInt8=q.writeInt8,e.writeInt16LE=q.writeInt16LE,e.writeInt16BE=q.writeInt16BE,e.writeInt32LE=q.writeInt32LE,e.writeInt32BE=q.writeInt32BE,e.writeFloatLE=q.writeFloatLE,e.writeFloatBE=q.writeFloatBE,e.writeDoubleLE=q.writeDoubleLE,e.writeDoubleBE=q.writeDoubleBE,e.fill=q.fill,e.inspect=q.inspect,e.toArrayBuffer=q.toArrayBuffer,e};var z=/[^+\/0-9A-z]/g},{"base64-js":7,ieee754:8}],7:[function(e,t,n){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(e){"use strict";function t(e){var t=e.charCodeAt(0);return t===a?62:t===s?63:l>t?-1:l+10>t?t-l+26+26:u+26>t?t-u:c+26>t?t-c+26:void 0}function n(e){function n(e){c[d++]=e}var r,i,a,s,l,c;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var u=e.length;l="="===e.charAt(u-2)?2:"="===e.charAt(u-1)?1:0,c=new o(3*e.length/4-l),a=l>0?e.length-4:e.length;var d=0;for(r=0,i=0;a>r;r+=4,i+=3)s=t(e.charAt(r))<<18|t(e.charAt(r+1))<<12|t(e.charAt(r+2))<<6|t(e.charAt(r+3)),n((16711680&s)>>16),n((65280&s)>>8),n(255&s);return 2===l?(s=t(e.charAt(r))<<2|t(e.charAt(r+1))>>4,n(255&s)):1===l&&(s=t(e.charAt(r))<<10|t(e.charAt(r+1))<<4|t(e.charAt(r+2))>>2,n(s>>8&255),n(255&s)),c}function i(e){function t(e){return r.charAt(e)}function n(e){return t(e>>18&63)+t(e>>12&63)+t(e>>6&63)+t(63&e)}var i,o,a,s=e.length%3,l="";for(i=0,a=e.length-s;a>i;i+=3)o=(e[i]<<16)+(e[i+1]<<8)+e[i+2],l+=n(o);switch(s){case 1:o=e[e.length-1],l+=t(o>>2),l+=t(o<<4&63),l+="==";break;case 2:o=(e[e.length-2]<<8)+e[e.length-1],l+=t(o>>10),l+=t(o>>4&63),l+=t(o<<2&63),l+="="}return l}var o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="+".charCodeAt(0),s="/".charCodeAt(0),l="0".charCodeAt(0),c="a".charCodeAt(0),u="A".charCodeAt(0);e.toByteArray=n,e.fromByteArray=i}("undefined"==typeof n?this.base64js={}:n)},{}],8:[function(e,t,n){n.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,l=(1<<s)-1,c=l>>1,u=-7,d=n?i-1:0,p=n?-1:1,h=e[t+d];for(d+=p,o=h&(1<<-u)-1,h>>=-u,u+=s;u>0;o=256*o+e[t+d],d+=p,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=r;u>0;a=256*a+e[t+d],d+=p,u-=8);if(0===o)o=1-c;else{if(o===l)return a?0/0:1/0*(h?-1:1);a+=Math.pow(2,r),o-=c}return(h?-1:1)*a*Math.pow(2,o-r)},n.write=function(e,t,n,r,i,o){var a,s,l,c=8*o-i-1,u=(1<<c)-1,d=u>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,f=r?1:-1,m=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||1/0===t?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),t+=a+d>=1?p/l:p*Math.pow(2,1-d),t*l>=2&&(a++,l/=2),a+d>=u?(s=0,a=u):a+d>=1?(s=(t*l-1)*Math.pow(2,i),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),a=0));i>=8;e[n+h]=255&s,h+=f,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[n+h]=255&a,h+=f,a/=256,c-=8);e[n+h-f]|=128*m}},{}],9:[function(e,t,n){(function(e){function t(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function r(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(e){return i.exec(e).slice(1)};n.resolve=function(){for(var n="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var a=o>=0?arguments[o]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(n=a+"/"+n,i="/"===a.charAt(0))}return n=t(r(n.split("/"),function(e){return!!e}),!i).join("/"),(i?"/":"")+n||"."},n.normalize=function(e){var i=n.isAbsolute(e),o="/"===a(e,-1);return e=t(r(e.split("/"),function(e){return!!e}),!i).join("/"),e||i||(e="."),e&&o&&(e+="/"),(i?"/":"")+e},n.isAbsolute=function(e){return"/"===e.charAt(0)},n.join=function(){var e=Array.prototype.slice.call(arguments,0);return n.normalize(r(e,function(e){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},n.relative=function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=n.resolve(e).substr(1),t=n.resolve(t).substr(1);for(var i=r(e.split("/")),o=r(t.split("/")),a=Math.min(i.length,o.length),s=a,l=0;a>l;l++)if(i[l]!==o[l]){s=l;break}for(var c=[],l=s;l<i.length;l++)c.push("..");return c=c.concat(o.slice(s)),c.join("/")},n.sep="/",n.delimiter=":",n.dirname=function(e){var t=o(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},n.basename=function(e,t){var n=o(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},n.extname=function(e){return o(e)[3]};var a="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return 0>t&&(t=e.length+t),e.substr(t,n)}}).call(this,e("JkpR2F"))},{JkpR2F:10}],10:[function(e,t){function n(){}var r=t.exports={};r.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=n,r.addListener=n,r.once=n,r.off=n,r.removeListener=n,r.removeAllListeners=n,r.emit=n,r.binding=function(){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(){throw new Error("process.chdir is not supported")}},{}],11:[function(e,t){(function(n){!function(e,t,n,r){function i(e){return e.split("").reduce(function(e,t){return e[t]=!0,e},{})}function o(e,t){return t=t||{},function(n){return s(n,e,t)}}function a(e,t){e=e||{},t=t||{};var n={};return Object.keys(t).forEach(function(e){n[e]=t[e]}),Object.keys(e).forEach(function(t){n[t]=e[t]}),n}function s(e,t,n){if("string"!=typeof t)throw new TypeError("glob pattern string required");return n||(n={}),n.nocomment||"#"!==t.charAt(0)?""===t.trim()?""===e:new l(t,n).match(e):!1}function l(e,t){if(!(this instanceof l))return new l(e,t,_);if("string"!=typeof e)throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),"win32"===r&&(e=e.split("\\").join("/"));var n=e+"\n"+b(t),i=s.cache.get(n);return i?i:(s.cache.set(n,this),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,void this.make())}function c(){if(!this._made){var e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();var n=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error),this.debug(this.pattern,n),n=this.globParts=n.map(function(e){return e.split(T)}),this.debug(this.pattern,n),n=n.map(function(e){return e.map(this.parse,this)},this),this.debug(this.pattern,n),n=n.filter(function(e){return-1===e.indexOf(!1)}),this.debug(this.pattern,n),this.set=n}}function u(){var e=this.pattern,t=!1,n=this.options,r=0;if(!n.nonegate){for(var i=0,o=e.length;o>i&&"!"===e.charAt(i);i++)t=!t,r++;r&&(this.pattern=e.substr(r)),this.negate=t}}function d(e,t,n){return n=n||"0",e+="",e.length>=t?e:new Array(t-e.length+1).join(n)+e}function p(e,t){function n(){_.push(I),I=""}if(t=t||this.options,e="undefined"==typeof e?this.pattern:e,"undefined"==typeof e)throw new Error("undefined pattern");if(t.nobrace||!e.match(/\{.*\}/))return[e];var r=!1;if("{"!==e.charAt(0)){this.debug(e);for(var i=null,o=0,a=e.length;a>o;o++){var s=e.charAt(o);if(this.debug(o,s),"\\"===s)r=!r;else if("{"===s&&!r){i=e.substr(0,o);break}}if(null===i)return this.debug("no sets"),[e];var l=p.call(this,e.substr(o),t);return l.map(function(e){return i+e})}var c=e.match(/^\{(-?[0-9]+)\.\.(-?[0-9]+)\}/);if(c){this.debug("numset",c[1],c[2]);for(var u,h=p.call(this,e.substr(c[0].length),t),f=+c[1],m="0"===c[1][0],g=c[1].length,v=+c[2],y=f>v?-1:1,_=[],o=f;o!=v+y;o+=y){u=m?d(o,g):o+"";for(var E=0,b=h.length;b>E;E++)_.push(u+h[E])}return _}var o=1,S=1,_=[],I="",r=!1;this.debug("Entering for");e:for(o=1,a=e.length;a>o;o++){var s=e.charAt(o);if(this.debug("",o,s),r)r=!1,I+="\\"+s;else switch(s){case"\\":r=!0;continue;case"{":S++,I+="{";continue;case"}":if(S--,0===S){n(),o++;break e}I+=s;continue;case",":1===S?n():I+=s;continue;default:I+=s;continue}}if(0!==S)return this.debug("didn't close",e),p.call(this,"\\"+e,t);this.debug("set",_),this.debug("suffix",e.substr(o));var h=p.call(this,e.substr(o),t),w=1===_.length;this.debug("set pre-expanded",_),_=_.map(function(e){return p.call(this,e,t)},this),this.debug("set expanded",_),_=_.reduce(function(e,t){return e.concat(t)}),w&&(_=_.map(function(e){return"{"+e+"}"}));for(var C=[],o=0,a=_.length;a>o;o++)for(var E=0,b=h.length;b>E;E++)C.push(_[o]+h[E]);return C}function h(e,t){function n(){if(o){switch(o){case"*":s+=I,l=!0;break;case"?":s+=S,l=!0;break;default:s+="\\"+o}m.debug("clearStateChar %j %j",o,s),o=!1}}var r=this.options;if(!r.noglobstar&&"**"===e)return E;if(""===e)return"";for(var i,o,a,s="",l=!!r.nocase,c=!1,u=[],d=!1,p=-1,h=-1,f="."===e.charAt(0)?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",m=this,v=0,y=e.length;y>v&&(a=e.charAt(v));v++)if(this.debug("%s	%s %s %j",e,v,s,a),c&&D[a])s+="\\"+a,c=!1;else switch(a){case"/":return!1;case"\\":n(),c=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,v,s,a),d){this.debug("  in class"),"!"===a&&v===h+1&&(a="^"),s+=a;continue}m.debug("call clearStateChar %j",o),n(),o=a,r.noext&&n();continue;case"(":if(d){s+="(";continue}if(!o){s+="\\(";continue}i=o,u.push({type:i,start:v-1,reStart:s.length}),s+="!"===o?"(?:(?!":"(?:",this.debug("plType %j %j",o,s),o=!1;continue;case")":if(d||!u.length){s+="\\)";continue}switch(n(),l=!0,s+=")",i=u.pop().type){case"!":s+="[^/]*?)";break;case"?":case"+":case"*":s+=i;case"@":}continue;case"|":if(d||!u.length||c){s+="\\|",c=!1;continue}n(),s+="|";continue;case"[":if(n(),d){s+="\\"+a;continue}d=!0,h=v,p=s.length,s+=a;continue;case"]":if(v===h+1||!d){s+="\\"+a,c=!1;continue}l=!0,d=!1,s+=a;continue;default:n(),c?c=!1:!D[a]||"^"===a&&d||(s+="\\"),s+=a}if(d){var _=e.substr(h+1),b=this.parse(_,O);s=s.substr(0,p)+"\\["+b[0],l=l||b[1]}for(var w;w=u.pop();){var C=s.slice(w.reStart+3);C=C.replace(/((?:\\{2})*)(\\?)\|/g,function(e,t,n){return n||(n="\\"),t+t+n+"|"}),this.debug("tail=%j\n   %s",C,C);var T="*"===w.type?I:"?"===w.type?S:"\\"+w.type;l=!0,s=s.slice(0,w.reStart)+T+"\\("+C}n(),c&&(s+="\\\\");var M=!1;switch(s.charAt(0)){case".":case"[":case"(":M=!0
}if(""!==s&&l&&(s="(?=.)"+s),M&&(s=f+s),t===O)return[s,l];if(!l)return g(e);var L=r.nocase?"i":"",R=new RegExp("^"+s+"$",L);return R._glob=e,R._src=s,R}function f(){if(this.regexp||this.regexp===!1)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1;var t=this.options,n=t.noglobstar?I:t.dot?w:C,r=t.nocase?"i":"",i=e.map(function(e){return e.map(function(e){return e===E?n:"string"==typeof e?v(e):e._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{return this.regexp=new RegExp(i,r)}catch(o){return this.regexp=!1}}function m(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var n=this.options;"win32"===r&&(e=e.split("\\").join("/")),e=e.split(T),this.debug(this.pattern,"split",e);var i=this.set;this.debug(this.pattern,"set",i);for(var o,a=e.length-1;a>=0&&!(o=e[a]);a--);for(var a=0,s=i.length;s>a;a++){var l=i[a],c=e;n.matchBase&&1===l.length&&(c=[o]);var u=this.matchOne(c,l,t);if(u)return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}function g(e){return e.replace(/\\(.)/g,"$1")}function v(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}n?n.exports=s:t.minimatch=s,e||(e=function(e){switch(e){case"sigmund":return function(e){return JSON.stringify(e)};case"path":return{basename:function(e){e=e.split(/[\/\\]/);var t=e.pop();return t||(t=e.pop()),t}};case"lru-cache":return function(){var e={},t=0;this.set=function(n,r){t++,t>=100&&(e={}),e[n]=r},this.get=function(t){return e[t]}}}}),s.Minimatch=l;var y=e("lru-cache"),_=s.cache=new y({max:100}),E=s.GLOBSTAR=l.GLOBSTAR={},b=e("sigmund"),S=(e("path"),"[^/]"),I=S+"*?",w="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",C="(?:(?!(?:\\/|^)\\.).)*?",D=i("().*{}+?[]^$\\!"),T=/\/+/;s.filter=o,s.defaults=function(e){if(!e||!Object.keys(e).length)return s;var t=s,n=function(n,r,i){return t.minimatch(n,r,a(e,i))};return n.Minimatch=function(n,r){return new t.Minimatch(n,a(e,r))},n},l.defaults=function(e){return e&&Object.keys(e).length?s.defaults(e).Minimatch:l},l.prototype.debug=function(){},l.prototype.make=c,l.prototype.parseNegate=u,s.braceExpand=function(e,t){return new l(e,t).braceExpand()},l.prototype.braceExpand=p,l.prototype.parse=h;var O={};s.makeRe=function(e,t){return new l(e,t||{}).makeRe()},l.prototype.makeRe=f,s.match=function(e,t,n){n=n||{};var r=new l(t,n);return e=e.filter(function(e){return r.match(e)}),r.options.nonull&&!e.length&&e.push(t),e},l.prototype.match=m,l.prototype.matchOne=function(e,t,n){var r=this.options;this.debug("matchOne",{"this":this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var i=0,o=0,a=e.length,s=t.length;a>i&&s>o;i++,o++){this.debug("matchOne loop");var l=t[o],c=e[i];if(this.debug(t,l,c),l===!1)return!1;if(l===E){this.debug("GLOBSTAR",[t,l,c]);var u=i,d=o+1;if(d===s){for(this.debug("** at the end");a>i;i++)if("."===e[i]||".."===e[i]||!r.dot&&"."===e[i].charAt(0))return!1;return!0}e:for(;a>u;){var p=e[u];if(this.debug("\nglobstar while",e,u,t,d,p),this.matchOne(e.slice(u),t.slice(d),n))return this.debug("globstar found match!",u,a,p),!0;if("."===p||".."===p||!r.dot&&"."===p.charAt(0)){this.debug("dot detected!",e,u,t,d);break e}this.debug("globstar swallow a segment, and continue"),u++}return n&&(this.debug("\n>>> no match, partial?",e,u,t,d),u===a)?!0:!1}var h;if("string"==typeof l?(h=r.nocase?c.toLowerCase()===l.toLowerCase():c===l,this.debug("string match",l,c,h)):(h=c.match(l),this.debug("pattern match",l,c,h)),!h)return!1}if(i===a&&o===s)return!0;if(i===a)return n;if(o===s){var f=i===a-1&&""===e[i];return f}throw new Error("wtf?")}}("function"==typeof e?e:null,this,"object"==typeof t?t:null,"object"==typeof n?n.platform:"win32")}).call(this,e("JkpR2F"))},{JkpR2F:10,"lru-cache":12,path:9,sigmund:13}],12:[function(e,t){!function(){function e(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function n(){return 1}function r(e){return this instanceof r?("number"==typeof e&&(e={max:e}),e||(e={}),this._max=e.max,(!this._max||"number"!=typeof this._max||this._max<=0)&&(this._max=1/0),this._lengthCalculator=e.length||n,"function"!=typeof this._lengthCalculator&&(this._lengthCalculator=n),this._allowStale=e.stale||!1,this._maxAge=e.maxAge||null,this._dispose=e.dispose,void this.reset()):new r(e)}function i(e,t,n){var r=e._cache[t];return r&&(e._maxAge&&Date.now()-r.now>e._maxAge?(l(e,r),e._allowStale||(r=void 0)):n&&o(e,r),r&&(r=r.value)),r}function o(e,t){s(e,t),t.lu=e._mru++,e._lruList[t.lu]=t}function a(e){for(;e._lru<e._mru&&e._length>e._max;)l(e,e._lruList[e._lru])}function s(e,t){for(delete e._lruList[t.lu];e._lru<e._mru&&!e._lruList[e._lru];)e._lru++}function l(e,t){t&&(e._dispose&&e._dispose(t.key,t.value),e._length-=t.length,e._itemCount--,delete e._cache[t.key],s(e,t))}function c(e,t,n,r,i){this.key=e,this.value=t,this.lu=n,this.length=r,this.now=i}"object"==typeof t&&t.exports?t.exports=r:this.LRUCache=r,Object.defineProperty(r.prototype,"max",{set:function(e){(!e||"number"!=typeof e||0>=e)&&(e=1/0),this._max=e,this._length>this._max&&a(this)},get:function(){return this._max},enumerable:!0}),Object.defineProperty(r.prototype,"lengthCalculator",{set:function(e){if("function"!=typeof e){this._lengthCalculator=n,this._length=this._itemCount;for(var t in this._cache)this._cache[t].length=1}else{this._lengthCalculator=e,this._length=0;for(var t in this._cache)this._cache[t].length=this._lengthCalculator(this._cache[t].value),this._length+=this._cache[t].length}this._length>this._max&&a(this)},get:function(){return this._lengthCalculator},enumerable:!0}),Object.defineProperty(r.prototype,"length",{get:function(){return this._length},enumerable:!0}),Object.defineProperty(r.prototype,"itemCount",{get:function(){return this._itemCount},enumerable:!0}),r.prototype.forEach=function(e,t){t=t||this;for(var n=0,r=this._mru-1;r>=0&&n<this._itemCount;r--)if(this._lruList[r]){n++;var i=this._lruList[r];this._maxAge&&Date.now()-i.now>this._maxAge&&(l(this,i),this._allowStale||(i=void 0)),i&&e.call(t,i.value,i.key,this)}},r.prototype.keys=function(){for(var e=new Array(this._itemCount),t=0,n=this._mru-1;n>=0&&t<this._itemCount;n--)if(this._lruList[n]){var r=this._lruList[n];e[t++]=r.key}return e},r.prototype.values=function(){for(var e=new Array(this._itemCount),t=0,n=this._mru-1;n>=0&&t<this._itemCount;n--)if(this._lruList[n]){var r=this._lruList[n];e[t++]=r.value}return e},r.prototype.reset=function(){if(this._dispose&&this._cache)for(var e in this._cache)this._dispose(e,this._cache[e].value);this._cache=Object.create(null),this._lruList=Object.create(null),this._mru=0,this._lru=0,this._length=0,this._itemCount=0},r.prototype.dump=function(){return this._cache},r.prototype.dumpLru=function(){return this._lruList},r.prototype.set=function(t,n){if(e(this._cache,t))return this._dispose&&this._dispose(t,this._cache[t].value),this._maxAge&&(this._cache[t].now=Date.now()),this._cache[t].value=n,this.get(t),!0;var r=this._lengthCalculator(n),i=this._maxAge?Date.now():0,o=new c(t,n,this._mru++,r,i);return o.length>this._max?(this._dispose&&this._dispose(t,n),!1):(this._length+=o.length,this._lruList[o.lu]=this._cache[t]=o,this._itemCount++,this._length>this._max&&a(this),!0)},r.prototype.has=function(t){if(!e(this._cache,t))return!1;var n=this._cache[t];return this._maxAge&&Date.now()-n.now>this._maxAge?!1:!0},r.prototype.get=function(e){return i(this,e,!0)},r.prototype.peek=function(e){return i(this,e,!1)},r.prototype.pop=function(){var e=this._lruList[this._lru];return l(this,e),e||null},r.prototype.del=function(e){l(this,this._cache[e])}}()},{}],13:[function(e,t){function n(e,t){function n(e,a){return a>t||"function"==typeof e||"undefined"==typeof e?void 0:"object"!=typeof e||!e||e instanceof o?void(i+=e):void(-1===r.indexOf(e)&&a!==t&&(r.push(e),i+="{",Object.keys(e).forEach(function(t){if("_"!==t.charAt(0)){var r=typeof e[t];"function"!==r&&"undefined"!==r&&(i+=t,n(e[t],a+1))}})))}t=t||10;var r=[],i="",o=RegExp;return n(e,0),i}t.exports=n},{}],14:[function(e,t){(function(e){function n(t,n,r){return t instanceof ArrayBuffer&&(t=new Uint8Array(t)),new e(t,n,r)}n.prototype=Object.create(e.prototype),n.prototype.constructor=n,Object.keys(e).forEach(function(t){e.hasOwnProperty(t)&&(n[t]=e[t])}),t.exports=n}).call(this,e("buffer").Buffer)},{buffer:6}],15:[function(e,t){var n="READ",r="WRITE",i="CREATE",o="EXCLUSIVE",a="TRUNCATE",s="APPEND",l="CREATE",c="REPLACE";t.exports={FILE_SYSTEM_NAME:"local",FILE_STORE_NAME:"files",IDB_RO:"readonly",IDB_RW:"readwrite",WSQL_VERSION:"1",WSQL_SIZE:5242880,WSQL_DESC:"FileSystem Storage",MODE_FILE:"FILE",MODE_DIRECTORY:"DIRECTORY",MODE_SYMBOLIC_LINK:"SYMLINK",MODE_META:"META",SYMLOOP_MAX:10,BINARY_MIME_TYPE:"application/octet-stream",JSON_MIME_TYPE:"application/json",ROOT_DIRECTORY_NAME:"/",FS_FORMAT:"FORMAT",FS_NOCTIME:"NOCTIME",FS_NOMTIME:"NOMTIME",FS_NODUPEIDCHECK:"FS_NODUPEIDCHECK",O_READ:n,O_WRITE:r,O_CREATE:i,O_EXCLUSIVE:o,O_TRUNCATE:a,O_APPEND:s,O_FLAGS:{r:[n],"r+":[n,r],w:[r,i,a],"w+":[r,n,i,a],wx:[r,i,o,a],"wx+":[r,n,i,o,a],a:[r,i,s],"a+":[r,n,i,s],ax:[r,i,o,s],"ax+":[r,n,i,o,s]},XATTR_CREATE:l,XATTR_REPLACE:c,FS_READY:"READY",FS_PENDING:"PENDING",FS_ERROR:"ERROR",SUPER_NODE_ID:"00000000-0000-0000-0000-000000000000",STDIN:0,STDOUT:1,STDERR:2,FIRST_DESCRIPTOR:3,ENVIRONMENT:{TMP:"/tmp",PATH:""}}},{}],16:[function(e,t){var n=e("./constants.js").MODE_FILE;t.exports=function(e,t){this.id=e,this.type=t||n}},{"./constants.js":15}],17:[function(e,t){(function(e){function n(e){return e.toString("utf8")}function r(t){return new e(t,"utf8")}t.exports={encode:r,decode:n}}).call(this,e("buffer").Buffer)},{buffer:6}],18:[function(e,t){var n={};["9:EBADF:bad file descriptor","10:EBUSY:resource busy or locked","18:EINVAL:invalid argument","27:ENOTDIR:not a directory","28:EISDIR:illegal operation on a directory","34:ENOENT:no such file or directory","47:EEXIST:file already exists","50:EPERM:operation not permitted","51:ELOOP:too many symbolic links encountered","53:ENOTEMPTY:directory not empty","55:EIO:i/o error","1000:ENOTMOUNTED:not mounted","1001:EFILESYSTEMERROR:missing super node, use 'FORMAT' flag to format filesystem.","1002:ENOATTR:attribute does not exist"].forEach(function(e){function t(e,t){Error.call(this),this.name=i,this.code=i,this.errno=r,this.message=e||o,t&&(this.path=t),this.stack=new Error(this.message).stack}e=e.split(":");var r=+e[0],i=e[1],o=e[2];t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t.prototype.toString=function(){var e=this.path?", '"+this.path+"'":"";return this.name+": "+this.message+e},n[i]=n[r]=t}),t.exports=n},{}],19:[function(e,t){function n(e,t,n,r,i){function o(n){e.changes.push({event:"change",path:t}),i(n)}var a=e.flags;dt(a).contains(Pt)&&delete r.ctime,dt(a).contains(At)&&delete r.mtime;var s=!1;r.ctime&&(n.ctime=r.ctime,n.atime=r.ctime,s=!0),r.atime&&(n.atime=r.atime,s=!0),r.mtime&&(n.mtime=r.mtime,s=!0),s?e.putObject(n.id,n,o):o()}function r(e,t,r,o){function a(n,r){n?o(n):r.mode!==Et?o(new Ft.ENOTDIR("a component of the path prefix is not a directory",t)):(d=r,i(e,t,s))}function s(n,r){!n&&r?o(new Ft.EEXIST("path name already exists",t)):!n||n instanceof Ft.ENOENT?e.getObject(d.data,l):o(n)}function l(t,n){t?o(t):(p=n,Vt.create({guid:e.guid,mode:r},function(t,n){return t?void o(t):(h=n,h.nlinks+=1,void e.putObject(h.id,h,u))}))}function c(t){if(t)o(t);else{var r=Date.now();n(e,m,h,{mtime:r,ctime:r},o)}}function u(t){t?o(t):(p[f]=new Ut(h.id,r),e.putObject(d.data,p,c))}if(r!==Et&&r!==_t)return o(new Ft.EINVAL("mode must be a directory or file",t));t=ht(t);var d,p,h,f=mt(t),m=ft(t);i(e,m,a)}function i(e,t,n){function r(t,r){t?n(t):r&&r.mode===St&&r.rnode?e.getObject(r.rnode,o):n(new Ft.EFILESYSTEMERROR)}function o(e,t){e?n(e):t?n(null,t):n(new Ft.ENOENT)}function a(r,i){r?n(r):i.mode===Et&&i.data?e.getObject(i.data,s):n(new Ft.ENOTDIR("a component of the path prefix is not a directory",t))}function s(r,i){if(r)n(r);else if(dt(i).has(u)){var o=i[u].id;e.getObject(o,l)}else n(new Ft.ENOENT(null,t))}function l(e,r){e?n(e):r.mode==bt?(p++,p>Ct?n(new Ft.ELOOP(null,t)):c(r.data)):n(null,r)}function c(t){t=ht(t),d=ft(t),u=mt(t),It==u?e.getObject(wt,r):i(e,d,a)}if(t=ht(t),!t)return n(new Ft.ENOENT("path is an empty string"));var u=mt(t),d=ft(t),p=0;It==u?e.getObject(wt,r):i(e,d,a)}function o(e,t,r,i,o,a,s){function l(i){i?s(i):n(e,t,r,{ctime:Date.now()},s)}var c=r.xattrs;a===Nt&&c.hasOwnProperty(i)?s(new Ft.EEXIST("attribute already exists",t)):a!==xt||c.hasOwnProperty(i)?(c[i]=o,e.putObject(r.id,r,l)):s(new Ft.ENOATTR(null,t))}function a(e,t){function n(n,i){!n&&i?t():!n||n instanceof Ft.ENOENT?$t.create({guid:e.guid},function(n,i){return n?void t(n):(o=i,void e.putObject(o.id,o,r))}):t(n)}function r(n){n?t(n):Vt.create({guid:e.guid,id:o.rnode,mode:Et},function(n,r){return n?void t(n):(a=r,a.nlinks+=1,void e.putObject(a.id,a,i))})}function i(n){n?t(n):(s={},e.putObject(a.data,s,t))}var o,a,s;e.getObject(wt,n)}function s(e,t,r){function o(n,o){!n&&o?r(new Ft.EEXIST(null,t)):!n||n instanceof Ft.ENOENT?i(e,g,a):r(n)}function a(t,n){t?r(t):(h=n,e.getObject(h.data,s))}function s(t,n){t?r(t):(f=n,Vt.create({guid:e.guid,mode:Et},function(t,n){return t?void r(t):(d=n,d.nlinks+=1,void e.putObject(d.id,d,l))}))}function l(t){t?r(t):(p={},e.putObject(d.data,p,u))}function c(t){if(t)r(t);else{var i=Date.now();n(e,g,h,{mtime:i,ctime:i},r)}}function u(t){t?r(t):(f[m]=new Ut(d.id,Et),e.putObject(h.data,f,c))}t=ht(t);var d,p,h,f,m=mt(t),g=ft(t);i(e,t,o)}function l(e,t,r){function o(t,n){t?r(t):(m=n,e.getObject(m.data,a))}function a(n,i){n?r(n):It==v?r(new Ft.EBUSY(null,t)):dt(i).has(v)?(g=i,h=g[v].id,e.getObject(h,s)):r(new Ft.ENOENT(null,t))}function s(n,i){n?r(n):i.mode!=Et?r(new Ft.ENOTDIR(null,t)):(h=i,e.getObject(h.data,l))}function l(e,n){e?r(e):(f=n,dt(f).size()>0?r(new Ft.ENOTEMPTY(null,t)):u())}function c(t){if(t)r(t);else{var i=Date.now();n(e,y,m,{mtime:i,ctime:i},d)}}function u(){delete g[v],e.putObject(m.data,g,c)}function d(t){t?r(t):e["delete"](h.id,p)}function p(t){t?r(t):e["delete"](h.data,r)}t=ht(t);var h,f,m,g,v=mt(t),y=ft(t);i(e,y,o)}function c(e,t,r,o){function a(n,r){n?o(n):r.mode!==Et?o(new Ft.ENOENT(null,t)):(g=r,e.getObject(g.data,s))}function s(n,i){n?o(n):(v=i,dt(v).has(b)?dt(r).contains(Mt)?o(new Ft.ENOENT("O_CREATE and O_EXCLUSIVE are set, and the named file exists",t)):(y=v[b],y.type==Et&&dt(r).contains(Tt)?o(new Ft.EISDIR("the named file is a directory and O_WRITE is set",t)):e.getObject(y.id,l)):dt(r).contains(Ot)?d():o(new Ft.ENOENT("O_CREATE is not set and the named file does not exist",t)))}function l(e,n){if(e)o(e);else{var r=n;r.mode==bt?(I++,I>Ct?o(new Ft.ELOOP(null,t)):c(r.data)):u(void 0,r)}}function c(n){n=ht(n),S=ft(n),b=mt(n),It==b&&(dt(r).contains(Tt)?o(new Ft.EISDIR("the named file is a directory and O_WRITE is set",t)):i(e,t,u)),i(e,S,a)}function u(e,t){e?o(e):(_=t,o(null,_))}function d(){Vt.create({guid:e.guid,mode:_t},function(t,n){return t?void o(t):(_=n,_.nlinks+=1,void e.putObject(_.id,_,p))})}function p(t){t?o(t):(E=new Ht(0),E.fill(0),e.putBuffer(_.data,E,f))}function h(t){if(t)o(t);else{var r=Date.now();n(e,S,g,{mtime:r,ctime:r},m)}}function f(t){t?o(t):(v[b]=new Ut(_.id,_t),e.putObject(g.data,v,h))}function m(e){e?o(e):o(null,_)}t=ht(t);var g,v,y,_,E,b=mt(t),S=ft(t),I=0;It==b?dt(r).contains(Tt)?o(new Ft.EISDIR("the named file is a directory and O_WRITE is set",t)):i(e,t,u):i(e,S,a)}function u(e,t,r,i,o,a){function s(e){e?a(e):a(null,o)}function l(r){if(r)a(r);else{var i=Date.now();n(e,t.path,d,{mtime:i,ctime:i},s)}}function c(t){t?a(t):e.putObject(d.id,d,l)}function u(n,s){if(n)a(n);else{d=s;var l=new Ht(o);l.fill(0),r.copy(l,0,i,i+o),t.position=o,d.size=o,d.version+=1,e.putBuffer(d.data,l,c)}}var d;e.getObject(t.id,u)}function d(e,t,r,i,o,a,s){function l(e){e?s(e):s(null,o)}function c(r){if(r)s(r);else{var i=Date.now();n(e,t.path,h,{mtime:i,ctime:i},l)}}function u(t){t?s(t):e.putObject(h.id,h,c)}function d(n,l){if(n)s(n);else{if(f=l,!f)return s(new Ft.EIO("Expected Buffer"));var c=void 0!==a&&null!==a?a:t.position,d=Math.max(f.length,c+o),p=new Ht(d);p.fill(0),f&&f.copy(p),r.copy(p,c,i,i+o),void 0===a&&(t.position+=o),h.size=d,h.version+=1,e.putBuffer(h.data,p,u)}}function p(t,n){t?s(t):(h=n,e.getBuffer(h.data,d))}var h,f;e.getObject(t.id,p)}function p(e,t,n,r,i,o,a){function s(e,s){if(e)a(e);else{if(u=s,!u)return a(new Ft.EIO("Expected Buffer"));var l=void 0!==o&&null!==o?o:t.position;i=l+i>n.length?i-l:i,u.copy(n,r,l,l+i),void 0===o&&(t.position+=i),a(null,i)}}function l(n,r){n?a(n):"DIRECTORY"===r.mode?a(new Ft.EISDIR("the named file is a directory",t.path)):(c=r,e.getBuffer(c.data,s))}var c,u;e.getObject(t.id,l)}function h(e,t,n){t=ht(t);mt(t);i(e,t,n)}function f(e,t,n){t.getNode(e,n)}function m(e,t,n){function r(t,r){t?n(t):(a=r,e.getObject(a.data,o))}function o(r,i){r?n(r):(s=i,dt(s).has(l)?e.getObject(s[l].id,n):n(new Ft.ENOENT("a component of the path does not name an existing file",t)))}t=ht(t);var a,s,l=mt(t),c=ft(t);It==l?i(e,t,n):i(e,c,r)}function g(e,t,r,o){function a(t){t?o(t):n(e,r,_,{ctime:Date.now()},o)}function s(t,n){t?o(t):(_=n,_.nlinks+=1,e.putObject(_.id,_,a))}function l(t){t?o(t):e.getObject(y[E].id,s)}function c(t,n){t?o(t):(y=n,dt(y).has(E)?o(new Ft.EEXIST("newpath resolves to an existing file",E)):(y[E]=g[h],e.putObject(v.data,y,l)))}function u(t,n){t?o(t):(v=n,e.getObject(v.data,c))}function d(t,n){t?o(t):(g=n,dt(g).has(h)?i(e,b,u):o(new Ft.ENOENT("a component of either path prefix does not exist",h)))}function p(t,n){t?o(t):(m=n,e.getObject(m.data,d))}t=ht(t);var h=mt(t),f=ft(t);r=ht(r);var m,g,v,y,_,E=mt(r),b=ft(r);i(e,f,p)}function v(e,t,r){function o(t){t?r(t):(delete p[f],e.putObject(d.data,p,function(){var t=Date.now();n(e,m,d,{mtime:t,ctime:t},r)}))}function a(t){t?r(t):e["delete"](h.data,o)}function s(i,s){i?r(i):(h=s,h.nlinks-=1,h.nlinks<1?e["delete"](h.id,a):e.putObject(h.id,h,function(){n(e,t,h,{ctime:Date.now()},o)}))}function l(e,t){e?r(e):"DIRECTORY"===t.mode?r(new Ft.EPERM("unlink not permitted on directories",f)):s(null,t)}function c(t,n){t?r(t):(p=n,dt(p).has(f)?e.getObject(p[f].id,l):r(new Ft.ENOENT("a component of the path does not name an existing file",f)))}function u(t,n){t?r(t):(d=n,e.getObject(d.data,c))}t=ht(t);var d,p,h,f=mt(t),m=ft(t);i(e,m,u)}function y(e,t,n){function r(e,t){if(e)n(e);else{s=t;var r=Object.keys(s);n(null,r)}}function o(i,o){i?n(i):o.mode!==Et?n(new Ft.ENOTDIR(null,t)):(a=o,e.getObject(a.data,r))}t=ht(t);{var a,s;mt(t)}i(e,t,o)}function _(e,t,r,o){function a(t,n){t?o(t):(d=n,e.getObject(d.data,s))}function s(e,t){e?o(e):(p=t,dt(p).has(f)?o(new Ft.EEXIST(null,f)):l())}function l(){Vt.create({guid:e.guid,mode:bt},function(n,r){return n?void o(n):(h=r,h.nlinks+=1,h.size=t.length,h.data=t,void e.putObject(h.id,h,u))})}function c(t){if(t)o(t);else{var r=Date.now();n(e,m,d,{mtime:r,ctime:r},o)}}function u(t){t?o(t):(p[f]=new Ut(h.id,bt),e.putObject(d.data,p,c))}r=ht(r);var d,p,h,f=mt(r),m=ft(r);It==f?o(new Ft.EEXIST(null,f)):i(e,m,a)}function E(e,t,n){function r(t,r){t?n(t):(s=r,e.getObject(s.data,o))}function o(t,r){t?n(t):(l=r,dt(l).has(c)?e.getObject(l[c].id,a):n(new Ft.ENOENT("a component of the path does not name an existing file",c)))}function a(e,r){e?n(e):r.mode!=bt?n(new Ft.EINVAL("path not a symbolic link",t)):n(null,r.data)}t=ht(t);var s,l,c=mt(t),u=ft(t);i(e,u,r)}function b(e,t,r,o){function a(n,r){n?o(n):r.mode==Et?o(new Ft.EISDIR(null,t)):(u=r,e.getBuffer(u.data,s))}function s(t,n){if(t)o(t);else{if(!n)return o(new Ft.EIO("Expected Buffer"));var i=new Ht(r);i.fill(0),n&&n.copy(i),e.putBuffer(u.data,i,c)}}function l(r){if(r)o(r);else{var i=Date.now();n(e,t,u,{mtime:i,ctime:i},o)}}function c(t){t?o(t):(u.size=r,u.version+=1,e.putObject(u.id,u,l))}t=ht(t);var u;0>r?o(new Ft.EINVAL("length cannot be negative")):i(e,t,a)}function S(e,t,r,i){function o(t,n){t?i(t):n.mode==Et?i(new Ft.EISDIR):(c=n,e.getBuffer(c.data,a))}function a(t,n){if(t)i(t);else{var o;if(!n)return i(new Ft.EIO("Expected Buffer"));n?o=n.slice(0,r):(o=new Ht(r),o.fill(0)),e.putBuffer(c.data,o,l)}}function s(r){if(r)i(r);else{var o=Date.now();n(e,t.path,c,{mtime:o,ctime:o},i)}}function l(t){t?i(t):(c.size=r,c.version+=1,e.putObject(c.id,c,s))}var c;0>r?i(new Ft.EINVAL("length cannot be negative")):t.getNode(e,o)}function I(e,t,r,o,a){function s(i,s){i?a(i):n(e,t,s,{atime:r,ctime:o,mtime:o},a)}t=ht(t),"number"!=typeof r||"number"!=typeof o?a(new Ft.EINVAL("atime and mtime must be number",t)):0>r||0>o?a(new Ft.EINVAL("atime and mtime must be positive integers",t)):i(e,t,s)}function w(e,t,r,i,o){function a(a,s){a?o(a):n(e,t.path,s,{atime:r,ctime:i,mtime:i},o)}"number"!=typeof r||"number"!=typeof i?o(new Ft.EINVAL("atime and mtime must be a number")):0>r||0>i?o(new Ft.EINVAL("atime and mtime must be positive integers")):t.getNode(e,a)}function C(e,t,n,r,a,s){function l(i,l){return i?s(i):void o(e,t,l,n,r,a,s)}t=ht(t),"string"!=typeof n?s(new Ft.EINVAL("attribute name must be a string",t)):n?null!==a&&a!==Nt&&a!==xt?s(new Ft.EINVAL("invalid flag, must be null, XATTR_CREATE or XATTR_REPLACE",t)):i(e,t,l):s(new Ft.EINVAL("attribute name cannot be an empty string",t))}function D(e,t,n,r,i,a){function s(s,l){return s?a(s):void o(e,t.path,l,n,r,i,a)}"string"!=typeof n?a(new Ft.EINVAL("attribute name must be a string")):n?null!==i&&i!==Nt&&i!==xt?a(new Ft.EINVAL("invalid flag, must be null, XATTR_CREATE or XATTR_REPLACE")):t.getNode(e,s):a(new Ft.EINVAL("attribute name cannot be an empty string"))}function T(e,t,n,r){function o(e,i){if(e)return r(e);var o=i.xattrs;o.hasOwnProperty(n)?r(null,o[n]):r(new Ft.ENOATTR(null,t))}t=ht(t),"string"!=typeof n?r(new Ft.EINVAL("attribute name must be a string",t)):n?i(e,t,o):r(new Ft.EINVAL("attribute name cannot be an empty string",t))}function O(e,t,n,r){function i(e,t){if(e)return r(e);var i=t.xattrs;i.hasOwnProperty(n)?r(null,i[n]):r(new Ft.ENOATTR)}"string"!=typeof n?r(new Ft.EINVAL):n?t.getNode(e,i):r(new Ft.EINVAL("attribute name cannot be an empty string"))}function M(e,t,r,o){function a(i,a){function s(r){r?o(r):n(e,t,a,{ctime:Date.now()},o)}if(i)return o(i);var l=a.xattrs;l.hasOwnProperty(r)?(delete l[r],e.putObject(a.id,a,s)):o(new Ft.ENOATTR(null,t))}t=ht(t),"string"!=typeof r?o(new Ft.EINVAL("attribute name must be a string",t)):r?i(e,t,a):o(new Ft.EINVAL("attribute name cannot be an empty string",t))}function L(e,t,r,i){function o(o,a){function s(r){r?i(r):n(e,t.path,a,{ctime:Date.now()},i)}if(o)return i(o);var l=a.xattrs;l.hasOwnProperty(r)?(delete l[r],e.putObject(a.id,a,s)):i(new Ft.ENOATTR)}"string"!=typeof r?i(new Ft.EINVAL("attribute name must be a string")):r?t.getNode(e,o):i(new Ft.EINVAL("attribute name cannot be an empty string"))}function R(e){return dt(Rt).has(e)?Rt[e]:null}function N(e,t,n){return e?"function"==typeof e?e={encoding:t,flag:n}:"string"==typeof e&&(e={encoding:e,flag:n}):e={encoding:t,flag:n},e}function x(e,t){var n;return e?vt(e)?n=new Ft.EINVAL("Path must be a string without null bytes.",e):gt(e)||(n=new Ft.EINVAL("Path must be absolute.",e)):n=new Ft.EINVAL("Path must be a string",e),n?(t(n),!1):!0}function A(e,t,n,r,i,o){function a(t,i){if(t)o(t);else{var a;a=dt(r).contains(Lt)?i.size:0;var s=new jt(n,i.id,r,a),l=e.allocDescriptor(s);o(null,l)}}o=arguments[arguments.length-1],x(n,o)&&(r=R(r),r||o(new Ft.EINVAL("flags is not valid"),n),c(t,n,r,a))}function P(e,t,n,r){dt(e.openFiles).has(n)?(e.releaseDescriptor(n),r(null)):r(new Ft.EBADF)}function k(e,t,n,i,o){x(n,o)&&r(t,n,i,o)}function F(e,t,n,r,i){i=arguments[arguments.length-1],x(n,i)&&s(t,n,i)}function U(e,t,n,r){x(n,r)&&l(t,n,r)}function j(e,t,n,r){function i(t,n){if(t)r(t);else{var i=new Bt(n,e.name);r(null,i)}}x(n,r)&&h(t,n,i)}function $(e,t,n,r){function i(t,n){if(t)r(t);else{var i=new Bt(n,e.name);r(null,i)}}var o=e.openFiles[n];o?f(t,o,i):r(new Ft.EBADF)}function V(e,t,n,r,i){x(n,i)&&x(r,i)&&g(t,n,r,i)}function B(e,t,n,r){x(n,r)&&v(t,n,r)}function H(e,t,n,r,i,o,a,s){function l(e,t){s(e,t||0,r)}i=void 0===i?0:i,o=void 0===o?r.length-i:o,s=arguments[arguments.length-1];var c=e.openFiles[n];c?dt(c.flags).contains(Dt)?p(t,c,r,i,o,a,l):s(new Ft.EBADF("descriptor does not permit reading")):s(new Ft.EBADF)}function W(e,t,n,r,i){if(i=arguments[arguments.length-1],r=N(r,null,"r"),x(n,i)){var o=R(r.flag||"r");return o?void c(t,n,o,function(a,s){function l(){e.releaseDescriptor(u)}if(a)return i(a);var c=new jt(n,s.id,o,0),u=e.allocDescriptor(c);f(t,c,function(o,a){if(o)return l(),i(o);var s=new Bt(a,e.name);if(s.isDirectory())return l(),i(new Ft.EISDIR("illegal operation on directory",n));var u=s.size,d=new Ht(u);d.fill(0),p(t,c,d,0,u,0,function(e){if(l(),e)return i(e);var t;t="utf8"===r.encoding?kt.decode(d):d,i(null,t)})})}):i(new Ft.EINVAL("flags is not valid",n))}}function G(e,t,n,r,i,o,a,s){s=arguments[arguments.length-1],i=void 0===i?0:i,o=void 0===o?r.length-i:o;var l=e.openFiles[n];l?dt(l.flags).contains(Tt)?r.length-i<o?s(new Ft.EIO("intput buffer is too small")):d(t,l,r,i,o,a,s):s(new Ft.EBADF("descriptor does not permit writing")):s(new Ft.EBADF)}function K(e,t,n,r,i,o){if(o=arguments[arguments.length-1],i=N(i,"utf8","w"),x(n,o)){var a=R(i.flag||"w");if(!a)return o(new Ft.EINVAL("flags is not valid",n));r=r||"","number"==typeof r&&(r=""+r),"string"==typeof r&&"utf8"===i.encoding&&(r=kt.encode(r)),c(t,n,a,function(i,s){if(i)return o(i);var l=new jt(n,s.id,a,0),c=e.allocDescriptor(l);u(t,l,r,0,r.length,function(t){return e.releaseDescriptor(c),t?o(t):void o(null)})})}}function q(e,t,n,r,i,o){if(o=arguments[arguments.length-1],i=N(i,"utf8","a"),x(n,o)){var a=R(i.flag||"a");if(!a)return o(new Ft.EINVAL("flags is not valid",n));r=r||"","number"==typeof r&&(r=""+r),"string"==typeof r&&"utf8"===i.encoding&&(r=kt.encode(r)),c(t,n,a,function(i,s){if(i)return o(i);var l=new jt(n,s.id,a,s.size),c=e.allocDescriptor(l);d(t,l,r,0,r.length,l.position,function(t){return e.releaseDescriptor(c),t?o(t):void o(null)})})}}function z(e,t,n,r){function i(e){r(e?!1:!0)}j(e,t,n,i)}function Y(e,t,n,r,i){x(n,i)&&T(t,n,r,i)}function X(e,t,n,r,i){var o=e.openFiles[n];o?O(t,o,r,i):i(new Ft.EBADF)}function Q(e,t,n,r,i,o,a){"function"==typeof o&&(a=o,o=null),x(n,a)&&C(t,n,r,i,o,a)}function J(e,t,n,r,i,o,a){"function"==typeof o&&(a=o,o=null);var s=e.openFiles[n];s?dt(s.flags).contains(Tt)?D(t,s,r,i,o,a):a(new Ft.EBADF("descriptor does not permit writing")):a(new Ft.EBADF)}function Z(e,t,n,r,i){x(n,i)&&M(t,n,r,i)}function et(e,t,n,r,i){var o=e.openFiles[n];o?dt(o.flags).contains(Tt)?L(t,o,r,i):i(new Ft.EBADF("descriptor does not permit writing")):i(new Ft.EBADF)}function tt(e,t,n,r,i,o){function a(e,t){e?o(e):t.size+r<0?o(new Ft.EINVAL("resulting file offset would be negative")):(s.position=t.size+r,o(null,s.position))}var s=e.openFiles[n];s||o(new Ft.EBADF),"SET"===i?0>r?o(new Ft.EINVAL("resulting file offset would be negative")):(s.position=r,o(null,s.position)):"CUR"===i?s.position+r<0?o(new Ft.EINVAL("resulting file offset would be negative")):(s.position+=r,o(null,s.position)):"END"===i?f(t,s,a):o(new Ft.EINVAL("whence argument is not a proper value"))}function nt(e,t,n,r){x(n,r)&&y(t,n,r)}function rt(e,t,n,r,i,o){if(x(n,o)){var a=Date.now();r=r?r:a,i=i?i:a,I(t,n,r,i,o)}}function it(e,t,n,r,i,o){var a=Date.now();r=r?r:a,i=i?i:a;var s=e.openFiles[n];s?dt(s.flags).contains(Tt)?w(t,s,r,i,o):o(new Ft.EBADF("descriptor does not permit writing")):o(new Ft.EBADF)}function ot(e,t,r,o,a){function s(e,r){e?a(e):n(t,o,r,{ctime:Date.now()},a)}function c(e){e?a(e):t.getObject(I[T].id,s)}function u(e){e?a(e):(delete b[D],t.putObject(E.data,b,c))}function d(e){e?a(e):(I[T]=b[D],t.putObject(S.data,I,u))}function p(e,n){e?a(e):(I=n,dt(I).has(T)?l(t,o,d):d())}function h(e,n){e?a(e):(S=n,t.getObject(S.data,p))}function f(e,n){e?a(e):(b=n,i(t,C,h))}function m(e,n){e?a(e):(E=n,t.getObject(n.data,f))}function y(e){e?a(e):v(t,r,a)}function _(e,n){e?a(e):"DIRECTORY"===n.mode?i(t,w,m):g(t,r,o,y)}if(x(r,a)&&x(o,a)){var E,b,S,I,w=pt.dirname(r),C=pt.dirname(r),D=pt.basename(r),T=pt.basename(o);i(t,r,_)}}function at(e,t,n,r,i,o){o=arguments[arguments.length-1],x(n,o)&&x(r,o)&&_(t,n,r,o)}function st(e,t,n,r){x(n,r)&&E(t,n,r)}function lt(e,t,n,r){function i(t,n){if(t)r(t);else{var i=new Bt(n,e.name);r(null,i)}}x(n,r)&&m(t,n,i)}function ct(e,t,n,r,i){i=arguments[arguments.length-1],r=r||0,x(n,i)&&b(t,n,r,i)}function ut(e,t,n,r,i){i=arguments[arguments.length-1],r=r||0;var o=e.openFiles[n];o?dt(o.flags).contains(Tt)?S(t,o,r,i):i(new Ft.EBADF("descriptor does not permit writing")):i(new Ft.EBADF)}var dt=e("../../lib/nodash.js"),pt=e("../path.js"),ht=pt.normalize,ft=pt.dirname,mt=pt.basename,gt=pt.isAbsolute,vt=pt.isNull,yt=e("../constants.js"),_t=yt.MODE_FILE,Et=yt.MODE_DIRECTORY,bt=yt.MODE_SYMBOLIC_LINK,St=yt.MODE_META,It=yt.ROOT_DIRECTORY_NAME,wt=yt.SUPER_NODE_ID,Ct=yt.SYMLOOP_MAX,Dt=yt.O_READ,Tt=yt.O_WRITE,Ot=yt.O_CREATE,Mt=yt.O_EXCLUSIVE,Lt=(yt.O_TRUNCATE,yt.O_APPEND),Rt=yt.O_FLAGS,Nt=yt.XATTR_CREATE,xt=yt.XATTR_REPLACE,At=yt.FS_NOMTIME,Pt=yt.FS_NOCTIME,kt=e("../encoding.js"),Ft=e("../errors.js"),Ut=e("../directory-entry.js"),jt=e("../open-file-description.js"),$t=e("../super-node.js"),Vt=e("../node.js"),Bt=e("../stats.js"),Ht=e("../buffer.js");t.exports={ensureRootDirectory:a,open:A,close:P,mknod:k,mkdir:F,rmdir:U,unlink:B,stat:j,fstat:$,link:V,read:H,readFile:W,write:G,writeFile:K,appendFile:q,exists:z,getxattr:Y,fgetxattr:X,setxattr:Q,fsetxattr:J,removexattr:Z,fremovexattr:et,lseek:tt,readdir:nt,utimes:rt,futimes:it,rename:ot,symlink:at,readlink:st,lstat:lt,truncate:ct,ftruncate:ut}},{"../../lib/nodash.js":4,"../buffer.js":14,"../constants.js":15,"../directory-entry.js":16,"../encoding.js":17,"../errors.js":18,"../node.js":23,"../open-file-description.js":24,"../path.js":25,"../stats.js":33,"../super-node.js":34}],20:[function(e,t){function n(e){return"function"==typeof e?e:function(e){if(e)throw e}}function r(e){e&&console.error("Filer error: ",e)}function i(e,t){function n(){A.forEach(function(e){e.call(this)}.bind(R)),A=null}function i(e){return function(t){function n(t){var r=T();e.getObject(r,function(e,i){return e?void t(e):void(i?n(t):t(null,r))})}return o(D).contains(f)?void t(null,T()):void n(t)}}function l(e){if(e.length){var t=v.getInstance();e.forEach(function(e){t.emit(e.event,e.path)})}}e=e||{},t=t||r;var D=e.flags,T=e.guid?e.guid:E,O=e.provider||new m.Default(e.name||c),M=e.name||O.name,L=o(D).contains(u),R=this;R.readyState=p,R.name=M,R.error=null,R.stdin=b,R.stdout=S,R.stderr=I,this.Shell=g.bind(void 0,this);var N={},x=w;Object.defineProperty(this,"openFiles",{get:function(){return N}}),this.allocDescriptor=function(e){var t=x++;return N[t]=e,t},this.releaseDescriptor=function(e){delete N[e]};var A=[];this.queueOrRun=function(e){var t;return d==R.readyState?e.call(R):h==R.readyState?t=new _.EFILESYSTEMERROR("unknown error"):A.push(e),t},this.watch=function(e,t,n){if(a(e))throw new Error("Path must be a string without null bytes.");"function"==typeof t&&(n=t,t={}),t=t||{},n=n||s;var r=new y;return r.start(e,!1,t.recursive),r.on("change",n),r},O.open(function(e){function r(e){function r(e){var t=O[e]();return t.flags=D,t.changes=[],t.guid=i(t),t.close=function(){var e=t.changes;l(e),e.length=0},t}R.provider={openReadWriteContext:function(){return r("getReadWriteContext")},openReadOnlyContext:function(){return r("getReadOnlyContext")}},R.readyState=e?h:d,n(),t(e,R)}if(e)return r(e);var o=O.getReadWriteContext();o.guid=i(o),L?o.clear(function(e){return e?r(e):void C.ensureRootDirectory(o,r)}):C.ensureRootDirectory(o,r)})}var o=e("../../lib/nodash.js"),a=e("../path.js").isNull,s=e("../shared.js").nop,l=e("../constants.js"),c=l.FILE_SYSTEM_NAME,u=l.FS_FORMAT,d=l.FS_READY,p=l.FS_PENDING,h=l.FS_ERROR,f=l.FS_NODUPEIDCHECK,m=e("../providers/index.js"),g=e("../shell/shell.js"),v=e("../../lib/intercom.js"),y=e("../fs-watcher.js"),_=e("../errors.js"),E=e("../shared.js").guid,b=l.STDIN,S=l.STDOUT,I=l.STDERR,w=l.FIRST_DESCRIPTOR,C=e("./implementation.js");i.providers=m,["open","close","mknod","mkdir","rmdir","stat","fstat","link","unlink","read","readFile","write","writeFile","appendFile","exists","lseek","readdir","rename","readlink","symlink","lstat","truncate","ftruncate","utimes","futimes","setxattr","getxattr","fsetxattr","fgetxattr","removexattr","fremovexattr"].forEach(function(e){i.prototype[e]=function(){var t=this,r=Array.prototype.slice.call(arguments,0),i=r.length-1,o="function"!=typeof r[i],a=n(r[i]),s=t.queueOrRun(function(){function n(){s.close(),a.apply(t,arguments)
}var s=t.provider.openReadWriteContext();if(h===t.readyState){var l=new _.EFILESYSTEMERROR("filesystem unavailable, operation canceled");return a.call(t,l)}o?r.push(n):r[i]=n;var c=[t,s].concat(r);C[e].apply(null,c)});s&&a(s)}}),t.exports=i},{"../../lib/intercom.js":3,"../../lib/nodash.js":4,"../constants.js":15,"../errors.js":18,"../fs-watcher.js":21,"../path.js":25,"../providers/index.js":26,"../shared.js":30,"../shell/shell.js":32,"./implementation.js":19}],21:[function(e,t){function n(){function e(e){(n===e||s&&0===e.indexOf(t))&&a.trigger("change","change",e)}r.call(this);var t,n,a=this,s=!1;a.start=function(r,a,l){if(!n){if(i.isNull(r))throw new Error("Path must be a string without null bytes.");n=i.normalize(r),s=l===!0,s&&(t="/"===n?"/":n+"/");var c=o.getInstance();c.on("change",e)}},a.close=function(){var t=o.getInstance();t.off("change",e),a.removeAllListeners("change")}}var r=e("../lib/eventemitter.js"),i=e("./path.js"),o=e("../lib/intercom.js");n.prototype=new r,n.prototype.constructor=n,t.exports=n},{"../lib/eventemitter.js":2,"../lib/intercom.js":3,"./path.js":25}],22:[function(e,t){t.exports={FileSystem:e("./filesystem/interface.js"),Buffer:e("./buffer.js"),Path:e("./path.js"),Errors:e("./errors.js"),Shell:e("./shell/shell.js")}},{"./buffer.js":14,"./errors.js":18,"./filesystem/interface.js":20,"./path.js":25,"./shell/shell.js":32}],23:[function(e,t){function n(e){var t=Date.now();this.id=e.id,this.mode=e.mode||i,this.size=e.size||0,this.atime=e.atime||t,this.ctime=e.ctime||t,this.mtime=e.mtime||t,this.flags=e.flags||[],this.xattrs=e.xattrs||{},this.nlinks=e.nlinks||0,this.version=e.version||0,this.blksize=void 0,this.nblocks=1,this.data=e.data}function r(e,t,n){e[t]?n(null):e.guid(function(r,i){e[t]=i,n(r)})}var i=e("./constants.js").MODE_FILE;n.create=function(e,t){r(e,"id",function(i){return i?void t(i):void r(e,"data",function(r){return r?void t(r):void t(null,new n(e))})})},t.exports=n},{"./constants.js":15}],24:[function(e,t){function n(e,t,n,r){this.path=e,this.id=t,this.flags=n,this.position=r}var r=e("./errors.js");n.prototype.getNode=function(e,t){function n(e,n){return e?t(e):n?void t(null,n):t(new r.EBADF("file descriptor refers to unknown node",o))}var i=this.id,o=this.path;e.getObject(i,n)},t.exports=n},{"./errors.js":18}],25:[function(e,t,n){function r(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function i(){for(var e="",t=!1,n=arguments.length-1;n>=-1&&!t;n--){var i=n>=0?arguments[n]:"/";"string"==typeof i&&i&&(e=i+"/"+e,t="/"===i.charAt(0))}return e=r(e.split("/").filter(function(e){return!!e}),!t).join("/"),(t?"/":"")+e||"."}function o(e){{var t="/"===e.charAt(0);"/"===e.substr(-1)}return e=r(e.split("/").filter(function(e){return!!e}),!t).join("/"),e||t||(e="."),(t?"/":"")+e}function a(){var e=Array.prototype.slice.call(arguments,0);return o(e.filter(function(e){return e&&"string"==typeof e}).join("/"))}function s(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=n.resolve(e).substr(1),t=n.resolve(t).substr(1);for(var i=r(e.split("/")),o=r(t.split("/")),a=Math.min(i.length,o.length),s=a,l=0;a>l;l++)if(i[l]!==o[l]){s=l;break}for(var c=[],l=s;l<i.length;l++)c.push("..");return c=c.concat(o.slice(s)),c.join("/")}function l(e){var t=g(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."}function c(e,t){var n=g(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),""===n?"/":n}function u(e){return g(e)[3]}function d(e){return"/"===e.charAt(0)?!0:!1}function p(e){return-1!==(""+e).indexOf("\0")?!0:!1}function h(e){return e.replace(/\/*$/,"/")}function f(e){return e=e.replace(/\/*$/,""),""===e?"/":e}var m=/^(\/?)([\s\S]+\/(?!$)|\/)?((?:\.{1,2}$|[\s\S]+?)?(\.[^.\/]*)?)$/,g=function(e){var t=m.exec(e);return[t[1]||"",t[2]||"",t[3]||"",t[4]||""]};t.exports={normalize:o,resolve:i,join:a,relative:s,sep:"/",delimiter:":",dirname:l,basename:c,extname:u,isAbsolute:d,isNull:p,addTrailing:h,removeTrailing:f}},{}],26:[function(e,t){var n=e("./indexeddb.js"),r=e("./websql.js"),i=e("./memory.js");t.exports={IndexedDB:n,WebSQL:r,Memory:i,Default:n,Fallback:function(){function e(){throw"[Filer Error] Your browser doesn't support IndexedDB or WebSQL."}return n.isSupported()?n:r.isSupported()?r:(e.isSupported=function(){return!1},e)}()}},{"./indexeddb.js":27,"./memory.js":28,"./websql.js":29}],27:[function(e,t){(function(n,r){function i(e,t){var n=e.transaction(c,t);this.objectStore=n.objectStore(c)}function o(e,t,n){try{var r=e.get(t);r.onsuccess=function(e){var t=e.target.result;n(null,t)},r.onerror=function(e){n(e)}}catch(i){n(i)}}function a(e,t,n,r){try{var i=e.put(n,t);i.onsuccess=function(e){var t=e.target.result;r(null,t)},i.onerror=function(e){r(e)}}catch(o){r(o)}}function s(e){this.name=e||l,this.db=null}var l=e("../constants.js").FILE_SYSTEM_NAME,c=e("../constants.js").FILE_STORE_NAME,u=e("../constants.js").IDB_RW,d=(e("../constants.js").IDB_RO,e("../errors.js")),p=e("../buffer.js"),h=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB;i.prototype.clear=function(e){try{var t=this.objectStore.clear();t.onsuccess=function(){e()},t.onerror=function(t){e(t)}}catch(n){e(n)}},i.prototype.getObject=function(e,t){o(this.objectStore,e,t)},i.prototype.getBuffer=function(e,t){o(this.objectStore,e,function(e,n){return e?t(e):void t(null,new p(n))})},i.prototype.putObject=function(e,t,n){a(this.objectStore,e,t,n)},i.prototype.putBuffer=function(e,t,n){var i;i=r._useTypedArrays?t.buffer:t.toArrayBuffer(),a(this.objectStore,e,i,n)},i.prototype["delete"]=function(e,t){try{var n=this.objectStore["delete"](e);n.onsuccess=function(e){var n=e.target.result;t(null,n)},n.onerror=function(e){t(e)}}catch(r){t(r)}},s.isSupported=function(){return!!h},s.prototype.open=function(e){var t=this;if(t.db)return e();var n=h.open(t.name);n.onupgradeneeded=function(e){var t=e.target.result;t.objectStoreNames.contains(c)&&t.deleteObjectStore(c),t.createObjectStore(c)},n.onsuccess=function(n){t.db=n.target.result,e()},n.onerror=function(){e(new d.EINVAL("IndexedDB cannot be accessed. If private browsing is enabled, disable it."))}},s.prototype.getReadOnlyContext=function(){return new i(this.db,u)},s.prototype.getReadWriteContext=function(){return new i(this.db,u)},t.exports=s}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer)},{"../buffer.js":14,"../constants.js":15,"../errors.js":18,buffer:6}],28:[function(e,t){function n(e,t){this.readOnly=t,this.objectStore=e}function r(e){this.name=e||i}var i=e("../constants.js").FILE_SYSTEM_NAME,o=e("../../lib/async.js").setImmediate,a=function(){var e={};return function(t){return e.hasOwnProperty(t)||(e[t]={}),e[t]}}();n.prototype.clear=function(e){if(this.readOnly)return void o(function(){e("[MemoryContext] Error: write operation on read only context")});var t=this.objectStore;Object.keys(t).forEach(function(e){delete t[e]}),o(e)},n.prototype.getObject=n.prototype.getBuffer=function(e,t){var n=this;o(function(){t(null,n.objectStore[e])})},n.prototype.putObject=n.prototype.putBuffer=function(e,t,n){return this.readOnly?void o(function(){n("[MemoryContext] Error: write operation on read only context")}):(this.objectStore[e]=t,void o(n))},n.prototype["delete"]=function(e,t){return this.readOnly?void o(function(){t("[MemoryContext] Error: write operation on read only context")}):(delete this.objectStore[e],void o(t))},r.isSupported=function(){return!0},r.prototype.open=function(e){this.db=a(this.name),o(e)},r.prototype.getReadOnlyContext=function(){return new n(this.db,!0)},r.prototype.getReadWriteContext=function(){return new n(this.db,!1)},t.exports=r},{"../../lib/async.js":1,"../constants.js":15}],29:[function(e,t){(function(n){function r(e,t){var n=this;this.getTransaction=function(r){return n.transaction?void r(n.transaction):void e[t?"readTransaction":"transaction"](function(e){n.transaction=e,r(e)})}}function i(e,t,n){function r(e,t){var r=0===t.rows.length?null:t.rows.item(0).data;n(null,r)}function i(e,t){n(t)}e(function(e){e.executeSql("SELECT data FROM "+l+" WHERE id = ? LIMIT 1;",[t],r,i)})}function o(e,t,n,r){function i(){r(null)}function o(e,t){r(t)}e(function(e){e.executeSql("INSERT OR REPLACE INTO "+l+" (id, data) VALUES (?, ?);",[t,n],i,o)})}function a(e){this.name=e||s,this.db=null}var s=e("../constants.js").FILE_SYSTEM_NAME,l=e("../constants.js").FILE_STORE_NAME,c=e("../constants.js").WSQL_VERSION,u=e("../constants.js").WSQL_SIZE,d=e("../constants.js").WSQL_DESC,p=e("../errors.js"),h=e("../buffer.js"),f=e("base64-arraybuffer");r.prototype.clear=function(e){function t(t,n){e(n)}function n(){e(null)}this.getTransaction(function(e){e.executeSql("DELETE FROM "+l+";",[],n,t)})},r.prototype.getObject=function(e,t){i(this.getTransaction,e,function(e,n){if(e)return t(e);try{n&&(n=JSON.parse(n))}catch(r){return t(r)}t(null,n)})},r.prototype.getBuffer=function(e,t){i(this.getTransaction,e,function(e,n){if(e)return t(e);if(n||""===n){var r=f.decode(n);n=new h(r)}t(null,n)})},r.prototype.putObject=function(e,t,n){var r=JSON.stringify(t);o(this.getTransaction,e,r,n)},r.prototype.putBuffer=function(e,t,n){var r=f.encode(t.buffer);o(this.getTransaction,e,r,n)},r.prototype["delete"]=function(e,t){function n(){t(null)}function r(e,n){t(n)}this.getTransaction(function(t){t.executeSql("DELETE FROM "+l+" WHERE id = ?;",[e],n,r)})},a.isSupported=function(){return!!n.openDatabase},a.prototype.open=function(e){function t(t,n){5===n.code&&e(new p.EINVAL("WebSQL cannot be accessed. If private browsing is enabled, disable it.")),e(n)}function r(){i.db=o,e()}var i=this;if(i.db)return e();var o=n.openDatabase(i.name,c,d,u);return o?void o.transaction(function(e){function n(e){e.executeSql("CREATE INDEX IF NOT EXISTS idx_"+l+"_id on "+l+" (id);",[],r,t)}e.executeSql("CREATE TABLE IF NOT EXISTS "+l+" (id unique, data TEXT);",[],n,t)}):void e("[WebSQL] Unable to open database.")},a.prototype.getReadOnlyContext=function(){return new r(this.db,!0)},a.prototype.getReadWriteContext=function(){return new r(this.db,!1)},t.exports=a}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../buffer.js":14,"../constants.js":15,"../errors.js":18,"base64-arraybuffer":5}],30:[function(e,t){function n(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)}).toUpperCase()}function r(){}function i(e){for(var t=[],n=e.length,r=0;n>r;r++)t[r]=e[r];return t}t.exports={guid:n,u8toArray:i,nop:r}},{}],31:[function(e,t){var n=e("../constants.js").ENVIRONMENT;t.exports=function(e){e=e||{},e.TMP=e.TMP||n.TMP,e.PATH=e.PATH||n.PATH,this.get=function(t){return e[t]},this.set=function(t,n){e[t]=n}}},{"../constants.js":15}],32:[function(e,t){function n(e,t){t=t||{};var n=new o(t.env),a="/";Object.defineProperty(this,"fs",{get:function(){return e},enumerable:!0}),Object.defineProperty(this,"env",{get:function(){return n},enumerable:!0}),this.cd=function(t,n){t=r.resolve(a,t),e.stat(t,function(e,r){return e?void n(new i.ENOTDIR(null,t)):void("DIRECTORY"===r.type?(a=t,n()):n(new i.ENOTDIR(null,t)))})},this.pwd=function(){return a}}var r=e("../path.js"),i=e("../errors.js"),o=e("./environment.js"),a=e("../../lib/async.js"),s=(e("../encoding.js"),e("minimatch"));n.prototype.exec=function(e,t,n){var i=this,o=i.fs;"function"==typeof t&&(n=t,t=[]),t=t||[],n=n||function(){},e=r.resolve(i.pwd(),e),o.readFile(e,"utf8",function(e,r){if(e)return void n(e);try{var i=new Function("fs","args","callback",r);i(o,t,n)}catch(a){n(a)}})},n.prototype.touch=function(e,t,n){function i(e){s.writeFile(e,"",n)}function o(e){var r=Date.now(),i=t.date||r,o=t.date||r;s.utimes(e,i,o,n)}var a=this,s=a.fs;"function"==typeof t&&(n=t,t={}),t=t||{},n=n||function(){},e=r.resolve(a.pwd(),e),s.stat(e,function(r){r?t.updateOnly===!0?n():i(e):o(e)})},n.prototype.cat=function(e,t){function n(e,t){var n=r.resolve(o.pwd(),e);s.readFile(n,"utf8",function(e,n){return e?void t(e):(l+=n+"\n",void t())})}var o=this,s=o.fs,l="";return t=t||function(){},e?(e="string"==typeof e?[e]:e,void a.eachSeries(e,n,function(e){e?t(e):t(null,l.replace(/\n$/,""))})):void t(new i.EINVAL("Missing files argument"))},n.prototype.ls=function(e,t,n){function o(e,n){var i=r.resolve(s.pwd(),e),c=[];l.readdir(i,function(e,s){function u(e,n){e=r.join(i,e),l.stat(e,function(a,s){if(a)return void n(a);var l={path:r.basename(e),links:s.nlinks,size:s.size,modified:s.mtime,type:s.type};t.recursive&&"DIRECTORY"===s.type?o(r.join(i,l.path),function(e,t){return e?void n(e):(l.contents=t,c.push(l),void n())}):(c.push(l),n())})}return e?void n(e):void a.eachSeries(s,u,function(e){n(e,c)})})}var s=this,l=s.fs;return"function"==typeof t&&(n=t,t={}),t=t||{},n=n||function(){},e?void o(e,n):void n(new i.EINVAL("Missing dir argument"))},n.prototype.rm=function(e,t,n){function o(e,n){e=r.resolve(s.pwd(),e),l.stat(e,function(s,c){return s?void n(s):"FILE"===c.type?void l.unlink(e,n):void l.readdir(e,function(s,c){return s?void n(s):0===c.length?void l.rmdir(e,n):t.recursive?(c=c.map(function(t){return r.join(e,t)}),void a.eachSeries(c,o,function(t){return t?void n(t):void l.rmdir(e,n)})):void n(new i.ENOTEMPTY(null,e))})})}var s=this,l=s.fs;return"function"==typeof t&&(n=t,t={}),t=t||{},n=n||function(){},e?void o(e,n):void n(new i.EINVAL("Missing path argument"))},n.prototype.tempDir=function(e){var t=this,n=t.fs,r=t.env.get("TMP");e=e||function(){},n.mkdir(r,function(){e(null,r)})},n.prototype.mkdirp=function(e,t){function n(e,t){a.stat(e,function(o,s){if(s){if(s.isDirectory())return void t();if(s.isFile())return void t(new i.ENOTDIR(null,e))}else{if(o&&"ENOENT"!==o.code)return void t(o);var l=r.dirname(e);"/"===l?a.mkdir(e,function(e){return e&&"EEXIST"!=e.code?void t(e):void t()}):n(l,function(n){return n?t(n):void a.mkdir(e,function(e){return e&&"EEXIST"!=e.code?void t(e):void t()})})}})}var o=this,a=o.fs;return t=t||function(){},e?"/"===e?void t():void n(e,t):void t(new i.EINVAL("Missing path argument"))},n.prototype.find=function(e,t,n){function o(e,t){p(e,function(n){return n?void t(n):(h.push(e),void t())})}function l(e,n){var i=r.removeTrailing(e);return t.regex&&!t.regex.test(i)?void n():t.name&&!s(r.basename(i),t.name)?void n():t.path&&!s(r.dirname(i),t.path)?void n():void o(e,n)}function c(e,t){e=r.resolve(u.pwd(),e),d.readdir(e,function(n,i){return n?void("ENOTDIR"===n.code?l(e,t):t(n)):void l(r.addTrailing(e),function(n){return n?void t(n):(i=i.map(function(t){return r.join(e,t)}),void a.eachSeries(i,c,function(e){t(e,h)}))})})}var u=this,d=u.fs;"function"==typeof t&&(n=t,t={}),t=t||{},n=n||function(){};var p=t.exec||function(e,t){t()},h=[];return e?void d.stat(e,function(t,r){return t?void n(t):r.isDirectory()?void c(e,n):void n(new i.ENOTDIR(null,e))}):void n(new i.EINVAL("Missing path argument"))},t.exports=n},{"../../lib/async.js":1,"../encoding.js":17,"../errors.js":18,"../path.js":25,"./environment.js":31,minimatch:11}],33:[function(e,t){function n(e,t){this.node=e.id,this.dev=t,this.size=e.size,this.nlinks=e.nlinks,this.atime=e.atime,this.mtime=e.mtime,this.ctime=e.ctime,this.type=e.mode}var r=e("./constants.js");n.prototype.isFile=function(){return this.type===r.MODE_FILE},n.prototype.isDirectory=function(){return this.type===r.MODE_DIRECTORY},n.prototype.isSymbolicLink=function(){return this.type===r.MODE_SYMBOLIC_LINK},n.prototype.isSocket=n.prototype.isFIFO=n.prototype.isCharacterDevice=n.prototype.isBlockDevice=function(){return!1},t.exports=n},{"./constants.js":15}],34:[function(e,t){function n(e){var t=Date.now();this.id=r.SUPER_NODE_ID,this.mode=r.MODE_META,this.atime=e.atime||t,this.ctime=e.ctime||t,this.mtime=e.mtime||t,this.rnode=e.rnode}var r=e("./constants.js");n.create=function(e,t){e.guid(function(r,i){return r?void t(r):(e.rnode=e.rnode||i,void t(null,new n(e)))})},t.exports=n},{"./constants.js":15}]},{},[22])(22)}),function(e,t){"function"==typeof define&&define.amd?define("thirdparty/filer-dialogs/filer-dialogs",[],function(){return e.filerDialogs=t()}):"object"==typeof exports?module.exports=t():e.filerDialogs=t()}(this,function(){function e(e){var t=document.createElement("div");t.classList.add("file-dialog-wrapper");var n=document.createElement("div");n.classList.add("file-dialog-backdrop");var r=document.createElement("div");r.classList.add("file-dialog-inner-wrapper");var i=document.createElement("div");return i.classList.add("makedrive-file-dialog"),t.appendChild(r),r.appendChild(n),r.appendChild(i),dialogString='  <div class="file-dialog-header">    <h1 class="file-dialog-title"></h1>',e.saveAs&&(dialogString+='    <div class="file-name-container">      <span class="input-label">Name </span>      <span class="fa-floppy-o fa-icon floppy-icon"></span>      <input class="file-name-input" value="">    </div>'),dialogString+='    <div class="file-path">      <span class="input-label">Folder </span>      <span class="fa-arrow-left fa-icon back-button"></span>      <input class="folder-name" value="">      <span class="fa-chevron-down fa-icon drop-down"></span>    </div>  </div>  <div class="file-dialog-body">    <div class="file-selector-box"></div>    <div class="open-files-container"></div>  </div>  <div class="file-dialog-footer">    <button class="cancel-button" data-button-id="cancel"></button>    <button class="open-button" data-button-id="done"></button>  </div>',i.innerHTML=dialogString,i.querySelector(".open-button").textContent=e.done,i.querySelector(".cancel-button").textContent=e.cancel,i.querySelector(".file-dialog-title").textContent=e.title,t}function t(e,t){var n=document.createElement("span"),r=document.createElement("div"),i=document.createElement("span"),o=document.createElement("div"),a=document.createElement("div");return n.classList.add("file"),i.classList.add(t),i.classList.add("file-icon"),o.classList.add("file-name"),a.textContent=e,r.appendChild(i),o.appendChild(a),n.appendChild(r),n.appendChild(o),n}function n(){function n(e,t){t?(e.classList.remove("disabled"),e.disabled=!1):(e.classList.add("disabled"),e.disabled=!0)}function r(e){d.cd(e,function(e){return e?void console.error(e):void i()})}function i(){d.ls(".",function(e,n){if(e)return void console.error(e);var r=l.querySelector(".open-files-container");r.innerHTML="";var i=l.querySelector(".folder-name");i.value=d.pwd(),m=[],n.forEach(function(e){function n(t){var n=r.querySelectorAll(".selected"),i=l.querySelector(".file-name-input");if(i&&"DIRECTORY"!==e.type&&(i.value=e.path.trim()),!t.shiftKey||!g||"DIRECTORY"===e.type&&!v||m[0]&&"DIRECTORY"===m[0].type&&!v){if(n.length)for(var a=0;a<n.length;a++)n[a].classList.remove("selected");o.classList.add("selected"),m=[e]}else o.classList.add("selected"),m.unshift(e);E(e)}var i;i="DIRECTORY"===e.type?"fa-folder":"fa-file-code-o";var o=t(e.path,i);o.querySelector(".file-icon").addEventListener("mousedown",n),o.querySelector(".file-name").addEventListener("mousedown",n),o.querySelector(".file-icon").addEventListener("dblclick",y),r.appendChild(o)})})}function o(){window.removeEventListener("keydown",a,!0),c&&c.parentNode&&c.parentNode.removeChild(c)}function a(e){27===e.keyCode?o():13===e.keyCode&&_()}function s(t,n){window.appshell?h=appshell.MakeDrive:window.MakeDrive&&(h=window.MakeDrive),p=h.fs(),d=p.Shell(),f=h.Path,t=t||"/",c=e(n),l=c.querySelector(".makedrive-file-dialog"),u=l.querySelector(".open-button[data-button-id='done']"),$("body").append(c),l.querySelector(".cancel-button[data-button-id='cancel']").addEventListener("click",o),l.querySelector(".back-button").addEventListener("click",function(){r("../")}),window.addEventListener("keydown",a,!0),r(t)}var l,c,u,d,p,h,f,m=[],g=!1,v=!1,y=function(){},_=function(){},E=function(){};return{showSaveAsDialog:function(e,t,i,a){a=a||arguments[arguments.length-1],s(t,{title:e,cancel:"Cancel",done:"Save",saveAs:!0}),_=function(){var e=l.querySelector(".file-name-input").value.trim();e&&(a(null,f.join(d.pwd(),e)),o())},y=function(){var e=m[0];"DIRECTORY"===e.type&&r(e.path)},u.addEventListener("click",_);var c=l.querySelector(".file-name-input");c.focus(),i=i.trim(),n(u,i),c.value=i||"",c.addEventListener("input",function(){c.value.trim()?n(u,!0):n(u,!1)});var h=l.querySelector(".folder-name");h.addEventListener("change",function(){var e=h.value.trim();p.stat(e,function(t,n){return t||"DIRECTORY"!==n.type?void(h.value=d.pwd()):void r(e)})})},showOpenDialog:function(e,t,i,a,c,h){v=t,g=e,h=h||arguments[arguments.length-1],_=function(){var e=[],n="DIRECTORY"===m[0].type;if(m&&m.length&&(n&&t||!n&&!t)){for(var r=0;r<m.length;r++)e.push(f.join(d.pwd(),m[r].path));h(null,e),o()}},y=function(){var e=m[0];return n(u,!1),"DIRECTORY"===e.type?void r(e.path):void _()},E=function(e){t?n(u,"DIRECTORY"===e.type):n(u,"DIRECTORY"!==e.type)},s(a,{title:i,cancel:"Cancel",done:"Open"}),n(u,!1),u.addEventListener("click",_);var b=l.querySelector(".folder-name"),S=l.querySelector(".open-files-container");b.addEventListener("input",function(){var e=b.value.trim(),r=S.querySelector(".selected");r&&r.classList.remove("selected"),m=[],p.stat(e,function(e,r){if(e)return void n(u,!1);t?n(u,"DIRECTORY"===r.type):n(u,"DIRECTORY"!==r.type)})}),b.addEventListener("change",function(){var e=b.value.trim();p.stat(e,function(i,o){if(i)return void(b.value=d.pwd());var a,s;"DIRECTORY"===o.type&&t||"DIRECTORY"!==o.type&&!t?(n(u,!0),s=f.dirname(e),a=f.basename(e),d.cd(s,function(e){return e?void console.error(e):(m=[{path:a}],void y())})):(n(u,!1),"DIRECTORY"===o.type&&r(e))})})}}}return{showOpenDialog:function(){var e=new n;e.showOpenDialog.apply(null,arguments)},showSaveAsDialog:function(){var e=new n;e.showSaveAsDialog.apply(null,arguments)}}}),define("fileSystemImpl",["require","exports","module","filesystem/FileSystemError","filesystem/FileSystemStats","thirdparty/filer/dist/filer","thirdparty/filer-dialogs/filer-dialogs"],function(e,t){"use strict";function n(){w.showOpenDialog.apply(null,arguments)}function r(){w.showSaveAsDialog.apply(null,arguments)}function i(e){if(!e)return null;switch(e.code){case"EINVAL":return b.INVALID_PARAMS;case"ENOENT":return b.NOT_FOUND;case"EROFS":return b.NOT_WRITABLE;case"ENOSPC":return b.OUT_OF_SPACE;case"ENOTEMPTY":case"EEXIST":return b.ALREADY_EXISTS;case"ENOTDIR":return b.INVALID_PARAMS;case"EBADF":return b.NOT_READABLE}return b.UNKNOWN}function o(e){return function(){var t=Array.prototype.slice.call(arguments);t[0]=i(t[0]),e.apply(null,t)}}function a(e,t){_.stat(e,function(n,r){if(n)return void t(i(n));var o=new Date(r.mtime),a={isFile:r.isFile(),mtime:o,size:r.size,realPath:e,hash:o.getTime()},s=new S(a);t(null,s)})}function s(e,t){_.exists(e,function(e){t(null,e)})}function l(e,t){e=C.normalize(e),_.readdir(e,function(n,r){if(n)return void t(i(n));var o=r.length;if(!o)return void t(null,[],[]);var s=[];r.forEach(function(n,i){a(C.join(e,n),function(e,n){s[i]=e||n,o--,0>=o&&t(null,r,s)})})})}function c(e,t,n){"function"==typeof t&&(n=t),_.mkdir(e,t,function(t){return t?void n(i(t)):void a(e,n)})}function u(e,t,n){_.rename(e,t,o(n))}function d(e,n,r){"function"==typeof n&&(r=n),n=n||{};var o,a,s,l=n.encoding||"utf8",c=!1;n.stat?(c=!0,a=n.stat):t.stat(e,function(e,t){c?r(e,e?null:o,t):(c=!0,a=t,s=e)}),_.readFile(e,l,function(e,t){return e?void r(i(e)):void(c?r(s,s?null:t,a):(c=!0,o=t))})}function p(e,t,n,r){function o(n){_.writeFile(e,t,s,function(t){return t?void r(i(t)):void a(e,function(e,t){r(e,t,n)})})}"function"==typeof n&&(r=n),n=n||{};var s=n.encoding||"utf8";a(e,function(t,i){if(!t)return n.hasOwnProperty("expectedHash")&&n.expectedHash!==i._hash?(console.error("Blind write attempted: ",e,i._hash,n.expectedHash),n.hasOwnProperty("expectedContents")?void _.readFile(e,s,function(e,t){return e||t!==n.expectedContents?void r(b.CONTENTS_MODIFIED):void o(!1)}):void r(b.CONTENTS_MODIFIED)):void o(!1);switch(t){case b.NOT_FOUND:o(!0);break;default:r(t)}})}function h(e,t){_.unlink(e,function(e){t(i(e))})}function f(e,t){h(e,t)}function m(e){E=e}function g(e,t){e=C.normalize(e),D[e]||(D[e]=_.watch(e,{recursive:!0},function(e,t){a(t,function(e,n){e||E(t,n)})}),t())}function v(e,t){e=C.normalize(e),D[e]&&(D[e].close(),delete D[e]),t()}function y(e){Object.keys(D).forEach(function(e){v(e,function(){})}),e()}var _,E,b=e("filesystem/FileSystemError"),S=e("filesystem/FileSystemStats"),I=e("thirdparty/filer/dist/filer"),w=e("thirdparty/filer-dialogs/filer-dialogs"),C=I.Path,D={};I.fs=function(){return _?_:new I.FileSystem({provider:new I.FileSystem.providers.Memory})},_=I.fs(),appshell.Filer=I,t.showOpenDialog=n,t.showSaveDialog=r,t.exists=s,t.readdir=l,t.mkdir=c,t.rename=u,t.stat=a,t.readFile=d,t.writeFile=p,t.unlink=h,t.moveToTrash=f,t.initWatchers=m,t.watchPath=g,t.unwatchPath=v,t.unwatchAll=y,t.recursiveWatch=!0,t.normalizeUNCPaths=!1}),define("filesystem/FileSystem",["require","exports","module","filesystem/Directory","filesystem/File","filesystem/FileIndex","filesystem/FileSystemError","filesystem/WatchedRoot","utils/EventDispatcher","fileSystemImpl"],function(e,t){"use strict";function n(){this._index=new s,this._watchedRoots={},this._watchRequests=[],this._externalChanges=[]}function r(e){return"/"!==e[e.length-1]&&(e+="/"),e}function i(e){return function(){return e.apply(p,arguments)}}var o=e("filesystem/Directory"),a=e("filesystem/File"),s=e("filesystem/FileIndex"),l=e("filesystem/FileSystemError"),c=e("filesystem/WatchedRoot"),u=e("utils/EventDispatcher");u.makeEventDispatcher(n.prototype),n.prototype._impl=null,n.prototype._index=null,n.prototype._activeChangeCount=0,n.prototype._getActiveChangeCount=function(){return this._activeChangeCount},n.prototype._externalChanges=null,n.prototype._triggerExternalChangesNow=function(){this._externalChanges.forEach(function(e){this._handleExternalChange(e.path,e.stat)},this),this._externalChanges.length=0},n.prototype._enqueueExternalChange=function(e,t){this._externalChanges.push({path:e,stat:t}),this._activeChangeCount||this._triggerExternalChangesNow()},n.prototype._watchRequests=null,n.prototype._dequeueWatchRequest=function(){if(this._watchRequests.length>0){var e=this._watchRequests[0];e.fn.call(null,function(){var t=arguments;try{e.cb.apply(null,t)}finally{this._watchRequests.shift(),this._dequeueWatchRequest()}}.bind(this))}},n.prototype._enqueueWatchRequest=function(e,t){this._watchRequests.push({fn:e,cb:t}),1===this._watchRequests.length&&this._dequeueWatchRequest()},n.prototype._watchedRoots=null,n.prototype._findWatchedRootForPath=function(e){var t=null;return Object.keys(this._watchedRoots).some(function(n){return 0===e.indexOf(n)?(t=this._watchedRoots[n],!0):void 0},this),t},n.prototype._watchOrUnwatchEntry=function(e,t,n,r){var i=this._impl,o=i.recursiveWatch,a=r?"watchPath":"unwatchPath";o?e!==t.entry?n(null):this._enqueueWatchRequest(function(t){i[a].call(i,e.fullPath,t)}.bind(this),n):r?this._enqueueWatchRequest(function(n){var r=[],o=function(e){return t.filter(e.name,e.parentPath)?((e.isDirectory||e===t.entry)&&r.push(e),!0):!1};e.visit(o,function(e){if(e)return void n(e);var t=r.length;if(0===t)return void n(null);var o=function(){0===--t&&n(null)};r.forEach(function(e){i.watchPath(e.fullPath,o)})})},n):this._enqueueWatchRequest(function(t){i.unwatchPath(e.fullPath,t)},n)},n.prototype._watchEntry=function(e,t,n){this._watchOrUnwatchEntry(e,t,n,!0)},n.prototype._unwatchEntry=function(e,t,n){this._watchOrUnwatchEntry(e,t,function(t){this._index.visitAll(function(t){0===t.fullPath.indexOf(e.fullPath)&&t._clearCachedData(!0)}.bind(this)),n(t)}.bind(this),!1)},n.prototype.init=function(e){console.assert(!this._impl,"This FileSystem has already been initialized!");var t=this._enqueueExternalChange.bind(this),n=this._unwatchAll.bind(this);this._impl=e,this._impl.initWatchers(t,n)},n.prototype.close=function(){this._impl.unwatchAll(),this._index.clear()},n.prototype._indexFilter=function(e,t){var n=this._findWatchedRootForPath(e);return n?n.filter(t,e):!0},n.prototype._beginChange=function(){this._activeChangeCount++},n.prototype._endChange=function(){this._activeChangeCount--,this._activeChangeCount<0&&console.error("FileSystem _activeChangeCount has fallen below zero!"),this._activeChangeCount||this._triggerExternalChangesNow()},n.isAbsolutePath=function(e){return"/"===e[0]||":"===e[1]&&"/"===e[2]};var d=/\/{2,}/g;n.prototype._normalizePath=function(e,t){if(!n.isAbsolutePath(e))throw new Error("Paths must be absolute: '"+e+"'");var i=this._impl.normalizeUNCPaths&&0===e.search(d);if(e=e.replace(d,"/"),-1!==e.indexOf("..")){var o,a=e.split("/");for(o=1;o<a.length;o++)if(".."===a[o]){if(2>o)throw new Error("Invalid absolute path: '"+e+"'");a.splice(o-1,2),o-=2}e=a.join("/")}return t&&(e=r(e)),i&&(e="/"+e),e},n.prototype._getEntryForPath=function(e,t){var n=e===o;t=this._normalizePath(t,n);var r=this._index.getEntry(t);return r||(r=new e(t,this),this._index.addEntry(r)),r},n.prototype.getFileForPath=function(e){return this._getEntryForPath(a,e)},n.prototype.getDirectoryForPath=function(e){return this._getEntryForPath(o,e)},n.prototype.resolve=function(e,t){var n=this._normalizePath(e,!1),i=this._index.getEntry(n);i||(n=r(n),i=this._index.getEntry(n)),i?i.stat(function(e,n){return e?void t(e):void t(null,i,n)}):this._impl.stat(e,function(n,r){return n?void t(n):(i=r.isFile?this.getFileForPath(e):this.getDirectoryForPath(e),i._isWatched()&&(i._stat=r),void t(null,i,r))}.bind(this))},n.prototype.showOpenDialog=function(e,t,n,r,i,o){this._impl.showOpenDialog(e,t,n,r,i,o)},n.prototype.showSaveDialog=function(e,t,n,r){this._impl.showSaveDialog(e,t,n,r)},n.prototype._fireRenameEvent=function(e,t){this.trigger("rename",e,t)},n.prototype._fireChangeEvent=function(e,t,n){this.trigger("change",e,t,n)},n.prototype._handleRename=function(e,t,n){this._index.entryRenamed(e,t,n)},n.prototype._handleDirectoryChange=function(e,t){var n=e._contents;e._clearCachedData(),e.getContents(function(r,i){var o=n&&i.filter(function(e){return-1===n.indexOf(e)}),a=n&&n.filter(function(e){return-1===i.indexOf(e)}),s=this._findWatchedRootForPath(e.fullPath);if(!s||!s.filter(e.name,e.parentPath))return this._index.visitAll(function(t){0===t.fullPath.indexOf(e.fullPath)&&t._clearCachedData(!0)}.bind(this)),void t(o,a);var l=o?o.length:0,c=a?a.length:0,u=l+c;if(0===u)return void t(o,a);var d=function(e){e&&console.error("FileSystem error in _handleDirectoryChange after watch/unwatch entries: "+e),0===--u&&t(o,a)};o&&o.forEach(function(e){this._watchEntry(e,s,d)},this),a&&a.forEach(function(e){this._unwatchEntry(e,s,d)},this)}.bind(this))},n.prototype._handleExternalChange=function(e,t){if(!e)return this._index.visitAll(function(e){e._clearCachedData(!0)}),void this._fireChangeEvent(null);e=this._normalizePath(e,!1);var n=this._index.getEntry(e);if(n){var r=n._stat;n.isFile?t&&r&&t.mtime.getTime()===r.mtime.getTime()||(n._clearCachedData(),n._stat=t,this._fireChangeEvent(n)):this._handleDirectoryChange(n,function(e,r){n._stat=t,this._fireChangeEvent(n,e,r)}.bind(this))}},n.prototype.clearAllCaches=function(){this._handleExternalChange(null)},n.prototype.watch=function(e,t,n){var r=e.fullPath;n=n||function(){};var i=this._findWatchedRootForPath(r);if(i&&(i.status===c.STARTING||i.status===c.ACTIVE))return void n("A parent of this root is already watched");var o=Object.keys(this._watchedRoots).some(function(e){var t=this._watchedRoots[e],n=t.entry.fullPath;return 0===n.indexOf(r)},this);if(o&&(o.status===c.STARTING||o.status===c.ACTIVE))return void n("A child of this root is already watched");var a=new c(e,t);this._watchedRoots[r]=a,a.status=c.STARTING,this._watchEntry(e,a,function(t){return t?(console.warn("Failed to watch root: ",e.fullPath,t),delete this._watchedRoots[r],void n(t)):(a.status=c.ACTIVE,void n(null))}.bind(this))},n.prototype.unwatch=function(e,t){var n=e.fullPath,r=this._watchedRoots[n];return t=t||function(){},r?(r.status=c.INACTIVE,void this._unwatchEntry(e,r,function(r){return delete this._watchedRoots[n],this._index.visitAll(function(t){0===t.fullPath.indexOf(e.fullPath)&&this._index.removeEntry(t)
}.bind(this)),r?(console.warn("Failed to unwatch root: ",e.fullPath,r),void t(r)):void t(null)}.bind(this))):void t(l.ROOT_NOT_WATCHED)},n.prototype._unwatchAll=function(){console.warn("File watchers went offline!"),Object.keys(this._watchedRoots).forEach(function(e){var t=this._watchedRoots[e];t.status=c.INACTIVE,delete this._watchedRoots[e],this._unwatchEntry(t.entry,t,function(){console.warn("Watching disabled for",t.entry.fullPath)})},this),this._handleExternalChange(null)};var p;t.init=i(n.prototype.init),t.close=i(n.prototype.close),t.shouldShow=i(n.prototype.shouldShow),t.getFileForPath=i(n.prototype.getFileForPath),t.getDirectoryForPath=i(n.prototype.getDirectoryForPath),t.resolve=i(n.prototype.resolve),t.showOpenDialog=i(n.prototype.showOpenDialog),t.showSaveDialog=i(n.prototype.showSaveDialog),t.watch=i(n.prototype.watch),t.unwatch=i(n.prototype.unwatch),t.clearAllCaches=i(n.prototype.clearAllCaches),t.isAbsolutePath=n.isAbsolutePath,t._getActiveChangeCount=i(n.prototype._getActiveChangeCount),t.on=function(e,t){p.on(e,t)},t.off=function(e,t){p.off(e,t)},t._FileSystem=n,p=new n,p.init(e("fileSystemImpl"))}),define("utils/KeyEvent",{DOM_VK_CANCEL:3,DOM_VK_HELP:6,DOM_VK_BACK_SPACE:8,DOM_VK_TAB:9,DOM_VK_CLEAR:12,DOM_VK_RETURN:13,DOM_VK_ENTER:14,DOM_VK_SHIFT:16,DOM_VK_CONTROL:17,DOM_VK_ALT:18,DOM_VK_PAUSE:19,DOM_VK_CAPS_LOCK:20,DOM_VK_ESCAPE:27,DOM_VK_SPACE:32,DOM_VK_PAGE_UP:33,DOM_VK_PAGE_DOWN:34,DOM_VK_END:35,DOM_VK_HOME:36,DOM_VK_LEFT:37,DOM_VK_UP:38,DOM_VK_RIGHT:39,DOM_VK_DOWN:40,DOM_VK_PRINTSCREEN:44,DOM_VK_INSERT:45,DOM_VK_DELETE:46,DOM_VK_0:48,DOM_VK_1:49,DOM_VK_2:50,DOM_VK_3:51,DOM_VK_4:52,DOM_VK_5:53,DOM_VK_6:54,DOM_VK_7:55,DOM_VK_8:56,DOM_VK_9:57,DOM_VK_A:65,DOM_VK_B:66,DOM_VK_C:67,DOM_VK_D:68,DOM_VK_E:69,DOM_VK_F:70,DOM_VK_G:71,DOM_VK_H:72,DOM_VK_I:73,DOM_VK_J:74,DOM_VK_K:75,DOM_VK_L:76,DOM_VK_M:77,DOM_VK_N:78,DOM_VK_O:79,DOM_VK_P:80,DOM_VK_Q:81,DOM_VK_R:82,DOM_VK_S:83,DOM_VK_T:84,DOM_VK_U:85,DOM_VK_V:86,DOM_VK_W:87,DOM_VK_X:88,DOM_VK_Y:89,DOM_VK_Z:90,DOM_VK_CONTEXT_MENU:93,DOM_VK_NUMPAD0:96,DOM_VK_NUMPAD1:97,DOM_VK_NUMPAD2:98,DOM_VK_NUMPAD3:99,DOM_VK_NUMPAD4:100,DOM_VK_NUMPAD5:101,DOM_VK_NUMPAD6:102,DOM_VK_NUMPAD7:103,DOM_VK_NUMPAD8:104,DOM_VK_NUMPAD9:105,DOM_VK_MULTIPLY:106,DOM_VK_ADD:107,DOM_VK_SEPARATOR:108,DOM_VK_SUBTRACT:109,DOM_VK_DECIMAL:110,DOM_VK_DIVIDE:111,DOM_VK_F1:112,DOM_VK_F2:113,DOM_VK_F3:114,DOM_VK_F4:115,DOM_VK_F5:116,DOM_VK_F6:117,DOM_VK_F7:118,DOM_VK_F8:119,DOM_VK_F9:120,DOM_VK_F10:121,DOM_VK_F11:122,DOM_VK_F12:123,DOM_VK_F13:124,DOM_VK_F14:125,DOM_VK_F15:126,DOM_VK_F16:127,DOM_VK_F17:128,DOM_VK_F18:129,DOM_VK_F19:130,DOM_VK_F20:131,DOM_VK_F21:132,DOM_VK_F22:133,DOM_VK_F23:134,DOM_VK_F24:135,DOM_VK_NUM_LOCK:144,DOM_VK_SCROLL_LOCK:145,DOM_VK_SEMICOLON:186,DOM_VK_EQUALS:187,DOM_VK_COMMA:188,DOM_VK_DASH:189,DOM_VK_PERIOD:190,DOM_VK_SLASH:191,DOM_VK_BACK_QUOTE:192,DOM_VK_OPEN_BRACKET:219,DOM_VK_BACK_SLASH:220,DOM_VK_CLOSE_BRACKET:221,DOM_VK_QUOTE:222,DOM_VK_META:224}),define("text!base-config/keyboard.json",[],function(){return'{\n    "file.newDoc":  [\n        "Ctrl-N"\n    ],\n    "file.open":  [\n        "Ctrl-O"\n    ],\n    "file.close":  [\n        "Ctrl-W"\n    ],\n    "file.openFolder": [\n        "Ctrl-Alt-O"\n    ],\n    "file.close_all":  [\n        "Ctrl-Shift-W"\n    ],\n    "file.save":  [\n        "Ctrl-S"\n    ],\n    "file.saveAll":  [\n        "Ctrl-Alt-S"\n    ],\n    "file.saveAs":  [\n        "Ctrl-Shift-S"\n    ],    \n    "file.liveFilePreview":  [\n        "Ctrl-Alt-P"\n    ],\n    "file.reloadLivePreview": [\n        {\n            "key": "Ctrl-Shift-R"\n        }\n    ],\n    "file.previewHighlight":  [\n        "Ctrl-Shift-C"\n    ],\n    "file.quit":  [\n        "Ctrl-Q"\n    ],\n    "edit.undo": [\n        "Ctrl-Z"\n    ],\n    "edit.redo": [\n        {\n            "key": "Ctrl-Y"\n        },\n        {\n            "key": "Cmd-Shift-Z",\n            "platform": "mac"\n        }\n    ],\n    "edit.cut": [\n        "Ctrl-X"\n    ],\n    "edit.copy": [\n        "Ctrl-C"\n    ],\n    "edit.paste": [\n        "Ctrl-V"\n    ],\n    "edit.selectAll":  [\n        "Ctrl-A"\n    ],\n    "edit.selectLine":  [\n        {\n            "key": "Ctrl-L"\n        },\n        {\n            "key": "Ctrl-L",\n            "platform": "mac"\n        }\n    ],\n    "edit.splitSelIntoLines": [\n        "Ctrl-Alt-L"\n    ],\n    "edit.addCursorToPrevLine": [\n        {\n            "key": "Shift-Alt-Up",\n            "displayKey": "Shift-Alt-↑"\n        }\n    ],\n    "edit.addCursorToNextLine": [\n        {\n            "key": "Shift-Alt-Down",\n            "displayKey": "Shift-Alt-↓"\n        }\n    ],\n    "edit.indent":  [\n        {\n            "key": "Ctrl-]"\n        }\n    ],\n    "edit.unindent":  [\n        {\n            "key": "Ctrl-["\n        }\n    ],\n    "edit.duplicate":  [\n        "Ctrl-D"\n    ],\n    "edit.deletelines":  [\n        "Ctrl-Shift-D"\n    ],\n    "edit.lineUp":  [\n        {\n            "key": "Ctrl-Shift-Up",\n            "displayKey": "Ctrl-Shift-↑"\n        },\n        {\n            "key": "Cmd-Ctrl-Up",\n            "displayKey": "Cmd-Ctrl-↑",\n            "platform": "mac"\n        }\n    ],\n    "edit.lineDown":  [\n        {\n            "key": "Ctrl-Shift-Down",\n            "displayKey": "Ctrl-Shift-↓"\n        },\n        {\n            "key": "Cmd-Ctrl-Down",\n            "displayKey": "Cmd-Ctrl-↓",\n            "platform": "mac"\n        }\n    ],\n    "edit.openLineAbove":  [\n        "Ctrl-Shift-Enter"\n    ],\n    "edit.openLineBelow":  [\n        "Ctrl-Enter"\n    ],\n    "edit.lineComment":  [\n        "Ctrl-/"\n    ],\n    "edit.blockComment":  [\n        {\n            "key": "Ctrl-Shift-/"\n        },\n        {\n            "key": "Cmd-Opt-/",\n            "platform": "mac"\n        }\n    ],\n    "edit.showCodeHints":  [\n        {\n            "key": "Ctrl-Space"\n        },\n        {\n            "key": "Ctrl-Space",\n            "platform": "mac"\n        }\n    ],\n    "cmd.find":  [\n        "Ctrl-F"\n    ],\n    "cmd.findInFiles":  [\n        "Ctrl-Shift-F"\n    ],\n    "cmd.replaceInFiles":  [\n        {\n            "key": "Ctrl-Shift-H"\n        },\n        {\n            "key": "Cmd-Opt-Shift-F",\n            "platform": "mac"\n        }\n    ],\n    "cmd.findNext":  [\n        {\n            "key": "F3"\n        },\n        {\n            "key": "Cmd-G",\n            "platform": "mac"\n        }\n    ],\n    "cmd.findPrevious":  [\n        {\n            "key": "Shift-F3"\n        },\n        {\n            "key": "Cmd-Shift-G",\n            "platform": "mac"\n        }\n    ],\n    "cmd.findAllAndSelect": [\n        {\n            "key": "Alt-F3"\n        },\n        {\n            "key": "Cmd-Ctrl-G",\n            "platform": "mac"\n        }\n    ],\n    "cmd.addNextMatch": [\n        {\n            "key": "Ctrl-B"\n        }\n    ],\n    "cmd.skipCurrentMatch": [\n        {\n            "key": "Ctrl-Shift-B"\n        }\n    ],\n    "cmd.replace":  [\n        {\n            "key": "Ctrl-H"\n        },\n        {\n            "key": "Cmd-Opt-F",\n            "platform": "mac"\n        }\n    ],\n    "view.hideSidebar":  [\n        {   \n            "key" : "Ctrl-Alt-H"\n        },\n        {\n            "key": "Cmd-Shift-H",\n            "platform": "mac"\n        }\n    ],\n    "view.increaseFontSize":  [\n        {\n            "key": "Ctrl-=",\n            "displayKey": "Ctrl-+"\n        },\n        {\n            "key": "Ctrl-+"\n        }\n    ],\n    "view.decreaseFontSize":  [\n        {\n            "key": "Ctrl--",\n            "displayKey": "Ctrl-−"\n        }\n    ],\n    "view.restoreFontSize":  [\n        "Ctrl-0"\n    ],\n    "view.scrollLineUp":  [\n        {\n            "key": "Ctrl-Up",\n            "displayKey": "Ctrl-\\u2191"\n        },\n        {\n            "key": "Ctrl-Opt-Up",\n            "displayKey": "Ctrl-Opt-\\u2191",\n            "platform": "mac"\n        }\n    ],\n    "view.scrollLineDown":  [\n        {\n            "key": "Ctrl-Down",\n            "displayKey": "Ctrl-\\u2193"\n        },\n        {\n            "key": "Ctrl-Opt-Down",\n            "displayKey": "Ctrl-Opt-\\u2193",\n            "platform": "mac"\n        }\n    ],\n    "navigate.quickOpen":  [\n        "Ctrl-Shift-O"\n    ],\n    "navigate.gotoLine":  [\n        {\n            "key": "Ctrl-G"\n        },\n        {\n            "key": "Cmd-L",\n            "platform": "mac"\n        }\n    ],\n    "navigate.gotoDefinition":  [\n        "Ctrl-T"\n    ],\n    "navigate.jumptoDefinition":  [\n        "Ctrl-J"\n    ],\n    "navigate.gotoFirstProblem":  [\n        {\n            "key": "F8"\n        },\n        {\n            "key": "Cmd-\'",\n            "platform": "mac"\n        }\n    ],\n    "navigate.nextDoc":  [\n        {\n            "key": "Ctrl-Tab"\n        },\n        {\n            "key": "Ctrl-Tab",\n            "platform": "mac"\n        },\n        {\n            "key": "Cmd-Shift-]",\n            "platform": "mac"\n        }\n    ],\n    "navigate.prevDoc":  [\n        {\n            "key": "Ctrl-Shift-Tab"\n        },\n        {\n            "key": "Ctrl-Shift-Tab",\n            "platform": "mac"\n        },\n        {\n            "key": "Cmd-Shift-[",\n            "platform": "mac"\n        }\n    ],\n    "navigate.toggleQuickEdit":  [\n        "Ctrl-E"\n    ],\n    "navigate.toggleQuickDocs":  [\n        "Ctrl-K"\n    ],\n    "navigate.previousMatch":  [\n        {\n            "key": "Alt-Up",\n            "displayKey": "Alt-↑"\n        }\n    ],\n    "navigate.nextMatch":  [\n        {\n            "key": "Alt-Down",\n            "displayKey": "Alt-↓"\n        }\n    ],\n    "navigate.newRule":  [\n        "Ctrl-Alt-N"\n    ],\n    "file.rename":  [\n        "F2"\n    ],\n    "help.support": [\n        "F1"\n    ]\n}\n'}),define("command/KeyBindingManager",["require","exports","module","utils/Global","utils/AppInit","command/Commands","command/CommandManager","widgets/DefaultDialogs","utils/EventDispatcher","filesystem/FileSystem","filesystem/FileSystemError","file/FileUtils","utils/KeyEvent","strings","utils/StringUtils","utils/UrlParams","thirdparty/lodash","text!base-config/keyboard.json"],function(e,t){"use strict";function n(){ft=!0,vt=gt.NOT_YET_DETECTED,yt=!1,k=null,F=null,$(window).off("keyup",U)}function r(e){"win"===brackets.platform&&(yt?("Control"===e.keyIdentifier||"Alt"===e.keyIdentifier)&&(e.altKey&&e.ctrlKey&&e.keyIdentifier===F?n():F=e.keyIdentifier):(vt!==gt.DETECTED_AND_IGNORED&&e.ctrlKey&&"Control"===e.keyIdentifier?vt=gt.DETECTED:e.repeat&&e.ctrlKey&&"Control"===e.keyIdentifier?vt=gt.DETECTED_AND_IGNORED:vt===gt.DETECTED&&e.altKey&&e.ctrlKey&&"Alt"===e.keyIdentifier&&e.timeStamp-k<_t?(yt=!0,F="Alt",ft=!1,$(window).on("keyup",U)):vt=gt.NOT_YET_DETECTED,k=e.timeStamp))}function i(){nt={},rt={},it={},ot={},at={},mt=[],tt=brackets.app.getApplicationSupportDirectory()+"/"+et}function o(e,t,n,r,i){if(!i)return console.log("KeyBindingManager _buildKeyDescriptor() - No key provided!"),"";var o=[];return e&&o.push("Ctrl"),n&&o.push("Alt"),r&&o.push("Shift"),t&&("mac"===brackets.platform?o.push("Cmd"):o.unshift("Ctrl")),o.push(i),o.join("-")}function a(e){function t(e,t){return e&&t?(e=e.trim().toLowerCase(),t=t.trim().toLowerCase(),e.length>0&&e===t):!1}var n=!1,r=!1,i=!1,a=!1,s="",l=!1;return e.split("-").forEach(function(o){t("ctrl",o)?"mac"===brackets.platform?n=!0:r=!0:t("cmd",o)?"mac"===brackets.platform?r=!0:l=!0:t("alt",o)?i=!0:t("opt",o)?"mac"===brackets.platform?i=!0:l=!0:t("shift",o)?a=!0:s.length>0?(console.log("KeyBindingManager normalizeKeyDescriptorString() - Multiple keys defined. Using key: "+s+" from: "+e),l=!0):s=o}),l?null:(""===s&&-1!==e.search(/^.+--$/)&&(s="-"),s.indexOf("+")>=0&&s.length>1?null:(/^[a-z]/i.test(s)&&(s=s.charAt(0).toUpperCase()+s.substr(1).toLowerCase()),/^Page/.test(s)&&(s=s.replace(/(up|down)$/,function(e,t){return t.charAt(0).toUpperCase()+t.substr(1)})),s.length>1&&!/F\d+/.test(s)&&-1===pt.indexOf(s)?null:o(n,r,i,a,s)))}function s(e,t){if(e>=z.DOM_VK_0&&e<=z.DOM_VK_9)return String(e-z.DOM_VK_0);if(e>=z.DOM_VK_NUMPAD0&&e<=z.DOM_VK_NUMPAD9)return String(e-z.DOM_VK_NUMPAD0);switch(e){case z.DOM_VK_SEMICOLON:return";";case z.DOM_VK_EQUALS:return"=";case z.DOM_VK_COMMA:return",";case z.DOM_VK_SUBTRACT:case z.DOM_VK_DASH:return"-";case z.DOM_VK_ADD:return"+";case z.DOM_VK_DECIMAL:case z.DOM_VK_PERIOD:return".";case z.DOM_VK_DIVIDE:case z.DOM_VK_SLASH:return"/";case z.DOM_VK_BACK_QUOTE:return"`";case z.DOM_VK_OPEN_BRACKET:return"[";case z.DOM_VK_BACK_SLASH:return"\\";case z.DOM_VK_CLOSE_BRACKET:return"]";case z.DOM_VK_QUOTE:return"'";default:return t}}function l(e){var t="mac"===brackets.platform?e.ctrlKey:!1,n="mac"!==brackets.platform?e.ctrlKey:e.metaKey,r=e.altKey,i=e.shiftKey,a=String.fromCharCode(e.keyCode),l=e.keyIdentifier;return l&&(a="U"===l.charAt(0)&&"+"===l.charAt(1)?String.fromCharCode(parseInt(l.substring(2),16)):l),a="	"===a?"Tab":" "===a?"Space":"\b"===a?"Backspace":"Help"===a?"Insert":e.keyCode===z.DOM_VK_DELETE?"Delete":s(e.keyCode,a),o(t,n,r,i,a)}function c(e){var t;return"mac"===brackets.platform?(t=e.replace(/-(?!$)/g,""),t=t.replace("Ctrl","⌃"),t=t.replace("Cmd","⌘"),t=t.replace("Shift","⇧"),t=t.replace("Alt","⌥")):(t=e.replace("Ctrl",Y.KEYBOARD_CTRL),t=t.replace("Shift",Y.KEYBOARD_SHIFT),t=t.replace("Space",Y.KEYBOARD_SPACE),t=t.replace(/-(?!$)/g,"+")),t}function u(e){return void 0!==nt[e]}function d(e,t){if(e&&(null===t||void 0===t||t===brackets.platform)){var n=a(e);if(n){if(u(n)){var r=nt[n],i=B.get(r.commandID),o=at[r.commandID];delete nt[n],o&&(at[r.commandID]=o.filter(function(e){return e.key!==n}),i&&i.trigger("keyBindingRemoved",{key:n,displayKey:r.displayKey}))}}else console.log("Fail to nomalize "+e)}}function p(e){0!==st.length&&e&&e.commandID&&-1===st.indexOf(e.commandID)&&(rt[e.commandID]=J.cloneDeep(e),P())}function h(e,n,r,i){var o,s,l,c,u,h,f=null,m=n.platform||r,g=[];if(c=m&&"all"!==m?m:brackets.platform,"mac"===m&&"mac"!==brackets.platform)return null;if(o=n.key||n,"mac"!==brackets.platform||void 0!==m&&"all"!==m||(o=o.replace("Ctrl","Cmd"),void 0!==n.displayKey&&(n.displayKey=n.displayKey.replace("Ctrl","Cmd"))),s=a(o),!s)return console.error("Unable to parse key binding "+o+". Permitted modifiers: Ctrl, Cmd, Alt, Opt, Shift; separated by '-' (not '+')."),null;if(h=nt[s],t.useWindowsCompatibleBindings&&"win"===m){if(h&&(!h.explicitPlatform||h.explicitPlatform===brackets.platform||"all"===h.explicitPlatform))return null;c=brackets.platform}if(c!==brackets.platform)return null;h&&!h.explicitPlatform&&m&&(d(s),h=!1);var v,y,_,E=at[e]||[];return E.forEach(function(e){v=t.useWindowsCompatibleBindings&&"win"===e.explicitPlatform,y=!e.explicitPlatform&&m,v||y?g.push(e):_=e.explicitPlatform&&!m}),_?null:h?(console.error("Cannot assign "+s+" to "+e+". It is already assigned to "+nt[s].commandID),null):(g.forEach(function(e){d(e.key)}),l=n.displayKey?a(n.displayKey):s,at[e]||(at[e]=[]),f={key:s,displayKey:l,explicitPlatform:m},at[e].push(f),nt[s]={commandID:e,key:s,displayKey:l,explicitPlatform:m},i||p(nt[s]),u=B.get(e),u&&u.trigger("keyBindingAdded",f),f)}function f(e){return $.extend({},e?rt:nt)}function m(e){if(ft&&nt[e]){var t=B.execute(nt[e].commandID);return"rejected"!==t.state()}return!1}function g(e,t){var n=e.platform?1:0,r=t.platform?1:0;return r-n}function v(e,t,n){var r,i="";if(!e)return void console.error("addBinding(): missing required parameter: command");if(t){if(i="string"==typeof e?e:e.getID(),Array.isArray(t)){var o;r=[],t.sort(g),t.forEach(function(e){o=h(i,e,e.platform),o&&r.push(o)})}else r=h(i,t,n);return r}}function y(e){var t=[],n="";return e?(n="string"==typeof e?e:e.getID(),t=at[n],t||[]):(console.error("getKeyBindings(): missing required parameter: command"),[])}function _(e,t){var n=t.getID(),r=Z[n];r&&v(n,r)}function E(e){mt.push(e)}function b(e){var t=mt.indexOf(e);-1!==t&&mt.splice(t,1)}function S(e){var t,n=!1;for(t=mt.length-1;t>=0;t--)if(mt[t](e)){n=!0;break}r(e),!n&&m(l(e))&&(e.stopPropagation(),e.preventDefault())}function I(t,n){e(["widgets/Dialogs"],function(e){var r=Y.ERROR_KEYMAP_CORRUPT;t===K.UNSUPPORTED_ENCODING?r=Y.ERROR_LOADING_KEYMAP:n&&(r=n),e.showModalDialog(H.DIALOG_ID_ERROR,Y.ERROR_KEYMAP_TITLE,r).done(function(){t!==K.UNSUPPORTED_ENCODING&&B.execute(V.FILE_OPEN_KEYMAP)})})}function w(e){return"mac"===brackets.platform&&"file.quit"===e?!0:ct.indexOf(e)>-1}function C(e){return e?ut.indexOf(e)>-1||ut.indexOf(e.replace("Cmd","Ctrl"))>-1?!0:"mac"===brackets.platform&&dt.indexOf(e)>-1?!0:!1:!1}function D(e){var t="<ul class='dialog-list'>";return e.forEach(function(e){t+="<li>"+e+"</li>"}),t+="</ul>"}function T(e){var t="",n=e?e.match(/(Up|Down|Left|Right|\-)$/i):null;return n&&!/Page(Up|Down)/.test(e)&&(t=e.substr(0,n.index)+lt[n[0].toLowerCase()]),t}function O(){var e=[],t=[],n=[],r=[],i=[],o=[],s=[],l=[],c="";J.forEach(it,function(c,p){var f=a(p),m=at[c]||[];if(w(c))return void n.push(c);if(C(f))return void r.push(p);if(!f)return void i.push(p);if(u(f)){if(-1!==t.indexOf(f))return void l.push(p);if(nt[f].commandID===c)return void e.push(c);d(f)}if(-1===t.indexOf(f)&&t.push(f),m.length&&m.forEach(function(e){d(e.key)}),c)if(-1!==st.indexOf(c))if(-1===e.indexOf(c)){var g={key:f};g.displayKey=T(f),h(c,g.displayKey?g:f,brackets.platform,!0),e.push(c)}else s.push(c);else o.push(c)}),n.length&&(c=X.format(Y.ERROR_RESTRICTED_COMMANDS,D(n))),r.length&&(c+=X.format(Y.ERROR_RESTRICTED_SHORTCUTS,D(r))),s.length&&(c+=X.format(Y.ERROR_MULTIPLE_SHORTCUTS,D(s))),l.length&&(c+=X.format(Y.ERROR_DUPLICATE_SHORTCUTS,D(l))),i.length&&(c+=X.format(Y.ERROR_INVALID_SHORTCUTS,D(i))),o.length&&(c+=X.format(Y.ERROR_NONEXISTENT_COMMANDS,D(o))),ht&&c&&I("",c)}function M(){J.forEach(ot,function(e,t){var n=a(t),r=J.find(J.toArray(rt),{commandID:e}),i=rt[n];w(e)||C(n)||(u(n)&&it[t]!==e&&it[n]!==e&&d(n),r&&v(e,r,brackets.platform),i&&i.key&&v(i.commandID,i.key,brackets.platform))})}function L(){return window.isBracketsTestWindow?brackets.app.getApplicationSupportDirectory()+"/_test_/"+et:tt}function R(){var e=G.getFileForPath(L()),t=new $.Deferred;return e.exists(function(n,r){r?q.readAsText(e).done(function(e){var n={};try{if(e){var r=JSON.parse(e);t.resolve(r&&r.overrides||n)}else t.resolve(n)}catch(i){t.reject(i)}}).fail(function(e){t.reject(e)}):t.resolve()}),t.promise()}function N(){var e=L(),t=G.getFileForPath(e);t.exists(function(n,r){if(r)B.execute(V.FILE_OPEN,{fullPath:e});else{var i='{\n    "documentation": "https://github.com/adobe/brackets/wiki/User-Key-Bindings",\n    "overrides": {\n        \n    }\n}\n';q.writeText(t,i,!0).done(function(){B.execute(V.FILE_OPEN,{fullPath:e})})}})}function x(){st=B.getAll(),rt=J.cloneDeep(nt)}function A(e){tt=e}e("utils/Global");var P,k,F,U,j=e("utils/AppInit"),V=e("command/Commands"),B=e("command/CommandManager"),H=e("widgets/DefaultDialogs"),W=e("utils/EventDispatcher"),G=e("filesystem/FileSystem"),K=e("filesystem/FileSystemError"),q=e("file/FileUtils"),z=e("utils/KeyEvent"),Y=e("strings"),X=e("utils/StringUtils"),Q=e("utils/UrlParams").UrlParams,J=e("thirdparty/lodash"),Z=JSON.parse(e("text!base-config/keyboard.json")),et="keymap.json",tt=brackets.app.getApplicationSupportDirectory()+"/"+et,nt={},rt={},it={},ot={},at={},st=[],lt={up:"↑",down:"↓",left:"←",right:"→","-":"−"},ct=[V.EDIT_UNDO,V.EDIT_REDO,V.EDIT_SELECT_ALL,V.EDIT_CUT,V.EDIT_COPY,V.EDIT_PASTE],ut=["Ctrl-Z","Ctrl-Y","Ctrl-A","Ctrl-X","Ctrl-C","Ctrl-V"],dt=["Cmd-,","Cmd-H","Cmd-Alt-H","Cmd-M","Cmd-Shift-Z","Cmd-Q"],pt=["Up","Down","Left","Right","Backspace","Enter","Space","Tab","PageUp","PageDown","Home","End","Insert","Delete"],ht=!0,ft=!0,mt=[],gt={NOT_YET_DETECTED:0,DETECTED:1,DETECTED_AND_IGNORED:2},vt=gt.NOT_YET_DETECTED,yt=!1,_t=30;U=function(e){var t=e.keyCode||e.which;yt&&t===z.DOM_VK_CONTROL&&n()},j.htmlReady(function(){window.document.body.addEventListener("keydown",S,!0),t.useWindowsCompatibleBindings="mac"!==brackets.platform&&"win"!==brackets.platform}),P=J.debounce(function(){R().then(function(e){st=B.getAll(),ot=J.cloneDeep(it),it=e,M(),O()},function(e){I(e)})},200),W.on_duringInit(B,"commandRegistered",_),B.register(Y.CMD_OPEN_KEYMAP,V.FILE_OPEN_KEYMAP,N),e(["document/DocumentManager"],function(e){e.on("documentSaved",function(e,t){t&&t.file.fullPath===tt&&P()})}),j.extensionsLoaded(function(){var e=new Q;e.parse(),"true"===e.get("reloadWithoutUserExts")&&(ht=!1),x(),P()}),t._reset=i,t._setUserKeyMapFilePath=A,t._getDisplayKey=T,t._loadUserKeyMap=P,t._initCommandAndKeyMaps=x,t._onCtrlUp=U,t.getKeymap=f,t.addBinding=v,t.removeBinding=d,t.formatKeyDescriptor=c,t.getKeyBindings=y,t.addGlobalKeydownHook=E,t.removeGlobalKeydownHook=b,t.useWindowsCompatibleBindings=!1,t._handleKey=m,t._handleKeyEvent=S}),define("text!htmlContent/dialog-template.html",[],function(){return'<div class="{{dlgClass}} template modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">{{{title}}}</h1>\n    </div>\n    <div class="modal-body">\n        <div class="dialog-message">{{{message}}}</div>\n    </div>\n    <div class="modal-footer">\n        {{#buttons}}\n        <button class="dialog-button btn {{className}}" data-button-id="{{id}}">{{{text}}}</button>\n        {{/buttons}}\n    </div>\n</div>\n'}),define("widgets/Dialogs",["require","exports","module","utils/Global","command/KeyBindingManager","utils/KeyEvent","strings","text!htmlContent/dialog-template.html"],function(e,t){"use strict";function n(e,t){e.data("buttonId",t),e.modal("hide")}function r(e,t,r){r?n(e,t):e.triggerHandler("buttonClick",t)}function i(e,t){return e.find("[data-button-id='"+t+"']").length>0}function o(e,t){function n(){e.stopPropagation(),e.preventDefault()}var r=$(":input:enabled, a",t).filter(":visible");$(e.target).closest(t).length?!e.shiftKey&&e.target===r[r.length-1]||e.shiftKey&&e.target===r[0]?(r.filter(e.shiftKey?":last":":first").focus(),n()):r.length||n():(r.first().focus(),n())}function a(e,t){this._$dlg=e,this._promise=t}function s(){var e,t,n=$(".modal-inner-wrapper > .instance");n.length>0&&(e=$("body").width(),t=$("body").height(),n.css({"max-width":e,"max-height":t,overflow:"auto"}))}function l(e,t){void 0===t&&(t=!0),$("body").append("<div class='modal-wrapper'><div class='modal-inner-wrapper'></div></div>");var n=new $.Deferred,i=n.promise(),o=$(e).addClass("instance").appendTo(".modal-inner-wrapper:last");s(),o.data("promise",i);var l=function(e){return C.call(o,e,t)};return o.one("hidden",function(){var e=o.data("buttonId");e||(e=m),window.setTimeout(function(){n.resolve(e)},0),o.remove(),d.removeGlobalKeydownHook(l),$(".modal-wrapper:last").remove()}).one("shown",function(){var e=o.find(".primary:enabled"),t=o.find(".modal-footer .dialog-button:enabled:eq(0)");e.length?e.focus():t.length?t.focus():document.activeElement.blur(),d.addGlobalKeydownHook(l)}),o.one("click",".dialog-button",function(){r(o,$(this).attr("data-button-id"),t)}),o.modal({backdrop:"static",show:!0,selector:".modal-inner-wrapper:last",keyboard:!1}).css("z-index",w+1).next().css("z-index",w),w+=2,new a(o,i)}function c(e,t,n,r,i){var o={dlgClass:e,title:t||"",message:n||"",buttons:r||[{className:b,id:g,text:h.OK}]},a=Mustache.render(f,o);return l(a,i)}function u(e,t){$("."+e+".instance").each(function(){$(this).is(":visible")&&n($(this),t||_)})}e("utils/Global");var d=e("command/KeyBindingManager"),p=e("utils/KeyEvent"),h=e("strings"),f=e("text!htmlContent/dialog-template.html"),m="cancel",g="ok",v="dontsave",y="save_as",_="_canceled",E="download",b="primary",S="",I="left",w=1050,C=function(e,t){function n(){e.preventDefault(),e.stopPropagation()}var a=this.find(".primary"),s=null,l=String.fromCharCode(e.which),c=this.find(".dialog-button:focus, a:focus"),u="TEXTAREA"===e.target.tagName,d=u||$(e.target).filter(":text, :password").length>0;return e.which===p.DOM_VK_TAB?o(e,this):e.which===p.DOM_VK_ESCAPE?s=m:e.which!==p.DOM_VK_RETURN||u&&!e.ctrlKey?e.which===p.DOM_VK_SPACE?c.length&&(n(),c.click()):"mac"===brackets.platform?e.metaKey&&e.which===p.DOM_VK_BACK_SPACE?i(this,v)&&(s=v):e.metaKey&&e.which===p.DOM_VK_PERIOD&&(s=m):"N"!==l||d||i(this,v)&&(s=v):(n(),"BUTTON"===e.target.tagName?this.find(e.target).click():a.click()),s&&(n(),r(this,s,t)),!0};a.prototype.getElement=function(){return this._$dlg},a.prototype.getPromise=function(){return this._promise},a.prototype.close=function(){this._$dlg.is(":visible")&&n(this._$dlg,_)},a.prototype.done=function(e){this._promise.done(e)},window.addEventListener("resize",s),t.DIALOG_BTN_CANCEL=m,t.DIALOG_BTN_OK=g,t.DIALOG_BTN_DONTSAVE=v,t.DIALOG_BTN_SAVE_AS=y,t.DIALOG_CANCELED=_,t.DIALOG_BTN_DOWNLOAD=E,t.DIALOG_BTN_CLASS_PRIMARY=b,t.DIALOG_BTN_CLASS_NORMAL=S,t.DIALOG_BTN_CLASS_LEFT=I,t.showModalDialog=c,t.showModalDialogUsingTemplate=l,t.cancelModalDialogIfOpen=u}),define("text!htmlContent/project-settings-dialog.html",[],function(){return'<div class="project-settings-dialog modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">{{title}}</h1>\n    </div>\n    <div class="modal-body">\n        <div class="field-container">\n            <label>\n                {{Strings.PROJECT_SETTING_BASE_URL}}: <input type="text" placeholder="{{Strings.PROJECT_SETTING_BASE_URL_HINT}}" value="{{baseUrl}}" class="url" />\n            </label>\n            {{#errorMessage}}<div class="alert" style="margin-bottom: 0">{{{errorMessage}}}</div>{{/errorMessage}}\n         </div>\n    </div>\n    <div class="modal-footer">\n        <button class="dialog-button btn" data-button-id="cancel">{{Strings.CANCEL}}</button>\n        <button class="dialog-button btn primary" data-button-id="ok">{{Strings.DONE}}</button>\n    </div>\n</div>\n'}),define("preferences/PreferencesDialogs",["require","exports","module","thirdparty/path-utils/path-utils.min","widgets/Dialogs","project/ProjectManager","utils/StringUtils","strings","text!htmlContent/project-settings-dialog.html"],function(e,t){"use strict";function n(e){var t="";if(""===e)return t;var n=PathUtils.parseUrl(e);if(n)if(0!==n.href.search(/^(http|https):\/\//i))t=a.format(s.BASEURL_ERROR_INVALID_PROTOCOL,n.href.substring(0,n.href.indexOf("//")));else if(""!==n.search)t=a.format(s.BASEURL_ERROR_SEARCH_DISALLOWED,n.search);else if(""!==n.hash)t=a.format(s.BASEURL_ERROR_HASH_DISALLOWED,n.hash);else{var r=e.search(/[ \^\[\]\{\}<>\\"\?]+/);-1!==r&&(t=a.format(s.BASEURL_ERROR_INVALID_CHAR,e[r]))}else t=s.BASEURL_ERROR_UNKNOWN_ERROR;return t}function r(e,t){var c,u,d,p="",h=o.getProjectRoot();h&&(p=h.name),d=a.format(s.PROJECT_SETTINGS_TITLE,p);var f={title:d,baseUrl:e,errorMessage:t,Strings:s};return u=i.showModalDialogUsingTemplate(Mustache.render(l,f)),u.done(function(e){if(e===i.DIALOG_BTN_OK){var t=c.val(),a=n(t);""===a?o.setBaseUrl(t):r(t,a)}}),c=u.getElement().find(".url"),c.focus(),u}e("thirdparty/path-utils/path-utils.min");var i=e("widgets/Dialogs"),o=e("project/ProjectManager"),a=e("utils/StringUtils"),s=e("strings"),l=e("text!htmlContent/project-settings-dialog.html");t._validateBaseUrl=n,t.showProjectPreferencesDialog=r}),define("preferences/PreferenceStorage",["require","exports","module","thirdparty/lodash","preferences/PreferencesManager","utils/DeprecationWarning"],function(e,t){"use strict";function n(e,t){if("string"==typeof e){var n={},r=null;n[e]=t;try{n=JSON.parse(JSON.stringify(n))}catch(i){r=i}return r||void 0===n[e]?(console.error("Value '"+t+"' for key '"+e+"' must be a valid JSON value"),!1):!0}return console.error("Preference key '"+e+"' must be a string"),!1}function r(){a.savePreferences()}function i(e,t){this._clientID=e,this._json=t}var o=e("thirdparty/lodash"),a=e("preferences/PreferencesManager"),s=e("utils/DeprecationWarning");i.prototype.getClientID=function(){return this._clientID},i.prototype.remove=function(e){s.deprecationWarning("remove is called to remove a preference '"+e+",' use PreferencesManager.set (with value of undefined) instead."),delete this._json[e],r()},i.prototype.setValue=function(e,t){s.deprecationWarning("setValue is called to set preference '"+e+",' use PreferencesManager.set instead."),n(e,t)&&(this._json[e]=t,r())},i.prototype.getValue=function(e){return s.deprecationWarning("getValue is called to get preference '"+e+",' use PreferencesManager.get instead."),this._json[e]},i.prototype.getAllValues=function(){return JSON.parse(JSON.stringify(this._json))},i.prototype.setAllValues=function(e,t){s.deprecationWarning("setAllValues is called to set preferences '"+Object.keys(e)+",' use PreferencesManager.set (probably with doNotSave flag) instead.");var i=this,a=null;return o.some(e,function(e,t){try{n(t,e)}catch(r){return a=r,!0}}),a?void console.error(a):(t||o.forEach(this._json,function(e,t){delete i._json[t]}),o.forEach(e,function(e,t){i._json[t]=e}),void r())},i.prototype.convert=function(e,t,n,i){var s=this._json,l=this,c=!0,u=n?a.stateManager:a,d=new $.Deferred;return t||(t=[]),Object.keys(s).forEach(function(n){if(!(t.indexOf(n)>-1)){var r=e[n];if(!r&&i)r=i(n);else if(i){var a=i(n,s[n]);a&&(r=o.cloneDeep(a))}if(r)if(o.isString(r)){var d=r.split(" ");if("user"===d[0]){var p=d.length>1?d[1]:n,h=null;if(d.length>2&&-1!==d[2].indexOf("/")){var f=r.substr(r.indexOf(d[2]));h={location:{scope:"user",layer:"project",layerID:f}}}u.set(p,s[n],h),t.push(n)}}else o.isObject(r)?(Object.keys(r).forEach(function(e){u.set(e,r[e])}),t.push(n)):c=!1;else console.warn("Preferences conversion for ",l._clientID," has no rule for",n),c=!1}}),t.length>0?u.save().done(function(){r(),d.resolve(c,t)}).fail(function(e){d.reject(e)}):d.resolve(c,t),d.promise()},t.PreferenceStorage=i}),define("utils/ExtensionUtils",["require","exports","module","filesystem/FileSystem","file/FileUtils"],function(e,t){"use strict";function n(e){return $("<style>").text(e).appendTo("head")[0]}function r(e,t){var n={type:"text/css",rel:"stylesheet",href:e},r=$("<link/>").attr(n);return t&&r.on("load",t.resolve).on("error",t.reject),r.appendTo("head"),r[0]}function i(e){return"win"===brackets.platform?PathUtils.isAbsoluteUrl(e):d.isAbsolutePath(e)}function o(e,t){var n,r=new $.Deferred;if(t){var o=t.slice(0,t.lastIndexOf("/")+1),a=t.slice(o.length);n={filename:a,paths:[o],rootpath:o},i(t)&&(n.currentFileInfo={currentDirectory:o,entryPath:o,filename:t,rootFilename:t,rootpath:o})}var s=new less.Parser(n);return s.parse(e,function(e,t){if(e)r.reject(e);else try{r.resolve(t.toCSS())}catch(n){r.reject(n)}}),r.promise()}function a(e,t){var n=e.uri.substr(0,e.uri.lastIndexOf("/")+1);return t&&(n+=t),n}function s(e,t){var n=encodeURI(a(e,t));return"win"===brackets.platform&&-1!==n.indexOf(":")&&(n="file:///"+n),n}function l(e,t){var n=PathUtils.isAbsoluteUrl(t)?t:s(e,t),r=$.get(n);return r}function c(e,t){var i=new $.Deferred;return l(e,t).done(function(e){var t=this.url;if(".less"===t.slice(-5))o(e,t).done(function(e){i.resolve(n(e))}).fail(i.reject);else{var a=new $.Deferred,s=r(t,a);a.done(function(){i.resolve(s)}).fail(i.reject)}}).fail(i.reject),i.fail(function(e,n,r){void 0!==e.readyState?console.error("[Extension] Unable to read stylesheet "+t+":",n,r):console.error("[Extension] Unable to process stylesheet "+t,e)}),i.promise()}function u(e){var t=d.getFileForPath(e+"/package.json"),n=new $.Deferred;return p.readAsText(t).done(function(e){try{var t=JSON.parse(e);n.resolve(t)}catch(r){n.reject()}}).fail(function(){n.reject()}),n.promise()}var d=e("filesystem/FileSystem"),p=e("file/FileUtils");t.addEmbeddedStyleSheet=n,t.addLinkedStyleSheet=r,t.parseLessCode=o,t.getModulePath=a,t.getModuleUrl=s,t.loadFile=l,t.loadStyleSheet=c,t.loadPackageJson=u}),define("utils/ExtensionLoader",["require","exports","module","utils/Global","thirdparty/lodash","utils/EventDispatcher","filesystem/FileSystem","file/FileUtils","utils/Async","utils/ExtensionUtils","utils/UrlParams"],function(e,t){"use strict";function n(){return brackets.app.getApplicationSupportDirectory?brackets.app.getApplicationSupportDirectory()+"/extensions/user":null}function r(e){return D[e]}function i(){return w}function o(e){w=e}function a(e){var t=new $.Deferred,n=g.getFileForPath(e.baseUrl+"/requirejs-config.json");
return v.readAsText(n).done(function(n){try{var r=JSON.parse(n);f.extend(r.paths,e.paths),f.extend(r,f.omit(e,"paths")),t.resolve(r)}catch(i){t.reject("failed to parse requirejs-config.json")}}).fail(function(){t.resolve(e)}),t.promise()}function s(e,t,n){var r={context:e,baseUrl:t.baseUrl,paths:T,locale:brackets.getLocale()},o=a(r).then(function(t){var r=brackets.libRequire.config(t),i=new $.Deferred;return D[e]=r,r([n],i.resolve,i.reject),i.promise()}).then(function(t){var n;if(I[e]=t,t&&t.initExtension&&"function"==typeof t.initExtension){try{n=y.withTimeout(t.initExtension(),i())}catch(r){return console.error("[Extension] Error -- error thrown during initExtension for "+e+": "+r),(new $.Deferred).reject(r).promise()}if(n)return n.fail(function(t){console.error(t===y.ERROR_TIMEOUT?"[Extension] Error -- timeout during initExtension for "+e:"[Extension] Error -- failed initExtension for "+e+(t?": "+t:""))}),n}},function(e){var n=String(e);"scripterror"===e.requireType&&e.originalError&&(n="Module does not exist: "+e.originalError.target.src),console.error("[Extension] failed to load "+t.baseUrl+" - "+n),"define"===e.requireType&&console.log(e.stack)});return o}function l(e,n,r){var i=new $.Deferred;return _.loadPackageJson(n.baseUrl).always(i.resolve),i.then(function(t){return t&&t.theme?void 0:s(e,n,r)}).then(function(){t.trigger("load",n.baseUrl)},function(){t.trigger("loadFailed",n.baseUrl)})}function c(e,t,n){var r=new $.Deferred,i=t.baseUrl+"/"+n+".js";return g.resolve(i,function(i,o){if(!i&&o.isFile){var a=brackets.libRequire.config({context:e,baseUrl:t.baseUrl,paths:$.extend({},t.paths,T)});a([n],function(){r.resolve()})}else r.reject()}),r.promise()}function u(e,t,n,r){var i=new $.Deferred;return g.getDirectoryForPath(e).getContents(function(o,a){if(o)console.error("[Extension] Error -- could not read native directory: "+e),i.reject();else{var s,l=[];for(s=0;s<a.length;s++)a[s].isDirectory&&l.push(a[s].name);if(0===l.length)return void i.resolve();y.doInParallel(l,function(e){var i={baseUrl:t.baseUrl+"/"+e,paths:t.paths};return r(e,i,n)}).always(function(){i.resolve()})}}),i.promise()}function d(e){return u(e,{baseUrl:e},"main",l)}function p(e){var t=v.getNativeBracketsDirectoryPath(),n={baseUrl:e};return n.paths={perf:t+"/perf",spec:t+"/spec"},u(e,n,"unittests",c)}function h(e){var t=new E;if(S)return(new $.Deferred).resolve().promise();if(brackets.inBrowser){var r=PathUtils.directory(window.location.href)+"extensions/default/",i=["CSSCodeHints","HTMLCodeHints","HtmlEntityCodeHints","InlineColorEditor","JavaScriptQuickEdit","QuickOpenCSS","QuickOpenHTML","QuickOpenJavaScript","QuickView","UrlCodeHints","HTMLHinter","brackets-browser-livedev"];return y.doInParallel(i,function(e){var t={baseUrl:r+e};return l(e,t,"main")})}e||(t.parse(),e="true"===t.get("reloadWithoutUserExts")?["default"]:["default","dev",n()]);var o=n();g.getDirectoryForPath(o).create();var a=o.replace(/\/user$/,"/disabled");g.getDirectoryForPath(a).create();var s=y.doSequentially(e,function(e){var t=e;return-1===e.indexOf("/")&&(t=v.getNativeBracketsDirectoryPath()+"/extensions/"+e),d(t)},!1);return s.always(function(){S=!0}),s}e("utils/Global");var f=e("thirdparty/lodash"),m=e("utils/EventDispatcher"),g=e("filesystem/FileSystem"),v=e("file/FileUtils"),y=e("utils/Async"),_=e("utils/ExtensionUtils"),E=e("utils/UrlParams").UrlParams,b=1e4,S=!1,I={},w=b,C=v.getNativeBracketsDirectoryPath(),D={};C=C.replace(/\/test$/,"/src");var T={text:C+"/thirdparty/text/text",i18n:C+"/thirdparty/i18n/i18n"};m.makeEventDispatcher(t),t._setInitExtensionTimeout=o,t._getInitExtensionTimeout=i,t.init=h,t.getUserExtensionPath=n,t.getRequireContextForExtension=r,t.loadExtension=l,t.testExtension=c,t.loadAllExtensionsInNativeDirectory=d,t.testAllExtensionsInNativeDirectory=p}),define("thirdparty/globmatch",["require","exports","module"],function(e,t,n,r){function i(e,t){var n={dot:!0,noext:!0};return"/"!==e[e.length-1]&&(n.matchBase=!0),t=t.replace(/\*\*/g,"{*,**/**/**}"),c(e,t,n)}function o(e){return e.split("").reduce(function(e,t){return e[t]=!0,e},{})}function a(){var e=Object.getOwnPropertyDescriptor(String.prototype,"match"),t=e.value;e.value=function(e){return e instanceof u?e.match(this):t.call(this,e)},Object.defineProperty(String.prototype,e)}function s(e,t){return t=t||{},function(n){return c(n,e,t)}}function l(e,t){e=e||{},t=t||{};var n={};return Object.keys(t).forEach(function(e){n[e]=t[e]}),Object.keys(e).forEach(function(t){n[t]=e[t]}),n}function c(e,t,n){if("string"!=typeof t)throw new TypeError("glob pattern string required");return n||(n={}),n.nocomment||"#"!==t.charAt(0)?""===t.trim()?""===e:new u(t,n).match(e):!1}function u(e,t){if(!(this instanceof u))return new u(e,t,E);if("string"!=typeof e)throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),"win32"===r&&(e=e.split("\\").join("/"));var n=e+"\n"+S(t),i=c.cache.get(n);return i?i:(c.cache.set(n,this),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,void this.make())}function d(){if(!this._made){var e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();var n=this.globSet=this.braceExpand();t.debug&&console.error(this.pattern,n),n=this.globParts=n.map(function(e){return e.split(M)}),t.debug&&console.error(this.pattern,n),n=n.map(function(e){return e.map(this.parse,this)},this),t.debug&&console.error(this.pattern,n),n=n.filter(function(e){return-1===e.indexOf(!1)}),t.debug&&console.error(this.pattern,n),this.set=n}}function p(){var e=this.pattern,t=!1,n=this.options,r=0;if(!n.nonegate){for(var i=0,o=e.length;o>i&&"!"===e.charAt(i);i++)t=!t,r++;r&&(this.pattern=e.substr(r)),this.negate=t}}function h(e,t){function n(){m.push(_),_=""}if(t=t||this.options,e="undefined"==typeof e?this.pattern:e,"undefined"==typeof e)throw new Error("undefined pattern");if(t.nobrace||!e.match(/\{.*\}/))return[e];var r=!1;if("{"!==e.charAt(0)){for(var i=null,o=0,a=e.length;a>o;o++){var s=e.charAt(o);if("\\"===s)r=!r;else if("{"===s&&!r){i=e.substr(0,o);break}}if(null===i)return[e];var l=h(e.substr(o),t);return l.map(function(e){return i+e})}var c=e.match(/^\{(-?[0-9]+)\.\.(-?[0-9]+)\}/);if(c){for(var u=h(e.substr(c[0].length),t),d=+c[1],p=+c[2],f=d>p?-1:1,m=[],o=d;o!=p+f;o+=f)for(var g=0,v=u.length;v>g;g++)m.push(o+u[g]);return m}var o=1,y=1,m=[],_="",r=!1;e:for(o=1,a=e.length;a>o;o++){var s=e.charAt(o);if(r)r=!1,_+="\\"+s;else switch(s){case"\\":r=!0;continue;case"{":y++,_+="{";continue;case"}":if(y--,0===y){n(),o++;break e}_+=s;continue;case",":1===y?n():_+=s;continue;default:_+=s;continue}}if(0!==y)return h("\\"+e,t);var u=h(e.substr(o),t),E=1===m.length;m=m.map(function(e){return h(e,t)}),m=m.reduce(function(e,t){return e.concat(t)}),E&&(m=m.map(function(e){return"{"+e+"}"}));for(var b=[],o=0,a=m.length;a>o;o++)for(var g=0,v=u.length;v>g;g++)b.push(m[o]+u[g]);return b}function f(e,t){function n(){if(o){switch(o){case"*":s+=C,l=!0;break;case"?":s+=w,l=!0;break;default:s+="\\"+o}o=!1}}var r=this.options;if(!r.noglobstar&&"**"===e)return b;if(""===e)return"";for(var i,o,a,s="",l=!!r.nocase,c=!1,u=[],d=!1,p=-1,h=-1,f="."===e.charAt(0)?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",m=0,g=e.length;g>m&&(a=e.charAt(m));m++)if(r.debug&&console.error("%s	%s %s %j",e,m,s,a),c&&O[a])s+="\\"+a,c=!1;else switch(a){case"/":return!1;case"\\":n(),c=!0;continue;case"?":case"*":case"+":case"@":case"!":if(r.debug&&console.error("%s	%s %s %j <-- stateChar",e,m,s,a),d){"!"===a&&m===h+1&&(a="^"),s+=a;continue}n(),o=a,r.noext&&n();continue;case"(":if(d){s+="(";continue}if(!o){s+="\\(";continue}i=o,u.push({type:i,start:m-1,reStart:s.length}),s+="!"===o?"(?:(?!":"(?:",o=!1;continue;case")":if(d||!u.length){s+="\\)";continue}switch(l=!0,s+=")",i=u.pop().type){case"!":s+="[^/]*?)";break;case"?":case"+":case"*":s+=i;case"@":}continue;case"|":if(d||!u.length||c){s+="\\|",c=!1;continue}s+="|";continue;case"[":if(n(),d){s+="\\"+a;continue}d=!0,h=m,p=s.length,s+=a;continue;case"]":if(m===h+1||!d){s+="\\"+a,c=!1;continue}l=!0,d=!1,s+=a;continue;default:n(),c?c=!1:!O[a]||"^"===a&&d||(s+="\\"),s+=a}if(d){var y=e.substr(h+1),_=this.parse(y,L);s=s.substr(0,p)+"\\["+_[0],l=l||_[1]}for(var E;E=u.pop();){var S=s.slice(E.reStart+3);S=S.replace(/((?:\\{2})*)(\\?)\|/g,function(e,t,n){return n||(n="\\"),t+t+n+"|"});var I="*"===E.type?C:"?"===E.type?w:"\\"+E.type;l=!0,s=s.slice(0,E.reStart)+I+"\\("+S}n(),c&&(s+="\\\\");var D=!1;switch(s.charAt(0)){case".":case"[":case"(":D=!0}if(""!==s&&l&&(s="(?=.)"+s),D&&(s=f+s),t===L)return[s,l];if(!l)return v(e);var T=r.nocase?"i":"",M=new RegExp("^"+s+"$",T);return M._glob=e,M._src=s,M}function m(){if(this.regexp||this.regexp===!1)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1;var t=this.options,n=t.noglobstar?C:t.dot?D:T,r=t.nocase?"i":"",i=e.map(function(e){return e.map(function(e){return e===b?n:"string"==typeof e?y(e):e._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{return this.regexp=new RegExp(i,r)}catch(o){return this.regexp=!1}}function g(e,t){if(this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var n=this.options;"win32"===r&&(e=e.split("\\").join("/")),e=e.split(M),n.debug&&console.error(this.pattern,"split",e);for(var i=this.set,o=0,a=i.length;a>o;o++){var s=i[o],l=this.matchOne(e,s,t);if(l)return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}function v(e){return e.replace(/\\(.)/g,"$1")}function y(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}n.exports=i,c.Minimatch=u;var _=function(){var e={},t=0;this.set=function(n,r){t++,t>=100&&(e={}),e[n]=r},this.get=function(t){return e[t]}},E=c.cache=new _({max:100}),b=c.GLOBSTAR=u.GLOBSTAR={},S=function(e){return JSON.stringify(e)},I={basename:function(e){e=e.split(/[\/\\]/);var t=e.pop();return t||(t=e.pop()),t}},w="[^/]",C=w+"*?",D="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",T="(?:(?!(?:\\/|^)\\.).)*?",O=o("().*{}+?[]^$\\!"),M=/\/+/;c.monkeyPatch=a,c.filter=s,c.defaults=function(e){if(!e||!Object.keys(e).length)return c;var t=c,n=function(n,r,i){return t.minimatch(n,r,l(e,i))};return n.Minimatch=function(n,r){return new t.Minimatch(n,l(e,r))},n},u.defaults=function(e){return e&&Object.keys(e).length?c.defaults(e).Minimatch:u},u.prototype.make=d,u.prototype.parseNegate=p,c.braceExpand=function(e,t){return new u(e,t).braceExpand()},u.prototype.braceExpand=h,u.prototype.parse=f;var L={};c.makeRe=function(e,t){return new u(e,t||{}).makeRe()},u.prototype.makeRe=m,c.match=function(e,t,n){var r=new u(t,n);return e=e.filter(function(e){return r.match(e)}),n.nonull&&!e.length&&e.push(t),e},u.prototype.match=g,u.prototype.matchOne=function(e,t,n){var r=this.options;r.debug&&console.error("matchOne",{"this":this,file:e,pattern:t}),r.matchBase&&1===t.length&&(e=I.basename(e.join("/")).split("/")),r.debug&&console.error("matchOne",e.length,t.length);for(var i=0,o=0,a=e.length,s=t.length;a>i&&s>o;i++,o++){r.debug&&console.error("matchOne loop");var l=t[o],c=e[i];if(r.debug&&console.error(t,l,c),l===!1)return!1;if(l===b){r.debug&&console.error("GLOBSTAR",[t,l,c]);var u=i,d=o+1;if(d===s){for(r.debug&&console.error("** at the end");a>i;i++)if("."===e[i]||".."===e[i]||!r.dot&&"."===e[i].charAt(0))return!1;return!0}e:for(;a>u;){var p=e[u];if(r.debug&&console.error("\nglobstar while",e,u,t,d,p),this.matchOne(e.slice(u),t.slice(d),n))return r.debug&&console.error("globstar found match!",u,a,p),!0;if("."===p||".."===p||!r.dot&&"."===p.charAt(0)){r.debug&&console.error("dot detected!",e,u,t,d);break e}r.debug&&console.error("globstar swallow a segment, and continue"),u++}return n&&u===a?!0:!1}var h;if("string"==typeof l?(h=r.nocase?c.toLowerCase()===l.toLowerCase():c===l,r.debug&&console.error("string match",l,c,h)):(h=c.match(l),r.debug&&console.error("pattern match",l,c,h)),!h)return!1}if(i===a&&o===s)return!0;if(i===a)return n;if(o===s){var f=i===a-1&&""===e[i];return f}throw new Error("wtf?")}}),define("preferences/PreferencesBase",["require","exports","module","file/FileUtils","filesystem/FileSystem","utils/EventDispatcher","thirdparty/lodash","utils/Async","thirdparty/globmatch"],function(e,t){"use strict";function n(e){this.data=e||{}}function r(e){this.name="ParsingError",this.message=e||""}function i(e,t){this.path=e,this.createIfNew=t,this._lineEndings=f.getPlatformLineEndings()}function o(e){this.storage=e,e.on("changed",this.load.bind(this)),this.data={},this._dirty=!1,this._layers=[],this._layerMap={},this._exclusions=[]}function a(e,t){var n,r=Object.keys(e);if(t)for(n=0;n<r.length;n++){var i=r[n];if(_(t,i))return i}}function s(){this.projectPath=null}function l(){}function c(e){this.setPrefFilePath(e)}function u(e){v.extend(this,e)}function d(e){var t={};g.makeEventDispatcher(t),e._on_internal=t.on,e._off_internal=t.off,e.trigger=t.trigger}function p(e,t){this.base=e,this.prefix=t,this._listenerInstalled=!1}function h(e){this.contextBuilder=e,this._knownPrefs={},this._scopes={"default":new o(new n)},this._scopes["default"].load(),this._defaults={scopeOrder:["default"],_shadowScopeOrder:[{id:"default",scope:this._scopes["default"],promise:(new $.Deferred).resolve().promise()}]},this._pendingScopes={},this._saveInProgress=!1,this._nextSaveDeferred=null,this._pathScopeDefinitions={},this._pathScopeFilenames=[],this._pathScopes={},this._changeEventQueue=null;var t=function(e){var t=this._knownPrefs[e];t&&t.trigger(E)}.bind(this);this.on(E,function(e,n){n.ids.forEach(t)}.bind(this))}var f=e("file/FileUtils"),m=e("filesystem/FileSystem"),g=e("utils/EventDispatcher"),v=e("thirdparty/lodash"),y=e("utils/Async"),_=e("thirdparty/globmatch"),E="change",b="scopeOrderChange";n.prototype={load:function(){var e=new $.Deferred;return e.resolve(this.data),e.promise()},save:function(e){var t=new $.Deferred;return this.data=e,t.resolve(),t.promise()},fileChanged:function(){}},g.makeEventDispatcher(n.prototype),r.prototype=new Error,i.prototype={load:function(){var e=new $.Deferred,t=this.path,n=this.createIfNew,i=this;if(t){var o=m.getFileForPath(t);o.read({},function(o,a){if(o)return void(n?e.resolve({}):e.reject(new Error("Unable to load prefs at "+t+" "+o)));if(i._lineEndings=f.sniffLineEndings(a),/^\s*$/.test(a))e.resolve({});else try{e.resolve(JSON.parse(a))}catch(s){e.reject(new r("Invalid JSON settings at "+t+"("+s.toString()+")"))}})}else e.resolve({});return e.promise()},save:function(e){var t=new $.Deferred,n=this.path,r=m.getFileForPath(n);if(n)try{var i=JSON.stringify(e,null,4);i=f.translateLineEndings(i,this._lineEndings),r.write(i,{},function(e){e?t.reject("Unable to save prefs at "+n+" "+e):t.resolve()})}catch(o){t.reject("Unable to convert prefs to JSON"+o.toString())}else t.resolve();return t.promise()},setPath:function(e){this.path=e,this.trigger("changed")},fileChanged:function(e){e===this.path&&this.trigger("changed")}},g.makeEventDispatcher(i.prototype),v.extend(o.prototype,{load:function(){var e=new $.Deferred;return this.storage.load().then(function(t){var n=this.getKeys();this.data=t,e.resolve(),this.trigger(E,{ids:v.union(this.getKeys(),n)})}.bind(this)).fail(function(t){e.reject(t)}),e.promise()},save:function(){var e=this;return this._dirty?(e._dirty=!1,this.storage.save(this.data)):(new $.Deferred).resolve().promise()},set:function(e,t,n,r){if(r||(r=this.getPreferenceLocation(e,n)),r&&r.layer){var i=this._layerMap[r.layer];if(i){void 0===this.data[i.key]&&(this.data[i.key]={});var o=i.set(this.data[i.key],e,t,n,r.layerID);return this._dirty=this._dirty||o,o}return!1}return this._performSet(e,t)},_performSet:function(e,t){return v.isEqual(this.data[e],t)?!1:(this._dirty=!0,void 0===t?delete this.data[e]:this.data[e]=v.cloneDeep(t),!0)},get:function(e,t){var n,r,i,o=this._layers,a=this.data;for(t=t||{},n=0;n<o.length;n++)if(r=o[n],i=r.get(a[r.key],e,t),void 0!==i)return i;return-1===this._exclusions.indexOf(e)?a[e]:void 0},getPreferenceLocation:function(e,t){var n,r,i,o=this._layers,a=this.data;for(t=t||{},n=0;n<o.length;n++)if(r=o[n],i=r.getPreferenceLocation(a[r.key],e,t),void 0!==i)return{layer:r.key,layerID:i};return-1===this._exclusions.indexOf(e)&&void 0!==a[e]?{}:void 0},getKeys:function(e){e=e||{};var t,n,r=this._layers,i=this.data,o=[v.difference(v.keys(i),this._exclusions)];for(t=0;t<r.length;t++)n=r[t],o.push(n.getKeys(i[n.key],e));return v.union.apply(null,o)},addLayer:function(e){this._layers.push(e),this._layerMap[e.key]=e,this._exclusions.push(e.key),this.trigger(E,{ids:e.getKeys(this.data[e.key],{})})},fileChanged:function(e){this.storage.fileChanged(e)},contextChanged:function(e,t){var n=[],r=this.data;return v.each(this._layers,function(i){if(r[i.key]&&e[i.key]!==t[i.key]){var o=i.contextChanged(r[i.key],e,t);o&&n.push(o)}}),v.union.apply(null,n)}}),g.makeEventDispatcher(o.prototype),s.prototype={key:"project",get:function(e,t){return e&&this.projectPath&&e[this.projectPath]&&void 0!==e[this.projectPath][t]?e[this.projectPath][t]:void 0},getPreferenceLocation:function(e,t){return e&&this.projectPath&&e[this.projectPath]&&void 0!==e[this.projectPath][t]?this.projectPath:void 0},set:function(e,t,n,r,i){if(i||(i=this.getPreferenceLocation(e,t)),!i)return!1;var o=e[i];return o||(e[i]=o={}),v.isEqual(o[t],n)?!1:(void 0===n?delete o[t]:o[t]=v.cloneDeep(n),!0)},getKeys:function(e){return e?v.union.apply(null,v.map(v.values(e),v.keys)):void 0},setProjectPath:function(e){this.projectPath=e}},l.prototype={key:"language",get:function(e,t,n){return e&&n.language&&e[n.language]&&void 0!==e[n.language][t]?e[n.language][t]:void 0},getPreferenceLocation:function(e,t,n){return e&&n.language&&e[n.language]&&void 0!==e[n.language][t]?n.language:void 0},getKeys:function(e,t){return e?v.isEmpty(t)?v.union.apply(null,v.map(v.values(e),v.keys)):e[t.language]?v.keys(e[t.language]):[]:void 0},set:function(e,t,n,r,i){if(i||(i=this.getPreferenceLocation(e,t,r)),!i)return!1;var o=e[i];return o||(e[i]=o={}),v.isEqual(o[t],n)?!1:(void 0===n?(delete o[t],v.isEmpty(o)&&delete e[i]):o[t]=v.cloneDeep(n),!0)},contextChanged:function(e,t,n){return void 0===n.language?v.keys(e[t.language]):void 0===t.language?v.keys(e[n.language]):v.union(v.keys(e[n.language]),v.keys(e[t.language]))}},c.prototype={key:"path",get:function(e,t,n){var r=this.getPreferenceLocation(e,t,n);if(r)return e[r][t]},getPreferenceLocation:function(e,t,n){if(e){var r=f.getRelativeFilename(this.prefFilePath,n[this.key]);if(r)return a(e,r)}},set:function(e,t,n,r,i){if(i||(i=this.getPreferenceLocation(e,t,r)),!i)return!1;var o=e[i];return o||(e[i]=o={}),v.isEqual(o[t],n)?!1:(void 0===n?delete o[t]:o[t]=v.cloneDeep(n),!0)},getKeys:function(e,t){if(e){var n=f.getRelativeFilename(this.prefFilePath,t[this.key]);if(n){var r=a(e,n);return r?v.keys(e[r]):[]}return v.union.apply(null,v.map(v.values(e),v.keys))}},setPrefFilePath:function(e){this.prefFilePath=e?f.getDirectoryPath(e):"/"},contextChanged:function(e,t,n){var r=a(e,f.getRelativeFilename(this.prefFilePath,n[this.key])),i=a(e,f.getRelativeFilename(this.prefFilePath,t[this.key]));if(r!==i)return void 0===r?v.keys(e[i]):void 0===i?v.keys(e[r]):v.union(v.keys(e[i]),v.keys(e[r]))}},g.makeEventDispatcher(u.prototype),p.prototype={definePreference:function(e,t,n,r){return this.base.definePreference(this.prefix+e,t,n,r)},getPreference:function(e){return this.base.getPreference(this.prefix+e)},get:function(e,t){return t=t||{},this.base.get(this.prefix+e,this.base._getContext(t))},getPreferenceLocation:function(e,t){return this.base.getPreferenceLocation(this.prefix+e,t)},set:function(e,t,n,r){return this.base.set(this.prefix+e,t,n,r)},_installListener:function(){if(!this._listenerInstalled){var e=this,t=this.prefix,n=function(e){return e.substr(0,t.length)===t?!0:!1},r=function(e){return e.substr(t.length)};this.base.on(E,function(t,i){var o=i.ids.filter(n);o.length>0&&e.trigger(E,{ids:o.map(r)})}),this._listenerInstalled=!0}},on:function(e,t,n){if("function"==typeof t&&(n=t,t=null),t){var r=this.getPreference(t);r.on(e,n)}else this._installListener(),this._on_internal(e,n)},off:function(e,t,n){if("function"==typeof t&&(n=t,t=null),t){var r=this.getPreference(t);r.off(e,n)}else this._off_internal(e,n)},save:function(){return this.base.save()}},d(p.prototype),v.extend(h.prototype,{definePreference:function(e,t,n,r){if(r=r||{},this._knownPrefs.hasOwnProperty(e))throw new Error("Preference "+e+" was redefined");var i=this._knownPrefs[e]=new u({type:t,initial:n,name:r.name,description:r.description,validator:r.validator});return this.set(e,n,{location:{scope:"default"}}),i},getPreference:function(e){return this._knownPrefs[e]},_pushToScopeOrder:function(e,t){var n=this._defaults.scopeOrder,r=v.findIndex(n,function(e){return e===t});if(!(r>-1))throw new Error("Internal error: scope "+t+" should be in the scope order");n.splice(r,0,e)},_tryAddToScopeOrder:function(e){for(var t=this._defaults._shadowScopeOrder,n=v.findIndex(t,function(t){return t===e}),r=n+1;r<t.length&&"pending"!==t[r].promise.state()&&"resolved"!==t[r].promise.state();)r++;switch(t[r].promise.state()){case"pending":t[r].promise.always(function(){this._tryAddToScopeOrder(e)}.bind(this));break;case"resolved":this._pushToScopeOrder(e.id,t[r].id),this.trigger(b,{id:e.id,action:"added"}),this._triggerChange({ids:e.scope.getKeys()});break;default:throw new Error('Internal error: no scope found to add before. "default" is missing?..')}},_addToScopeOrder:function(e,t,n,r){var i,o,a=this._defaults._shadowScopeOrder,s=!1,l=this;if(t.on(E+".prefsys",function(e,t){l._triggerChange(t)}.bind(this)),o=v.findIndex(a,function(t){return t.id===e}),o>-1)i=a[o];else if(i={id:e,promise:n,scope:t},r)if(o=v.findIndex(a,function(e){return e.id===r}),o>-1)a.splice(o,0,i);else{var c=this._pendingScopes[r];c||(c=[],this._pendingScopes[r]=c),c.unshift(i),s=!0}else a.unshift(i);if(!s&&(n.then(function(){this._scopes[e]=t,this._tryAddToScopeOrder(i)}.bind(this)).fail(function(){v.pull(a,i)}.bind(this)),this._pendingScopes[e])){var u=this._pendingScopes[e];delete this._pendingScopes[e],u.forEach(function(t){this._addToScopeOrder(t.id,t.scope,t.promise,e)}.bind(this))}},addToScopeOrder:function(e,t){var n,r=this._defaults._shadowScopeOrder,i=v.findIndex(r,function(t){return t.id===e});i>-1&&(n=r[i],this._addToScopeOrder(n.id,n.scope,n.promise,t))},removeFromScopeOrder:function(e){var t=this._scopes[e];t&&(v.pull(this._defaults.scopeOrder,e),t.off(".prefsys"),this.trigger(b,{id:e,action:"removed"}),this._triggerChange({ids:t.getKeys()}))},_getContext:function(e){return e?(this.contextBuilder&&(e=this.contextBuilder(e)),e.scopeOrder||(e.scopeOrder=this._defaults.scopeOrder),e):{scopeOrder:this._defaults.scopeOrder}},addScope:function(e,t,n){var i;if(n=n||{},this._scopes[e])throw new Error("Attempt to redefine preferences scope: "+e);return t.get||(t=new o(t)),i=t.load(),this._addToScopeOrder(e,t,i,n.before),i.fail(function(e){e instanceof r&&console.error(e)}),i},removeScope:function(e){var t,n=this._scopes[e];n&&(this.removeFromScopeOrder(e),t=v.findIndex(this._defaults._shadowScopeOrder,function(t){return t.id===e}),this._defaults._shadowScopeOrder.splice(t,1),delete this._scopes[e])},_getScopeOrder:function(e){return e.scopeOrder||this._defaults.scopeOrder},get:function(e,t){var n;t=this._getContext(t);var r=this._getScopeOrder(t);for(n=0;n<r.length;n++){var i=this._scopes[r[n]];if(i){var o=i.get(e,t);if(void 0!==o){var a=this.getPreference(e),s=a&&a.validator;if(!s||s(o))return v.cloneDeep(o)}}}},getPreferenceLocation:function(e,t){var n,r;t=this._getContext(t);var i=this._getScopeOrder(t);for(n=0;n<i.length;n++){r=i[n];var o=this._scopes[r];if(o){var a=o.getPreferenceLocation(e,t);if(void 0!==a)return a.scope=r,a}}},set:function(e,t,n,r){n=n||{};var i=this._getContext(n.context),o=n.location&&"default"===n.location.scope?!0:!1,a=n.location||this.getPreferenceLocation(e,i);if(!a||"default"===a.scope&&!o){var s=this._getScopeOrder(i);if(!(s.length>1))return{valid:!0,stored:!1};a={scope:s[s.length-2]}}var l=this._scopes[a.scope];if(!l)return{valid:!0,stored:!1};var c=this.getPreference(e),u=c&&c.validator;if(u&&!u(t))return{valid:!1,stored:!1};var d=l.set(e,t,i,a);return d&&(r||this.save(),this._triggerChange({ids:[e]})),{valid:!0,stored:d}},save:function(){if(this._saveInProgress)return this._nextSaveDeferred||(this._nextSaveDeferred=new $.Deferred),this._nextSaveDeferred.promise();var e=this._nextSaveDeferred||new $.Deferred;return this._saveInProgress=!0,this._nextSaveDeferred=null,y.doInParallel(v.values(this._scopes),function(e){return e?e.save():(new $.Deferred).resolve().promise()}.bind(this)).then(function(){this._saveInProgress=!1,this._nextSaveDeferred&&this.save(),e.resolve()}.bind(this)).fail(function(t){e.reject(t)}),e.promise()},signalContextChanged:function(e,t){var n=[];v.each(this._scopes,function(r){var i=r.contextChanged(e,t);i&&n.push(i)}),n=v.union.apply(null,n),n.length>0&&this._triggerChange({ids:n})},on:function(e,t,n){if("function"==typeof t&&(n=t,t=null),t){var r=this.getPreference(t);r.on(e,n)}else this._on_internal(e,n)},off:function(e,t,n){if("function"==typeof t&&(n=t,t=null),t){var r=this.getPreference(t);r.off(e,n)}else this._off_internal(e,n)},_triggerChange:function(e){this._changeEventQueue?this._changeEventQueue=v.union(this._changeEventQueue,e.ids):this.trigger(E,e)},pauseChangeEvents:function(){this._changeEventQueue||(this._changeEventQueue=[])},resumeChangeEvents:function(){this._changeEventQueue&&(this.trigger(E,{ids:this._changeEventQueue}),this._changeEventQueue=null)},fileChanged:function(e){v.forEach(this._scopes,function(t){t.fileChanged(e)})},getPrefixedSystem:function(e){return new p(this,e+".")}}),d(h.prototype),t.PreferencesSystem=h,t.Scope=o,t.MemoryStorage=n,t.PathLayer=c,t.ProjectLayer=s,t.LanguageLayer=l,t.FileStorage=i}),define("preferences/PreferencesImpl",["require","exports","module","./PreferencesBase","utils/Async"],function(e,t){"use strict";function n(){return u}function r(e){var t=brackets.app.getApplicationSupportDirectory()+"/";0===t.indexOf(e.fullPath)&&(p.fileChanged(l),b.fileChanged(S))}var i=e("./PreferencesBase"),o=e("utils/Async"),a="brackets.json",s="state.json",l=brackets.app.getApplicationSupportDirectory()+"/"+a,c=new $.Deferred,u=!1,d=[],p=new i.PreferencesSystem;p.pauseChangeEvents();var h=new i.FileStorage(void 0,!0),f=new i.Scope(h),m=new i.PathLayer,g=new i.LanguageLayer;f.addLayer(m),f.addLayer(g);var v=new i.FileStorage(l,!0),y=new i.Scope(v),_=new i.LanguageLayer;y.addLayer(_);var E=p.addScope("user",y);d.push(E),E.fail(function(e){d.push(p.addScope("user",new i.MemoryStorage,{before:"default"})),e.name&&"ParsingError"===e.name&&(u=!0)}).always(function(){d.push(p.addScope("project",f,{before:"user"})),d.push(p.addScope("session",new i.MemoryStorage)),o.waitForAll(d).always(function(){c.resolve()})});var b=new i.PreferencesSystem,S=brackets.app.getApplicationSupportDirectory()+"/"+s,I=new i.Scope(new i.FileStorage(S,!0)),w=new i.ProjectLayer;I.addLayer(w);var C=b.addScope("user",I);t.manager=p,t.projectStorage=h,t.projectPathLayer=m,t.userScopeLoading=E,t.stateManager=b,t.stateProjectLayer=w,t.smUserScopeLoading=C,t.userPrefFile=l,t.isUserScopeCorrupt=n,t.managerReady=c.promise(),t.reloadUserPrefs=r,t.STATE_FILENAME=s,t.SETTINGS_FILENAME=a}),define("preferences/PreferencesManager",["require","exports","module","preferences/PreferenceStorage","utils/AppInit","command/Commands","command/CommandManager","utils/DeprecationWarning","file/FileUtils","utils/ExtensionLoader","preferences/PreferencesBase","filesystem/FileSystem","strings","preferences/PreferencesImpl","thirdparty/lodash"],function(e,t){"use strict";function n(){if(!T){var e=x.getNativeBracketsDirectoryPath();T=[e+"/extensions/default/",e+"/extensions/dev/",A.getUserExtensionPath()+"/"]}return T}function r(e){var n,r,i=t._getExtensionPaths();return i.some(function(t){return 0===e.uri.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())?(n=t,!0):void 0}),r=n?V+e.uri.replace(n,""):V+e.id}function i(e,t,n){if(!n){var i="object"==typeof e?e.uri:e;N.deprecationWarning("getPreferenceStorage is called with client ID '"+i+",' use PreferencesManager.definePreference instead.")}if(!e||"object"==typeof e&&(!e.id||!e.uri))return void console.error("Invalid clientID");"object"==typeof e&&(e=r(e));var o=C[e];if(void 0===o){if(n)return;o=t&&JSON.stringify(t)?t:{},C[e]=o}else t&&j.forEach(t,function(e,t){void 0===o[t]&&(o[t]=e)});return new O(e,o)}function o(){D.setItem(w,JSON.stringify(C))}function a(){C={},D.setItem(w,JSON.stringify(C))}function s(e){D=e,B&&(C=JSON.parse(D.getItem(w))),C||a()}function l(e){return e=e||W,e&&K?void 0!==x.getRelativeFilename(K,e):!1}function c(){return U.userPrefFile}function u(){l()!==q&&(q?U.manager.removeFromScopeOrder("project"):U.manager.addToScopeOrder("project","user"),q=!q)}function d(e){K=x.getDirectoryPath(e),u(),U.projectPathLayer.setPrefFilePath(e),U.projectStorage.setPath(e)}function p(e){return U.manager.getPrefixedSystem(e)}function h(e,t,n,a){U.smUserScopeLoading.done(function(){U.userScopeLoading.done(function(){if(!e||"object"==typeof e&&(!e.id||!e.uri))return void console.error("Invalid clientID");var s=i(e,null,!0);if(s){var l="object"==typeof e?r(e):e;void 0===C.convertedKeysMap&&(C.convertedKeysMap={});var c=C.convertedKeysMap;s.convert(t,c[l],n,a).done(function(e,t){C.convertedKeysMap[l]=t,o()})}}).fail(function(t){console.error("Error while converting ","object"==typeof e?r(e):e),console.error(t)})})}function f(e,t){var n=e.indexOf("project")>-1;if(n===t)return e;var r;if(t){var i=e.indexOf("user");-1===i&&(i=e.length-2),r=j.first(e,i),r.push("project"),r.push.apply(r,j.rest(e,i))}else r=j.without(e,"project");return r}function m(e,t){var n={};return n.path=e?e:W,n.language=t?t:G,n.scopeOrder=l(n.path)?Y:X,n}function g(e){return e=e||{},m(e.path,e.language)}function v(e){var t=W;t!==e&&(W=e,u(),U.manager.signalContextChanged(m(t,G),m(e,G)))}function y(e){var t=G;t!==e&&(G=e,U.manager.signalContextChanged(m(W,t),m(W,e)))}function _(){var e=U.manager._getScopeOrder({});Y=f(e,!0),X=f(e,!1),z.scopeOrder=Y}function E(){var e=c(),t=k.getFileForPath(e);t.exists(function(n,r){r?R.execute(L.FILE_OPEN,{fullPath:e}):x.writeText(t,"",!0).done(function(){R.execute(L.FILE_OPEN,{fullPath:e})})})}function b(e,n,r){N.deprecationWarning("setValueAndSave called for "+e+". Use set instead.");var i=t.set(e,n,r).stored;return U.manager.save(),i}function S(e,t){return U.stateManager.get(e,t)}function I(e,t,n,r){U.stateManager.set(e,t,n),r||U.stateManager.save()}var w,C,D,T,O=e("preferences/PreferenceStorage").PreferenceStorage,M=e("utils/AppInit"),L=e("command/Commands"),R=e("command/CommandManager"),N=e("utils/DeprecationWarning"),x=e("file/FileUtils"),A=e("utils/ExtensionLoader"),P=e("preferences/PreferencesBase"),k=e("filesystem/FileSystem"),F=e("strings"),U=e("preferences/PreferencesImpl"),j=e("thirdparty/lodash"),$="com.adobe.brackets.preferences",V="com.adobe.brackets.",B=!1;w=localStorage.getItem("preferencesKey"),w?B=!!localStorage.getItem("doLoadPreferences"):(w=$,B=!0),s(localStorage),t.getPreferenceStorage=i,t.savePreferences=o,t.getClientID=r,t._reset=a,t._getExtensionPaths=n;var H,W=null,G=null,K=null,q=!0,z={},Y=null,X=null;U.manager.contextBuilder=g,_(),U.manager.on("scopeOrderChange",_),R.register(F.CMD_OPEN_PREFERENCES,L.FILE_OPEN_PREFERENCES,E),M.appReady(function(){U.manager.resumeChangeEvents()}),t._isUserScopeCorrupt=U.isUserScopeCorrupt,t._setCurrentFile=v,t._setCurrentLanguage=y,t._setProjectSettingsFile=d,t._smUserScopeLoading=U.smUserScopeLoading,t._stateProjectLayer=U.stateProjectLayer,t._reloadUserPrefs=U.reloadUserPrefs,t._buildContext=m,t.CURRENT_FILE=H,t.CURRENT_PROJECT=z,t.ready=U.managerReady,t.getUserPrefFile=c,t.get=U.manager.get.bind(U.manager),t.set=U.manager.set.bind(U.manager),t.save=U.manager.save.bind(U.manager),t.on=U.manager.on.bind(U.manager),t.off=U.manager.off.bind(U.manager),t.getPreference=U.manager.getPreference.bind(U.manager),t.getExtensionPrefs=p,t.setValueAndSave=b,t.getViewState=S,t.setViewState=I,t.addScope=U.manager.addScope.bind(U.manager),t.stateManager=U.stateManager,t.FileStorage=P.FileStorage,t.SETTINGS_FILENAME=U.SETTINGS_FILENAME,t.definePreference=U.manager.definePreference.bind(U.manager),t.fileChanged=U.manager.fileChanged.bind(U.manager),t.convertPreferences=h
}),define("utils/Resizer",["require","exports","module","utils/AppInit","utils/EventDispatcher","preferences/PreferencesManager"],function(e,t,n){"use strict";function r(e){var t=$(e).data("show");t&&t.apply(e)}function i(e){var t=$(e).data("hide");t&&t.apply(e)}function o(e){$(e).is(":visible")?i(e):r(e)}function a(e){var t=$(e).data("removeSizable");t&&t.apply(e)}function s(e){var t=$(e).data("resyncSizer");t&&t.apply(e)}function l(e){return $(e).is(":visible")}function c(e,t,n,r,a,s,l,c,u){function d(e){void 0!==s&&$(s,w).css("left",e)}function p(e,t){x.apply(I,[e]),C.length&&P.apply(C,[t])}function _(e){var t=e||1;(n===v||n===m)&&E.css(A,t)}var E=$('<div class="'+t+'-resizer"></div>'),I=$(e),w=I.parent(),C=$(I.find(".resizable-content:first")[0]),D=$(window.document.body),T=I.attr("id"),O=b.getViewState(T)||{},M=null,L=t===h?"clientX":"clientY",R=n===f||n===g?1:-1,N=t===h?w.innerWidth:w.innerHeight,x=function(e){if(e){if(c){var n,r,i=N.apply(w);return r=t===h?"width":"height",n=e/i,this.css(r,100*n+"%"),this}return t===h?this.width(e):this.height(e)}return t===h?this.width():this.height()},A=t===h?"left":"top",P=t===h?C.width:C.height;return T?w[0]&&w.is(".content")&&!l?void console.error("Resizable panels within the editor area should be created via WorkspaceManager.createBottomPanel(). \nElement:",e):(void 0===r&&(r=y),a=a||!1,u?w.prepend(E):I.prepend(E),I.css("box-sizing","border-box"),I.data("removeSizable",function(){E.off(".resizer"),I.removeData("show"),I.removeData("hide"),I.removeData("resyncSizer"),I.removeData("removeSizable"),E.remove()}),I.data("resyncSizer",function(){_(x.apply(I))}),I.data("show",function(){var e=I.offset(),t=x.apply(I)||O.size,r=P.apply(C)||O.contentSize;p(t,r),I.show(),O.visible=!0,a&&(u?w.prepend(E):I.prepend(E),n===f?E.css(A,""):n===v&&E.css(A,e[A]+t)),d(t),I.trigger("panelExpanded",[t]),b.setViewState(T,O,null,S)}),I.data("hide",function(){var e=I.offset(),t=x.apply(I),r=x.apply(E);I.hide(),O.visible=!1,a&&(E.insertBefore(I),n===v?E.css(A,""):n===f&&E.css(A,e[A]+t-r)),d(0),I.trigger("panelCollapsed",[t]),b.setViewState(T,O,null,S)}),E.on("mousedown.resizer",function(e){function n(){S&&(f!==m&&(m=f,I.is(":visible")?10>f?(o(I),x.apply(I,[0])):(v||(v=!0,I.trigger("panelResizeStart",f)),p(f,f-g),d(f),I.trigger("panelResizeUpdate",[f])):f>10&&(x.apply(I,[f]),o(I),v||(v=!0,I.trigger("panelResizeStart",f)))),M=window.requestAnimationFrame(n))}function i(e){f=Math.max(u+R*(c-e[L]),r);var t=I.data("maxsize");void 0!==t&&(f=Math.min(f,t)),e.preventDefault(),null===M&&(M=window.requestAnimationFrame(n))}function s(){if(S){var e=x.apply(I);I.is(":visible")&&(O.size=e,C.length&&(O.contentSize=P.apply(C)),b.setViewState(T,O),_(e)),S=!1,v&&I.trigger("panelResizeEnd",[e]),window.setTimeout(function(){$(window.document).off("mousemove",i),l.off("mousedown"),l.remove(),M=null},300)}}var l=$("<div class='resizing-container "+t+"-resizing' />"),c=e[L],u=I.is(":visible")?x.apply(I):0,f=u,m=u,g=0,v=!1;S=!0,D.append(l),C.length&&I.children().not(".horz-resizer, .vert-resizer, .resizable-content").each(function(e,n){g+=t===h?$(n).outerWidth():$(n).outerHeight()}),$(window.document).on("mousemove",i),a&&l.on("mousedown",function(){$(window.document).off("mousemove",i),l.off("mousedown"),l.remove(),M=null,o(I)}),$(window.document).one("mouseup",s),e.preventDefault()}),void(O&&(void 0!==O.size&&x.apply(I,[O.size]),void 0!==O.contentSize&&P.apply(C,[O.contentSize]),void 0===O.visible||O.visible?(d(x.apply(I)),_(x.apply(I))):i(I)))):void console.error("Resizable panels must have a DOM id to use as a preferences key:",e)}function u(e){return e?"user":null}var d,p="vert",h="horz",f="top",m="bottom",g="left",v="right",y=100,_=e("utils/AppInit"),E=e("utils/EventDispatcher"),b=e("preferences/PreferencesManager"),S=!1;_.htmlReady(function(){var e=y;d=$(".main-view"),$(".vert-resizable").each(function(t,n){void 0!==$(n).data().minsize&&(e=$(n).data().minsize),$(n).hasClass("top-resizer")&&c(n,p,f,e,$(n).hasClass("collapsible"))}),$(".horz-resizable").each(function(t,n){void 0!==$(n).data().minsize&&(e=$(n).data().minsize),$(n).hasClass("right-resizer")&&c(n,h,v,e,$(n).hasClass("collapsible"),$(n).data().forceleft)})}),b.convertPreferences(n,{panelState:"user"},!0,u),E.makeEventDispatcher(t),t.makeResizable=c,t.removeSizable=a,t.resyncSizer=s,t.toggle=o,t.show=r,t.hide=i,t.isVisible=l,t.DIRECTION_VERTICAL=p,t.DIRECTION_HORIZONTAL=h,t.POSITION_TOP=f,t.POSITION_RIGHT=v,t.POSITION_BOTTOM=m,t.POSITION_LEFT=g}),define("view/WorkspaceManager",["require","exports","module","utils/AppInit","utils/EventDispatcher","utils/Resizer"],function(e,t){"use strict";function n(){var e=d.height();return p.siblings().each(function(t,n){var r=$(n);"none"!==r.css("display")&&"absolute"!==r.css("position")&&(e-=r.outerHeight())}),Math.max(e,0)}function r(){var e=p.height();p.siblings().each(function(t,n){var r=$(n);"none"===r.css("display")?r.data("maxsize",e):r.data("maxsize",e+r.outerHeight())})}function i(e){var r=n();p.height(r),t.trigger("workspaceUpdateLayout",r,e)}function o(){d&&p&&(i(),g||(g=!0,$(window.document).one("mousemove",function(){g=!1,r()})))}function a(e){e.on("panelCollapsed panelExpanded panelResizeUpdate",function(){i()}),e.on("panelCollapsed panelExpanded panelResizeEnd",function(){r()})}function s(e,t){this.$panel=e,m.makeResizable(e[0],m.DIRECTION_VERTICAL,m.POSITION_TOP,t,!1,void 0,!0),a(e)}function l(e,t,n){return t.insertBefore("#status-bar"),t.hide(),r(),new s(t,n)}function c(e){i(e),r()}function u(e,t){d=e,p=t}var d,p,h=e("utils/AppInit"),f=e("utils/EventDispatcher"),m=e("utils/Resizer"),g=!1;s.prototype.$panel=null,s.prototype.isVisible=function(){return this.$panel.is(":visible")},s.prototype.show=function(){m.show(this.$panel[0])},s.prototype.hide=function(){m.hide(this.$panel[0])},s.prototype.setVisible=function(e){e?m.show(this.$panel[0]):m.hide(this.$panel[0])},h.htmlReady(function(){d=$(".content"),p=$("#editor-holder"),a($("#sidebar"))}),window.addEventListener("resize",o,!0),f.makeEventDispatcher(t),t.createBottomPanel=l,t.recomputeLayout=c,t._setMockDOM=u}),define("view/MainViewFactory",["require","exports","module","thirdparty/lodash"],function(e,t){"use strict";function n(e){o.push(e)}function r(e){return i.find(o,function(t){return t.canOpenFile(e)})}var i=e("thirdparty/lodash"),o=[];t.registerViewFactory=n,t.findSuitableFactoryForPath=r}),define("view/ViewStateManager",["require","exports","module","thirdparty/lodash"],function(e,t){"use strict";function n(){l={}}function r(e,t){l[e.fullPath]=t}function i(e){e.getViewState&&r(e.getFile(),e.getViewState())}function o(e){return l[e.fullPath]}function a(e){l=s.extend(l,e)}var s=e("thirdparty/lodash"),l={};t.reset=n,t.updateViewState=i,t.getViewState=o,t.addViewStates=a}),define("utils/ViewUtils",["require","exports","module","thirdparty/lodash","language/LanguageManager"],function(e,t){"use strict";function n(e,t,n,r,i){var o=0,a=t.get(0),s=a.scrollTop,l=Math.min(s-g,0),c=e.width();if(n&&(n.css("background-position","0px "+l+"px"),i&&(o=e.offset().top,n.css("top",o)),i&&n.css("width",c)),r){var u=a.clientHeight,d=e.outerHeight(),p=a.scrollHeight,h=g;p>u&&(h-=Math.min(g,p-(s+u))),r.css("background-position","0px "+h+"px"),r.css("top",o+d-g),r.css("width",c)}}function r(e,t,n){var r=e.find(".scroller-shadow."+t);return 0===r.length&&(r=$(window.document.createElement("div")).addClass("scroller-shadow "+t),e.append(r)),n||(r.css("position","absolute"),r.css(t,"0")),r}function i(e,t,i){var o=!1;t||(t=e,o=!0);var a=$(e),s=$(t),l=r(a,"top",o),c=i?r(a,"bottom",o):null,u=function(){n(a,s,l,c,o)};s.off("scroll.scroller-shadow"),a.off("contentChanged.scroller-shadow"),s.on("scroll.scroller-shadow",u),a.on("contentChanged.scroller-shadow",u),u()}function o(e,t){t||(t=e);var n=$(e),r=$(t);n.find(".scroller-shadow.top").remove(),n.find(".scroller-shadow.bottom").remove(),r.off("scroll.scroller-shadow"),n.off("contentChanged.scroller-shadow")}function a(e,t,n){n?e.addClass(t):e.removeClass(t)}function s(e,t,n){var r,i,o=e.find("ul"),s=$("#sidebar"),l=!0;r=$(window.document.createElement("div")).addClass("sidebar-selection"),e.prepend(r),e.css("overflow","auto"),e.css("position","relative"),i=$(window.document.createElement("div")).addClass("sidebar-selection-extension"),e.append(i),t="."+(t||"selected");var c=function(){var t=r.height(),n=r.offset(),o=e.offset(),c=i.outerHeight(),u=o.top,d=u+e.outerHeight(),p=n.top;i.css("top",p),i.css("left",s.width()-i.outerWidth()),a(i,"selectionExtension-visible",l);var h=Math.floor((t-c)/2),f=p+c+h;u>p||f>d?i.css("clip","rect("+Math.max(u-p-h,0)+"px, auto, "+(c-Math.max(f-d,0))+"px, auto)"):i.css("clip","")},u=function(){i.addClass("forced-hidden"),r.addClass("forced-hidden")},d=function(a,s){var u=o.find(t).closest("li");if(n&&(l=u.hasClass(n)),i.removeClass("forced-hidden"),r.removeClass("forced-hidden"),i.hide(),r.hide(),1===u.length){var d=u.offset().top-e.offset().top+e.get(0).scrollTop;r.width(e.get(0).scrollWidth),r.css("top",d),r.show(),c(),i.show();var p=e.get(0),h=p.clientHeight,f=r.height(),m=d+f,g=p.scrollTop+h;s&&(d>=g?u.get(0).scrollIntoView(!1):m<=p.scrollTop&&u.get(0).scrollIntoView(!0))}};o.on("selectionChanged",d),e.on("scroll",c),e.on("selectionRedraw",c),e.on("selectionHide",u),d(),v.push(c)}function l(){v.forEach(function(e){e.apply()})}function c(e,t){var n,r={top:0,right:0,bottom:0,left:0},i=e.offset()||{top:0,left:0};return n=t.top+t.height-(i.top+e.height()),n>0&&(r.bottom=n),n=i.top-t.top,n>0&&(r.top=n),n=i.left-t.left,n>0&&(r.left=n),n=t.left+t.width-(i.left+e.width()),n>0&&(r.right=n),r}function u(e,t,n){var r=t.offset(),i={top:r.top,left:r.left,height:t.height(),width:t.width()},o=c(e,i);o.bottom>0?e.scrollTop(e.scrollTop()+o.bottom):o.top>0&&e.scrollTop(e.scrollTop()-o.top),n&&(o.left>0?e.scrollLeft(e.scrollLeft()-o.left):o.right>0&&e.scrollLeft(e.scrollLeft()+o.right))}function d(e){var t=e.name,n=m.getCompoundFileExtension(t),r=t.lastIndexOf("."+n);return t=r>0?f.escape(t.substring(0,r))+"<span class='extension'>"+f.escape(t.substring(r))+"</span>":f.escape(t)}function p(e){if(e.length<=1)return[];var t={},n=[],r=[];e.forEach(function(e,i){var o=e.fullPath.split("/");o.pop(),r[i]=o.pop(),n[i]=o,t[r[i]]?t[r[i]].push(i):t[r[i]]=[i]});var i,o=function(e){var t=!1;return f.forEach(e,function(i,o){i.length>1&&i.forEach(function(i){0!==n[i].length&&(r[i]=n[i].pop()+"/"+r[i],t=!0,e[r[i]]?e[r[i]].push(i):e[r[i]]=[i])}),delete e[o]}),t};do i=o(t);while(i);return r}function h(e,t,n){if(1!==Math.abs(n))return console.error("traverseViewArray called with unsupported direction: "+n.toString()),null;if(-1===t){if(e.length>0)return e[0]}else if(e.length>1)return t+=n,t>=e.length?t=0:0>t&&(t=e.length-1),e[t];return null}var f=e("thirdparty/lodash"),m=e("language/LanguageManager"),g=5,v=[];$(window).resize(l),t.SCROLL_SHADOW_HEIGHT=g,t.addScrollerShadow=i,t.removeScrollerShadow=o,t.sidebarList=s,t.scrollElementIntoView=u,t.getElementClipSize=c,t.getFileEntryDisplay=d,t.toggleClass=a,t.getDirNamesForDuplicateFiles=p,t.traverseViewArray=h}),define("document/InMemoryFile",["require","exports","module","filesystem/File","filesystem/FileSystemError"],function(e,t,n){"use strict";function r(e,t){i.call(this,e,t)}var i=e("filesystem/File"),o=e("filesystem/FileSystemError");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.parentClass=i.prototype,r.prototype.read=function(e,t){"function"==typeof e&&(t=e),t(o.NOT_FOUND)},r.prototype.write=function(e,t,n){"function"==typeof t&&(n=t),n(o.NOT_FOUND)},r.prototype.exists=function(e){e(null,!1)},r.prototype.stat=function(e){e(o.NOT_FOUND)},r.prototype.unlink=function(e){e(o.NOT_FOUND)},r.prototype.rename=function(e,t){t(o.NOT_FOUND)},r.prototype.moveToTrash=function(e){e(o.NOT_FOUND)},n.exports=r}),define("text!htmlContent/pane.html",[],function(){return'<div id="{{id}}" class="view-pane">\n    <div class="pane-header"></div>\n    <div class="pane-content">\n        <div class="not-editor"></div>\n    </div>\n</div>'}),define("view/Pane",["require","exports","module","thirdparty/lodash","utils/EventDispatcher","filesystem/FileSystem","document/InMemoryFile","view/ViewStateManager","view/MainViewManager","document/DocumentManager","command/CommandManager","command/Commands","strings","utils/ViewUtils","project/ProjectManager","text!htmlContent/pane.html"],function(e,t){"use strict";function n(e,t){return{indexRequested:e,index:t}}function r(e,t){this._initialize();var n=this,r=t.append(Mustache.render(g,{id:e})).find("#"+e),o=r.find(".pane-header"),a=r.find(".pane-content");r.on("focusin.pane",function(e){n._lastFocusedElement=e.target}),this._lastFocusedElement=r[0],Object.defineProperty(this,"id",{get:function(){return e},set:function(){console.error("cannot change the id of a working pane")}}),Object.defineProperty(this,"$el",{get:function(){return r},set:function(){console.error("cannot change the DOM node of a working pane")}}),Object.defineProperty(this,"$header",{get:function(){return o},set:function(){console.error("cannot change the DOM node of a working pane")}}),Object.defineProperty(this,"$content",{get:function(){return a},set:function(){console.error("cannot change the DOM node of a working pane")}}),Object.defineProperty(this,"$container",{get:function(){return t},set:function(){console.error("cannot change the DOM node of a working pane")}}),this.updateHeaderText(),u.on(this._makeEventName("fileNameChange"),i.bind(this._handleFileNameChange,this)),u.on(this._makeEventName("pathDeleted"),i.bind(this._handleFileDeleted,this)),c.on(this._makeEventName("activePaneChange"),i.bind(this._handleActivePaneChange,this)),c.on(this._makeEventName("workingSetAdd"),i.bind(this.updateHeaderText,this)),c.on(this._makeEventName("workingSetRemove"),i.bind(this.updateHeaderText,this)),c.on(this._makeEventName("workingSetAddList"),i.bind(this.updateHeaderText,this)),c.on(this._makeEventName("workingSetRemoveList"),i.bind(this.updateHeaderText,this))}var i=e("thirdparty/lodash"),o=e("utils/EventDispatcher"),a=e("filesystem/FileSystem"),s=e("document/InMemoryFile"),l=e("view/ViewStateManager"),c=e("view/MainViewManager"),u=e("document/DocumentManager"),d=e("command/CommandManager"),p=e("command/Commands"),h=e("strings"),f=e("utils/ViewUtils"),m=e("project/ProjectManager"),g=e("text!htmlContent/pane.html");o.makeEventDispatcher(r.prototype),r.prototype.id=null,r.prototype.$container=null,r.prototype.$el=null,r.prototype.$header=null,r.prototype.$content=null,r.prototype._viewList=[],r.prototype._viewListMRUOrder=[],r.prototype._viewListAddedOrder=[],r.prototype._views={},r.prototype._currentView=null,r.prototype._lastFocusedElement=null,r.prototype._initialize=function(){this._viewList=[],this._viewListMRUOrder=[],this._viewListAddedOrder=[],this._views={},this._currentView=null,this.showInterstitial(!0)},r.prototype._makeEventName=function(e){return e+".pane-"+this.id},r.prototype._reparent=function(e){e.$el.appendTo(this.$content),this._views[e.getFile().fullPath]=e,e.notifyContainerChange&&e.notifyContainerChange()},r.prototype._hideCurrentView=function(){if(this._currentView){var e=this._currentView;this._setViewVisibility(this._currentView,!1),this.showInterstitial(!0),this._currentView=null,this._notifyCurrentViewChange(null,e)}},r.prototype.moveView=function(e,t,r){var i=this,o=new $.Deferred,a=new $.Deferred;if(this.getCurrentlyViewedPath()===e.fullPath){var s=this.traverseViewListByMRU(1,e.fullPath);s?this._execOpenFile(s.fullPath).fail(function(){i._hideCurrentView()}).always(function(){o.resolve()}):(this._hideCurrentView(),o.resolve())}else o.resolve();return o.done(function(){i._viewList.splice(i.findInViewList(e.fullPath),1),i._viewListMRUOrder.splice(i.findInViewListMRUOrder(e.fullPath),1),i._viewListAddedOrder.splice(i.findInViewListAddedOrder(e.fullPath),1),t._addToViewList(e,n(!0,r));var o=i._views[e.fullPath];o?(delete i._views[e.fullPath],t.addView(o,!t.getCurrentlyViewedFile()),a.resolve()):t.getCurrentlyViewedFile()?a.resolve():t._execOpenFile(e.fullPath).always(function(){a.resolve()})}),a.promise()},r.prototype.mergeFrom=function(e){var t=e._currentView;e._hideCurrentView(),this._viewList=i.union(this._viewList,e._viewList),this._viewListMRUOrder=i.union(this._viewListMRUOrder,e._viewListMRUOrder),this._viewListAddedOrder=i.union(this._viewListAddedOrder,e._viewListAddedOrder);var n=this,r=[];i.forEach(e._views,function(t){var i=t.getFile(),o=i&&i.fullPath;o&&-1!==e.findInViewList(o)?n._reparent(t):r.push(t)}),t&&!e._isViewNeeded(t)&&-1===r.indexOf(t)&&r.push(t),i.forEach(r,function(e){n.trigger("viewDestroy",e),e.destroy()}),e._initialize()},r.prototype.destroy=function(){(this._currentView||Object.keys(this._views).length>0||this._viewList.length>0)&&console.warn("destroying a pane that isn't empty"),this._reset(),u.off(this._makeEventName("")),c.off(this._makeEventName("")),this.$el.off(".pane"),this.$el.remove()},r.prototype.getViewList=function(){return i.clone(this._viewList)},r.prototype.getViewListSize=function(){return this._viewList.length},r.prototype.findInViewList=function(e){return i.findIndex(this._viewList,function(t){return t.fullPath===e})},r.prototype.findInViewListAddedOrder=function(e){return i.findIndex(this._viewListAddedOrder,function(t){return t.fullPath===e})},r.prototype.findInViewListMRUOrder=function(e){return i.findIndex(this._viewListMRUOrder,function(t){return t.fullPath===e})},r.prototype.ITEM_NOT_FOUND=-1,r.prototype.ITEM_FOUND_NO_SORT=0,r.prototype.ITEM_FOUND_NEEDS_SORT=1,r.prototype.reorderItem=function(e,t,n){var r=void 0!==t&&null!==t&&t>=0,i=this.findInViewList(e.fullPath);if(-1!==i){if(n||r&&i!==t){var o=this._viewList.splice(i,1)[0];return this._viewList.splice(t,0,o),this.ITEM_FOUND_NEEDS_SORT}return this.ITEM_FOUND_NO_SORT}return this.ITEM_NOT_FOUND},r.prototype._canAddFile=function(e){return this._views.hasOwnProperty(e.fullPath)&&-1===this.findInViewList(e.fullPath)||!c._getPaneIdForPath(e.fullPath)},r.prototype._addToViewList=function(e,t){t&&t.indexRequested?this._viewList.splice(t.index,0,e):this._viewList.push(e);var n=this.getCurrentlyViewedPath();n&&n===e.fullPath?this._viewListMRUOrder.unshift(e):this._viewListMRUOrder.push(e),this._viewListAddedOrder.unshift(e)},r.prototype.addToViewList=function(e,t){var r=void 0!==t&&null!==t&&t>=0&&t<this._viewList.length;return this._addToViewList(e,n(r,t)),r||(t=this._viewList.length-1),t},r.prototype.addListToViewList=function(e){var t=this,n=[];return e.forEach(function(e){t._canAddFile(e)&&(t._addToViewList(e),n.push(e))}),n},r.prototype._notifyCurrentViewChange=function(e,t){this.updateHeaderText(),this.trigger("currentViewChange",e,t)},r.prototype._doDestroyView=function(e){this._currentView===e&&this._hideCurrentView(),delete this._views[e.getFile().fullPath],this.trigger("viewDestroy",e),e.destroy()},r.prototype._doRemove=function(e,t){var n=this.findInViewList(e.fullPath);n>-1&&(this._viewList.splice(n,1),this._viewListMRUOrder.splice(this.findInViewListMRUOrder(e.fullPath),1),this._viewListAddedOrder.splice(this.findInViewListAddedOrder(e.fullPath),1));var r=this._views[e.fullPath];return r&&(t||this._doDestroyView(r)),n>-1||Boolean(r)},r.prototype.makeViewMostRecent=function(e){var t=this.findInViewListMRUOrder(e.fullPath);-1!==t&&(this._viewListMRUOrder.splice(t,1),this._viewListMRUOrder.unshift(e))},r.prototype.sortViewList=function(e){this._viewList.sort(i.partial(e,this.id))},r.prototype.moveWorkingSetItem=function(e,t){this._viewList.splice(t,0,this._viewList.splice(e,1)[0])},r.prototype.swapViewListIndexes=function(e,t){var n=this._viewList[e];return this._viewList[e]=this._viewList[t],this._viewList[t]=n,!0},r.prototype.traverseViewListByMRU=function(e,t){if(!t&&this._currentView){var n=this._currentView.getFile();t=n&&n.fullPath}var r=t?this.findInViewListMRUOrder(t):-1;return f.traverseViewArray(this._viewListMRUOrder,r,e)},r.prototype.updateHeaderText=function(){var e,t,n=this.getCurrentlyViewedFile();n?(e=c.getAllOpenFiles().filter(function(e){return e.name===n.name}),e.length<2?this.$header.text(n.name):(t=m.makeProjectRelativeIfPossible(n.fullPath),this.$header.text(t))):this.$header.html(h.EMPTY_VIEW_HEADER)},r.prototype._handleFileNameChange=function(e,t,n){var r=this.findInViewList(n)>=0;if(this._views.hasOwnProperty(t)){var i=this._views[t];this._views[n]=i,delete this._views[t]}this.updateHeaderText(),r&&this.trigger("viewListChange")},r.prototype._handleFileDeleted=function(e,t){this.removeView({fullPath:t})&&this.trigger("viewListChange")},r.prototype.showInterstitial=function(e){this.$content&&this.$content.find(".not-editor").css("display",e?"":"none")},r.prototype.getViewForPath=function(e){return this._views[e]},r.prototype.addView=function(e,t){var n=e.getFile(),r=n&&n.fullPath;return r?(e.$el.parent()!==this.$content?this._reparent(e):this._views[r]=e,void(t&&this.showView(e))):void console.error("cannot add a view that does not have a fullPath")},r.prototype._setViewVisibility=function(e,t){e.$el.css("display",t?"":"none"),e.notifyVisibilityChange&&e.notifyVisibilityChange(t)},r.prototype.showView=function(e){if(this._currentView&&this._currentView===e)return this._setViewVisibility(this._currentView,!0),void this.updateLayout(!0);var t=e.getFile(),n=t&&t.fullPath,r=this._currentView;this._currentView?(this._currentView.getFile()&&l.updateViewState(this._currentView),this._setViewVisibility(this._currentView,!1)):this.showInterstitial(!1),this._currentView=e,this._setViewVisibility(this._currentView,!0),this.updateLayout(),this._notifyCurrentViewChange(e,r),r&&this.destroyViewIfNotNeeded(r),this._views.hasOwnProperty(n)||console.error(n+" found in pane working set but pane.addView() has not been called for the view created for it")},r.prototype._updateHeaderHeight=function(){var e=this.$el.height();c.getPaneCount()>1?(this.$header.show(),e-=this.$header.outerHeight()):this.$header.hide(),this.$content.height(e)},r.prototype.updateLayout=function(e){this._updateHeaderHeight(),this._currentView&&this._currentView.updateLayout(e)},r.prototype._isViewNeeded=function(e){var t=e.getFile().fullPath,n=this.getCurrentlyViewedPath();return this._currentView&&n===t||-1!==this.findInViewList(t)},r.prototype.getCurrentlyViewedFile=function(){return this._currentView?this._currentView.getFile():null},r.prototype.getCurrentlyViewedPath=function(){var e=this.getCurrentlyViewedFile();return e?e.fullPath:null},r.prototype.destroyViewIfNotNeeded=function(e){if(!this._isViewNeeded(e)){var t=e.getFile(),n=t&&t.fullPath;delete this._views[n],this.trigger("viewDestroy",e),e.destroy()}},r.prototype._reset=function(){var e=this,t=[],n=this._currentView;i.forEach(this._views,function(e){t.push(e)}),this._currentView&&-1===t.indexOf(this._currentView)&&t.push(this._currentView),this._initialize(),n&&this._notifyCurrentViewChange(null,n),t.forEach(function(t){e.trigger("viewDestroy",t),t.destroy()})},r.prototype._execOpenFile=function(e){return d.execute(p.CMD_ADD_TO_WORKINGSET_AND_OPEN,{fullPath:e,paneId:this.id,options:{noPaneActivate:!0}})},r.prototype.removeView=function(e,t,n){var r=!t&&this.traverseViewListByMRU(1,e.fullPath);if(r&&r.fullPath!==e.fullPath&&this.getCurrentlyViewedPath()===e.fullPath){var i=this,o=r.fullPath,a=-1!==this.findInViewList(o);return this._doRemove(e,a)?(a&&this._execOpenFile(o).fail(function(){i._doDestroyView(i._currentView)}),!0):!1}return this._doRemove(e,n)},r.prototype.removeViews=function(e){var t,n=this,r=!1;if(r=-1!==i.findIndex(e,function(e){return e.fullPath===n.getCurrentlyViewedPath()}),t=e.filter(function(e){return n.removeView(e,!0,!0)}),r){var o=this.traverseViewListByMRU(1,this.getCurrentlyViewedPath()),a=o&&o.fullPath,s=a&&-1!==this.findInViewList(a);s?this._execOpenFile(a).fail(function(){n._doDestroyView(n._currentView)}):this._doDestroyView(this._currentView)}return t},r.prototype.focus=function(){function e(){n._currentView?n._currentView.focus?n._currentView.focus():n._currentView.$el.focus():n.$el.focus()}var t=window.document.activeElement,n=this;if(this._lastFocusedElement!==t){"textarea"!==t.tagName.toLowerCase()||this._currentView&&this._currentView._codeMirror||t.blur();var r=$(this._lastFocusedElement);r.length&&!r.is(".view-pane")&&r.is(":visible")?r.focus():e()}},r.prototype._handleActivePaneChange=function(e,t){this.$el.toggleClass("active-pane",Boolean(t===this.id))},r.prototype.loadState=function(e){var t,n,r=[],o={},s=this,c=function(){return s._viewList.length>0?s._viewList[0].fullPath:null};return i.forEach(e,function(e){r.push(a.getFileForPath(e.file)),e.active&&(t=e.file),e.viewState&&(o[e.file]=e.viewState)}),this.addListToViewList(r),l.addViewStates(o),t=t||c(),t&&(n={paneId:s.id,fullPath:t}),(new $.Deferred).resolve(n)},r.prototype.saveState=function(){var e=[],t=this.getCurrentlyViewedPath();return this._currentView&&this._currentView.getFile()&&l.updateViewState(this._currentView),this._viewList.forEach(function(n){n instanceof s||e.push({file:n.fullPath,active:n.fullPath===t,viewState:l.getViewState(n)})}),e},r.prototype.getScrollState=function(){return this._currentView&&this._currentView.getScrollPos?{scrollPos:this._currentView.getScrollPos()}:void 0},r.prototype.restoreAndAdjustScrollState=function(e,t){this._currentView&&e&&e.scrollPos&&this._currentView.adjustScrollPos&&this._currentView.adjustScrollPos(e.scrollPos,t)},t.Pane=r}),define("view/MainViewManager",["require","exports","module","thirdparty/lodash","utils/EventDispatcher","strings","utils/AppInit","command/CommandManager","view/MainViewFactory","view/ViewStateManager","command/Commands","widgets/Dialogs","widgets/DefaultDialogs","editor/EditorManager","filesystem/FileSystemError","document/DocumentManager","preferences/PreferencesManager","project/ProjectManager","view/WorkspaceManager","utils/Async","utils/ViewUtils","utils/Resizer","view/Pane"],function(e,t){"use strict";function n(e,t){return{file:e,paneId:t}}function r(e){return dt.findIndex(Gt,function(t){return t.file.fullPath===e.fullPath})}function i(){return Vt}function o(e){return e&&e!==At?e:i()}function a(e){return e=o(e),Bt[e]?Bt[e]:null}function s(){a(At).focus()}function l(e){return e===At||e===xt}function c(e,t){var i,o,s=a(e);Wt||(s.makeViewMostRecent(t),i=dt.findIndex(Gt,function(e){return e.file===t&&e.paneId===s.id}),o=n(t,s.id),-1!==i&&Gt.splice(i,1),-1!==r(t)&&console.log(t.fullPath+" duplicated in mru list"),Gt.unshift(o))}function u(e){var t=a(e);t.getCurrentlyViewedFile()&&c(e,t.getCurrentlyViewedFile())}function d(e){if(!l(e)&&e!==Vt){var n=Vt,r=a(At),i=a(e);if(!i)throw new Error("invalid pane id: "+e);Vt=e,t.trigger("activePaneChange",e,n),t.trigger("currentFileChange",a(At).getCurrentlyViewedFile(),e,r.getCurrentlyViewedFile(),n),u(Vt),s()}}function p(e){return dt.find(Bt,function(t){return t.$el[0]===e[0]?t:void 0})}function h(e){var t=a(e);return t?t.getCurrentlyViewedFile():null}function f(e){var t=h(e);return t?t.fullPath:null}function m(e,t){if(t){var n=t.$el.parent().parent(),r=p(n);if(r)r.id!==Vt&&d(r.id);else{var i=n.parents(".view-pane");1===i.length&&(n=$(i[0]),r=p(n),r&&r.id!==Vt&&(d(r.id),t.focus()))}}}function g(e,t){e===xt?dt.forEach(Bt,t):t(a(e))}function v(e){g(e,function(e){Ht[e.id]=e.getScrollState()})}function y(e,t){g(e,function(e){e.restoreAndAdjustScrollState(Ht[e.id],t),delete Ht[e.id]})}function _(e){var t=[];return g(e,function(e){var n=e.getViewList();t=dt.union(t,n)}),t}function E(){var e=_(xt);return dt.forEach(Bt,function(t){var n=t.getCurrentlyViewedFile();n&&(e=dt.union(e,[n]))}),e}function b(){return Object.keys(Bt)}function S(e){var t=0;return g(e,function(e){t+=e.getViewListSize()}),t}function I(e){return Kt[e][$t]}function w(){return Object.keys(Bt).length}function C(e,t,n){var r=-1;return g(e,function(e){var i=e[n].call(e,t);return i>=0?(r=i,!1):void 0}),r}function D(e){var t,n=[];return dt.forEach(Bt,function(r){t=r.findInViewList(e),t>=0&&n.push({paneId:r.id,index:t})}),n}function T(e,t){return C(e,t,"findInViewList")}function O(e,t){return C(e,t,"findInViewListAddedOrder")}function M(e,t){return C(e,t,"findInViewListMRUOrder")}function L(e){var t=D(e).shift();return t||dt.forEach(Bt,function(n){return n.getCurrentlyViewedPath()===e?(t={paneId:n.id},!1):void 0}),t?t.paneId:null}function R(e,i,o,s){var l=a(e),c=L(i.fullPath);if(!l)throw new Error("invalid pane id: "+e);if(-1===T(xt,i.fullPath)){c&&c!==l.id&&(l=a(c));var u=l.reorderItem(i,o,s),d=n(i,l.id);u===l.ITEM_FOUND_NEEDS_SORT?(console.warn("pane.reorderItem returned pane.ITEM_FOUND_NEEDS_SORT which shouldn't happen "+i),t.trigger("workingSetSort",l.id)):u===l.ITEM_NOT_FOUND&&(o=l.addToViewList(i,o),-1===r(i)&&(l.getCurrentlyViewedFile()===i?Gt.unshift(d):Gt.push(d)),t.trigger("workingSetAdd",i,o,l.id))}}function N(e,i){var o,s=a(e);o=s.addListToViewList(i),o.forEach(function(e){-1!==r(e)&&console.log(e.fullPath+" duplicated in mru list"),Gt.push(n(e,s.id))}),t.trigger("workingSetAddList",o,s.id);var l=i.filter(function(e){return-1===s.findInViewList(e.fullPath)&&L(e.fullPath)});l.length&&N(L(l[0].fullPath),l)}function x(e,t){var n,r=function(n){return n.file===t&&n.paneId===e};do n=dt.findIndex(Gt,r),-1!==n&&Gt.splice(n,1);while(-1!==n)}function A(e,n,r){var i=a(e);i.removeView(n)&&(x(i.id,n),t.trigger("workingSetRemove",n,r,i.id))}function P(e,n,r,i){var o=new $.Deferred,s=a(e),l=a(n);return s.moveView(r,l,i).done(function(){Gt.every(function(e){return e.file===r&&e.paneId===s.id?(e.paneId=l.id,!1):!0}),t.trigger("workingSetMove",r,s.id,l.id),o.resolve()}),o.promise()}function k(e,t){var n,r=function(e){return e.file.fullPath===t};do n=dt.findIndex(Gt,r),-1!==n&&Gt.splice(n,1);while(-1!==n)}function F(e,n){g(e,function(e){e.sortViewList(n),t.trigger("workingSetSort",e.id)})}function U(e,n,r){var i=a(e);i.moveWorkingSetItem(n,r),t.trigger("workingSetSort",i.id),t.trigger("_workingSetDisableAutoSort",i.id)}function j(e,n,r){var i=a(e);i.swapViewListIndexes(n,r),t.trigger("workingSetSort",i.id),t.trigger("_workingSetDisableAutoSort",i.id)}function V(e){var t=h(),n=i(),r=dt.findIndex(Gt,function(e){return e.file===t&&e.paneId===n});return Ot.traverseViewArray(Gt,r,e)}function B(){Wt=!0}function H(){var e=a(At);Wt&&(Wt=!1,c(e.id,e.getCurrentlyViewedFile()))}function W(e,t){var n;n=$t===Ft?ut.innerWidth():ut.innerHeight(),Mt.resyncSizer(e.$el),e.$el.data("maxsize",n-jt),e.updateLayout(t)}function G(e,t,n){var r;r=$t===Ft?ut.innerWidth():ut.innerHeight(),dt.forEach(Bt,function(e){if(e.id===kt&&$t===Ut){var t=(Bt[Pt].$el.height()+1)/r;e.$el.css("height",100-100*t+"%")}W(e,n)})}function K(e){var t=Object.keys(Bt),n=100/t.length;dt.forEach(Bt,function(t){t.$el.css(t.id===Pt?$t===Ft?{height:"100%",width:n+"%","float":"left"}:{height:n+"%",width:"100%"}:$t===Ft?{height:"100%",width:"auto","float":"none"}:{width:"100%",height:"50%"}),W(t,e)})}function q(){g(xt,function(e){e.updateHeaderText()})}function z(e){var n;return Bt.hasOwnProperty(e)||(n=new Lt(e,ut),Bt[e]=n,t.trigger("paneCreate",n.id),n.$el.on("click.mainview dragover.mainview",function(){d(n.id)}),n.on("viewListChange.mainview",function(){q(),t.trigger("workingSetUpdate",n.id)}),n.on("currentViewChange.mainview",function(e,r,i){q(),Vt===n.id&&t.trigger("currentFileChange",r&&r.getFile(),n.id,i&&i.getFile(),n.id)}),n.on("viewDestroy.mainView",function(e,t){x(n.id,t.getFile())})),n}function Y(){var e=Bt[Pt];Mt.makeResizable(e.$el,$t===Ut?Mt.DIRECTION_VERTICAL:Mt.DIRECTION_HORIZONTAL,$t===Ut?Mt.POSITION_BOTTOM:Mt.POSITION_RIGHT,jt,!1,!1,!1,!0,!0),e.$el.on("panelResizeUpdate",function(){G()})}function X(e){var n,r;e!==$t&&(n=Bt[Pt],Mt.removeSizable(n.$el),$t&&ut.removeClass("split-"+$t.toLowerCase()),ut.addClass("split-"+e.toLowerCase()),$t=e,r=z(kt),Y(),K(),t.trigger("paneLayoutChange",$t),r&&h(n.id)&&d(r.id))}function Q(e,t,n){var r=n||{},i=L(t.file.fullPath);i&&(e=i);var o=a(e);(t.isUntitled()||!Ct.isWithinProject(t.file.fullPath))&&R(e,t.file),bt.openDocument(t,o),c(e,t.file),r.noPaneActivate||d(e)}function J(e,t,n){function r(){s.noPaneActivate||d(e)
}var i=new $.Deferred,s=n||{};if(!t||!a(e))return i.reject("bad argument").promise();var l=L(t.fullPath);l&&(wt.getViewState("splitview.multipane-info")||l===o(e)||(wt.setViewState("splitview.multipane-info",!0),window.setTimeout(function(){_t.showModalDialog(Et.DIALOG_ID_INFO,ht.SPLITVIEW_INFO_TITLE,ht.SPLITVIEW_MULTIPANE_WARNING)},500)),e=l);var u=a(e),p=gt.findSuitableFactoryForPath(t.fullPath);return p?t.exists(function(n,o){o?p.openFile(t,u).done(function(){Ct.isWithinProject(t.fullPath)||R(e,t),r(),i.resolve(t)}).fail(function(e){i.reject(e)}):i.reject(n||St.NOT_FOUND)}):It.getDocumentForPath(t.fullPath).done(function(t){Q(e,t,$.extend({},s,{noPaneActivate:!0})),r(),i.resolve(t.file)}).fail(function(e){i.reject(e)}),i.done(function(){c(e,t)}),i}function Z(){if(Bt.hasOwnProperty(kt)){var e=Bt[Pt],n=Bt[kt],r=n.getViewList(),i=h();Mt.removeSizable(e.$el),e.mergeFrom(n),t.trigger("workingSetRemoveList",r,n.id),d(e.id),n.$el.off(".mainview"),n.off(".mainview"),n.destroy(),delete Bt[kt],t.trigger("paneDestroy",n.id),t.trigger("workingSetAddList",r,e.id),Gt.forEach(function(t){t.paneId===n.id&&(t.paneId=e.id)}),ut.removeClass("split-"+$t.toLowerCase()),$t=null,K(),t.trigger("paneLayoutChange",$t),i&&h()!==i&&t._open(e.id,i)}}function et(e,n,r){var i=r||{};g(e,function(e){return e.removeView(n,i.noOpenNextFile)?(x(e.id,n),t.trigger("workingSetRemove",n,!1,e.id),!1):void 0})}function tt(e,n){g(e,function(e){var r=e.removeViews(n);r.forEach(function(t){x(e.id,t)}),t.trigger("workingSetRemoveList",r,e.id)})}function nt(e){g(e,function(e){var n=e.getViewList();n.forEach(function(t){x(e.id,t)}),e._reset(),t.trigger("workingSetRemoveList",n,e.id)})}function rt(e){var t=p($(e._masterEditor.$el.parent().parent()));if(!t){var n=D(e.file.fullPath).shift();n&&(t=Bt[n.paneId])}return t}function it(e){if(!(e instanceof It.Document))throw new Error("_destroyEditorIfUnneeded() should be passed a Document");if(e._masterEditor){var t=rt(e);t?t.destroyViewIfNotNeeded(e._masterEditor):e._masterEditor.destroy()}}function ot(){function e(){var e={location:{scope:"user",layer:"project"}},t=wt.getViewState(Nt,e);if(t){var n={orientation:null,activePaneId:Pt,panes:{"first-pane":[]}};return t.forEach(function(e){n.panes[Pt].push(e)}),n}}var i,o=[],a={location:{scope:"user",layer:"project"}},s=wt.getViewState(Rt,a);s||(s=e()),Z(),Gt=[],vt.reset(),s&&(i=Object.keys(s.panes),$t=i.length>1?s.orientation:null,dt.forEach(s.panes,function(e,t){z(t),o.push(Bt[t].loadState(e))}),Tt.waitForAll(o).then(function(e){if(K(),i.length>1&&(Y(),$.isNumeric(s.splitPercentage)&&s.splitPercentage>0)){var a;a=$t===Ft?"width":"height",Bt[Pt].$el.css(a,100*s.splitPercentage+"%"),G()}$t&&(ut.addClass("split-"+$t.toLowerCase()),t.trigger("paneLayoutChange",$t)),dt.forEach(Bt,function(e){var i=e.getViewList();i.forEach(function(t){-1!==r(t)&&console.log(t.fullPath+" duplicated in mru list"),Gt.push(n(t,e.id))}),t.trigger("workingSetAddList",i,e.id)}),o=[],e.forEach(function(e){e&&o.push(mt.execute(yt.FILE_OPEN,e))}),Tt.waitForAll(o).then(function(){d(s.activePaneId)})}))}function at(){function e(){var e,t;return 1===w()?1:($t===Ft?(e=ut.innerWidth(),t=Bt[Pt].$el.width()):(e=ut.innerHeight(),t=Bt[Pt].$el.height()),t/e)}var t=Ct.getProjectRoot(),n={location:{scope:"user",layer:"project",layerID:t.fullPath}},r={orientation:$t,activePaneId:i(),splitPercentage:e(),panes:{}};t&&(dt.forEach(Bt,function(e){r.panes[e.id]=e.saveState()}),wt.setViewState(Rt,r,n))}function st(e){if(Vt)throw new Error("MainViewManager has already been initialized");ut=e,z(Pt),Vt=Pt,Bt[Pt]._handleActivePaneChange(void 0,Vt),K(),Dt.on("workspaceUpdateLayout",G)}function lt(e,t){return 1>e||e>2||1>t||t>2||2===t&&2===e?(console.error("setLayoutScheme unsupported layout "+e+", "+t),!1):(e===t?Z():X(e>t?Ut:Ft),!0)}function ct(){var e={rows:1,columns:1};return $t===Ut?e.rows=2:$t===Ft&&(e.columns=2),e}var ut,dt=e("thirdparty/lodash"),pt=e("utils/EventDispatcher"),ht=e("strings"),ft=e("utils/AppInit"),mt=e("command/CommandManager"),gt=e("view/MainViewFactory"),vt=e("view/ViewStateManager"),yt=e("command/Commands"),_t=e("widgets/Dialogs"),Et=e("widgets/DefaultDialogs"),bt=e("editor/EditorManager"),St=e("filesystem/FileSystemError"),It=e("document/DocumentManager"),wt=e("preferences/PreferencesManager"),Ct=e("project/ProjectManager"),Dt=e("view/WorkspaceManager"),Tt=e("utils/Async"),Ot=e("utils/ViewUtils"),Mt=e("utils/Resizer"),Lt=e("view/Pane").Pane,Rt="mainView.state",Nt="project.files",xt="ALL_PANES",At="ACTIVE_PANE",Pt="first-pane",kt="second-pane",Ft="VERTICAL",Ut="HORIZONTAL",jt=75,$t=null,Vt=null,Bt={},Ht={},Wt=!1,Gt=[],Kt={};Kt[Pt]={},Kt[kt]={},Kt[Pt][Ft]=ht.LEFT,Kt[Pt][Ut]=ht.TOP,Kt[kt][Ft]=ht.RIGHT,Kt[kt][Ut]=ht.BOTTOM,ft.htmlReady(function(){st($("#editor-holder"))}),pt.on_duringInit(Ct,"projectOpen",ot),pt.on_duringInit(Ct,"beforeProjectClose beforeAppClose",at),pt.on_duringInit(bt,"activeEditorChange",m),pt.on_duringInit(It,"pathDeleted",k),pt.makeEventDispatcher(t),t._initialize=st,t._getPane=a,t._removeView=A,t._moveView=P,t._sortWorkingSet=F,t._moveWorkingSetItem=U,t._swapWorkingSetListIndexes=j,t._destroyEditorIfNotNeeded=it,t._edit=Q,t._open=J,t._close=et,t._closeAll=nt,t._closeList=tt,t._getPaneIdForPath=L,t.addToWorkingSet=R,t.addListToWorkingSet=N,t.getWorkingSetSize=S,t.getWorkingSet=_,t.cacheScrollState=v,t.restoreAdjustedScrollState=y,t.findInWorkingSet=T,t.findInWorkingSetByAddedOrder=O,t.findInWorkingSetByMRUOrder=M,t.findInAllWorkingSets=D,t.beginTraversal=B,t.endTraversal=H,t.traverseToNextViewByMRU=V,t.getActivePaneId=i,t.setActivePaneId=d,t.getPaneIdList=b,t.getPaneTitle=I,t.getPaneCount=w,t.getAllOpenFiles=E,t.focusActivePane=s,t.setLayoutScheme=lt,t.getLayoutScheme=ct,t.getCurrentlyViewedFile=h,t.getCurrentlyViewedPath=f,t.ALL_PANES=xt,t.ACTIVE_PANE=At}),define("utils/AnimationUtils",["require","exports","module","utils/Async"],function(e,t){"use strict";function n(e,t,n){function i(t){t.target===e&&a.resolve()}function o(){s.removeClass(t).off("webkitTransitionEnd",i)}var a=new $.Deferred,s=$(e);return n=n||400,s.is(":hidden")?a.resolve():s.addClass(t).on("webkitTransitionEnd",i),r.withTimeout(a.promise(),n,!0).done(o)}var r=e("utils/Async");t.animateUsingClass=n}),define("widgets/PopUpManager",["require","exports","module","utils/AppInit","utils/EventDispatcher","command/CommandManager","utils/KeyEvent"],function(e,t){"use strict";function n(e,t,n){n=n||!1,p.push(e[0]),e.data("PopUpManager-autoRemove",n),e.data("PopUpManager-removeHandler",t)}function r(e){if(e.find(":visible").length>0){var t=e.data("PopUpManager-removeHandler");t&&t()}var n=p.indexOf(e[0]);if(n>=0){var r=e.data("PopUpManager-autoRemove");r&&(e.remove(),p.splice(n,1))}}function i(e){var t,n,i=new $.Event("popUpClose");for(n=p.length-1;n>=0;n--)if(t=$(p[n]),t.find(":visible").length>0){t.trigger(i),i.isDefaultPrevented()||(e&&e.stopImmediatePropagation(),r(t));break}}function o(e){(e.keyCode===d.DOM_VK_ESCAPE||e.keyCode===d.DOM_VK_ALT&&"win"===brackets.platform)&&(e.keyCode===d.DOM_VK_ALT&&e.ctrlKey||i(e))}function a(){i()}function s(e){e.on("beforeContextMenuOpen",a)}var l=e("utils/AppInit"),c=e("utils/EventDispatcher"),u=e("command/CommandManager"),d=e("utils/KeyEvent"),p=[];l.htmlReady(function(){window.document.body.addEventListener("keydown",o,!0),t.on("beforeMenuPopup",a),u.on("beforeExecuteCommand",function(){i()})}),c.makeEventDispatcher(t),t.addPopUp=n,t.removePopUp=r,t.listenToContextMenu=s}),define("command/Menus",["require","exports","module","thirdparty/lodash","command/Commands","utils/EventDispatcher","command/KeyBindingManager","utils/StringUtils","command/CommandManager","widgets/PopUpManager","utils/ViewUtils","utils/DeprecationWarning","utils/Global"],function(e,t){"use strict";function n(e){return G[e]}function r(){return G}function i(e){return K[e]}function o(e){return!!i(e)}function a(e){return!brackets.nativeMenus||o(e)}function s(e){return q[e]}function l(e){return $("#"+C.jQueryIdEscape(e)).get(0)}function c(e){return $("#"+C.jQueryIdEscape(e)).get(0)}function u(e,t,n){var r=e.find(".menu-shortcut");0===r.length&&(r=$("<span class='menu-shortcut' />"),e.append(r)),r.data("key",t),r.text(w.formatKeyDescriptor(n))}function d(e){var t=w.getKeyBindings(e.getCommand().getID()),n=null;return t.length>0&&(n=t[t.length-1],u($(c(e.id)),n.key,n.displayKey)),n}function p(){return"brackets-menuDivider-"+z++}function h(e,t,n,r){var i=!1;n&&(n===F?n=x:n===U&&(n=A),n===P?(e.prepend(t),i=!0):r&&r.length>0&&(n===A?(r.after(t),i=!0):n===x&&(r.before(t),i=!0))),i||e.append(t)}function f(e,t){this.id=e,this.isDivider=t===j,this.isNative=!1,this.isDivider||(this._enabledChanged=this._enabledChanged.bind(this),this._checkedChanged=this._checkedChanged.bind(this),this._nameChanged=this._nameChanged.bind(this),this._keyBindingAdded=this._keyBindingAdded.bind(this),this._keyBindingRemoved=this._keyBindingRemoved.bind(this),this._command=t,this._command.on("enabledStateChange",this._enabledChanged).on("checkedStateChange",this._checkedChanged).on("nameChange",this._nameChanged).on("keyBindingAdded",this._keyBindingAdded).on("keyBindingRemoved",this._keyBindingRemoved))}function m(e){this.id=e}function g(){$(".dropdown").removeClass("open")}function v(e,t,n,r){e=b.escape(e);var i,o=$("#titlebar .nav");if(!e||!t)return console.error("call to addMenu() is missing required parameters"),null;if(G[t])return console.log("Menu added with same name and id of existing Menu: "+t),null;if(i=new m(t),G[t]=i,!a(t))return brackets.app.addMenu(e,t,n,r,function(n){switch(n){case V:brackets.app.setMenuTitle(t,e,function(e){e&&console.error("setMenuTitle() -- error: "+e)});break;case B:console.error("addMenu(): Unknown Error when adding the menu "+t);break;case H:console.error("addMenu(): Invalid Parameters when adding the menu "+t);break;case W:console.error("addMenu(): Menu with command "+r+" could not be found when adding the menu "+t);break;default:console.error("addMenu(): Unknown Error ("+n+") when adding the menu "+t)}}),i;var s=$("<a href='#' class='dropdown-toggle' data-toggle='dropdown'>"+e+"</a>"),c=$("<ul class='dropdown-menu'></ul>"),u=$("<li class='dropdown' id='"+t+"'></li>").append(s).append(c),d=r&&$(l(r));return h(o,u,n,d),T.addPopUp(c,g,!1),i}function y(e){var t,r="";return e?G[e]?(t=n(e),b.forEach(q,function(n,i){i.substring(0,e.length)===e&&(n.isDivider?t.removeMenuDivider(i):(r=n.getCommand(),t.removeMenuItem(r)))}),a(e)?$(l(e)).remove():brackets.app.removeMenu(e,function(t){t&&console.error("removeMenu() -- id not found: "+e+" (error: "+t+")")}),void delete G[e]):void console.error("removeMenu(): menu id not found: %s",e):void console.error("removeMenu(): missing required parameter: id")}function _(e){m.apply(this,arguments);var t=$("<li class='dropdown context-menu' id='"+C.jQueryIdEscape(e)+"'></li>"),n=$("<ul class='dropdown-menu'></ul>"),r=$("<a href='#' class='dropdown-toggle' data-toggle='dropdown'></a>").hide();t.append(r).append(n),$("#context-menu-bar > ul").append(t);var i=this;T.addPopUp(n,function(){i.close()},!1),T.listenToContextMenu(this)}function E(e){if(!e)return console.error("call to registerContextMenu() is missing required parameters"),null;if(K[e])return console.log("Context Menu added with same name and id of existing Context Menu: "+e),null;var t=new _(e);return K[e]=t,t}var b=e("thirdparty/lodash"),S=e("command/Commands"),I=e("utils/EventDispatcher"),w=e("command/KeyBindingManager"),C=e("utils/StringUtils"),D=e("command/CommandManager"),T=e("widgets/PopUpManager"),O=e("utils/ViewUtils"),M=e("utils/DeprecationWarning");e("utils/Global");var L={FILE_MENU:"file-menu",EDIT_MENU:"edit-menu",FIND_MENU:"find-menu",VIEW_MENU:"view-menu",NAVIGATE_MENU:"navigate-menu",HELP_MENU:"help-menu"},R={EDITOR_MENU:"editor-context-menu",INLINE_EDITOR_MENU:"inline-editor-context-menu",PROJECT_MENU:"project-context-menu",WORKING_SET_CONTEXT_MENU:"workingset-context-menu",WORKING_SET_CONFIG_MENU:"workingset-configuration-menu",SPLITVIEW_MENU:"splitview-menu"},N={FILE_OPEN_CLOSE_COMMANDS:{sectionMarker:S.FILE_NEW},FILE_SAVE_COMMANDS:{sectionMarker:S.FILE_SAVE},FILE_LIVE:{sectionMarker:S.FILE_LIVE_FILE_PREVIEW},FILE_EXTENSION_MANAGER:{sectionMarker:S.FILE_EXTENSION_MANAGER},EDIT_UNDO_REDO_COMMANDS:{sectionMarker:S.EDIT_UNDO},EDIT_TEXT_COMMANDS:{sectionMarker:S.EDIT_CUT},EDIT_SELECTION_COMMANDS:{sectionMarker:S.EDIT_SELECT_ALL},EDIT_MODIFY_SELECTION:{sectionMarker:S.EDIT_INDENT},EDIT_COMMENT_SELECTION:{sectionMarker:S.EDIT_LINE_COMMENT},EDIT_CODE_HINTS_COMMANDS:{sectionMarker:S.SHOW_CODE_HINTS},EDIT_TOGGLE_OPTIONS:{sectionMarker:S.TOGGLE_CLOSE_BRACKETS},FIND_FIND_COMMANDS:{sectionMarker:S.CMD_FIND},FIND_FIND_IN_COMMANDS:{sectionMarker:S.CMD_FIND_IN_FILES},FIND_REPLACE_COMMANDS:{sectionMarker:S.CMD_REPLACE},VIEW_HIDESHOW_COMMANDS:{sectionMarker:S.VIEW_HIDE_SIDEBAR},VIEW_FONTSIZE_COMMANDS:{sectionMarker:S.VIEW_INCREASE_FONT_SIZE},VIEW_TOGGLE_OPTIONS:{sectionMarker:S.TOGGLE_ACTIVE_LINE},NAVIGATE_GOTO_COMMANDS:{sectionMarker:S.NAVIGATE_QUICK_OPEN},NAVIGATE_DOCUMENTS_COMMANDS:{sectionMarker:S.NAVIGATE_NEXT_DOC},NAVIGATE_OS_COMMANDS:{sectionMarker:S.NAVIGATE_SHOW_IN_FILE_TREE},NAVIGATE_QUICK_EDIT_COMMANDS:{sectionMarker:S.TOGGLE_QUICK_EDIT},NAVIGATE_QUICK_DOCS_COMMANDS:{sectionMarker:S.TOGGLE_QUICK_DOCS}},x="before",A="after",P="first",k="last",F="firstInSection",U="lastInSection",j="---",V=0,B=1,H=2,W=3,G={},K={},q={},z=1;m.prototype._getMenuItemId=function(e){return this.id+"-"+e},m.prototype._getMenuItemForCommand=function(e){if(!e)return null;var t=q[this._getMenuItemId(e.getID())];return t?$(c(t.id)).closest("li"):null},m.prototype._getRelativeMenuItem=function(e,t){var n;if(e){if(t===F||t===U){if(!e.hasOwnProperty("sectionMarker"))return console.error("Bad Parameter in _getRelativeMenuItem(): relativeID must be a MenuSection when position refers to a menu section"),null;var r=this._getMenuItemForCommand(D.get(e.sectionMarker));if(!r)return console.error("_getRelativeMenuItem(): MenuSection "+e.sectionMarker+" not found in Menu "+this.id),null;var i=r;for(n=i;;){if(i=t===F?i.prev():i.next(),0===i.length)break;if(i.find(".divider").length>0)break;n=i}}else{if(e.hasOwnProperty("sectionMarker"))return console.error("Bad Parameter in _getRelativeMenuItem(): if relativeID is a MenuSection, position must be FIRST_IN_SECTION or LAST_IN_SECTION"),null;var o=D.get(e);if(o&&(n=this._getMenuItemForCommand(o)),!n)return console.error("_getRelativeMenuItem(): MenuItem with Command id "+e+" not found in Menu "+this.id),null}return n}return t&&t!==P&&t!==k?(console.error("Bad Parameter in _getRelativeMenuItem(): relative position specified with no relativeID"),null):n},m.prototype.removeMenuItem=function(e){var t,n;if(!e)return void console.error("removeMenuItem(): missing required parameters: command");if("string"==typeof e){var r=D.get(e);if(!r)return void console.error("removeMenuItem(): command not found: "+e);n=e}else n=e.getID();t=this._getMenuItemId(n),a(this.id)?$(c(t)).parent().remove():brackets.app.removeMenuItem(n,function(e){e&&console.error("removeMenuItem() -- command not found: "+n+" (error: "+e+")")}),delete q[t]},m.prototype.removeMenuDivider=function(e){var t,n;if(!e)return void console.error("removeMenuDivider(): missing required parameters: menuItemID");if(t=s(e),!t)return void console.error("removeMenuDivider(): parameter menuItemID: %s is not a valid menu item id",e);if(!t.isDivider)return void console.error("removeMenuDivider(): parameter menuItemID: %s is not a menu divider",e);if(a(this.id)){if(n=$(c(e)).parent(),!n)return void console.error("removeMenuDivider(): HTML menu divider not found: %s",e);n.remove()}else brackets.app.removeMenuItem(t.dividerId,function(t){t&&console.error("removeMenuDivider() -- divider not found: %s (error: %s)",e,t)});return q[e]?void delete q[e]:void console.error("removeMenuDivider(): menu divider not found in menuItemMap: %s",e)},m.prototype.addMenuItem=function(e,t,n,r){var i,o,s,l,c,u=this.id;if(!e)return console.error("addMenuItem(): missing required parameters: command"),null;if("string"==typeof e)if(e===j)l=j,c=p();else{if(c=e,e=D.get(c),!e)return console.error("addMenuItem(): commandID not found: "+c),null;l=e.getName()}else c=e.getID(),l=e.getName();if(i=this._getMenuItemId(c),q[i])return console.log("MenuItem added with same id of existing MenuItem: "+i),null;if(s=new f(i,e),q[i]=s,a(this.id)){l===j?o=$("<li><hr class='divider' id='"+i+"' /></li>"):(o=$("<li><a href='#' id='"+i+"'> <span class='menu-name'></span></a></li>"),o.on("click",function(){s._command.execute()}));var m=this._getRelativeMenuItem(r,n);h($("li#"+C.jQueryIdEscape(this.id)+" > ul.dropdown-menu"),o,n,m)}else{var g,v=w.getKeyBindings(c),y="",_="";if(v&&v.length>0&&(g=v[v.length-1],y=g.displayKey||g.key),y.length>0&&(_=w.formatKeyDescriptor(y)),n===F||n===U){if(!r.hasOwnProperty("sectionMarker"))return console.error("Bad Parameter in _getRelativeMenuItem(): relativeID must be a MenuSection when position refers to a menu section"),null;r=r.sectionMarker}brackets.app.addMenuItem(this.id,l,c,y,_,n,r,function(e){switch(e){case V:break;case H:console.error("addMenuItem(): Invalid Parameters when adding the command "+c);break;case W:console.error("_getRelativeMenuItem(): MenuItem with Command id "+r+" not found in the Menu "+u);break;default:console.error("addMenuItem(); Unknown Error ("+e+") when adding the command "+c)}}),s.isNative=!0}return s.isDivider?s.dividerId=c:(t&&(Array.isArray(t)||(t=[t])),w.addBinding(c,t),d(s,c),s._checkedChanged(),s._enabledChanged(),s._nameChanged()),s},m.prototype.addMenuDivider=function(e,t){return this.addMenuItem(j,"",e,t)},f.prototype.getCommand=function(){return this._command},f.prototype.getParentMenu=function(){var e=$(c(this.id)).parents(".dropdown").get(0);return e?n(e.id):null},f.prototype._checkedChanged=function(){var e=!!this._command.getChecked();if(this.isNative){var t=!!this._command.getEnabled();brackets.app.setMenuItemState(this._command.getID(),t,e,function(e){e&&console.log("Error setting menu item state: "+e)})}else O.toggleClass($(c(this.id)),"checked",e)},f.prototype._enabledChanged=function(){if(this.isNative){var e=!!this._command.getEnabled(),t=!!this._command.getChecked();brackets.app.setMenuItemState(this._command.getID(),e,t,function(e){e&&console.log("Error setting menu item state: "+e)})}else O.toggleClass($(c(this.id)),"disabled",!this._command.getEnabled())},f.prototype._nameChanged=function(){this.isNative?brackets.app.setMenuTitle(this._command.getID(),this._command.getName(),function(e){e&&console.log("Error setting menu title: "+e)}):$(c(this.id)).find(".menu-name").text(this._command.getName())},f.prototype._keyBindingAdded=function(e,t){if(this.isNative){var n=t.displayKey||t.key;brackets.app.setMenuItemShortcut(this._command.getID(),n,w.formatKeyDescriptor(n),function(e){e&&console.error("Error setting menu item shortcut: "+e)})}else u($(c(this.id)),t.key,t.displayKey)},f.prototype._keyBindingRemoved=function(e,t){if(this.isNative)brackets.app.setMenuItemShortcut(this._command.getID(),"","",function(e){e&&console.error("Error setting menu item shortcut: "+e)});else{var n=$(c(this.id)).find(".menu-shortcut");n.length>0&&n.data("key")===t.key&&null===d(this)&&n.empty()}},_.prototype=Object.create(m.prototype),_.prototype.constructor=_,_.prototype.parentClass=m.prototype,I.makeEventDispatcher(_.prototype),_.prototype.open=function(e){if(!e||!e.hasOwnProperty("pageX")||!e.hasOwnProperty("pageY"))return void console.error("ContextMenu open(): missing required parameter");var t=$(window),n=C.jQueryIdEscape(this.id),r=$("#"+n),i=$("#"+n+" > ul"),o=e.pageY,a=e.pageX;if(!(i.children().length<=0)){this.trigger("beforeContextMenuOpen"),g();var s={top:o,left:a,height:i.height()+25,width:i.width()},l=O.getElementClipSize(t,s);l.bottom>0&&(o=Math.max(0,o-l.bottom)),o-=30,a+=5,l.right>0&&(a=Math.max(0,a-l.right)),r.addClass("open").css({left:a,top:o})}},_.prototype.close=function(){this.trigger("beforeContextMenuClose"),$("#"+C.jQueryIdEscape(this.id)).removeClass("open")},_.prototype.isOpen=function(){return $("#"+C.jQueryIdEscape(this.id)).hasClass("open")},_.assignContextMenuToSelector=function(e,t){$(e).on("click",function(e){var n,r;e.stopPropagation(),t.isOpen()?t.close():(n=$(this).offset(),r=$(this).outerHeight(),t.open({pageX:n.left,pageY:n.top+r}))})},M.deprecateConstant(R,"WORKING_SET_MENU","WORKING_SET_CONTEXT_MENU"),M.deprecateConstant(R,"WORKING_SET_SETTINGS_MENU","WORKING_SET_CONFIG_MENU"),t.AppMenuBar=L,t.ContextMenuIds=R,t.MenuSection=N,t.BEFORE=x,t.AFTER=A,t.LAST=k,t.FIRST=P,t.FIRST_IN_SECTION=F,t.LAST_IN_SECTION=U,t.DIVIDER=j,t.getMenu=n,t.getAllMenus=r,t.getMenuItem=s,t.getContextMenu=i,t.addMenu=v,t.removeMenu=y,t.registerContextMenu=E,t.closeAll=g,t.Menu=m,t.MenuItem=f,t.ContextMenu=_}),define("document/TextRange",["require","exports","module","utils/EventDispatcher"],function(e,t){"use strict";function n(e,t,n){this.startLine=t,this.endLine=n,this.document=e,e.addRef(),this._handleDocumentChange=this._handleDocumentChange.bind(this),this._handleDocumentDeleted=this._handleDocumentDeleted.bind(this),e.on("change",this._handleDocumentChange),e.on("deleted",this._handleDocumentDeleted)}var r=e("utils/EventDispatcher");r.makeEventDispatcher(n.prototype),n.prototype.dispose=function(){this.document.releaseRef(),this.document.off("change",this._handleDocumentChange),this.document.off("deleted",this._handleDocumentDeleted)},n.prototype.document=null,n.prototype.startLine=null,n.prototype.endLine=null,n.prototype._applySingleChangeToRange=function(e){if(e.from&&e.to){if(e.from.line<this.startLine&&e.to.line>=this.startLine||e.from.line<=this.endLine&&e.to.line>this.endLine)return this.startLine=null,this.endLine=null,{hasChanged:!0,hasContentChanged:!0};var t=e.text.length-(e.to.line-e.from.line+1),n={hasChanged:!1,hasContentChanged:!1};return 0!==t&&(e.to.line<this.startLine&&(this.startLine+=t,n.hasChanged=!0),e.to.line<=this.endLine&&(this.endLine+=t,n.hasChanged=!0)),e.from.line>=this.startLine&&e.from.line<=this.endLine&&(n.hasContentChanged=!0),n}return this.startLine=null,this.endLine=null,{hasChanged:!0,hasContentChanged:!0}},n.prototype._applyChangesToRange=function(e){var t,n=!1,r=!1;for(t=0;t<e.length;t++){var i=this._applySingleChangeToRange(e[t]);if(n=n||i.hasChanged,r=r||i.hasContentChanged,null===this.startLine||null===this.endLine){this.trigger("lostSync");break}}n&&this.trigger("change"),r&&this.trigger("contentChange")},n.prototype._handleDocumentChange=function(e,t,n){this._applyChangesToRange(n)},n.prototype._handleDocumentDeleted=function(){this.trigger("lostSync")},n.prototype.toString=function(){return"[TextRange "+this.startLine+"-"+this.endLine+" in "+this.document+"]"},t.TextRange=n}),define("utils/TokenUtils",["require","exports","module","thirdparty/lodash","thirdparty/CodeMirror2/lib/codemirror"],function(e,t){"use strict";function n(e){h=null,e&&e.off("changes",n)}function r(e,t){if(!h||!h.tokens||h.line!==t||h.cm!==e){var r=e.getLineTokens(t,!1);r.unshift(e.getTokenAt({line:t,ch:0},!1)),h={cm:e,line:t,timeStamp:Date.now(),tokens:r},e.off("changes",n),e.on("changes",n)}return h.tokens}function i(e,t,i){if(i)return n(),e.getTokenAt(t,i);var o=r(e,t.line),a=f.sortedIndex(o,{end:t.ch},"end"),s=o[a];return s||e.getTokenAt(t,i)}function o(e,t){return{editor:e,pos:t,token:e.getTokenAt(t,!0)}}function a(e,t){if(void 0===t&&(t=!0),e.pos.ch<=0||e.token.start<=0){if(e.pos.line<=0)return!1;e.pos.line--,e.pos.ch=e.editor.getLine(e.pos.line).length}else e.pos.ch=e.token.start;return e.token=i(e.editor,e.pos,t),!0}function s(e){return(e.pos.ch<=0||e.token.start<=0)&&e.pos.line<=0}function l(e,t){var n=e.editor.getLine(e.pos.line).length;if(void 0===t&&(t=!0),e.pos.ch>=n||e.token.end>=n){if(e.pos.line>=e.editor.lineCount()-1)return!1;e.pos.line++,e.pos.ch=0}else e.pos.ch=e.token.end+1;return e.token=i(e.editor,e.pos,t),!0}function c(e){var t=e.editor.getLine(e.pos.line).length;return(e.pos.ch>=t||e.token.end>=t)&&e.pos.line>=e.editor.lineCount()-1}function u(e,t){if(!e(t))return!1;for(;!t.token.type&&!/\S/.test(t.token.string);)if(!e(t))return!1;return!0}function d(e){var t=e.pos.ch-e.token.start;return 0>t&&console.log("CodeHintUtils: _offsetInToken - Invalid context: pos not in the current token!"),t}function p(e,t){var n,r=e.getMode(),i=m.innerMode(r,e.getTokenAt(t,!0).state);return n="xml"===i.mode.name?i.mode.configuration:i.mode.name,{mode:i.mode,name:n}}var h,f=e("thirdparty/lodash"),m=e("thirdparty/CodeMirror2/lib/codemirror");t.movePrevToken=a,t.moveNextToken=l,t.isAtStart=s,t.isAtEnd=c,t.moveSkippingWhitespace=u,t.getInitialContext=o,t.offsetInToken=d,t.getModeAt=p}),define("utils/ValidationUtils",["require","exports","module"],function(e,t){"use strict";function n(e){return"number"!=typeof e||isNaN(parseInt(e,10))?!1:Math.floor(e)!==e?!1:isFinite(e)?!0:!1}function r(e,t,r){if(!n(e))return!1;var i="number"==typeof t,o="number"==typeof r;return(!i||e>=t)&&(!o||r>=e)}t.isInteger=n,t.isIntegerInRange=r}),define("editor/Editor",["require","exports","module","utils/AnimationUtils","utils/Async","thirdparty/CodeMirror2/lib/codemirror","language/LanguageManager","utils/EventDispatcher","command/Menus","utils/PerfUtils","widgets/PopUpManager","preferences/PreferencesManager","document/TextRange","utils/TokenUtils","utils/ValidationUtils","utils/ViewUtils","thirdparty/lodash"],function(e,t,n){"use strict";function r(e){return new p.Pos(e.line,e.ch)}function i(e){return e!==X}function o(){return!0}function a(e){return y._buildContext(e,e?h.getLanguageForPath(e).getId():void 0)}function s(e,t,n,r){var i=this;Q.push(this),this.document=e,e.addRef(),n.jquery&&(n=n.get(0));var o=$(n);r&&(this._visibleRange=new _(e,r.startLine,r.endLine)),this._handleDocumentChange=this._handleDocumentChange.bind(this),this._handleDocumentDeleted=this._handleDocumentDeleted.bind(this),this._handleDocumentLanguageChanged=this._handleDocumentLanguageChanged.bind(this),e.on("change",this._handleDocumentChange),e.on("deleted",this._handleDocumentDeleted),e.on("languageChanged",this._handleDocumentLanguageChanged);var a=this._getModeFromDocument();this._inlineWidgets=[],this._inlineWidgetQueues={},this._hideMarks=[],this._lastEditorWidth=null,this._$messagePopover=null;var s={Tab:function(){i._handleTabKey()},"Shift-Tab":"indentLess",Left:function(){i._handleSoftTabNavigation(-1,"moveH")},Right:function(){i._handleSoftTabNavigation(1,"moveH")},Backspace:function(){i._handleSoftTabNavigation(-1,"deleteH")},Delete:function(){i._handleSoftTabNavigation(1,"deleteH")},Esc:function(e){i.getSelections().length>1?p.commands.singleSelection(e):i.removeAllInlineWidgets()},Home:"goLineLeftSmart","Cmd-Left":"goLineLeftSmart",End:"goLineRight","Cmd-Right":"goLineRight"},l=this._currentOptions=I.zipObject(q,I.map(q,function(e){return i._getOption(e)}));o.toggleClass("show-line-padding",Boolean(!this._getOption("showLineNumbers"))),this._codeMirror=new p(n,{autoCloseBrackets:l[w],autoCloseTags:l[C],coverGutterNextToScrollbar:!0,cursorScrollMargin:3,dragDrop:l[D],electricChars:!1,extraKeys:s,highlightSelectionMatches:l[T],indentUnit:l[F]?l[P]:l[x],indentWithTabs:l[F],lineNumbers:l[L],lineWrapping:l[U],matchBrackets:{maxScanLineLength:5e4,maxScanLines:1e3},matchTags:{bothTags:!0},showCursorWhenSelecting:l[M],scrollPastEnd:!r&&l[O],smartIndent:l[R],styleActiveLine:l[A],tabSize:l[P]}),this._focused=!1,this._installEditorListeners(),this.on("cursorActivity",function(e){i._handleCursorActivity(e)}),this.on("keypress",function(e,t,n){i._handleKeypressEvents(n)}),this.on("change",function(e,t,n){i._handleEditorChange(n)}),this._codeMirror.setOption("mode",a),this._duringSync=!0,this._resetText(e.getText()),this._duringSync=!1,r&&(this._updateHiddenLines(),this.setCursorPos(r.startLine,0)),t&&e._makeEditable(this),Object.defineProperty(this,"scrollTop",{get:function(){return this._codeMirror.getScrollInfo().top}}),Object.defineProperty(this,"$el",{get:function(){return $(this.getRootElement())}})}function l(e,t){return t.line<e.line||t.line===e.line&&t.ch<e.ch?{start:r(t),end:r(e),reversed:!0}:{start:r(e),end:r(t),reversed:!1}}function c(){var e={};q.forEach(function(t){e[t]="user"}),y.convertPreferences(n,e)}var u=e("utils/AnimationUtils"),d=e("utils/Async"),p=e("thirdparty/CodeMirror2/lib/codemirror"),h=e("language/LanguageManager"),f=e("utils/EventDispatcher"),m=e("command/Menus"),g=e("utils/PerfUtils"),v=e("widgets/PopUpManager"),y=e("preferences/PreferencesManager"),_=e("document/TextRange").TextRange,E=e("utils/TokenUtils"),b=e("utils/ValidationUtils"),S=e("utils/ViewUtils"),I=e("thirdparty/lodash"),w="closeBrackets",C="closeTags",D="dragDropText",T="highlightMatches",O="scrollPastEnd",M="showCursorWhenSelecting",L="showLineNumbers",R="smartIndent",N="softTabs",x="spaceUnits",A="styleActiveLine",P="tabSize",k="uppercaseColors",F="useTabChar",U="wordWrap",j={},V=1,B=1,H=4,W=4,G=10,K=10;j[w]="autoCloseBrackets",j[C]="autoCloseTags",j[D]="dragDrop",j[T]="highlightSelectionMatches",j[O]="scrollPastEnd",j[M]="showCursorWhenSelecting",j[L]="lineNumbers",j[R]="smartIndent",j[x]="indentUnit",j[A]="styleActiveLine",j[P]="tabSize",j[F]="indentWithTabs",j[U]="lineWrapping",y.definePreference(w,"boolean",!1),y.definePreference(C,"Object",{whenOpening:!0,whenClosing:!0,indentTags:[]}),y.definePreference(D,"boolean",!1),y.definePreference(T,"boolean",!1),y.definePreference(O,"boolean",!1),y.definePreference(M,"boolean",!1),y.definePreference(L,"boolean",!0),y.definePreference(R,"boolean",!0),y.definePreference(N,"boolean",!0),y.definePreference(x,"number",H,{validator:I.partialRight(b.isIntegerInRange,V,G)}),y.definePreference(A,"boolean",!1),y.definePreference(P,"number",W,{validator:I.partialRight(b.isIntegerInRange,B,K)}),y.definePreference(k,"boolean",!1),y.definePreference(F,"boolean",!1),y.definePreference(U,"boolean",!0);var q=Object.keys(j),z=!1,Y=0,X=1,Q=[];f.makeEventDispatcher(s.prototype),f.markDeprecated(s.prototype,"keyEvent","'keydown/press/up'"),s.prototype.destroy=function(){this.trigger("beforeDestroy",this),$(this.getRootElement()).remove(),Q.splice(Q.indexOf(this),1),this.document.releaseRef(),this.document.off("change",this._handleDocumentChange),this.document.off("deleted",this._handleDocumentDeleted),this.document.off("languageChanged",this._handleDocumentLanguageChanged),this._visibleRange&&this._visibleRange.dispose(),this.document._masterEditor===this&&this.document._makeNonEditable();var e=this;this._inlineWidgets.forEach(function(t){e._removeInlineWidgetInternal(t)})},s.prototype._checkElectricChars=function(e){var t=this._codeMirror,n=String.fromCharCode(e.which||e.keyCode);if(/[\]\{\}\)]/.test(n)){var r=this.getCursorPos(),i=t.getLine(r.line),o=i.search(/\S/);(-1===o||o>=r.ch)&&(-1===o&&this.setCursorPos(r.line,this.document.getLine(r.line).length),window.setTimeout(function(){t.indentLine(r.line)},75))}},s.prototype._handleCursorActivity=function(){this._updateStyleActiveLine()},s.prototype._handleKeypressEvents=function(e){this._checkElectricChars(e)},s.prototype._addIndentAtEachSelection=function(e){var t=this._codeMirror,n=t.getOption("indentWithTabs"),r=t.getOption("indentUnit"),i=[];I.each(e,function(e){var t,o,a="";if(n)a="	";else for(o=r-e.start.ch%r,t=0;o>t;t++)a+=" ";i.push({edit:{text:a,start:e.start}})}),this.document.doMultipleEdits(i)},s.prototype._autoIndentEachSelection=function(e){var t=this._codeMirror,n={};I.each(e,function(e){n[e.start.line]=t.getLine(e.start.line).length}),p.commands.indentAuto(t);var r=!1,i=this.getSelections();i.length===e.length?I.each(e,function(e,o){var a=i[o];return 0!==p.cmpPos(e.start,a.start)||0!==p.cmpPos(e.end,a.end)||t.getLine(e.start.line).length!==n[e.start.line]?(r=!0,!1):void 0}):r=!0,r||p.commands.indentMore(t)},s.prototype._handleTabKey=function(){var e=this._codeMirror,t="indentAuto",n=this.getSelections();switch(I.each(n,function(n){return n.start.line!==n.end.line?(t="indentAtBeginning",!1):void(n.end.ch>0&&n.end.ch>=e.getLine(n.end.line).search(/\S/)&&(t="indentAtSelection"))
}),t){case"indentAtBeginning":p.commands.indentMore(e);break;case"indentAtSelection":this._addIndentAtEachSelection(n);break;case"indentAuto":this._autoIndentEachSelection(n)}},s.prototype._handleSoftTabNavigation=function(e,t){var n=this._codeMirror,r=null;if(!n.getOption("indentWithTabs")&&y.get(N)){var i=n.getOption("indentUnit");I.each(this.getSelections(),function(t){if(0===p.cmpPos(t.start,t.end)){var o=t.start,a=0===i?1:o.ch%i,s=n.getLine(o.line);return-1!==s.substr(0,o.ch).search(/\S/)?a=null:1===e?(i&&(a=i-a),(o.ch+a>s.length||-1!==s.substr(o.ch,a).search(/\S/))&&(a=null)):(0===a&&(a=i),a=o.ch-a<0?null:-a),null===a||null!==r&&r!==a?(r=null,!1):void(r=a)}})}null===r&&(r=e),n[t](r,"char")},s.prototype._getModeFromDocument=function(){return this.document.getLanguage().getMode()||"text/plain"},s.prototype.selectAllNoScroll=function(){var e=this._codeMirror,t=this._codeMirror.getScrollInfo();e.operation(function(){e.scrollTo(t.left,t.top),e.execCommand("selectAll")})},s.prototype.isTextSubset=function(){return Boolean(this._visibleRange)},s.prototype._updateHiddenLines=function(){if(this._visibleRange){var e=this._codeMirror,t=this;e.operation(function(){t._hideMarks.forEach(function(e){e&&e.clear()}),t._hideMarks=[],t._hideMarks.push(t._hideLines(0,t._visibleRange.startLine)),t._hideMarks.push(t._hideLines(t._visibleRange.endLine+1,t.lineCount()))})}},s.prototype._applyChanges=function(e){if(this._visibleRange&&(null===this._visibleRange.startLine||null===this._visibleRange.endLine))return void this.trigger("lostContent");var t=this._codeMirror;t.operation(function(){var n,r,i;for(i=0;i<e.length;i++)n=e[i],r=n.text.join("\n"),n.from&&n.to?t.replaceRange(r,n.from,n.to,n.origin):((n.from||n.to)&&console.error("Change record received with only one end undefined--replacing entire text"),t.setValue(r))}),this._updateHiddenLines()},s.prototype._handleEditorChange=function(e){this._duringSync||(this.document._ensureMasterEditor(),this.document._masterEditor!==this&&(this._duringSync=!0,this.document._masterEditor._applyChanges(e),this._duringSync=!1,this._updateHiddenLines()),this.trigger("editorChange",this,e))},s.prototype._handleDocumentChange=function(e,t,n){this._duringSync||this.document._masterEditor!==this&&(this._duringSync=!0,this._applyChanges(n),this._duringSync=!1)},s.prototype._handleDocumentDeleted=function(e){this.trigger("lostContent",e)},s.prototype._handleDocumentLanguageChanged=function(){this._codeMirror.setOption("mode",this._getModeFromDocument())},s.prototype._installEditorListeners=function(){function e(e,n){return t.trigger("keyEvent",t,n),t.trigger(n.type,t,n),n.defaultPrevented}var t=this;this._codeMirror.on("keydown",e),this._codeMirror.on("keypress",e),this._codeMirror.on("keyup",e),this._codeMirror.on("changes",function(e,n){t.trigger("change",t,n)}),this._codeMirror.on("beforeChange",function(e,n){t.trigger("beforeChange",t,n)}),this._codeMirror.on("cursorActivity",function(){t.trigger("cursorActivity",t)}),this._codeMirror.on("scroll",function(){t.isFullyVisible()&&m.closeAll(),t.trigger("scroll",t)}),this._codeMirror.on("focus",function(){t._focused=!0,t.trigger("focus",t)}),this._codeMirror.on("blur",function(){t._focused=!1,t.trigger("blur",t)}),this._codeMirror.on("update",function(){t.trigger("update",t)}),this._codeMirror.on("overwriteToggle",function(e,n){t.trigger("overwriteToggle",t,n)}),this._codeMirror.on("drop",function(e,t){var n=t.dataTransfer.files;n&&n.length&&t.preventDefault()})},s.prototype._resetText=function(e){var t=g.markStart("Editor._resetText()	"+(!this.document||this.document.file.fullPath)),n=this.getCursorPos(),r=this.getScrollPos();this._codeMirror.setValue(e),this._codeMirror.clearHistory(),this._codeMirror.markClean(),this.setCursorPos(n),this.setScrollPos(r.x,r.y),g.addMeasurement(t)},s.prototype.getFile=function(){return this.document.file},s.prototype.getCursorPos=function(e,t){"start"===t?t="from":"end"===t&&(t="to");var n=r(this._codeMirror.getCursor(t));return e&&(n.ch=this.getColOffset(n)),n},s.prototype.getColOffset=function(e){var t,n=this._codeMirror.getRange({line:e.line,ch:0},e),r=null,i=0;for(t=0;t<n.length;t++)"	"===n[t]?(null===r&&(r=s.getTabSize()),r>0&&(i+=r-i%r)):i++;return i},s.prototype.getCharIndexForColumn=function(e,t){var n,r=this._codeMirror.getLine(e),i=null,o=0;for(n=0;t>o;n++)"	"===r[n]?(null===i&&(i=s.getTabSize()),i>0&&(o+=i-o%i)):o++;return n},s.prototype.setCursorPos=function(e,t,n,r){r&&(t=this.getColOffset({line:e,ch:t})),this._codeMirror.setCursor(e,t),n&&this.centerOnCursor()},s.prototype.setSize=function(e,t){this._codeMirror.setSize(e,t)};var J=.15;s.prototype.centerOnCursor=function(e){var t=$(this.getScrollerElement()),n=t.height(),r=t.outerHeight()-n,a=t.offset().top,s=this._codeMirror.cursorCoords(null,"local").bottom,l=this._codeMirror.cursorCoords(null,"page").bottom-a;if(i(e)&&n*J>l||o(e)&&l>n*(1-J)){var c=s-n/2+r,u=this._codeMirror.getScrollInfo();c=Math.min(Math.max(c,0),u.height-u.clientHeight),this.setScrollPos(null,c)}},s.prototype.indexFromPos=function(e){return this._codeMirror.indexFromPos(e)},s.prototype.posWithinRange=function(e,t,n,r){return t.line<=e.line&&n.line>=e.line?r?(t.line<e.line||t.ch<=e.ch)&&(n.line>e.line||n.ch>=e.ch):(t.line<e.line||t.ch<=e.ch)&&(n.line>e.line||n.ch>e.ch):!1},s.prototype.hasSelection=function(){return this._codeMirror.somethingSelected()},s.prototype.getSelection=function(){return l(this.getCursorPos(!1,"anchor"),this.getCursorPos(!1,"head"))},s.prototype.getSelections=function(){var e=this.getSelection();return I.map(this._codeMirror.listSelections(),function(t){var n=l(t.anchor,t.head);return n.primary=n.start.line===e.start.line&&n.start.ch===e.start.ch&&n.end.line===e.end.line&&n.end.ch===e.end.ch?!0:!1,n})},s.prototype.convertToLineSelections=function(e,t){var n=this;t=t||{},I.defaults(t,{expandEndAtStartOfLine:!1,mergeAdjacent:!0});var r,i=[];return I.each(e,function(e){var o=I.cloneDeep(e);o.start.ch=0;var a=o.start.line!==o.end.line||o.start.ch!==o.end.ch;(t.expandEndAtStartOfLine||!a||0!==o.end.ch)&&(o.end={line:o.end.line+1,ch:0}),r&&n.posWithinRange(o.start,r.selectionForEdit.start,r.selectionForEdit.end,t.mergeAdjacent)?(r.selectionForEdit.end.line=o.end.line,r.selectionsToTrack.push(e)):(r={selectionForEdit:o,selectionsToTrack:[e]},i.push(r))}),i},s.prototype.getSelectedText=function(e){if(e)return this._codeMirror.getSelection();var t=this.getSelection();return this.document.getRange(t.start,t.end)},s.prototype.setSelection=function(e,t,n,r,i){this.setSelections([{start:e,end:t||e}],n,r,i)},s.prototype.setSelections=function(e,t,n,r){var i,o=e.length-1;r&&(i={origin:r}),this._codeMirror.setSelections(I.map(e,function(e,t){return e.primary&&(o=t),{anchor:e.reversed?e.end:e.start,head:e.reversed?e.start:e.end}}),o,i),t&&this.centerOnCursor(n)},s.prototype.toggleOverwrite=function(e){this._codeMirror.toggleOverwrite(e)},s.prototype.selectWordAt=function(e){function t(e){return/\w/.test(e)||e.toUpperCase()!==e.toLowerCase()}for(var n=this.document.getLine(e.line),r=e.ch,i=e.ch;r>0&&t(n.charAt(r-1));)--r;for(;i<n.length&&t(n.charAt(i));)++i;this.setSelection({line:e.line,ch:r},{line:e.line,ch:i})},s.prototype.lineCount=function(){return this._codeMirror.lineCount()},s.prototype.isLineVisible=function(e){var t=this._codeMirror.charCoords({line:e,ch:0},"local"),n=this._codeMirror.getScrollInfo(),r=n.top,i=n.top+n.clientHeight;return t.top>=r&&t.bottom<=i},s.prototype.getFirstVisibleLine=function(){return this._visibleRange?this._visibleRange.startLine:0},s.prototype.getLastVisibleLine=function(){return this._visibleRange?this._visibleRange.endLine:this.lineCount()-1},s.prototype._hideLines=function(e,t){if(!(e>=t)){var n=this._codeMirror.markText({line:e,ch:0},{line:t-1,ch:this._codeMirror.getLine(t-1).length},{collapsed:!0,inclusiveLeft:!0,inclusiveRight:!0,clearWhenEmpty:!1});return n}},s.prototype.totalHeight=function(){return this.getScrollerElement().scrollHeight},s.prototype.getScrollerElement=function(){return this._codeMirror.getScrollerElement()},s.prototype.getRootElement=function(){return this._codeMirror.getWrapperElement()},s.prototype._getLineSpaceElement=function(){return $(".CodeMirror-lines",this.getScrollerElement()).children().get(0)},s.prototype.getScrollPos=function(){var e=this._codeMirror.getScrollInfo();return{x:e.left,y:e.top}},s.prototype.adjustScrollPos=function(e,t){this._codeMirror.scrollTo(e.x,e.y+t)},s.prototype.setScrollPos=function(e,t){this._codeMirror.scrollTo(e,t)},s.prototype.getTextHeight=function(){return this._codeMirror.defaultTextHeight()},s.prototype.addInlineWidget=function(e,t,n){var r=this,i=this._inlineWidgetQueues[e.line],o=new $.Deferred;return i||(i=new d.PromiseQueue,this._inlineWidgetQueues[e.line]=i),i.add(function(){return r._addInlineWidgetInternal(e,t,n,o),o.promise()}),o.promise()},s.prototype._addInlineWidgetInternal=function(e,t,n,r){var i=this;this.removeAllInlineWidgetsForLine(e.line).done(function(){void 0===n&&(n=!0),n&&i._codeMirror.scrollIntoView(e),t.info=i._codeMirror.addLineWidget(e.line,t.htmlContent,{coverGutter:!0,noHScroll:!0}),p.on(t.info.line,"delete",function(){i._removeInlineWidgetInternal(t)}),i._inlineWidgets.push(t),t.$htmlContent.height(0),u.animateUsingClass(t.htmlContent,"animating").done(function(){r.resolve()}),t.onAdded()})},s.prototype.removeAllInlineWidgets=function(){var e=[].concat(this.getInlineWidgets());return d.doInParallel(e,this.removeInlineWidget.bind(this))},s.prototype.removeInlineWidget=function(e){function t(){r._codeMirror.removeLineWidget(e.info),r._removeInlineWidgetInternal(e),n.resolve()}var n=new $.Deferred,r=this;return e.closePromise||(r._removeInlineWidgetFromList(e),r.isFullyVisible()?(u.animateUsingClass(e.htmlContent,"animating").done(t),e.$htmlContent.height(0)):t(),e.closePromise=n.promise()),e.closePromise},s.prototype.removeAllInlineWidgetsForLine=function(e){var t=this._codeMirror.lineInfo(e),n=t&&t.widgets?[].concat(t.widgets):null,r=this;if(n&&n.length){var i,o=this._inlineWidgets.map(function(e){return e.info});return d.doInParallel(n,function(e){return i=r._inlineWidgets[o.indexOf(e)],i?r.removeInlineWidget(i):(new $.Deferred).resolve().promise()})}return(new $.Deferred).resolve().promise()},s.prototype._removeInlineWidgetFromList=function(e){var t,n=this._inlineWidgets.length;for(t=0;n>t;t++)if(this._inlineWidgets[t]===e){this._inlineWidgets.splice(t,1);break}},s.prototype._removeInlineWidgetInternal=function(e){e.isClosed||(this._removeInlineWidgetFromList(e),e.onClosed(),e.isClosed=!0)},s.prototype.getInlineWidgets=function(){return this._inlineWidgets},s.prototype.getFocusedInlineWidget=function(){var e=null;return this.getInlineWidgets().forEach(function(t){t.hasFocus()&&(e=t)}),e},s.prototype.displayErrorMessageAtCursor=function(e){function t(){m.off(".msgbox")}function n(){m._$messagePopover&&m._$messagePopover.length>0&&(m._$messagePopover=null),t()}function r(){m._$messagePopover&&v.removePopUp(m._$messagePopover)}function i(){m.on("blur.msgbox",r).on("change.msgbox",r).on("cursorActivity.msgbox",r).on("update.msgbox",r)}var o,a,s,l,c,d,p,h,f,m=this,g=10,y=10,_=y+3;this._$messagePopover&&r(),a=this.getCursorPos(),this._codeMirror.scrollIntoView(a),s=this._codeMirror.charCoords(a),o=s.top>100,this._$messagePopover=$("<div/>").addClass("popover-message").appendTo($("body")),o||$("<div/>").addClass("arrowAbove").appendTo(this._$messagePopover),$("<div/>").addClass("text").appendTo(this._$messagePopover).html(e),o&&$("<div/>").addClass("arrowBelow").appendTo(this._$messagePopover),c=o?s.top-this._$messagePopover.height()-g:s.bottom+g,d=s.left-this._$messagePopover.width()/2,l={top:c,left:d,height:this._$messagePopover.height(),width:this._$messagePopover.width()},p=S.getElementClipSize($("#editor-holder"),l),p.left>0?d+=p.left:p.right>0&&(d-=p.right),this._$messagePopover.css({top:c,left:d}),h=s.left-d,h=Math.min(l.width-_,Math.max(h,_)),f=h-y,o?this._$messagePopover.find(".arrowBelow").css({"margin-left":f}):this._$messagePopover.find(".arrowAbove").css({"margin-left":f}),v.addPopUp(this._$messagePopover,n,!0),i(),u.animateUsingClass(this._$messagePopover[0],"animateOpen").done(function(){m._$messagePopover&&m._$messagePopover.length>0&&(m._$messagePopover.addClass("open"),m.on("scroll.msgbox",r),u.animateUsingClass(m._$messagePopover[0],"animateClose",6e3).done(r))})},s.prototype.getVirtualScrollAreaTop=function(){var e=this._getLineSpaceElement().offsetTop,t=this.getScrollerElement();return $(t).offset().top-t.scrollTop+e},s.prototype.setInlineWidgetHeight=function(e,t,n){function r(){c&&e.info.changed()}function i(){function e(t){t.target===a&&(r(),$(a).off("webkitTransitionEnd",e))}$(a).height(t),$(a).hasClass("animating")?$(a).on("webkitTransitionEnd",e):r()}var o=this,a=e.htmlContent,s=a&&$(a).height()||0,l=s!==t,c=void 0!==e.info;if((l||!a.style.height)&&($(a).hasClass("animating")?window.setTimeout(i,0):i()),n&&c){var u=$(a).offset(),d=$(a).position(),p=o.getVirtualScrollAreaTop();o._codeMirror.scrollIntoView({left:d.left,top:u.top-p,right:d.left,bottom:u.top+t-p})}},s.prototype._getInlineWidgetLineNumber=function(e){return this._codeMirror.getLineNumber(e.info.line)},s.prototype.focus=function(){if(!z){z=!0;try{this._codeMirror.focus()}finally{z=!1}}},s.prototype.hasFocus=function(){return this._focused},s.prototype.getViewState=function(){return{selections:this.getSelections(),scrollPos:this.getScrollPos()}},s.prototype.restoreViewState=function(e){e.selection&&this.setSelection(e.selection.start,e.selection.end),e.selections&&this.setSelections(e.selections),e.scrollPos&&this.setScrollPos(e.scrollPos.x,e.scrollPos.y)},s.prototype.refresh=function(){var e=window.document.activeElement,t=$.contains(this._codeMirror.getScrollerElement(),e);this._codeMirror.refresh(),t&&e.focus()},s.prototype.refreshAll=function(e){this.refresh(e),this.getInlineWidgets().forEach(function(e){e.refresh()})},s.prototype.undo=function(){this._codeMirror.undo()},s.prototype.redo=function(){this._codeMirror.redo()},s.prototype.notifyVisibilityChange=function(e,t){e&&(t||void 0===t)&&this.refresh(),e&&this._inlineWidgets.forEach(function(e){e.onParentShown()})},s.prototype.setVisible=function(e,t){this.$el.css("display",e?"":"none"),this.notifyVisibilityChange(e,t)},s.prototype.isFullyVisible=function(){return $(this.getRootElement()).is(":visible")},s.prototype.getModeForRange=function(e,t,n){var r=this._codeMirror.getMode(),i=E.getModeAt(this._codeMirror,e),o=E.getModeAt(this._codeMirror,t);return n||r.name!==i.name?i&&o&&i.name===o.name?i:null:this._codeMirror.getOption("mode")},s.prototype.getModeForSelection=function(){var e=this,t=this.getSelections(),n=this.getSelection(),r=this._codeMirror.getMode(),i=E.getModeAt(this._codeMirror,n.start),o=r.name!==i.name;if(o){if(n.start.line!==n.end.line||n.start.ch!==n.end.ch){var a=E.getModeAt(this._codeMirror,n.end);if(i.name!==a.name)return null}var s=I.some(t,function(r){if(t===n)return!1;var o=e.getModeForRange(r.start,r.end,!0);return!o||o.name!==i.name});return s?null:i.name}return this._codeMirror.getOption("mode")},s.prototype.getLanguageForSelection=function(){return this.document.getLanguage().getLanguageForMode(this.getModeForSelection())},s.prototype.getModeForDocument=function(){return this._codeMirror.getOption("mode")},s.prototype.document=null,s.prototype._lastEditorWidth=null,s.prototype._duringSync=!1,s.prototype._codeMirror=null,s.prototype._inlineWidgets=null,s.prototype._visibleRange=null,s.prototype._inlineWidgetQueues=null,s.prototype._hideMarks=null,s.prototype._getOption=function(e){return y.get(e,y._buildContext(this.document.file.fullPath,this.document.getLanguage().getId()))},s.prototype._updateOption=function(e){var t=this._currentOptions[e],n=this._getOption(e);if(t!==n){if(this._currentOptions[e]=n,e===F)this._codeMirror.setOption(j[e],n),this._codeMirror.setOption("indentUnit",n===!0?this._currentOptions[P]:this._currentOptions[x]);else if(e===A)this._updateStyleActiveLine();else{if(e===O&&this._visibleRange)return;e===L?(s._toggleLinePadding(!n),this._codeMirror.setOption(j[L],n),this.refreshAll()):this._codeMirror.setOption(j[e],n)}this.trigger("optionChange",e,n)}},s.prototype._updateStyleActiveLine=function(){this.hasSelection()?this._codeMirror.getOption("styleActiveLine")&&this._codeMirror.setOption("styleActiveLine",!1):this._codeMirror.setOption("styleActiveLine",this._currentOptions[A])},s.prototype.updateLayout=function(e){var t=this.getRootElement(),n=$(t).width(),r=this.$el.parent(),i=r.height();t.style.height&&$(t).height()===i?n!==this._lastEditorWidth&&void 0===e&&(e=!0):(this.setSize(null,i),void 0===e&&(e=!0)),this._lastEditorWidth=n,e&&this.refreshAll(e)},s.setUseTabChar=function(e,t){var n=t&&{context:t};return y.set(F,e,n)},s.getUseTabChar=function(e){return y.get(F,a(e))},s.setTabSize=function(e,t){var n=t&&{context:t};return y.set(P,e,n)},s.getTabSize=function(e){return y.get(P,a(e))},s.setSpaceUnits=function(e,t){var n=t&&{context:t};return y.set(x,e,n)},s.getSpaceUnits=function(e){return y.get(x,a(e))},s.setCloseBrackets=function(e,t){var n=t&&{context:t};return y.set(w,e,n)},s.getCloseBrackets=function(e){return y.get(w,a(e))},s.setShowLineNumbers=function(e,t){var n=t&&{context:t};return y.set(L,e,n)},s.getShowLineNumbers=function(e){return y.get(L,a(e))},s.setShowActiveLine=function(e){return y.set(A,e)},s.getShowActiveLine=function(e){return y.get(A,a(e))},s.setWordWrap=function(e,t){var n=t&&{context:t};return y.set(U,e,n)},s.getWordWrap=function(e){return y.get(U,a(e))},s._toggleLinePadding=function(e){var t=[];Q.forEach(function(e){var n=e.$el.parent();-1===t.indexOf(n)&&t.push(n)}),I.each(t,function(t){t.toggleClass("show-line-padding",Boolean(e))})},q.forEach(function(e){y.on("change",e,function(){Q.forEach(function(t){t._updateOption(e)})})}),c(),t.Editor=s,t.BOUNDARY_CHECK_NORMAL=Y,t.BOUNDARY_IGNORE_TOP=X}),define("editor/InlineWidget",["require","exports","module","editor/EditorManager","utils/EventDispatcher","utils/KeyEvent"],function(e,t){"use strict";function n(){var e=this;this.htmlContent=window.document.createElement("div"),this.$htmlContent=$(this.htmlContent).addClass("inline-widget").attr("tabindex","-1"),this.$htmlContent.append("<div class='shadow top' />").append("<div class='shadow bottom' />").append("<a href='#' class='close no-focus'>&times;</a>"),this.$closeBtn=this.$htmlContent.find(".close"),this.$closeBtn.click(function(t){e.close(),t.stopImmediatePropagation()}),this.$htmlContent.on("keydown",function(t){t.keyCode===o.DOM_VK_ESCAPE&&(e.close(),t.stopImmediatePropagation())})}var r=e("editor/EditorManager"),i=e("utils/EventDispatcher"),o=e("utils/KeyEvent");n.prototype.htmlContent=null,n.prototype.$htmlContent=null,n.prototype.id=null,n.prototype.hostEditor=null,i.makeEventDispatcher(n.prototype),n.prototype.height=0,n.prototype.close=function(){return r.closeInlineWidget(this.hostEditor,this)},n.prototype.hasFocus=function(){var e=window.document.activeElement,t=this.$htmlContent[0];return $.contains(t,e)||t===e},n.prototype.onClosed=function(){this.trigger("close")},n.prototype.onAdded=function(){this.trigger("add")},n.prototype.load=function(e){this.hostEditor=e},n.prototype.onParentShown=function(){},n.prototype.refresh=function(){},t.InlineWidget=n}),define("editor/InlineTextEditor",["require","exports","module","thirdparty/CodeMirror2/lib/codemirror","utils/EventDispatcher","document/DocumentManager","editor/EditorManager","command/CommandManager","command/Commands","editor/InlineWidget","utils/KeyEvent"],function(e,t){"use strict";function n(e,t){e.css("width",t?16:0)}function r(e,t){var r,i=$(".inline-text-editor .dirty-indicator");i.each(function(){r=$(this),r.data("fullPath")===t.file.fullPath&&n(r,t.isDirty)})}function i(){p.call(this),this.editor=null,this.handleKeyDown=this.handleKeyDown.bind(this),this.htmlContent.addEventListener("keydown",this.handleKeyDown,!0)}function o(e){var t=c.getInlineEditors(e);t.push(e);var n=0;return t.forEach(function(e){var t=$(e._codeMirror.getGutterElement()).find(".CodeMirror-linenumbers");t.css("min-width","");var r=t.width();r>n&&(n=r)}),1===t.length?void t[0]._codeMirror.setOption("gutters",t[0]._codeMirror.getOption("gutters")):(n+="px",void t.forEach(function(e){$(e._codeMirror.getGutterElement()).find(".CodeMirror-linenumbers").css("min-width",n),e._codeMirror.setOption("gutters",e._codeMirror.getOption("gutters"))}))}var a=e("thirdparty/CodeMirror2/lib/codemirror"),s=e("utils/EventDispatcher"),l=e("document/DocumentManager"),c=e("editor/EditorManager"),u=e("command/CommandManager"),d=e("command/Commands"),p=e("editor/InlineWidget").InlineWidget,h=e("utils/KeyEvent");i.prototype=Object.create(p.prototype),i.prototype.constructor=i,i.prototype.parentClass=p.prototype,i.prototype.$wrapper=null,i.prototype.editor=null,i.prototype.$editorHolder=null,i.prototype.$header=null,i.prototype.$filename=null,i.prototype.onClosed=function(){i.prototype.parentClass.onClosed.apply(this,arguments),o(this.hostEditor),this.setInlineContent(null),this.htmlContent.removeEventListener("keydown",this.handleKeyDown,!0)},i.prototype.sizeInlineWidgetToContents=function(){},i.prototype.onAdded=function(){var e=this;i.prototype.parentClass.onAdded.apply(this,arguments),this.editor&&this.editor.refresh(),a.on(this.info,"redraw",function(){window.setTimeout(function(){e.editor&&e.editor.refresh()},0)}),o(this.hostEditor),this.editor&&this.editor.focus()},i.prototype.getFocusedEditor=function(){return this.editor&&this.editor.hasFocus()?this.editor:null},i.prototype.handleKeyDown=function(e){e.keyCode===h.DOM_VK_ESCAPE&&this.editor&&this.editor.getSelections().length>1&&(a.commands.singleSelection(this.editor._codeMirror),e.stopImmediatePropagation())},i.prototype.setInlineContent=function(e,t,r){var i=this;if(this.editor&&(this.editor.off(".InlineTextEditor"),this.editor.destroy(),this.editor=null,this.$filename.off(".InlineTextEditor").removeAttr("title"),this.$filename.html("")),e){var o={startLine:t,endLine:r},a=$("<div/>").addClass("dirty-indicator").html("&bull;").width(0);a.data("fullPath",e.file.fullPath),this.$lineNumber=$("<span class='line-number'/>"),this.$filename.append(a).append(e.file.name+" : ").append(this.$lineNumber).attr("title",e.file.fullPath),this.$filename.on("click.InlineTextEditor",function(){u.execute(d.FILE_OPEN,{fullPath:e.file.fullPath}).done(function(){c.getCurrentFullEditor().setCursorPos(t,0,!0)})});var s=c.createInlineEditorForDocument(e,o,this.$editorHolder.get(0));this.editor=s.editor,this._updateLineRange(s.editor),this.editor.on("update.InlineTextEditor",function(){i.sizeInlineWidgetToContents()}),this.editor.on("change.InlineTextEditor",function(e,t){i.hostEditor.isFullyVisible()&&(i.sizeInlineWidgetToContents(),i._updateLineRange(t))}),this.editor.on("lostContent.InlineTextEditor",function(){i._onLostContent.apply(i,arguments)}),n(a,e.isDirty)}},i.prototype._updateLineRange=function(e){this._startLine=e.getFirstVisibleLine(),this._endLine=e.getLastVisibleLine(),this._lineCount=this._endLine-this._startLine,this.$lineNumber.text(this._startLine+1)},i.prototype.load=function(){i.prototype.parentClass.load.apply(this,arguments),this.$wrapper=$("<div/>").addClass("inline-text-editor").appendTo(this.$htmlContent),this.$header=$("<div/>").addClass("inline-editor-header").appendTo(this.$wrapper),this.$filename=$("<a/>").addClass("filename").appendTo(this.$header),this.$editorHolder=$("<div/>").addClass("inline-editor-holder").appendTo(this.$wrapper)},i.prototype.onParentShown=function(){i.prototype.parentClass.onParentShown.apply(this,arguments),this.editor&&(this._updateLineRange(this.editor),this.editor.refresh()),this.sizeInlineWidgetToContents()},i.prototype._onLostContent=function(){this.close()},s.on_duringInit(l,"dirtyFlagChange",r),t.InlineTextEditor=i}),define("editor/EditorManager",["require","exports","module","command/Commands","utils/EventDispatcher","view/WorkspaceManager","preferences/PreferencesManager","command/CommandManager","document/DocumentManager","view/MainViewManager","view/ViewStateManager","utils/PerfUtils","editor/Editor","editor/InlineTextEditor","strings","language/LanguageManager","utils/DeprecationWarning"],function(e,t){"use strict";function n(){var e=V.getCurrentlyViewedPath(V.ACTIVE_PANE),t=e&&j.getOpenDocumentForPath(e);return t&&t._masterEditor}function r(e){B.updateViewState(e)}function i(e){var t=B.getViewState(e.document.file);t&&e.restoreViewState(t)}function o(e){if(Y!==e){var n=Y;Y=e,t.trigger("activeEditorChange",e,n)}}function a(e,t){var n=t&&j.getOpenDocumentForPath(t.fullPath);o(n&&n._masterEditor)}function s(e,t,n,i){var a=new W(e,t,n,i);return a.on("focus",function(){o(a)}),a.on("beforeDestroy",function(){a.$el.is(":visible")&&r(a)}),a}function l(e,t,n){H.markStart(H.INLINE_WIDGET_OPEN);var r,i,o,a,s=e.getCursorPos(),l=new $.Deferred;for(i=0;i<t.length&&!r;i++){var c=t[i].provider;a=c(e,s),a&&(a.hasOwnProperty("done")?r=a:o||"string"!=typeof a||(o=a))}return o=o||n,r?r.done(function(t){e.addInlineWidget(s,t).done(function(){H.addMeasurement(H.INLINE_WIDGET_OPEN),l.resolve()})}).fail(function(){H.finalizeMeasurement(H.INLINE_WIDGET_OPEN),e.displayErrorMessageAtCursor(o),l.reject()}):(H.finalizeMeasurement(H.INLINE_WIDGET_OPEN),e.displayErrorMessageAtCursor(o),l.reject()),l.promise()}function c(e,t){var r=new $.Deferred,i=n();if(i){var o=i.getFocusedInlineWidget();o?(H.markStart(H.INLINE_WIDGET_CLOSE),o.close().done(function(){H.addMeasurement(H.INLINE_WIDGET_CLOSE),r.resolve(!1)})):l(i,e,t).done(function(){r.resolve(!0)}).fail(function(){r.reject()})}else r.reject();return r.promise()}function u(e,t,n){var r,i={priority:n,provider:t};for(r=0;r<e.length&&!(e[r].priority<n);r++);e.splice(r,0,i)}function d(e){x||(x=$("#hidden-editors"));var t=s(e,!0,x);t.setVisible(!1)}function p(e,t){if(t.hasFocus()){var n=e._codeMirror.getLineNumber(t.info.line),r=e.getCursorPos().line;r!==n&&e.setCursorPos({line:n,pos:0}),e.focus()}return e.removeInlineWidget(t)}function h(e,t){void 0===t&&(t=0),u(X,e,t)}function f(e,t){void 0===t&&(t=0),u(Q,e,t)}function m(e){J.push(e)}function g(e){var t=[];return e&&e.getInlineWidgets().forEach(function(e){e instanceof G&&e.editor&&t.push(e.editor)}),t}function v(e,n){var r=s(e,!0,n.$content);return r.setVisible(!1),n.addView(r),t.trigger("_fullEditorCreatedForDocument",e,r,n.id),r}function y(e,t,n){$(n).hide();var r=s(e,!1,n,t);return $(n).show(),{content:n,editor:r}}function _(){z.deprecationWarning("Use MainViewManager.focusActivePane() instead of EditorManager.focusEditor().",!0),V.focusActivePane()}function E(){z.deprecationWarning("Use WorkspaceManager.recomputeLayout() instead of EditorManager.resizeEditor().",!0),k.recomputeLayout()}function b(e,t){var n=!1,r=e._masterEditor;r?r.$el.parent()[0]!==t.$content[0]&&t.addView(r):(window.getSelection&&window.getSelection().empty&&window.getSelection().empty(),r=v(e,t),n=!0),t.showView(r),V.getActivePaneId()===t.id&&r.focus(),n&&i(r)}function S(){z.deprecationWarning("Use MainViewManager.getCurrentlyViewedFile() instead of EditorManager.getCurrentlyViewedPath().",!0);var e,t=V.getCurrentlyViewedPath(V.ACTIVE_PANE);return t&&(e=j.getOpenDocumentForPath(t)),e?t:null}function I(){throw new Error("EditorManager.setEditorHolder() has been removed.")}function w(){throw new Error("EditorManager.registerCustomViewer() has been removed.")}function C(e){return!q.getLanguageForPath(e).isBinary()}function D(e,t){var n=H.markStart("EditorManager.openDocument():	"+(!e||e.file.fullPath));e&&t&&b(e,t),H.addMeasurement(n)}function T(){var e=n();return e?e.getFocusedInlineWidget():null}function O(){var e=T();return e instanceof G?e.getFocusedEditor():null}function M(){var e=n();if(e){var t=O();if(t)return t;if(e.hasFocus())return e}return null}function L(){return Y}function R(){var e,t,n=J,r=new $.Deferred,i=L();if(i){var o=i.getCursorPos();for(H.markStart(H.JUMP_TO_DEFINITION),t=0;t<n.length&&!e;t++){var a=n[t];e=a(i,o)}e?e.done(function(){H.addMeasurement(H.JUMP_TO_DEFINITION),r.resolve()}).fail(function(){H.finalizeMeasurement(H.JUMP_TO_DEFINITION),r.reject()}):(H.finalizeMeasurement(H.JUMP_TO_DEFINITION),r.reject())}else r.reject();return r.promise()}function N(e,t){var n=function(e){var t=j.getOpenDocumentForPath(e.fullPath);t&&V._destroyEditorIfNotNeeded(t)};$.isArray(t)?t.forEach(function(e){n(e)}):n(t)}var x,A=e("command/Commands"),P=e("utils/EventDispatcher"),k=e("view/WorkspaceManager"),F=e("preferences/PreferencesManager"),U=e("command/CommandManager"),j=e("document/DocumentManager"),V=e("view/MainViewManager"),B=e("view/ViewStateManager"),H=e("utils/PerfUtils"),W=e("editor/Editor").Editor,G=e("editor/InlineTextEditor").InlineTextEditor,K=e("strings"),q=e("language/LanguageManager"),z=e("utils/DeprecationWarning"),Y=null,X=[],Q=[],J=[];P.makeEventDispatcher(t),t.on("activeEditorChange",function(e,t){t&&t.document&&t.document.file&&F._setCurrentFile(t.document.file.fullPath)}),U.register(K.CMD_TOGGLE_QUICK_EDIT,A.TOGGLE_QUICK_EDIT,function(){return c(X,K.ERROR_QUICK_EDIT_PROVIDER_NOT_FOUND)}),U.register(K.CMD_TOGGLE_QUICK_DOCS,A.TOGGLE_QUICK_DOCS,function(){return c(Q,K.ERROR_QUICK_DOCS_PROVIDER_NOT_FOUND)}),U.register(K.CMD_JUMPTO_DEFINITION,A.NAVIGATE_JUMPTO_DEFINITION,R),H.createPerfMeasurement("JUMP_TO_DEFINITION","Jump-To-Definiiton"),V.on("currentFileChange",a),V.on("workingSetRemove workingSetRemoveList",N),t._createFullEditorForDocument=v,t._notifyActiveEditorChanged=o,t._saveEditorViewState=r,t._createUnattachedMasterEditor=d,t.createInlineEditorForDocument=y,t.getFocusedInlineWidget=T,t.getInlineEditors=g,t.closeInlineWidget=p,t.openDocument=D,t.canOpenPath=C,t.getActiveEditor=L,t.getCurrentFullEditor=n,t.getFocusedEditor=M,t.registerInlineEditProvider=h,t.registerInlineDocsProvider=f,t.registerJumpToDefProvider=m,t.registerCustomViewer=w,t.resizeEditor=E,t.focusEditor=_,t.getCurrentlyViewedPath=S,t.setEditorHolder=I}),define("document/Document",["require","exports","module","editor/EditorManager","utils/EventDispatcher","file/FileUtils","document/InMemoryFile","utils/PerfUtils","language/LanguageManager","thirdparty/CodeMirror2/lib/codemirror","thirdparty/lodash"],function(e,t){"use strict";function n(e,t,n){this.file=e,this._updateLanguage(),this.refreshText(n,t,!0)}function r(e,t){Array.isArray(e)?d.each(e,t):t(e,0)}var i=e("editor/EditorManager"),o=e("utils/EventDispatcher"),a=e("file/FileUtils"),s=e("document/InMemoryFile"),l=e("utils/PerfUtils"),c=e("language/LanguageManager"),u=e("thirdparty/CodeMirror2/lib/codemirror"),d=e("thirdparty/lodash");o.makeEventDispatcher(n.prototype),n.prototype._refCount=0,n.prototype.file=null,n.prototype.language=null,n.prototype.isDirty=!1,n.prototype.isSaving=!1,n.prototype.diskTimestamp=null,n.prototype.keepChangesTime=null,n.prototype._refreshInProgress=!1,n.prototype._text=null,n.prototype._masterEditor=null,n.prototype._lineEndings=null,n.prototype.addRef=function(){0===this._refCount&&t.trigger("_afterDocumentCreate",this)||this._refCount++},n.prototype.releaseRef=function(){return this._refCount--,this._refCount<0?void console.error("Document ref count has fallen below zero!"):void(0===this._refCount&&t.trigger("_beforeDocumentDelete",this))},n.prototype._makeEditable=function(e){this._masterEditor?console.error("Document is already editable"):(this._text=null,this._masterEditor=e,e.on("change",this._handleEditorChange.bind(this)))},n.prototype._makeNonEditable=function(){this._masterEditor?(this._text=this.getText(!0),this._masterEditor=null):console.error("Document is already non-editable")},n.prototype._ensureMasterEditor=function(){this._masterEditor||i._createUnattachedMasterEditor(this)},n.prototype.getText=function(e){if(this._masterEditor){var t=this._masterEditor._codeMirror.getValue();return e&&this._lineEndings===a.LINE_ENDINGS_CRLF?t.replace(/\n/g,"\r\n"):t}return e?this._text:n.normalizeText(this._text)},n.normalizeText=function(e){return e.replace(/\r\n/g,"\n")
},n.prototype.setText=function(e){this._ensureMasterEditor(),this._masterEditor._codeMirror.setValue(e)},n.prototype._notifyDocumentChange=function(e){this.trigger("change",this,e),t.trigger("documentChange",this,e)},n.prototype.refreshText=function(e,n,r){var i=l.markStart("refreshText:	"+(!this.file||this.file.fullPath));this._refreshInProgress=!0,this._masterEditor?this._masterEditor._resetText(e):(this._text=e,r||this._notifyDocumentChange([{text:e.split(/\r?\n/)}])),this._updateTimestamp(n),this.isDirty&&this._markClean(),this._refreshInProgress=!1,this._lineEndings=a.sniffLineEndings(e),this._lineEndings||(this._lineEndings=a.getPlatformLineEndings()),t.trigger("_documentRefreshed",this),l.addMeasurement(i)},n.prototype.replaceRange=function(e,t,n,r){this._ensureMasterEditor(),this._masterEditor._codeMirror.replaceRange(e,t,n,r)},n.prototype.getRange=function(e,t){return this._ensureMasterEditor(),this._masterEditor._codeMirror.getRange(e,t)},n.prototype.getLine=function(e){return this._ensureMasterEditor(),this._masterEditor._codeMirror.getLine(e)},n.prototype.batchOperation=function(e){this._ensureMasterEditor();var t=this;t._masterEditor._codeMirror.operation(e)},n.prototype._handleEditorChange=function(e,n,r){if(!this._refreshInProgress){var i=this.isDirty;this.isDirty=!n._codeMirror.isClean(),i!==this.isDirty&&t.trigger("_dirtyFlagChange",this)}this._notifyDocumentChange(r)},n.prototype._markClean=function(){this.isDirty=!1,this._masterEditor&&this._masterEditor._codeMirror.markClean(),t.trigger("_dirtyFlagChange",this)},n.prototype._updateTimestamp=function(e){this.diskTimestamp=e,this.keepChangesTime=null},n.prototype.notifySaved=function(){this._masterEditor||console.log("### Warning: saving a Document that is not modifiable!"),this._markClean();var e=this;this.file.stat(function(n,r){n?console.log("Error updating timestamp after saving file: "+e.file.fullPath):e._updateTimestamp(r.mtime),t.trigger("_documentSaved",e)})},n.prototype.adjustPosForChange=function(e,t,n,r){var i={text:t,from:n,to:r};if(u.cmpPos(e,n)<0)return e;if(u.cmpPos(e,r)<=0)return u.changeEnd(i);var o=e.line+i.text.length-(i.to.line-i.from.line)-1,a=e.ch;return e.line===i.to.line&&(a+=u.changeEnd(i).ch-i.to.ch),{line:o,ch:a}},n.prototype.doMultipleEdits=function(e,t){var n=this;e.sort(function(e,t){var n=Array.isArray(e.edit)?e.edit[0]:e.edit,r=Array.isArray(t.edit)?t.edit[0]:t.edit;return n?r?u.cmpPos(r.start,n.start):1:-1});var i=d.cloneDeep(d.pluck(e,"selection"));return d.each(e,function(t,n){r(t.edit,function(t){if(t&&(t.end||(t.end=t.start),n>0)){var i=e[n-1].edit;r(i,function(e){if(u.cmpPos(t.end,e.start)>0)throw new Error("Document.doMultipleEdits(): Overlapping edits specified")})}})}),this.batchOperation(function(){d.each(e,function(e,o){r(e.edit,function(e){if(e){n.replaceRange(e.text,e.start,e.end,t);var a=e.text.split("\n");d.each(i,function(t,i){t&&r(t,function(t){(t.isBeforeEdit||i!==o)&&(t.start=n.adjustPosForChange(t.start,a,e.start,e.end),t.end=n.adjustPosForChange(t.end,a,e.start,e.end))})})}})})}),i=d.chain(i).filter(function(e){return void 0!==e}).flatten().sort(function(e,t){return u.cmpPos(e.start,t.start)}).value(),d.each(i,function(e){delete e.isBeforeEdit}),i},n.prototype.toString=function(){var e=this.isDirty?" (dirty!)":" (clean)",t=this._masterEditor?" (Editable)":" (Non-editable)",n=" refs:"+this._refCount;return"[Document "+this.file.fullPath+e+t+n+"]"},n.prototype.getLanguage=function(){return this.language},n.prototype._updateLanguage=function(){var e=this.language;this.language=c.getLanguageForPath(this.file.fullPath),e&&e!==this.language&&this.trigger("languageChanged",e,this.language)},n.prototype._notifyFilePathChanged=function(){this._updateLanguage()},n.prototype.isUntitled=function(){return this.file instanceof s},o.makeEventDispatcher(t),t.Document=n}),define("project/FileSyncManager",["require","exports","module","project/ProjectManager","document/DocumentManager","view/MainViewManager","utils/Async","widgets/Dialogs","widgets/DefaultDialogs","strings","utils/StringUtils","file/FileUtils","filesystem/FileSystemError"],function(e,t){"use strict";function n(e){function t(e){var t=new $.Deferred;return e.isUntitled()?t.resolve():e.file.stat(function(n,r){if(n)n===I.NOT_FOUND?(-1!==e.keepChangesTime&&(e.isDirty?h.push({doc:e,fileTime:-1}):d.push(e)),t.resolve()):(console.log("Error checking modification status of "+e.file.fullPath,n),t.reject());else{var i=r.mtime.getTime();i!==e.diskTimestamp.getTime()&&e.keepChangesTime!==i&&(e.isDirty?p.push({doc:e,fileTime:i}):u.push(e)),t.resolve()}}),t.promise()}return u=[],d=[],p=[],h=[],v.doInParallel(e,t,!0)}function r(){function e(e){var t=new $.Deferred;return e.stat(function(n){n?n===I.NOT_FOUND?(m.notifyFileDeleted(e),t.resolve()):(console.log("Error checking for deletion of "+e.fullPath,n),t.reject()):t.resolve()}),t.promise()}var t=g.getWorkingSet(g.ALL_PANES).filter(function(e){return!m.getOpenDocumentForPath(e.fullPath)});return v.doInParallel(t,e,!1)}function i(e){var t=S.readAsText(e.file);return t.done(function(t,n){e.refreshText(t,n)}),t.fail(function(t){console.log("Error reloading contents of "+e.file.fullPath,t)}),t}function o(){return v.doInParallel(u,i,!1)}function a(e,t){return y.showModalDialog(_.DIALOG_ID_ERROR,E.ERROR_RELOADING_FILE_TITLE,b.format(E.ERROR_RELOADING_FILE,b.breakableUrl(t.file.fullPath),S.getFileErrorString(e)))}function s(){d.forEach(function(e){m.notifyFileDeleted(e.file)})}function l(e){function t(t,n){var r=new $.Deferred,o=r.promise(),s=t.doc,l=t.fileTime;if(C)return r.resolve(),o;var c,u,d,h;return n<p.length?(c=!1,u=_.DIALOG_ID_EXT_CHANGED,d=b.format(E.EXT_MODIFIED_MESSAGE,b.breakableUrl(f.makeProjectRelativeIfPossible(s.file.fullPath))),h=[{className:y.DIALOG_BTN_CLASS_LEFT,id:y.DIALOG_BTN_DONTSAVE,text:E.RELOAD_FROM_DISK},{className:y.DIALOG_BTN_CLASS_PRIMARY,id:y.DIALOG_BTN_CANCEL,text:E.KEEP_CHANGES_IN_EDITOR}]):(c=!0,u=_.DIALOG_ID_EXT_DELETED,d=b.format(E.EXT_DELETED_MESSAGE,b.breakableUrl(f.makeProjectRelativeIfPossible(s.file.fullPath))),h=[{className:y.DIALOG_BTN_CLASS_LEFT,id:y.DIALOG_BTN_DONTSAVE,text:E.CLOSE_DONT_SAVE},{className:y.DIALOG_BTN_CLASS_PRIMARY,id:y.DIALOG_BTN_CANCEL,text:E.KEEP_CHANGES_IN_EDITOR}]),y.showModalDialog(u,e,d,h).done(function(e){e===y.DIALOG_BTN_DONTSAVE?c?(m.notifyFileDeleted(s.file),r.resolve()):i(s).done(function(){r.resolve()}).fail(function(e){a(e,s).done(function(){r.reject()})}):(C||(s.keepChangesTime=l),r.resolve())}),o}var n=p.concat(h);return v.doSequentially(n,t,!1)}function c(e){if(e=e||E.EXT_MODIFIED_TITLE,w)return C=!0,y.cancelModalDialogIfOpen(_.DIALOG_ID_EXT_CHANGED),void y.cancelModalDialogIfOpen(_.DIALOG_ID_EXT_DELETED);w=!0;var t=m.getAllOpenDocuments();n(t).done(function(){r().always(function(){o().always(function(){s(),l(e).always(function(){C?(C=!1,w=!1,c()):(w=!1,(p.length>0||h.length>0)&&g.focusActivePane())})})})}).fail(function(){w=!1})}var u,d,p,h,f=e("project/ProjectManager"),m=e("document/DocumentManager"),g=e("view/MainViewManager"),v=e("utils/Async"),y=e("widgets/Dialogs"),_=e("widgets/DefaultDialogs"),E=e("strings"),b=e("utils/StringUtils"),S=e("file/FileUtils"),I=e("filesystem/FileSystemError"),w=!1,C=!1;t.syncOpenDocuments=c}),define("document/DocumentManager",["require","exports","module","thirdparty/lodash","utils/AppInit","utils/EventDispatcher","document/Document","utils/DeprecationWarning","view/MainViewManager","view/MainViewFactory","project/FileSyncManager","filesystem/FileSystem","preferences/PreferencesManager","file/FileUtils","document/InMemoryFile","command/CommandManager","command/Commands","utils/PerfUtils","language/LanguageManager","strings"],function(e,t,n){"use strict";function r(e){var t;for(t in K)if(K.hasOwnProperty(t)&&K[t].file.fullPath===e)return K[t];return null}function i(){var e=N.getCurrentlyViewedFile(N.ACTIVE_PANE);return e?r(e.fullPath):null}function o(){return R.deprecationWarning("Use MainViewManager.getWorkingSet() instead of DocumentManager.getWorkingSet()",!0),N.getWorkingSet(N.ALL_PANES).filter(function(e){return!x.findSuitableFactoryForPath(e.fullPath)})}function a(e){return R.deprecationWarning("Use MainViewManager.findInWorkingSet() instead of DocumentManager.findInWorkingSet()",!0),N.findInWorkingSet(N.ACTIVE_PANE,e)}function s(){var e,t=[];for(e in K)K.hasOwnProperty(e)&&t.push(K[e]);return t}function l(e,t,n){R.deprecationWarning("Use MainViewManager.addToWorkingSet() instead of DocumentManager.addToWorkingSet()",!0),N.addToWorkingSet(N.ACTIVE_PANE,e,t,n)}function c(e){R.deprecationWarning("Use MainViewManager.addListToWorkingSet() instead of DocumentManager.addListToWorkingSet()",!0),N.addListToWorkingSet(N.ACTIVE_PANE,e)}function u(e){R.deprecationWarning("Use CommandManager.execute(Commands.FILE_CLOSE_LIST, {PaneId: MainViewManager.ALL_PANES, fileList: list}) instead of DocumentManager.removeListFromWorkingSet()",!0),j.execute(V.FILE_CLOSE_LIST,{PaneId:N.ALL_PANES,fileList:e})}function d(){R.deprecationWarning("Use CommandManager.execute(Commands.FILE_CLOSE_ALL,{PaneId: MainViewManager.ALL_PANES}) instead of DocumentManager.closeAll()",!0),j.execute(V.FILE_CLOSE_ALL,{PaneId:N.ALL_PANES})}function p(e){R.deprecationWarning("Use CommandManager.execute(Commands.FILE_CLOSE, {File: file} instead of DocumentManager.closeFullEditor()",!0),j.execute(V.FILE_CLOSE,{File:e})}function h(e){R.deprecationWarning("Use CommandManager.execute(Commands.CMD_OPEN) instead of DocumentManager.setCurrentDocument()",!0),j.execute(V.CMD_OPEN,{fullPath:e.file.fullPath})}function f(){R.deprecationWarning("Use MainViewManager.beginTraversal() instead of DocumentManager.beginDocumentNavigation()",!0),N.beginTraversal()}function m(){R.deprecationWarning("Use MainViewManager.endTraversal() instead of DocumentManager.finalizeDocumentNavigation()",!0),N.endTraversal()}function g(e){R.deprecationWarning("Use MainViewManager.traverseToNextViewByMRU() instead of DocumentManager.getNextPrevFile()",!0);var t=N.traverseToNextViewByMRU(e);return t?t.file:null}function v(){s().forEach(function(e){1===e._refCount&&e._masterEditor&&N._destroyEditorIfNotNeeded(e)})}function y(e){var t=r(e);if(t)return(new $.Deferred).resolve(t).promise();if(0===e.indexOf(G))return console.error("getDocumentForPath called for non-open untitled document: "+e),(new $.Deferred).reject().promise();var n=P.getFileForPath(e),i=y._pendingDocumentPromises[n.id];if(i)return i;var o=new $.Deferred,a=o.promise();y._pendingDocumentPromises[n.id]=a;var s=B.markStart("getDocumentForPath:	"+e);return o.done(function(){B.addMeasurement(s)}).fail(function(){B.finalizeMeasurement(s)}),F.readAsText(n).always(function(){delete y._pendingDocumentPromises[n.id]}).done(function(e,r){t=new L.Document(n,r,e),v(),o.resolve(t)}).fail(function(e){o.reject(e)}),a}function _(e,t){var n=new $.Deferred,i=r(e.fullPath);return i?n.resolve(i.getText(),i.diskTimestamp,t?i._lineEndings:null):e.read(function(e,r,i){if(e)n.reject(e);else{var o=t?F.sniffLineEndings(r):null;r=L.Document.normalizeText(r),n.resolve(r,i.mtime,o)}}),n.promise()}function E(e,t){var n=W.UNTITLED+"-"+e+t,r=G+"/"+n,i=new Date,o=new U(r,P);return new L.Document(o,i,"")}function b(e){t.trigger("pathDeleted",e.fullPath);var n=r(e.fullPath);n&&n.trigger("deleted"),n&&n._refCount>0&&console.warn("Deleted "+e.fullPath+" Document still has "+n._refCount+" references. Did someone addRef() without listening for 'deleted'?")}function S(e){A.syncOpenDocuments(W.FILE_DELETED_TITLE),r(e)||N.findInAllWorkingSets(e).length||t.trigger("pathDeleted",e)}function I(e,n){T.forEach(K,function(e){e._notifyFilePathChanged()}),t.trigger("fileNameChange",e,n)}function w(){T.forEach(K,function(e){e.getLanguage().isFallbackLanguage()&&e._updateLanguage()})}function C(e,t){T.forEach(K,function(e){var n=e.getLanguage();(n===t||n.isFallbackLanguage())&&e._updateLanguage()})}function D(e){var t="files_";if(0===e.indexOf(t)){var n=e.substr(t.length);return"user project.files "+n}return null}var T=e("thirdparty/lodash"),O=e("utils/AppInit"),M=e("utils/EventDispatcher"),L=e("document/Document"),R=e("utils/DeprecationWarning"),N=e("view/MainViewManager"),x=e("view/MainViewFactory"),A=e("project/FileSyncManager"),P=e("filesystem/FileSystem"),k=e("preferences/PreferencesManager"),F=e("file/FileUtils"),U=e("document/InMemoryFile"),j=e("command/CommandManager"),V=e("command/Commands"),B=e("utils/PerfUtils"),H=e("language/LanguageManager"),W=e("strings"),G="/_brackets_"+T.random(1e7,99999999),K={};y._pendingDocumentPromises={},L.on("_afterDocumentCreate",function(e,n){return K[n.file.id]?(console.error("Document for this path already in _openDocuments!"),!0):(K[n.file.id]=n,void t.trigger("afterDocumentCreate",n))}).on("_beforeDocumentDelete",function(e,n){return K[n.file.id]?(t.trigger("beforeDocumentDelete",n),void delete K[n.file.id]):(console.error("Document with references was not in _openDocuments!"),!0)}).on("_documentRefreshed",function(e,n){t.trigger("documentRefreshed",n)}).on("_dirtyFlagChange",function(e,n){t.trigger("dirtyFlagChange",n),n.isDirty&&(N.addToWorkingSet(N.ACTIVE_PANE,n.file),N.getCurrentlyViewedFile()||-1===N.findInWorkingSet(N.ACTIVE_PANE,n.file.fullPath)||j.execute(V.FILE_OPEN,{fullPath:n.file.fullPath}))}).on("_documentSaved",function(e,n){t.trigger("documentSaved",n)}),M.makeEventDispatcher(t),M.markDeprecated(t,"currentDocumentChange","MainViewManager.currentFileChange"),M.markDeprecated(t,"workingSetAdd","MainViewManager.workingSetAdd"),M.markDeprecated(t,"workingSetAddList","MainViewManager.workingSetAddList"),M.markDeprecated(t,"workingSetRemove","MainViewManager.workingSetRemove"),M.markDeprecated(t,"workingSetRemoveList","MainViewManager.workingSetRemoveList"),M.markDeprecated(t,"workingSetSort","MainViewManager.workingSetSort"),O.extensionsLoaded(function(){function e(e){R.deprecateEvent(t,N,e,e,"DocumentManager."+e,"MainViewManager."+e)}e("workingSetAdd"),e("workingSetAddList"),e("workingSetRemove"),e("workingSetRemoveList"),e("workingSetSort")}),k.convertPreferences(n,{files_:"user"},!0,D),t.on("documentSaved",function(e,t){k.fileChanged(t.file.fullPath)}),N.on("currentFileChange",function(e,n,i,o){var a=null,s=null;n&&(a=r(n.fullPath)),o&&(s=r(o.fullPath)),s&&s.off("languageChanged.DocumentManager"),a?(k._setCurrentLanguage(a.getLanguage().getId()),a.on("languageChanged.DocumentManager",function(e,n,r){k._setCurrentLanguage(r.getId()),t.trigger("currentDocumentLanguageChanged",[n,r])})):k._setCurrentLanguage(void 0),a!==s&&t.trigger("currentDocumentChange",a,s)}),t.getWorkingSet=o,t.findInWorkingSet=a,t.addToWorkingSet=l,t.addListToWorkingSet=c,t.removeListFromWorkingSet=u,t.getCurrentDocument=i,t.beginDocumentNavigation=f,t.finalizeDocumentNavigation=m,t.getNextPrevFile=g,t.setCurrentDocument=h,t.closeFullEditor=p,t.closeAll=d,t.Document=L.Document,t.getDocumentForPath=y,t.getOpenDocumentForPath=r,t.getDocumentText=_,t.createUntitledDocument=E,t.getAllOpenDocuments=s,t.notifyPathNameChanged=I,t.notifyPathDeleted=S,t.notifyFileDeleted=b,B.createPerfMeasurement("DOCUMENT_MANAGER_GET_DOCUMENT_FOR_PATH","DocumentManager.getDocumentForPath()"),H.on("languageAdded",w),H.on("languageModified",C)}),define("project/FileViewController",["require","exports","module","document/DocumentManager","utils/EventDispatcher","view/MainViewManager","command/CommandManager","utils/PerfUtils","command/Commands","utils/DeprecationWarning"],function(e,t){"use strict";function n(e){e?u.setActivePaneId(e):u.focusActivePane(),t.trigger("documentSelectionFocusChange")}function r(e){return e!==v&&e!==g?void console.error("Bad parameter passed to FileViewController.setFileViewFocus"):void(y!==e&&(y=e,t.trigger("fileViewFocusChange")))}function i(e,t,r){var i,o=m;if(t!==v&&t!==g)return void console.error("Bad parameter passed to FileViewController.openAndSelectDocument");m=!0,y=t,r=r||u.ACTIVE_PANE;var a=u.getCurrentlyViewedPath(r);return a===e?(n(r),i=(new $.Deferred).resolve().promise()):i=d.execute(h.FILE_OPEN,{fullPath:e,paneId:r}),i.always(function(){m=o}),i}function o(e,t){var r=new $.Deferred,i=d.execute(h.CMD_ADD_TO_WORKINGSET_AND_OPEN,{fullPath:e,paneId:t});return i.done(function(e){y=g,n(t),r.resolve(e)}).fail(function(e){r.reject(e)}),r.promise()}function a(e){f.deprecationWarning("Use FileViewController.openFileAndAddToWorkingSet() instead of FileViewController.addToWorkingSetAndSelect().",!0);var t=new $.Deferred;return o(e).done(function(e){var n;e&&(n=l.getOpenDocumentForPath(e.fullPath)),t.resolve(n)}).fail(function(e){t.reject(e)}),t.promise()}function s(){return y}var l=e("document/DocumentManager"),c=e("utils/EventDispatcher"),u=e("view/MainViewManager"),d=e("command/CommandManager"),p=e("utils/PerfUtils"),h=e("command/Commands"),f=e("utils/DeprecationWarning"),m=!1,g="WorkingSetView",v="ProjectManager",y=v;c.on_duringInit(u,"workingSetAdd",function(){y=g,t.trigger("documentSelectionFocusChange")}),c.on_duringInit(u,"currentFileChange",function(e,n,r){var i;m||(i=p.markStart("FileViewController._oncurrentFileChange():	"+(n?n.fullPath:"(no open file)")),y=n&&-1!==u.findInWorkingSet(r,n.fullPath)?g:v),t.trigger("documentSelectionFocusChange"),m||p.addMeasurement(i)}),c.makeEventDispatcher(t),t.addToWorkingSetAndSelect=a,t.getFileSelectionFocus=s,t.openAndSelectDocument=i,t.openFileAndAddToWorkingSet=o,t.setFileViewFocus=r,t.WORKING_SET_VIEW=g,t.PROJECT_MANAGER=v}),"object"==typeof exports?module.exports=universalModule():"function"==typeof define&&define.amd?define("thirdparty/immutable",universalModule):Immutable=universalModule(),define("project/FileTreeViewModel",["require","exports","module","thirdparty/immutable","thirdparty/lodash","utils/EventDispatcher","file/FileUtils"],function(e,t){"use strict";function n(e){return void 0===e.get("children")}function r(){this._commit=this._commit.bind(this)}function i(e,t){if(null===t)return null;if(""===t)return[];for(var n,r=t.split("/"),i=r.shift(),o=[];i;){if(!e)return null;if(n=e.get(i),void 0===n)return null;o.push(i),i=r.shift(),i&&(e=n.get("children"),e&&o.push("children"))}return o}function o(e,t){if(null===t)return null;if(""===t)return!0;for(var n,r=t.split("/"),i=r.shift(),o=[];i;){if(null===e)return!1;if(n=e.get(i),void 0===n)return null;if(o.push(i),i=r.shift()){if(!n.get("open"))return!1;e=n.get("children"),e&&o.push("children")}}return!0}function a(e,t){function r(e,t,o){e&&e.forEach(function(e,a){if(!n(e)){var s=t+a+"/";if(e.get("open")){var l=i[o];l||(l=i[o]=[]),l.push(s),r(e.get("children"),s,o+1)}}})}var i=[];return r(e,t,0),i}function s(e,t){function r(e){e&&e.forEach(function(e,t){if(!n(e)){var r=t+"/";i.push(r)}})}var i=[];return r(e,t,0),i}function l(e,t,n){return e.updateIn(t,function(){return n})}function c(e,t,n,r){var o;r&&(o=i(e,r));var a=e;if(n&&n!==r){var s=i(e,n);s&&(a=a.updateIn(s,function(e){return e["delete"](t)}))}return r&&o&&0!==o.length&&(a=a.updateIn(o,function(e){return e.set(t,!0)})),a}function u(e,t,r){var o=i(e,t),a=e.getIn(o);if(!o)return{needsLoading:!0,treeData:e};if(!n(a)){var s=a.get("open")===!0;if(!(s&&r||!s&&!r))return e=e.updateIn(o,function(e){return r?e.set("open",!0):e["delete"]("open")}),r&&(null===a.get("children")||a.get("notFullyLoaded"))?{needsLoading:!0,treeData:e}:{needsLoading:!1,treeData:e}}}function d(e){e=e["delete"]("open");var t=e.get("children");return t&&t.keySeq().forEach(function(e){var r=t.get(e);n(r)||(r=d(r),t=t.set(e,r))}),e=e.set("children",t)}function p(e,t){var r=[];return e=e.withMutations(function(e){t.forEach(function(t){r.push(t.name);var i=e.get(t.name);if(i){var o=n(i);o!==t.isFile&&(i=void 0)}i||(t.isFile?e.set(t.name,b.Map()):e.set(t.name,b.Map({children:null})))});var i=e.keySeq().toJS(),o=S.difference(i,r);o.forEach(function(t){e["delete"](t)})})}function h(e){return e?e.merge({notFullyLoaded:!0,children:b.Map()}):b.Map({notFullyLoaded:!0,children:b.Map()})}function f(e,t){var n=[],r={objectPath:n,treeData:e},i=e;if(""===t)return r;for(var o,a=t.split("/"),s=a.shift();s;){if(null===i)return null;o=i.get(s),n.push(s),void 0===o&&(e=e.updateIn(n,h),o=e.getIn(n)),s=a.shift(),s&&(i=o.get("children"),i?n.push("children"):(e=e.updateIn(n,h),n.push("children"),i=e.getIn(n)))}return r.treeData=e,r}function m(e,t){function r(e){return e.set("open",!0)}for(var o=i(e,t);o&&o.length;){var a=e.getIn(o);n(a)?o.pop():(a.get("open")||(e=e.updateIn(o,r)),o.pop(),o.length&&o.pop())}return e}function g(e,t,n,r,o){o=o||{};var a=i(e,t);if(a){var s={};o.notInCreateMode||(s.creating=!0),r&&(s.children=o.notInCreateMode?null:b.Map());var l=b.Map(s);if(o.doNotOpen||(e=m(e,t)),a.length>0){var c=S.clone(a);c.push("children"),e=e.updateIn(c,function(e){return e.set(n,l)})}else e=e.set(n,l);return e}}function v(e,t){var n=i(e,t);if(n){var r=S.last(n);return n.pop(),e=e.updateIn(n,function(e){return e=e["delete"](r)})}}function y(e){return e.set("_timestamp",(new Date).getTime())}function _(e,t){return t.forEach(function(t){var n=i(e,t);n&&(e=e.updateIn(n,y))}),e}function E(e,t){return t.forEach(function(t){var n="/"===S.last(t);t=n?t.substr(0,t.length-1):t;var r=w.getDirectoryPath(t),o=i(e,r),a=w.getBaseName(t);if(o){var s=S.clone(o);if(s.push("children"),null===e.getIn(s))return;e=g(e,r,a,n,{notInCreateMode:!0,doNotOpen:!0})}}),e}var b=e("thirdparty/immutable"),S=e("thirdparty/lodash"),I=e("utils/EventDispatcher"),w=e("file/FileUtils"),C="change";I.makeEventDispatcher(r.prototype),r.prototype.sortDirectoriesFirst=!1,r.prototype._treeData=b.Map(),Object.defineProperty(r.prototype,"treeData",{get:function(){return this._treeData}}),r.prototype._selectionViewInfo=b.Map({width:0,scrollTop:0,scrollLeft:0,offsetTop:0,hasContext:!1,hasSelection:!1}),Object.defineProperty(r.prototype,"selectionViewInfo",{get:function(){return this._selectionViewInfo}}),r.prototype._rootChanged=function(){this._treeData=b.Map()},r.prototype._commit=function(e,t){var n=!1;e&&e!==this._treeData&&(this._treeData=e,n=!0),t&&t!==this._selectionViewInfo&&(this._selectionViewInfo=t,n=!0),n&&this.trigger(C)},r.prototype.isFilePathVisible=function(e){return o(this._treeData,e)},r.prototype.isPathLoaded=function(e){var t=i(this._treeData,e);if(!t)return!1;if("/"===S.last(e)){var n=this._treeData.getIn(t);if(!n.get("children")||n.get("notFullyLoaded"))return!1}return!0},r.prototype.getOpenNodes=function(e){return a(this._treeData,e)},r.prototype.getChildDirectories=function(e){var t=this._treeData,n=i(t,e);if(n){var r;return 0===n.length?r=this._treeData:(n.push("children"),r=this._treeData.getIn(n)),s(r,e)}},r.prototype.moveMarker=function(e,t,n){var r=c(this._treeData,e,t,n),i=this._selectionViewInfo;"selected"===e?i=i.set("hasSelection",!!n):"context"===e&&(i=i.set("hasContext",!!n)),this._commit(r,i)},r.prototype.renameItem=function(e,t){var n=this._treeData,r=i(n,e);if(r){var o=S.last(r),a=n.getIn(r);r.pop(),n=n.updateIn(r,function(e){return e=e["delete"](o),e=e.set(t,a)}),this._commit(n)}},r.prototype.setDirectoryOpen=function(e,t){var n=u(this._treeData,e,t);return n&&n.treeData&&this._commit(n.treeData),n?n.needsLoading:!1},r.prototype._getObject=function(e){var t=i(this._treeData,e);return t?this._treeData.getIn(t):null},r.prototype.closeSubtree=function(e){var t=this._treeData,n=i(t,e);if(n){var r=t.getIn(n);r=d(r),t=l(t,n,r),this._commit(t)}},r.prototype.setDirectoryContents=function(e,t){e=w.stripTrailingSlash(e);var r=f(this._treeData,e),i=r.objectPath,o=r.treeData;if(null!==i){var a=o.getIn(i),s=a;if(""!==e){if(n(a))return;a.get("notFullyLoaded")&&(a=a["delete"]("notFullyLoaded")),a.get("children")||(a=a.set("children",b.Map())),o=l(o,i,a),i.push("children"),s=a.get("children")}s=p(s,t),o=l(o,i,s),this._commit(o)}},r.prototype.openPath=function(e){this._commit(m(this._treeData,e))},r.prototype.createPlaceholder=function(e,t,n){var r=g(this._treeData,e,t,n);this._commit(r)},r.prototype.deleteAtPath=function(e){var t=v(this._treeData,e);t&&this._commit(t)},r.prototype.processChanges=function(e){var t=this._treeData;e.changed&&(t=_(t,e.changed)),e.added&&(t=E(t,e.added)),e.removed&&e.removed.forEach(function(e){t=v(t,e)}),this._commit(t)},r.prototype.ensureDirectoryExists=function(e){var t=this._treeData,n=w.stripTrailingSlash(e),r=w.getDirectoryPath(n),o=n.substr(r.length),a=[];if(r){if(a=i(t,r),!a)return;if(a.push("children"),!t.getIn(a))return}a.push(o),t.getIn(a)||(t=l(t,a,b.Map({children:null})),this._commit(t))},r.prototype.setSortDirectoriesFirst=function(e){e!==this.sortDirectoriesFirst&&(this.sortDirectoriesFirst=e,this.trigger(C))},r.prototype.setSelectionWidth=function(e){var t=this._selectionViewInfo;t=t.set("width",e),this._commit(null,t)},r.prototype.setSelectionScrollerInfo=function(e,t,n,r){this._selectionViewInfo=this._selectionViewInfo.set("scrollWidth",e),this._selectionViewInfo=this._selectionViewInfo.set("scrollTop",t),void 0!==n&&(this._selectionViewInfo=this._selectionViewInfo.set("scrollLeft",n)),void 0!==r&&(this._selectionViewInfo=this._selectionViewInfo.set("offsetTop",r))},t.EVENT_CHANGE=C,t._filePathToObjectPath=i,t._isFilePathVisible=o,t._createPlaceholder=g,t.isFile=n,t.FileTreeViewModel=r}),define("project/ProjectModel",["require","exports","module","document/InMemoryFile","utils/EventDispatcher","file/FileUtils","thirdparty/lodash","filesystem/FileSystem","filesystem/FileSystemError","project/FileTreeViewModel","utils/Async","utils/PerfUtils"],function(e,t){"use strict";function n(e,t){return!(-1!==e.search(new RegExp("["+t+"]+"))||e.match(R))}function r(e){return!e.match(L)}function i(e){return r(e.name)}function o(e){return"/"!==_.last(e)}function a(e){return e?o(e)?E.getFileForPath(e):E.getDirectoryForPath(e):e}function s(e){return e&&e.fullPath?e.fullPath:e}function l(e,t){var r=new $.Deferred,i=y.getBaseName(e);return n(i,m)?(E.resolve(e,function(n){if(n)if(t){var i=E.getDirectoryForPath(e);i.create(function(e){e?r.reject(e):r.resolve(i)})}else{var o=E.getFileForPath(e);y.writeText(o,"").then(function(){r.resolve(o)},r.reject)}else r.reject(b.ALREADY_EXISTS)}),r.promise()):r.reject(M).promise()}function c(e){e=e||{},e.projectRoot&&(this.projectRoot=e.projectRoot),void 0!==e.focused&&(this._focused=e.focused),this._viewModel=new S.FileTreeViewModel,this._viewModel.on(S.EVENT_CHANGE,function(){this.trigger(C)}.bind(this)),this._selections={}}function u(e,t,r){var i=new $.Deferred;if(e===t)i.resolve();else if(n(y.getBaseName(t),m)){var o=r?E.getDirectoryForPath(e):E.getFileForPath(e);o.rename(t,function(e){e?i.reject(e):i.resolve()})}else i.reject(M);return i.promise()}function d(e){return o(e)?e+"/":e}function p(e,t){return e&&(t=t.substr(0,t.lastIndexOf("/"))+"/samples/"+e),d(t)}function h(e,t){var n,r=y.stripTrailingSlash(e);return n=t?_.clone(t):[],-1===n.indexOf(r)&&n.push(r),n}function f(e,t,n){if(e===t)return!0;if(!n)return!1;var r=y.stripTrailingSlash(e);return-1!==n.indexOf(r)}var m,g=e("document/InMemoryFile"),v=e("utils/EventDispatcher"),y=e("file/FileUtils"),_=e("thirdparty/lodash"),E=e("filesystem/FileSystem"),b=e("filesystem/FileSystemError"),S=e("project/FileTreeViewModel"),I=e("utils/Async"),w=e("utils/PerfUtils"),C="change",D="select",T="focus",O="creationError",M="invalidFilename",L=/\.pyc$|^\.git$|^\.gitmodules$|^\.svn$|^\.DS_Store$|^Thumbs\.db$|^\.hg$|^CVS$|^\.hgtags$|^\.idea$|^\.c9revisions$|^\.SyncArchive$|^\.SyncID$|^\.SyncIgnore$|\~$/,R=/^(\.+|com[1-9]|lpt[1-9]|nul|con|prn|aux|)$|\.+$/i,N=0,x=1,A=2;v.makeEventDispatcher(c.prototype),c.prototype.projectRoot=null,c.prototype._viewModel=null,c.prototype._projectBaseUrl="",c.prototype._selections=null,c.prototype._focused=!0,c.prototype._currentPath=null,c.prototype._allFilesCachePromise=null,c.prototype.setFocused=function(e){this._focused=e,e||this.setSelected(null)},c.prototype.setSelectionWidth=function(e){this._viewModel.setSelectionWidth(e)},c.prototype.setScrollerInfo=function(e,t,n,r){this._viewModel.setSelectionScrollerInfo(e,t,n,r)},c.prototype.getBaseUrl=function(){return this._projectBaseUrl},c.prototype.setBaseUrl=function(e){return e.length>0&&"/"!==e[e.length-1]&&(e+="/"),this._projectBaseUrl=e,e},c.prototype.isWithinProject=function(e){var t=e.fullPath||e;return this.projectRoot&&0===t.indexOf(this.projectRoot.fullPath)},c.prototype.makeProjectRelativeIfPossible=function(e){return e&&this.isWithinProject(e)?e.slice(this.projectRoot.fullPath.length):e},c.prototype.getDirectoryInProject=function(e){return e&&"string"==typeof e?"/"!==_.last(e)&&(e+="/"):e=e&&e.isDirectory?e.fullPath:null,e&&"string"==typeof e&&this.isWithinProject(e)||(e=this.projectRoot.fullPath),e},c.prototype._getAllFilesCache=function(){if(!this._allFilesCachePromise){var e=new $.Deferred,t=[],n=function(e){return i(e)?(e.isFile&&t.push(e),!0):!1};this._allFilesCachePromise=e.promise();var r=w.markStart("Creating project files cache: "+this.projectRoot.fullPath);this.projectRoot.visit(n,function(n){n?(w.finalizeMeasurement(r),e.reject(n)):(w.addMeasurement(r),e.resolve(t))}.bind(this))}return this._allFilesCachePromise},c.prototype.getAllFiles=function(e,t){void 0===t&&"function"!=typeof e&&(t=e,e=null);var n=new $.Deferred;return this._getAllFilesCache().done(function(r){t&&t.forEach(function(e){-1!==r.indexOf(e)||e instanceof g||r.push(e)}),e&&(r=r.filter(e));try{n.resolve(r)}catch(i){console.error("Unhandled exception in getAllFiles handler: "+i,i.stack)}}).fail(function(e){try{n.reject(e)}catch(t){console.error("Unhandled exception in getAllFiles handler: "+t,t.stack)}}),n.promise()},c.prototype._resetCache=function(){this._allFilesCachePromise=null},c.prototype.setProjectRoot=function(e){this.projectRoot=e,this._resetCache(),this._viewModel._rootChanged();var t=new $.Deferred,n=this;return e.getContents(function(e,r){e?t.reject(e):(n._viewModel.setDirectoryContents("",r),t.resolve())}),t.promise()},c.prototype._getDirectoryContents=function(e){var t=new $.Deferred;return E.getDirectoryForPath(e).getContents(function(e,n){e?t.reject(e):t.resolve(n)}),t.promise()},c.prototype.setDirectoryOpen=function(e,t){function n(e){if(e&&a._viewModel.setDirectoryContents(r,e),t){if(a._viewModel.openPath(r),a._focused){var n=a.makeProjectRelativeIfPossible(a._currentPath);a._viewModel.isFilePathVisible(n)?a.setSelected(a._currentPath,!0):a.setSelected(null)}}else{a._viewModel.setDirectoryOpen(r,!1);var i=a._selections.selected;if(i){var s=a.makeProjectRelativeIfPossible(i);a._viewModel.isFilePathVisible(s)||a.setSelected(null)}}o.resolve()}var r=this.makeProjectRelativeIfPossible(e),i=!this._viewModel.isPathLoaded(r),o=new $.Deferred,a=this;if(t&&i){var s=y.getDirectoryPath(y.stripTrailingSlash(e));this.setDirectoryOpen(s,!0).then(function(){a._getDirectoryContents(e).then(n).fail(function(e){o.reject(e)})},function(e){o.reject(e)})}else n();return o.promise()},c.prototype.showInTree=function(e){var t=new $.Deferred;if(e=s(e),!this.isWithinProject(e))return t.resolve().promise();var n=y.getDirectoryPath(e),r=this;return this.setDirectoryOpen(n,!0).then(function(){o(e)&&r.setSelected(e),t.resolve()},function(e){t.reject(e)}),t.promise()},c.prototype.setSelected=function(e,t){if(e=s(e),o(e)){var n=this.makeProjectRelativeIfPossible(this._selections.selected),r=this.makeProjectRelativeIfPossible(e);e&&!this._viewModel.isFilePathVisible(r)&&(e=null,r=null),this.performRename(),this._viewModel.moveMarker("selected",n,r),this._selections.context&&(this._viewModel.moveMarker("context",this.makeProjectRelativeIfPossible(this._selections.context),null),delete this._selections.context);var i=this._selections.selected;this._selections.selected=e,e&&(t||this.trigger(D,{path:e,previousPath:i,hadFocus:this._focused}),this.trigger(T))}},c.prototype.getSelected=function(){return a(this._selections.selected)},c.prototype.setCurrentFile=function(e){this._currentPath=s(e)},c.prototype.selectInWorkingSet=function(e){this.performRename(),this.trigger(D,{path:e,add:!0})},c.prototype.setContext=function(e,t,n){n?this._selections.previousContext=e?e:this._selections.context:delete this._selections.previousContext,e=s(e),t||this.performRename();var r=this._selections.context;
this._selections.context=e,this._viewModel.moveMarker("context",this.makeProjectRelativeIfPossible(r),this.makeProjectRelativeIfPossible(e))},c.prototype.restoreContext=function(){this._selections.previousContext&&this.setContext(this._selections.previousContext)},c.prototype.getContext=function(){return a(this._selections.context)},c.prototype.startRename=function(e){if(e=s(e),!e&&(e=this._selections.context,!e))return(new $.Deferred).resolve().promise();if(!this._selections.rename||this._selections.rename.path!==e){var t=this.makeProjectRelativeIfPossible(e);this._viewModel.isFilePathVisible(t)||this.showInTree(e),e!==this._selections.context?this.setContext(e):this.performRename(),this._viewModel.moveMarker("rename",null,t);var n=new $.Deferred;return this._selections.rename={deferred:n,type:N,path:e,newName:y.getBaseName(e)},n.promise()}},c.prototype.setRenameValue=function(e){this._selections.rename&&(this._selections.rename.newName=e)},c.prototype.cancelRename=function(){var e=this._selections.rename;if(e){if(e.type===x)return void this._cancelCreating();this._viewModel.moveMarker("rename",this.makeProjectRelativeIfPossible(e.path),null),e.deferred.resolve(A),delete this._selections.rename,this.setContext(null)}},c.prototype._renameItem=function(e,t){return u(e,t,!o(e))},c.prototype.performRename=function(){function e(){u.renameItem(i,l),d._selections.selected&&0===d._selections.selected.indexOf(n)&&(d._selections.selected=c+d._selections.selected.slice(n.length))}var t=this._selections.rename;if(t){var n=t.path,r=t.isFolder||!o(n),i=this.makeProjectRelativeIfPossible(n),a=y.getDirectoryPath(r?y.stripTrailingSlash(n):n),s=y.getBaseName(n),l=t.newName,c=a+l,u=this._viewModel,d=this;if(t.type!==x&&s===l)return void this.cancelRename();r&&(c+="/"),delete this._selections.rename,delete this._selections.context,u.moveMarker("rename",i,null),u.moveMarker("context",i,null),u.moveMarker("creating",i,null),t.type===x?this.createAtPath(c).done(function(n){e(),t.deferred.resolve(n)}).fail(function(e){d._viewModel.deleteAtPath(d.makeProjectRelativeIfPossible(t.path)),t.deferred.reject(e)}):this._renameItem(n,c).then(function(){e(),t.deferred.resolve({newPath:c})}).fail(function(e){var i={type:e,isFolder:r,fullPath:n};t.deferred.reject(i)})}},c.prototype.createAtPath=function(e){var t=!o(e),n=y.getBaseName(e),r=this;return l(e,t).done(function(e){t||r.selectInWorkingSet(e.fullPath)}).fail(function(e){r.trigger(O,{type:e,name:n,isFolder:t})})},c.prototype.startCreating=function(e,t,n){this.performRename();var r=new $.Deferred,i=this;return this.setDirectoryOpen(e,!0).then(function(){i._viewModel.createPlaceholder(i.makeProjectRelativeIfPossible(e),t,n);var o=i.startRename(e+t);i._selections.rename.type=x,n&&(i._selections.rename.isFolder=n),o.then(r.resolve).fail(r.reject)}).fail(function(e){r.reject(e)}),r.promise()},c.prototype._cancelCreating=function(){var e=this._selections.rename;e&&e.type===x&&(this._viewModel.deleteAtPath(this.makeProjectRelativeIfPossible(e.path)),e.deferred.resolve(A),delete this._selections.rename,this.setContext(null))},c.prototype.setSortDirectoriesFirst=function(e){this._viewModel.setSortDirectoriesFirst(e)},c.prototype.getOpenNodes=function(){return this._viewModel.getOpenNodes(this.projectRoot.fullPath)},c.prototype.reopenNodes=function(e){var t=new $.Deferred;if(e&&0!==e.length){var n=this;return I.doSequentially(e,function(e){return I.doInParallel(e,function(e){return n._getDirectoryContents(e).then(function(t){var r=n.makeProjectRelativeIfPossible(e);n._viewModel.setDirectoryContents(r,t),n._viewModel.setDirectoryOpen(r,!0)})},!1)})}return t.resolve().promise()},c.prototype.refresh=function(){var e=this.projectRoot,t=this.getOpenNodes(),n=this,r=this._selections,i=this._viewModel,o=new $.Deferred;return this.setProjectRoot(e).then(function(){n.reopenNodes(t).then(function(){r.selected&&i.moveMarker("selected",null,n.makeProjectRelativeIfPossible(r.selected)),r.context&&i.moveMarker("context",null,n.makeProjectRelativeIfPossible(r.context)),r.rename&&i.moveMarker("rename",null,n.makeProjectRelativeIfPossible(r.rename)),o.resolve()})}),o.promise()},c.prototype.handleFSEvent=function(e,t,n){if(this._resetCache(),!e)return void this.refresh();if(this.isWithinProject(e)){var r={},i=this;if(e.isFile)r.changed=[this.makeProjectRelativeIfPossible(e.fullPath)];else if(!t&&!n)return void e.getContents(function(t,n){return t?void console.error("Unexpected error refreshing file tree for directory "+e.fullPath+": "+t,t.stack):void i._viewModel.setDirectoryContents(i.makeProjectRelativeIfPossible(e.fullPath),n)});t&&(r.added=t.map(function(e){return i.makeProjectRelativeIfPossible(e.fullPath)})),n&&(this._selections.selected&&_.find(n,{fullPath:this._selections.selected})&&this.setSelected(null),this._selections.rename&&_.find(n,{fullPath:this._selections.rename.path})&&this.cancelRename(),this._selections.context&&_.find(n,{fullPath:this._selections.context})&&this.setContext(null),r.removed=n.map(function(e){return i.makeProjectRelativeIfPossible(e.fullPath)})),this._viewModel.processChanges(r)}},c.prototype.closeSubtree=function(e){this._viewModel.closeSubtree(this.makeProjectRelativeIfPossible(e))},c.prototype.toggleSubdirectories=function(e,t){var n=this,r=new $.Deferred;return this.setDirectoryOpen(e,!0).then(function(){var i=n.makeProjectRelativeIfPossible(e),o=n._viewModel.getChildDirectories(i);I.doInParallel(o,function(r){return n.setDirectoryOpen(e+r,t)},!0).then(function(){r.resolve()},function(e){r.reject(e)})}),r.promise()},m="mac"===brackets.platform?"?*|:":"linux"===brackets.platform?"?*|/":'/?*:<>\\|"',t._getWelcomeProjectPath=p,t._addWelcomeProjectPath=h,t._isWelcomeProjectPath=f,t._ensureTrailingSlash=d,t._shouldShowName=r,t._invalidChars=m,t.shouldShow=i,t.isValidFilename=n,t.EVENT_CHANGE=C,t.EVENT_SHOULD_SELECT=D,t.EVENT_SHOULD_FOCUS=T,t.ERROR_CREATION=O,t.ERROR_INVALID_FILENAME=M,t.FILE_RENAMING=N,t.FILE_CREATING=x,t.RENAME_CANCELLED=A,t.doCreate=l,t.ProjectModel=c}),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("thirdparty/react",[],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.React=e()}}(function(){return function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return i(n?n:e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t){"use strict";var n=e("./focusNode"),r={componentDidMount:function(){this.props.autoFocus&&n(this.getDOMNode())}};t.exports=r},{"./focusNode":120}],2:[function(e,t){"use strict";function n(){var e=window.opera;return"object"==typeof e&&"function"==typeof e.version&&parseInt(e.version(),10)<=12}function r(e){return(e.ctrlKey||e.altKey||e.metaKey)&&!(e.ctrlKey&&e.altKey)}var i=e("./EventConstants"),o=e("./EventPropagators"),a=e("./ExecutionEnvironment"),s=e("./SyntheticInputEvent"),l=e("./keyOf"),c=a.canUseDOM&&"TextEvent"in window&&!("documentMode"in document||n()),u=32,d=String.fromCharCode(u),p=i.topLevelTypes,h={beforeInput:{phasedRegistrationNames:{bubbled:l({onBeforeInput:null}),captured:l({onBeforeInputCapture:null})},dependencies:[p.topCompositionEnd,p.topKeyPress,p.topTextInput,p.topPaste]}},f=null,m={eventTypes:h,extractEvents:function(e,t,n,i){var a;if(c)switch(e){case p.topKeyPress:var l=i.which;if(l!==u)return;a=String.fromCharCode(l);break;case p.topTextInput:if(a=i.data,a===d)return;break;default:return}else{switch(e){case p.topPaste:f=null;break;case p.topKeyPress:i.which&&!r(i)&&(f=String.fromCharCode(i.which));break;case p.topCompositionEnd:f=i.data}if(null===f)return;a=f}if(a){var m=s.getPooled(h.beforeInput,n,i);return m.data=a,f=null,o.accumulateTwoPhaseDispatches(m),m}}};t.exports=m},{"./EventConstants":16,"./EventPropagators":21,"./ExecutionEnvironment":22,"./SyntheticInputEvent":98,"./keyOf":141}],3:[function(e,t){var n=e("./invariant"),r={addClass:function(e,t){return n(!/\s/.test(t),'CSSCore.addClass takes only a single class name. "%s" contains multiple classes.',t),t&&(e.classList?e.classList.add(t):r.hasClass(e,t)||(e.className=e.className+" "+t)),e},removeClass:function(e,t){return n(!/\s/.test(t),'CSSCore.removeClass takes only a single class name. "%s" contains multiple classes.',t),t&&(e.classList?e.classList.remove(t):r.hasClass(e,t)&&(e.className=e.className.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,""))),e},conditionClass:function(e,t,n){return(n?r.addClass:r.removeClass)(e,t)},hasClass:function(e,t){return n(!/\s/.test(t),"CSS.hasClass takes only a single class name."),e.classList?!!t&&e.classList.contains(t):(" "+e.className+" ").indexOf(" "+t+" ")>-1}};t.exports=r},{"./invariant":134}],4:[function(e,t){"use strict";function n(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}var r={columnCount:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},i=["Webkit","ms","Moz","O"];Object.keys(r).forEach(function(e){i.forEach(function(t){r[n(t,e)]=r[e]})});var o={background:{backgroundImage:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundColor:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0}},a={isUnitlessNumber:r,shorthandPropertyExpansions:o};t.exports=a},{}],5:[function(e,t){"use strict";var n=e("./CSSProperty"),r=e("./dangerousStyleValue"),i=e("./hyphenateStyleName"),o=e("./memoizeStringOnly"),a=o(function(e){return i(e)}),s={createMarkupForStyles:function(e){var t="";for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];null!=i&&(t+=a(n)+":",t+=r(n,i)+";")}return t||null},setValueForStyles:function(e,t){var i=e.style;for(var o in t)if(t.hasOwnProperty(o)){var a=r(o,t[o]);if(a)i[o]=a;else{var s=n.shorthandPropertyExpansions[o];if(s)for(var l in s)i[l]="";else i[o]=""}}}};t.exports=s},{"./CSSProperty":4,"./dangerousStyleValue":115,"./hyphenateStyleName":132,"./memoizeStringOnly":143}],6:[function(e,t){"use strict";function n(){this._callbacks=null,this._contexts=null}var r=e("./PooledClass"),i=e("./invariant"),o=e("./mixInto");o(n,{enqueue:function(e,t){this._callbacks=this._callbacks||[],this._contexts=this._contexts||[],this._callbacks.push(e),this._contexts.push(t)},notifyAll:function(){var e=this._callbacks,t=this._contexts;if(e){i(e.length===t.length,"Mismatched list of contexts in callback queue"),this._callbacks=null,this._contexts=null;for(var n=0,r=e.length;r>n;n++)e[n].call(t[n]);e.length=0,t.length=0}},reset:function(){this._callbacks=null,this._contexts=null},destructor:function(){this.reset()}}),r.addPoolingTo(n),t.exports=n},{"./PooledClass":28,"./invariant":134,"./mixInto":147}],7:[function(e,t){"use strict";function n(e){return"SELECT"===e.nodeName||"INPUT"===e.nodeName&&"file"===e.type}function r(e){var t=S.getPooled(T.change,M,e);_.accumulateTwoPhaseDispatches(t),b.batchedUpdates(i,t)}function i(e){y.enqueueEvents(e),y.processEventQueue()}function o(e,t){O=e,M=t,O.attachEvent("onchange",r)}function a(){O&&(O.detachEvent("onchange",r),O=null,M=null)}function s(e,t,n){return e===D.topChange?n:void 0}function l(e,t,n){e===D.topFocus?(a(),o(t,n)):e===D.topBlur&&a()}function c(e,t){O=e,M=t,L=e.value,R=Object.getOwnPropertyDescriptor(e.constructor.prototype,"value"),Object.defineProperty(O,"value",A),O.attachEvent("onpropertychange",d)}function u(){O&&(delete O.value,O.detachEvent("onpropertychange",d),O=null,M=null,L=null,R=null)}function d(e){if("value"===e.propertyName){var t=e.srcElement.value;t!==L&&(L=t,r(e))}}function p(e,t,n){return e===D.topInput?n:void 0}function h(e,t,n){e===D.topFocus?(u(),c(t,n)):e===D.topBlur&&u()}function f(e){return e!==D.topSelectionChange&&e!==D.topKeyUp&&e!==D.topKeyDown||!O||O.value===L?void 0:(L=O.value,M)}function m(e){return"INPUT"===e.nodeName&&("checkbox"===e.type||"radio"===e.type)}function g(e,t,n){return e===D.topClick?n:void 0}var v=e("./EventConstants"),y=e("./EventPluginHub"),_=e("./EventPropagators"),E=e("./ExecutionEnvironment"),b=e("./ReactUpdates"),S=e("./SyntheticEvent"),I=e("./isEventSupported"),w=e("./isTextInputElement"),C=e("./keyOf"),D=v.topLevelTypes,T={change:{phasedRegistrationNames:{bubbled:C({onChange:null}),captured:C({onChangeCapture:null})},dependencies:[D.topBlur,D.topChange,D.topClick,D.topFocus,D.topInput,D.topKeyDown,D.topKeyUp,D.topSelectionChange]}},O=null,M=null,L=null,R=null,N=!1;E.canUseDOM&&(N=I("change")&&(!("documentMode"in document)||document.documentMode>8));var x=!1;E.canUseDOM&&(x=I("input")&&(!("documentMode"in document)||document.documentMode>9));var A={get:function(){return R.get.call(this)},set:function(e){L=""+e,R.set.call(this,e)}},P={eventTypes:T,extractEvents:function(e,t,r,i){var o,a;if(n(t)?N?o=s:a=l:w(t)?x?o=p:(o=f,a=h):m(t)&&(o=g),o){var c=o(e,t,r);if(c){var u=S.getPooled(T.change,c,i);return _.accumulateTwoPhaseDispatches(u),u}}a&&a(e,t,r)}};t.exports=P},{"./EventConstants":16,"./EventPluginHub":18,"./EventPropagators":21,"./ExecutionEnvironment":22,"./ReactUpdates":87,"./SyntheticEvent":96,"./isEventSupported":135,"./isTextInputElement":137,"./keyOf":141}],8:[function(e,t){"use strict";var n=0,r={createReactRootIndex:function(){return n++}};t.exports=r},{}],9:[function(e,t){"use strict";function n(e){switch(e){case v.topCompositionStart:return _.compositionStart;case v.topCompositionEnd:return _.compositionEnd;case v.topCompositionUpdate:return _.compositionUpdate}}function r(e,t){return e===v.topKeyDown&&t.keyCode===f}function i(e,t){switch(e){case v.topKeyUp:return-1!==h.indexOf(t.keyCode);case v.topKeyDown:return t.keyCode!==f;case v.topKeyPress:case v.topMouseDown:case v.topBlur:return!0;default:return!1}}function o(e){this.root=e,this.startSelection=c.getSelection(e),this.startValue=this.getText()}var a=e("./EventConstants"),s=e("./EventPropagators"),l=e("./ExecutionEnvironment"),c=e("./ReactInputSelection"),u=e("./SyntheticCompositionEvent"),d=e("./getTextContentAccessor"),p=e("./keyOf"),h=[9,13,27,32],f=229,m=l.canUseDOM&&"CompositionEvent"in window,g=!m||"documentMode"in document&&document.documentMode>8&&document.documentMode<=11,v=a.topLevelTypes,y=null,_={compositionEnd:{phasedRegistrationNames:{bubbled:p({onCompositionEnd:null}),captured:p({onCompositionEndCapture:null})},dependencies:[v.topBlur,v.topCompositionEnd,v.topKeyDown,v.topKeyPress,v.topKeyUp,v.topMouseDown]},compositionStart:{phasedRegistrationNames:{bubbled:p({onCompositionStart:null}),captured:p({onCompositionStartCapture:null})},dependencies:[v.topBlur,v.topCompositionStart,v.topKeyDown,v.topKeyPress,v.topKeyUp,v.topMouseDown]},compositionUpdate:{phasedRegistrationNames:{bubbled:p({onCompositionUpdate:null}),captured:p({onCompositionUpdateCapture:null})},dependencies:[v.topBlur,v.topCompositionUpdate,v.topKeyDown,v.topKeyPress,v.topKeyUp,v.topMouseDown]}};o.prototype.getText=function(){return this.root.value||this.root[d()]},o.prototype.getData=function(){var e=this.getText(),t=this.startSelection.start,n=this.startValue.length-this.startSelection.end;return e.substr(t,e.length-n-t)};var E={eventTypes:_,extractEvents:function(e,t,a,l){var c,d;if(m?c=n(e):y?i(e,l)&&(c=_.compositionEnd):r(e,l)&&(c=_.compositionStart),g&&(y||c!==_.compositionStart?c===_.compositionEnd&&y&&(d=y.getData(),y=null):y=new o(t)),c){var p=u.getPooled(c,a,l);return d&&(p.data=d),s.accumulateTwoPhaseDispatches(p),p}}};t.exports=E},{"./EventConstants":16,"./EventPropagators":21,"./ExecutionEnvironment":22,"./ReactInputSelection":63,"./SyntheticCompositionEvent":94,"./getTextContentAccessor":129,"./keyOf":141}],10:[function(e,t){"use strict";function n(e,t,n){e.insertBefore(t,e.childNodes[n]||null)}var r,i=e("./Danger"),o=e("./ReactMultiChildUpdateTypes"),a=e("./getTextContentAccessor"),s=e("./invariant"),l=a();r="textContent"===l?function(e,t){e.textContent=t}:function(e,t){for(;e.firstChild;)e.removeChild(e.firstChild);if(t){var n=e.ownerDocument||document;e.appendChild(n.createTextNode(t))}};var c={dangerouslyReplaceNodeWithMarkup:i.dangerouslyReplaceNodeWithMarkup,updateTextContent:r,processUpdates:function(e,t){for(var a,l=null,c=null,u=0;a=e[u];u++)if(a.type===o.MOVE_EXISTING||a.type===o.REMOVE_NODE){var d=a.fromIndex,p=a.parentNode.childNodes[d],h=a.parentID;s(p,"processUpdates(): Unable to find child %s of element. This probably means the DOM was unexpectedly mutated (e.g., by the browser), usually due to forgetting a <tbody> when using tables, nesting <p> or <a> tags, or using non-SVG elements in an <svg> parent. Try inspecting the child nodes of the element with React ID `%s`.",d,h),l=l||{},l[h]=l[h]||[],l[h][d]=p,c=c||[],c.push(p)}var f=i.dangerouslyRenderMarkup(t);if(c)for(var m=0;m<c.length;m++)c[m].parentNode.removeChild(c[m]);for(var g=0;a=e[g];g++)switch(a.type){case o.INSERT_MARKUP:n(a.parentNode,f[a.markupIndex],a.toIndex);break;case o.MOVE_EXISTING:n(a.parentNode,l[a.parentID][a.fromIndex],a.toIndex);break;case o.TEXT_CONTENT:r(a.parentNode,a.textContent);break;case o.REMOVE_NODE:}}};t.exports=c},{"./Danger":13,"./ReactMultiChildUpdateTypes":69,"./getTextContentAccessor":129,"./invariant":134}],11:[function(e,t){"use strict";var n=e("./invariant"),r={MUST_USE_ATTRIBUTE:1,MUST_USE_PROPERTY:2,HAS_SIDE_EFFECTS:4,HAS_BOOLEAN_VALUE:8,HAS_NUMERIC_VALUE:16,HAS_POSITIVE_NUMERIC_VALUE:48,HAS_OVERLOADED_BOOLEAN_VALUE:64,injectDOMPropertyConfig:function(e){var t=e.Properties||{},i=e.DOMAttributeNames||{},a=e.DOMPropertyNames||{},s=e.DOMMutationMethods||{};e.isCustomAttribute&&o._isCustomAttributeFunctions.push(e.isCustomAttribute);for(var l in t){n(!o.isStandardName.hasOwnProperty(l),"injectDOMPropertyConfig(...): You're trying to inject DOM property '%s' which has already been injected. You may be accidentally injecting the same DOM property config twice, or you may be injecting two configs that have conflicting property names.",l),o.isStandardName[l]=!0;var c=l.toLowerCase();if(o.getPossibleStandardName[c]=l,i.hasOwnProperty(l)){var u=i[l];o.getPossibleStandardName[u]=l,o.getAttributeName[l]=u}else o.getAttributeName[l]=c;o.getPropertyName[l]=a.hasOwnProperty(l)?a[l]:l,o.getMutationMethod[l]=s.hasOwnProperty(l)?s[l]:null;var d=t[l];o.mustUseAttribute[l]=d&r.MUST_USE_ATTRIBUTE,o.mustUseProperty[l]=d&r.MUST_USE_PROPERTY,o.hasSideEffects[l]=d&r.HAS_SIDE_EFFECTS,o.hasBooleanValue[l]=d&r.HAS_BOOLEAN_VALUE,o.hasNumericValue[l]=d&r.HAS_NUMERIC_VALUE,o.hasPositiveNumericValue[l]=d&r.HAS_POSITIVE_NUMERIC_VALUE,o.hasOverloadedBooleanValue[l]=d&r.HAS_OVERLOADED_BOOLEAN_VALUE,n(!o.mustUseAttribute[l]||!o.mustUseProperty[l],"DOMProperty: Cannot require using both attribute and property: %s",l),n(o.mustUseProperty[l]||!o.hasSideEffects[l],"DOMProperty: Properties that have side effects must use property: %s",l),n(!!o.hasBooleanValue[l]+!!o.hasNumericValue[l]+!!o.hasOverloadedBooleanValue[l]<=1,"DOMProperty: Value can be one of boolean, overloaded boolean, or numeric value, but not a combination: %s",l)}}},i={},o={ID_ATTRIBUTE_NAME:"data-reactid",isStandardName:{},getPossibleStandardName:{},getAttributeName:{},getPropertyName:{},getMutationMethod:{},mustUseAttribute:{},mustUseProperty:{},hasSideEffects:{},hasBooleanValue:{},hasNumericValue:{},hasPositiveNumericValue:{},hasOverloadedBooleanValue:{},_isCustomAttributeFunctions:[],isCustomAttribute:function(e){for(var t=0;t<o._isCustomAttributeFunctions.length;t++){var n=o._isCustomAttributeFunctions[t];if(n(e))return!0}return!1},getDefaultValueForProperty:function(e,t){var n,r=i[e];return r||(i[e]=r={}),t in r||(n=document.createElement(e),r[t]=n[t]),r[t]},injection:r};t.exports=o},{"./invariant":134}],12:[function(e,t){"use strict";function n(e,t){return null==t||r.hasBooleanValue[e]&&!t||r.hasNumericValue[e]&&isNaN(t)||r.hasPositiveNumericValue[e]&&1>t||r.hasOverloadedBooleanValue[e]&&t===!1}var r=e("./DOMProperty"),i=e("./escapeTextForBrowser"),o=e("./memoizeStringOnly"),a=e("./warning"),s=o(function(e){return i(e)+'="'}),l={children:!0,dangerouslySetInnerHTML:!0,key:!0,ref:!0},c={},u=function(e){if(!(l.hasOwnProperty(e)&&l[e]||c.hasOwnProperty(e)&&c[e])){c[e]=!0;var t=e.toLowerCase(),n=r.isCustomAttribute(t)?t:r.getPossibleStandardName.hasOwnProperty(t)?r.getPossibleStandardName[t]:null;a(null==n,"Unknown DOM property "+e+". Did you mean "+n+"?")}},d={createMarkupForID:function(e){return s(r.ID_ATTRIBUTE_NAME)+i(e)+'"'},createMarkupForProperty:function(e,t){if(r.isStandardName.hasOwnProperty(e)&&r.isStandardName[e]){if(n(e,t))return"";var o=r.getAttributeName[e];return r.hasBooleanValue[e]||r.hasOverloadedBooleanValue[e]&&t===!0?i(o):s(o)+i(t)+'"'}return r.isCustomAttribute(e)?null==t?"":s(e)+i(t)+'"':(u(e),null)},setValueForProperty:function(e,t,i){if(r.isStandardName.hasOwnProperty(t)&&r.isStandardName[t]){var o=r.getMutationMethod[t];if(o)o(e,i);else if(n(t,i))this.deleteValueForProperty(e,t);else if(r.mustUseAttribute[t])e.setAttribute(r.getAttributeName[t],""+i);else{var a=r.getPropertyName[t];r.hasSideEffects[t]&&e[a]===i||(e[a]=i)}}else r.isCustomAttribute(t)?null==i?e.removeAttribute(t):e.setAttribute(t,""+i):u(t)},deleteValueForProperty:function(e,t){if(r.isStandardName.hasOwnProperty(t)&&r.isStandardName[t]){var n=r.getMutationMethod[t];if(n)n(e,void 0);else if(r.mustUseAttribute[t])e.removeAttribute(r.getAttributeName[t]);else{var i=r.getPropertyName[t],o=r.getDefaultValueForProperty(e.nodeName,i);r.hasSideEffects[t]&&e[i]===o||(e[i]=o)}}else r.isCustomAttribute(t)?e.removeAttribute(t):u(t)}};t.exports=d},{"./DOMProperty":11,"./escapeTextForBrowser":118,"./memoizeStringOnly":143,"./warning":158}],13:[function(e,t){"use strict";function n(e){return e.substring(1,e.indexOf(" "))}var r=e("./ExecutionEnvironment"),i=e("./createNodesFromMarkup"),o=e("./emptyFunction"),a=e("./getMarkupWrap"),s=e("./invariant"),l=/^(<[^ \/>]+)/,c="data-danger-index",u={dangerouslyRenderMarkup:function(e){s(r.canUseDOM,"dangerouslyRenderMarkup(...): Cannot render markup in a Worker thread. This is likely a bug in the framework. Please report immediately.");for(var t,u={},d=0;d<e.length;d++)s(e[d],"dangerouslyRenderMarkup(...): Missing markup."),t=n(e[d]),t=a(t)?t:"*",u[t]=u[t]||[],u[t][d]=e[d];var p=[],h=0;for(t in u)if(u.hasOwnProperty(t)){var f=u[t];for(var m in f)if(f.hasOwnProperty(m)){var g=f[m];f[m]=g.replace(l,"$1 "+c+'="'+m+'" ')}var v=i(f.join(""),o);for(d=0;d<v.length;++d){var y=v[d];y.hasAttribute&&y.hasAttribute(c)?(m=+y.getAttribute(c),y.removeAttribute(c),s(!p.hasOwnProperty(m),"Danger: Assigning to an already-occupied result index."),p[m]=y,h+=1):console.error("Danger: Discarding unexpected node:",y)}}return s(h===p.length,"Danger: Did not assign to every index of resultList."),s(p.length===e.length,"Danger: Expected markup to render %s nodes, but rendered %s.",e.length,p.length),p},dangerouslyReplaceNodeWithMarkup:function(e,t){s(r.canUseDOM,"dangerouslyReplaceNodeWithMarkup(...): Cannot render markup in a worker thread. This is likely a bug in the framework. Please report immediately."),s(t,"dangerouslyReplaceNodeWithMarkup(...): Missing markup."),s("html"!==e.tagName.toLowerCase(),"dangerouslyReplaceNodeWithMarkup(...): Cannot replace markup of the <html> node. This is because browser quirks make this unreliable and/or slow. If you want to render to the root you must use server rendering. See renderComponentToString().");var n=i(t,o)[0];e.parentNode.replaceChild(n,e)}};t.exports=u},{"./ExecutionEnvironment":22,"./createNodesFromMarkup":113,"./emptyFunction":116,"./getMarkupWrap":126,"./invariant":134}],14:[function(e,t){"use strict";var n=e("./keyOf"),r=[n({ResponderEventPlugin:null}),n({SimpleEventPlugin:null}),n({TapEventPlugin:null}),n({EnterLeaveEventPlugin:null}),n({ChangeEventPlugin:null}),n({SelectEventPlugin:null}),n({CompositionEventPlugin:null}),n({BeforeInputEventPlugin:null}),n({AnalyticsEventPlugin:null}),n({MobileSafariClickEventPlugin:null})];t.exports=r},{"./keyOf":141}],15:[function(e,t){"use strict";var n=e("./EventConstants"),r=e("./EventPropagators"),i=e("./SyntheticMouseEvent"),o=e("./ReactMount"),a=e("./keyOf"),s=n.topLevelTypes,l=o.getFirstReactDOM,c={mouseEnter:{registrationName:a({onMouseEnter:null}),dependencies:[s.topMouseOut,s.topMouseOver]},mouseLeave:{registrationName:a({onMouseLeave:null}),dependencies:[s.topMouseOut,s.topMouseOver]}},u=[null,null],d={eventTypes:c,extractEvents:function(e,t,n,a){if(e===s.topMouseOver&&(a.relatedTarget||a.fromElement))return null;if(e!==s.topMouseOut&&e!==s.topMouseOver)return null;var d;if(t.window===t)d=t;else{var p=t.ownerDocument;d=p?p.defaultView||p.parentWindow:window}var h,f;if(e===s.topMouseOut?(h=t,f=l(a.relatedTarget||a.toElement)||d):(h=d,f=t),h===f)return null;var m=h?o.getID(h):"",g=f?o.getID(f):"",v=i.getPooled(c.mouseLeave,m,a);v.type="mouseleave",v.target=h,v.relatedTarget=f;var y=i.getPooled(c.mouseEnter,g,a);return y.type="mouseenter",y.target=f,y.relatedTarget=h,r.accumulateEnterLeaveDispatches(v,y,m,g),u[0]=v,u[1]=y,u}};t.exports=d},{"./EventConstants":16,"./EventPropagators":21,"./ReactMount":67,"./SyntheticMouseEvent":100,"./keyOf":141}],16:[function(e,t){"use strict";var n=e("./keyMirror"),r=n({bubbled:null,captured:null}),i=n({topBlur:null,topChange:null,topClick:null,topCompositionEnd:null,topCompositionStart:null,topCompositionUpdate:null,topContextMenu:null,topCopy:null,topCut:null,topDoubleClick:null,topDrag:null,topDragEnd:null,topDragEnter:null,topDragExit:null,topDragLeave:null,topDragOver:null,topDragStart:null,topDrop:null,topError:null,topFocus:null,topInput:null,topKeyDown:null,topKeyPress:null,topKeyUp:null,topLoad:null,topMouseDown:null,topMouseMove:null,topMouseOut:null,topMouseOver:null,topMouseUp:null,topPaste:null,topReset:null,topScroll:null,topSelectionChange:null,topSubmit:null,topTextInput:null,topTouchCancel:null,topTouchEnd:null,topTouchMove:null,topTouchStart:null,topWheel:null}),o={topLevelTypes:i,PropagationPhases:r};t.exports=o},{"./keyMirror":140}],17:[function(e,t){var n=e("./emptyFunction"),r={listen:function(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!1),{remove:function(){e.removeEventListener(t,n,!1)}}):e.attachEvent?(e.attachEvent("on"+t,n),{remove:function(){e.detachEvent("on"+t,n)}}):void 0},capture:function(e,t,r){return e.addEventListener?(e.addEventListener(t,r,!0),{remove:function(){e.removeEventListener(t,r,!0)}}):(console.error("Attempted to listen to events during the capture phase on a browser that does not support the capture phase. Your application will not receive some events."),{remove:n})},registerDefault:function(){}};t.exports=r},{"./emptyFunction":116}],18:[function(e,t){"use strict";function n(){var e=!h||!h.traverseTwoPhase||!h.traverseEnterLeave;if(e)throw new Error("InstanceHandle not injected before use!")}var r=e("./EventPluginRegistry"),i=e("./EventPluginUtils"),o=e("./accumulate"),a=e("./forEachAccumulated"),s=e("./invariant"),l=e("./isEventSupported"),c=e("./monitorCodeUse"),u={},d=null,p=function(e){if(e){var t=i.executeDispatch,n=r.getPluginModuleForEvent(e);n&&n.executeDispatch&&(t=n.executeDispatch),i.executeDispatchesInOrder(e,t),e.isPersistent()||e.constructor.release(e)}},h=null,f={injection:{injectMount:i.injection.injectMount,injectInstanceHandle:function(e){h=e,n()},getInstanceHandle:function(){return n(),h},injectEventPluginOrder:r.injectEventPluginOrder,injectEventPluginsByName:r.injectEventPluginsByName},eventNameDispatchConfigs:r.eventNameDispatchConfigs,registrationNameModules:r.registrationNameModules,putListener:function(e,t,n){s(!n||"function"==typeof n,"Expected %s listener to be a function, instead got type %s",t,typeof n),"onScroll"!==t||l("scroll",!0)||(c("react_no_scroll_event"),console.warn("This browser doesn't support the `onScroll` event"));var r=u[t]||(u[t]={});r[e]=n},getListener:function(e,t){var n=u[t];return n&&n[e]},deleteListener:function(e,t){var n=u[t];n&&delete n[e]},deleteAllListeners:function(e){for(var t in u)delete u[t][e]},extractEvents:function(e,t,n,i){for(var a,s=r.plugins,l=0,c=s.length;c>l;l++){var u=s[l];if(u){var d=u.extractEvents(e,t,n,i);d&&(a=o(a,d))}}return a},enqueueEvents:function(e){e&&(d=o(d,e))},processEventQueue:function(){var e=d;d=null,a(e,p),s(!d,"processEventQueue(): Additional events were enqueued while processing an event queue. Support for this has not yet been implemented.")},__purge:function(){u={}},__getListenerBank:function(){return u}};t.exports=f},{"./EventPluginRegistry":19,"./EventPluginUtils":20,"./accumulate":106,"./forEachAccumulated":121,"./invariant":134,"./isEventSupported":135,"./monitorCodeUse":148}],19:[function(e,t){"use strict";function n(){if(a)for(var e in s){var t=s[e],n=a.indexOf(e);if(o(n>-1,"EventPluginRegistry: Cannot inject event plugins that do not exist in the plugin ordering, `%s`.",e),!l.plugins[n]){o(t.extractEvents,"EventPluginRegistry: Event plugins must implement an `extractEvents` method, but `%s` does not.",e),l.plugins[n]=t;var i=t.eventTypes;for(var c in i)o(r(i[c],t,c),"EventPluginRegistry: Failed to publish event `%s` for plugin `%s`.",c,e)}}}function r(e,t,n){o(!l.eventNameDispatchConfigs.hasOwnProperty(n),"EventPluginHub: More than one plugin attempted to publish the same event name, `%s`.",n),l.eventNameDispatchConfigs[n]=e;var r=e.phasedRegistrationNames;if(r){for(var a in r)if(r.hasOwnProperty(a)){var s=r[a];i(s,t,n)}return!0}return e.registrationName?(i(e.registrationName,t,n),!0):!1}function i(e,t,n){o(!l.registrationNameModules[e],"EventPluginHub: More than one plugin attempted to publish the same registration name, `%s`.",e),l.registrationNameModules[e]=t,l.registrationNameDependencies[e]=t.eventTypes[n].dependencies}var o=e("./invariant"),a=null,s={},l={plugins:[],eventNameDispatchConfigs:{},registrationNameModules:{},registrationNameDependencies:{},injectEventPluginOrder:function(e){o(!a,"EventPluginRegistry: Cannot inject event plugin ordering more than once. You are likely trying to load more than one copy of React."),a=Array.prototype.slice.call(e),n()},injectEventPluginsByName:function(e){var t=!1;for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];s.hasOwnProperty(r)&&s[r]===i||(o(!s[r],"EventPluginRegistry: Cannot inject two different event plugins using the same name, `%s`.",r),s[r]=i,t=!0)}t&&n()},getPluginModuleForEvent:function(e){var t=e.dispatchConfig;if(t.registrationName)return l.registrationNameModules[t.registrationName]||null;for(var n in t.phasedRegistrationNames)if(t.phasedRegistrationNames.hasOwnProperty(n)){var r=l.registrationNameModules[t.phasedRegistrationNames[n]];if(r)return r}return null},_resetEventPlugins:function(){a=null;for(var e in s)s.hasOwnProperty(e)&&delete s[e];l.plugins.length=0;var t=l.eventNameDispatchConfigs;for(var n in t)t.hasOwnProperty(n)&&delete t[n];var r=l.registrationNameModules;for(var i in r)r.hasOwnProperty(i)&&delete r[i]}};t.exports=l},{"./invariant":134}],20:[function(e,t){"use strict";function n(e){return e===g.topMouseUp||e===g.topTouchEnd||e===g.topTouchCancel}function r(e){return e===g.topMouseMove||e===g.topTouchMove}function i(e){return e===g.topMouseDown||e===g.topTouchStart}function o(e,t){var n=e._dispatchListeners,r=e._dispatchIDs;if(p(e),Array.isArray(n))for(var i=0;i<n.length&&!e.isPropagationStopped();i++)t(e,n[i],r[i]);else n&&t(e,n,r)}function a(e,t,n){e.currentTarget=m.Mount.getNode(n);var r=t(e,n);return e.currentTarget=null,r}function s(e,t){o(e,t),e._dispatchListeners=null,e._dispatchIDs=null
}function l(e){var t=e._dispatchListeners,n=e._dispatchIDs;if(p(e),Array.isArray(t)){for(var r=0;r<t.length&&!e.isPropagationStopped();r++)if(t[r](e,n[r]))return n[r]}else if(t&&t(e,n))return n;return null}function c(e){var t=l(e);return e._dispatchIDs=null,e._dispatchListeners=null,t}function u(e){p(e);var t=e._dispatchListeners,n=e._dispatchIDs;f(!Array.isArray(t),"executeDirectDispatch(...): Invalid `event`.");var r=t?t(e,n):null;return e._dispatchListeners=null,e._dispatchIDs=null,r}function d(e){return!!e._dispatchListeners}var p,h=e("./EventConstants"),f=e("./invariant"),m={Mount:null,injectMount:function(e){m.Mount=e,f(e&&e.getNode,"EventPluginUtils.injection.injectMount(...): Injected Mount module is missing getNode.")}},g=h.topLevelTypes;p=function(e){var t=e._dispatchListeners,n=e._dispatchIDs,r=Array.isArray(t),i=Array.isArray(n),o=i?n.length:n?1:0,a=r?t.length:t?1:0;f(i===r&&o===a,"EventPluginUtils: Invalid `event`.")};var v={isEndish:n,isMoveish:r,isStartish:i,executeDirectDispatch:u,executeDispatch:a,executeDispatchesInOrder:s,executeDispatchesInOrderStopAtTrue:c,hasDispatches:d,injection:m,useTouchEvents:!1};t.exports=v},{"./EventConstants":16,"./invariant":134}],21:[function(e,t){"use strict";function n(e,t,n){var r=t.dispatchConfig.phasedRegistrationNames[n];return m(e,r)}function r(e,t,r){if(!e)throw new Error("Dispatching id must not be null");var i=t?f.bubbled:f.captured,o=n(e,r,i);o&&(r._dispatchListeners=p(r._dispatchListeners,o),r._dispatchIDs=p(r._dispatchIDs,e))}function i(e){e&&e.dispatchConfig.phasedRegistrationNames&&d.injection.getInstanceHandle().traverseTwoPhase(e.dispatchMarker,r,e)}function o(e,t,n){if(n&&n.dispatchConfig.registrationName){var r=n.dispatchConfig.registrationName,i=m(e,r);i&&(n._dispatchListeners=p(n._dispatchListeners,i),n._dispatchIDs=p(n._dispatchIDs,e))}}function a(e){e&&e.dispatchConfig.registrationName&&o(e.dispatchMarker,null,e)}function s(e){h(e,i)}function l(e,t,n,r){d.injection.getInstanceHandle().traverseEnterLeave(n,r,o,e,t)}function c(e){h(e,a)}var u=e("./EventConstants"),d=e("./EventPluginHub"),p=e("./accumulate"),h=e("./forEachAccumulated"),f=u.PropagationPhases,m=d.getListener,g={accumulateTwoPhaseDispatches:s,accumulateDirectDispatches:c,accumulateEnterLeaveDispatches:l};t.exports=g},{"./EventConstants":16,"./EventPluginHub":18,"./accumulate":106,"./forEachAccumulated":121}],22:[function(e,t){"use strict";var n=!("undefined"==typeof window||!window.document||!window.document.createElement),r={canUseDOM:n,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:n&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:n&&!!window.screen,isInWorker:!n};t.exports=r},{}],23:[function(e,t){"use strict";var n,r=e("./DOMProperty"),i=e("./ExecutionEnvironment"),o=r.injection.MUST_USE_ATTRIBUTE,a=r.injection.MUST_USE_PROPERTY,s=r.injection.HAS_BOOLEAN_VALUE,l=r.injection.HAS_SIDE_EFFECTS,c=r.injection.HAS_NUMERIC_VALUE,u=r.injection.HAS_POSITIVE_NUMERIC_VALUE,d=r.injection.HAS_OVERLOADED_BOOLEAN_VALUE;if(i.canUseDOM){var p=document.implementation;n=p&&p.hasFeature&&p.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}var h={isCustomAttribute:RegExp.prototype.test.bind(/^(data|aria)-[a-z_][a-z\d_.\-]*$/),Properties:{accept:null,accessKey:null,action:null,allowFullScreen:o|s,allowTransparency:o,alt:null,async:s,autoComplete:null,autoPlay:s,cellPadding:null,cellSpacing:null,charSet:o,checked:a|s,className:n?o:a,cols:o|u,colSpan:null,content:null,contentEditable:null,contextMenu:o,controls:a|s,coords:null,crossOrigin:null,data:null,dateTime:o,defer:s,dir:null,disabled:o|s,download:d,draggable:null,encType:null,form:o,formNoValidate:s,frameBorder:o,height:o,hidden:o|s,href:null,hrefLang:null,htmlFor:null,httpEquiv:null,icon:null,id:a,label:null,lang:null,list:null,loop:a|s,max:null,maxLength:o,media:o,mediaGroup:null,method:null,min:null,multiple:a|s,muted:a|s,name:null,noValidate:s,open:null,pattern:null,placeholder:null,poster:null,preload:null,radioGroup:null,readOnly:a|s,rel:null,required:s,role:o,rows:o|u,rowSpan:null,sandbox:null,scope:null,scrollLeft:a,scrolling:null,scrollTop:a,seamless:o|s,selected:a|s,shape:null,size:o|u,sizes:o,span:u,spellCheck:null,src:null,srcDoc:a,srcSet:o,start:c,step:null,style:null,tabIndex:null,target:null,title:null,type:null,useMap:null,value:a|l,width:o,wmode:o,autoCapitalize:null,autoCorrect:null,itemProp:o,itemScope:o|s,itemType:o,property:null},DOMAttributeNames:{className:"class",htmlFor:"for",httpEquiv:"http-equiv"},DOMPropertyNames:{autoCapitalize:"autocapitalize",autoComplete:"autocomplete",autoCorrect:"autocorrect",autoFocus:"autofocus",autoPlay:"autoplay",encType:"enctype",hrefLang:"hreflang",radioGroup:"radiogroup",spellCheck:"spellcheck",srcDoc:"srcdoc",srcSet:"srcset"}};t.exports=h},{"./DOMProperty":11,"./ExecutionEnvironment":22}],24:[function(e,t){"use strict";var n=e("./ReactLink"),r=e("./ReactStateSetters"),i={linkState:function(e){return new n(this.state[e],r.createStateKeySetter(this,e))}};t.exports=i},{"./ReactLink":65,"./ReactStateSetters":81}],25:[function(e,t){"use strict";function n(e){l(null==e.props.checkedLink||null==e.props.valueLink,"Cannot provide a checkedLink and a valueLink. If you want to use checkedLink, you probably don't want to use valueLink and vice versa.")}function r(e){n(e),l(null==e.props.value&&null==e.props.onChange,"Cannot provide a valueLink and a value or onChange event. If you want to use value or onChange, you probably don't want to use valueLink.")}function i(e){n(e),l(null==e.props.checked&&null==e.props.onChange,"Cannot provide a checkedLink and a checked property or onChange event. If you want to use checked or onChange, you probably don't want to use checkedLink")}function o(e){this.props.valueLink.requestChange(e.target.value)}function a(e){this.props.checkedLink.requestChange(e.target.checked)}var s=e("./ReactPropTypes"),l=e("./invariant"),c={button:!0,checkbox:!0,image:!0,hidden:!0,radio:!0,reset:!0,submit:!0},u={Mixin:{propTypes:{value:function(e,t){return!e[t]||c[e.type]||e.onChange||e.readOnly||e.disabled?void 0:new Error("You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`.")},checked:function(e,t){return!e[t]||e.onChange||e.readOnly||e.disabled?void 0:new Error("You provided a `checked` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultChecked`. Otherwise, set either `onChange` or `readOnly`.")},onChange:s.func}},getValue:function(e){return e.props.valueLink?(r(e),e.props.valueLink.value):e.props.value},getChecked:function(e){return e.props.checkedLink?(i(e),e.props.checkedLink.value):e.props.checked},getOnChange:function(e){return e.props.valueLink?(r(e),o):e.props.checkedLink?(i(e),a):e.props.onChange}};t.exports=u},{"./ReactPropTypes":75,"./invariant":134}],26:[function(e,t){"use strict";function n(e){e.remove()}var r=e("./ReactBrowserEventEmitter"),i=e("./accumulate"),o=e("./forEachAccumulated"),a=e("./invariant"),s={trapBubbledEvent:function(e,t){a(this.isMounted(),"Must be mounted to trap events");var n=r.trapBubbledEvent(e,t,this.getDOMNode());this._localEventListeners=i(this._localEventListeners,n)},componentWillUnmount:function(){this._localEventListeners&&o(this._localEventListeners,n)}};t.exports=s},{"./ReactBrowserEventEmitter":31,"./accumulate":106,"./forEachAccumulated":121,"./invariant":134}],27:[function(e,t){"use strict";var n=e("./EventConstants"),r=e("./emptyFunction"),i=n.topLevelTypes,o={eventTypes:null,extractEvents:function(e,t,n,o){if(e===i.topTouchStart){var a=o.target;a&&!a.onclick&&(a.onclick=r)}}};t.exports=o},{"./EventConstants":16,"./emptyFunction":116}],28:[function(e,t){"use strict";var n=e("./invariant"),r=function(e){var t=this;if(t.instancePool.length){var n=t.instancePool.pop();return t.call(n,e),n}return new t(e)},i=function(e,t){var n=this;if(n.instancePool.length){var r=n.instancePool.pop();return n.call(r,e,t),r}return new n(e,t)},o=function(e,t,n){var r=this;if(r.instancePool.length){var i=r.instancePool.pop();return r.call(i,e,t,n),i}return new r(e,t,n)},a=function(e,t,n,r,i){var o=this;if(o.instancePool.length){var a=o.instancePool.pop();return o.call(a,e,t,n,r,i),a}return new o(e,t,n,r,i)},s=function(e){var t=this;n(e instanceof t,"Trying to release an instance into a pool of a different type."),e.destructor&&e.destructor(),t.instancePool.length<t.poolSize&&t.instancePool.push(e)},l=10,c=r,u=function(e,t){var n=e;return n.instancePool=[],n.getPooled=t||c,n.poolSize||(n.poolSize=l),n.release=s,n},d={addPoolingTo:u,oneArgumentPooler:r,twoArgumentPooler:i,threeArgumentPooler:o,fiveArgumentPooler:a};t.exports=d},{"./invariant":134}],29:[function(e,t){"use strict";function n(e){var t=Array.prototype.slice.call(arguments,1);return e.apply(null,t)}var r=e("./DOMPropertyOperations"),i=e("./EventPluginUtils"),o=e("./ReactChildren"),a=e("./ReactComponent"),s=e("./ReactCompositeComponent"),l=e("./ReactContext"),c=e("./ReactCurrentOwner"),u=e("./ReactDescriptor"),d=e("./ReactDOM"),p=e("./ReactDOMComponent"),h=e("./ReactDefaultInjection"),f=e("./ReactInstanceHandles"),m=e("./ReactMount"),g=e("./ReactMultiChild"),v=e("./ReactPerf"),y=e("./ReactPropTypes"),_=e("./ReactServerRendering"),E=e("./ReactTextComponent"),b=e("./onlyChild"),S=e("./warning");h.inject();var I=!1,w={Children:{map:o.map,forEach:o.forEach,count:o.count,only:b},DOM:d,PropTypes:y,initializeTouchEvents:function(e){i.useTouchEvents=e},createClass:s.createClass,createDescriptor:function(){return S(I,"React.createDescriptor is deprecated and will be removed in the next version of React. Use React.createElement instead."),I=!0,n.apply(this,arguments)},createElement:n,constructAndRenderComponent:m.constructAndRenderComponent,constructAndRenderComponentByID:m.constructAndRenderComponentByID,renderComponent:v.measure("React","renderComponent",m.renderComponent),renderComponentToString:_.renderComponentToString,renderComponentToStaticMarkup:_.renderComponentToStaticMarkup,unmountComponentAtNode:m.unmountComponentAtNode,isValidClass:u.isValidFactory,isValidComponent:u.isValidDescriptor,withContext:l.withContext,__internals:{Component:a,CurrentOwner:c,DOMComponent:p,DOMPropertyOperations:r,InstanceHandles:f,Mount:m,MultiChild:g,TextComponent:E}},C=e("./ExecutionEnvironment");if(C.canUseDOM&&window.top===window.self&&navigator.userAgent.indexOf("Chrome")>-1){console.debug("Download the React DevTools for a better development experience: http://fb.me/react-devtools");var D=[Array.isArray,Array.prototype.every,Array.prototype.forEach,Array.prototype.indexOf,Array.prototype.map,Date.now,Function.prototype.bind,Object.keys,String.prototype.split,String.prototype.trim,Object.create,Object.freeze];for(var T in D)if(!D[T]){console.error("One or more ES5 shim/shams expected by React are not available: http://fb.me/react-warning-polyfills");break}}w.version="0.11.2",t.exports=w},{"./DOMPropertyOperations":12,"./EventPluginUtils":20,"./ExecutionEnvironment":22,"./ReactChildren":34,"./ReactComponent":35,"./ReactCompositeComponent":38,"./ReactContext":39,"./ReactCurrentOwner":40,"./ReactDOM":41,"./ReactDOMComponent":43,"./ReactDefaultInjection":53,"./ReactDescriptor":56,"./ReactInstanceHandles":64,"./ReactMount":67,"./ReactMultiChild":68,"./ReactPerf":71,"./ReactPropTypes":75,"./ReactServerRendering":79,"./ReactTextComponent":83,"./onlyChild":149,"./warning":158}],30:[function(e,t){"use strict";var n=e("./ReactEmptyComponent"),r=e("./ReactMount"),i=e("./invariant"),o={getDOMNode:function(){return i(this.isMounted(),"getDOMNode(): A component must be mounted to have a DOM node."),n.isNullComponentID(this._rootNodeID)?null:r.getNode(this._rootNodeID)}};t.exports=o},{"./ReactEmptyComponent":58,"./ReactMount":67,"./invariant":134}],31:[function(e,t){"use strict";function n(e){return Object.prototype.hasOwnProperty.call(e,f)||(e[f]=p++,u[e[f]]={}),u[e[f]]}var r=e("./EventConstants"),i=e("./EventPluginHub"),o=e("./EventPluginRegistry"),a=e("./ReactEventEmitterMixin"),s=e("./ViewportMetrics"),l=e("./isEventSupported"),c=e("./merge"),u={},d=!1,p=0,h={topBlur:"blur",topChange:"change",topClick:"click",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topScroll:"scroll",topSelectionChange:"selectionchange",topTextInput:"textInput",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topWheel:"wheel"},f="_reactListenersID"+String(Math.random()).slice(2),m=c(a,{ReactEventListener:null,injection:{injectReactEventListener:function(e){e.setHandleTopLevel(m.handleTopLevel),m.ReactEventListener=e}},setEnabled:function(e){m.ReactEventListener&&m.ReactEventListener.setEnabled(e)},isEnabled:function(){return!(!m.ReactEventListener||!m.ReactEventListener.isEnabled())},listenTo:function(e,t){for(var i=t,a=n(i),s=o.registrationNameDependencies[e],c=r.topLevelTypes,u=0,d=s.length;d>u;u++){var p=s[u];a.hasOwnProperty(p)&&a[p]||(p===c.topWheel?l("wheel")?m.ReactEventListener.trapBubbledEvent(c.topWheel,"wheel",i):l("mousewheel")?m.ReactEventListener.trapBubbledEvent(c.topWheel,"mousewheel",i):m.ReactEventListener.trapBubbledEvent(c.topWheel,"DOMMouseScroll",i):p===c.topScroll?l("scroll",!0)?m.ReactEventListener.trapCapturedEvent(c.topScroll,"scroll",i):m.ReactEventListener.trapBubbledEvent(c.topScroll,"scroll",m.ReactEventListener.WINDOW_HANDLE):p===c.topFocus||p===c.topBlur?(l("focus",!0)?(m.ReactEventListener.trapCapturedEvent(c.topFocus,"focus",i),m.ReactEventListener.trapCapturedEvent(c.topBlur,"blur",i)):l("focusin")&&(m.ReactEventListener.trapBubbledEvent(c.topFocus,"focusin",i),m.ReactEventListener.trapBubbledEvent(c.topBlur,"focusout",i)),a[c.topBlur]=!0,a[c.topFocus]=!0):h.hasOwnProperty(p)&&m.ReactEventListener.trapBubbledEvent(p,h[p],i),a[p]=!0)}},trapBubbledEvent:function(e,t,n){return m.ReactEventListener.trapBubbledEvent(e,t,n)},trapCapturedEvent:function(e,t,n){return m.ReactEventListener.trapCapturedEvent(e,t,n)},ensureScrollValueMonitoring:function(){if(!d){var e=s.refreshScrollValues;m.ReactEventListener.monitorScrollValue(e),d=!0}},eventNameDispatchConfigs:i.eventNameDispatchConfigs,registrationNameModules:i.registrationNameModules,putListener:i.putListener,getListener:i.getListener,deleteListener:i.deleteListener,deleteAllListeners:i.deleteAllListeners});t.exports=m},{"./EventConstants":16,"./EventPluginHub":18,"./EventPluginRegistry":19,"./ReactEventEmitterMixin":60,"./ViewportMetrics":105,"./isEventSupported":135,"./merge":144}],32:[function(e,t){"use strict";var n=e("./React"),r=e("./ReactTransitionGroup"),i=e("./ReactCSSTransitionGroupChild"),o=n.createClass({displayName:"ReactCSSTransitionGroup",propTypes:{transitionName:n.PropTypes.string.isRequired,transitionEnter:n.PropTypes.bool,transitionLeave:n.PropTypes.bool},getDefaultProps:function(){return{transitionEnter:!0,transitionLeave:!0}},_wrapChild:function(e){return i({name:this.props.transitionName,enter:this.props.transitionEnter,leave:this.props.transitionLeave},e)},render:function(){return this.transferPropsTo(r({childFactory:this._wrapChild},this.props.children))}});t.exports=o},{"./React":29,"./ReactCSSTransitionGroupChild":33,"./ReactTransitionGroup":86}],33:[function(e,t){"use strict";var n=e("./React"),r=e("./CSSCore"),i=e("./ReactTransitionEvents"),o=e("./onlyChild"),a=17,s=5e3,l=null;l=function(){console.warn("transition(): tried to perform an animation without an animationend or transitionend event after timeout ("+s+"ms). You should either disable this transition in JS or add a CSS animation/transition.")};var c=n.createClass({displayName:"ReactCSSTransitionGroupChild",transition:function(e,t){var n=this.getDOMNode(),o=this.props.name+"-"+e,a=o+"-active",c=null,u=function(){clearTimeout(c),r.removeClass(n,o),r.removeClass(n,a),i.removeEndEventListener(n,u),t&&t()};i.addEndEventListener(n,u),r.addClass(n,o),this.queueClass(a),c=setTimeout(l,s)},queueClass:function(e){this.classNameQueue.push(e),this.timeout||(this.timeout=setTimeout(this.flushClassNameQueue,a))},flushClassNameQueue:function(){this.isMounted()&&this.classNameQueue.forEach(r.addClass.bind(r,this.getDOMNode())),this.classNameQueue.length=0,this.timeout=null},componentWillMount:function(){this.classNameQueue=[]},componentWillUnmount:function(){this.timeout&&clearTimeout(this.timeout)},componentWillEnter:function(e){this.props.enter?this.transition("enter",e):e()},componentWillLeave:function(e){this.props.leave?this.transition("leave",e):e()},render:function(){return o(this.props.children)}});t.exports=c},{"./CSSCore":3,"./React":29,"./ReactTransitionEvents":85,"./onlyChild":149}],34:[function(e,t){"use strict";function n(e,t){this.forEachFunction=e,this.forEachContext=t}function r(e,t,n,r){var i=e;i.forEachFunction.call(i.forEachContext,t,r)}function i(e,t,i){if(null==e)return e;var o=n.getPooled(t,i);d(e,r,o),n.release(o)}function o(e,t,n){this.mapResult=e,this.mapFunction=t,this.mapContext=n}function a(e,t,n,r){var i=e,o=i.mapResult,a=!o.hasOwnProperty(n);if(p(a,"ReactChildren.map(...): Encountered two children with the same key, `%s`. Child keys must be unique; when two children share a key, only the first child will be used.",n),a){var s=i.mapFunction.call(i.mapContext,t,r);o[n]=s}}function s(e,t,n){if(null==e)return e;var r={},i=o.getPooled(r,t,n);return d(e,a,i),o.release(i),r}function l(){return null}function c(e){return d(e,l,null)}var u=e("./PooledClass"),d=e("./traverseAllChildren"),p=e("./warning"),h=u.twoArgumentPooler,f=u.threeArgumentPooler;u.addPoolingTo(n,h),u.addPoolingTo(o,f);var m={forEach:i,map:s,count:c};t.exports=m},{"./PooledClass":28,"./traverseAllChildren":156,"./warning":158}],35:[function(e,t){"use strict";var n=e("./ReactDescriptor"),r=e("./ReactOwner"),i=e("./ReactUpdates"),o=e("./invariant"),a=e("./keyMirror"),s=e("./merge"),l=a({MOUNTED:null,UNMOUNTED:null}),c=!1,u=null,d=null,p={injection:{injectEnvironment:function(e){o(!c,"ReactComponent: injectEnvironment() can only be called once."),d=e.mountImageIntoNode,u=e.unmountIDFromEnvironment,p.BackendIDOperations=e.BackendIDOperations,c=!0}},LifeCycle:l,BackendIDOperations:null,Mixin:{isMounted:function(){return this._lifeCycleState===l.MOUNTED},setProps:function(e,t){var n=this._pendingDescriptor||this._descriptor;this.replaceProps(s(n.props,e),t)},replaceProps:function(e,t){o(this.isMounted(),"replaceProps(...): Can only update a mounted component."),o(0===this._mountDepth,"replaceProps(...): You called `setProps` or `replaceProps` on a component with a parent. This is an anti-pattern since props will get reactively updated when rendered. Instead, change the owner's `render` method to pass the correct value as props to the component where it is created."),this._pendingDescriptor=n.cloneAndReplaceProps(this._pendingDescriptor||this._descriptor,e),i.enqueueUpdate(this,t)},_setPropsInternal:function(e,t){var r=this._pendingDescriptor||this._descriptor;this._pendingDescriptor=n.cloneAndReplaceProps(r,s(r.props,e)),i.enqueueUpdate(this,t)},construct:function(e){this.props=e.props,this._owner=e._owner,this._lifeCycleState=l.UNMOUNTED,this._pendingCallbacks=null,this._descriptor=e,this._pendingDescriptor=null},mountComponent:function(e,t,n){o(!this.isMounted(),"mountComponent(%s, ...): Can only mount an unmounted component. Make sure to avoid storing components between renders or reusing a single component instance in multiple places.",e);var i=this._descriptor.props;if(null!=i.ref){var a=this._descriptor._owner;r.addComponentAsRefTo(this,i.ref,a)}this._rootNodeID=e,this._lifeCycleState=l.MOUNTED,this._mountDepth=n},unmountComponent:function(){o(this.isMounted(),"unmountComponent(): Can only unmount a mounted component.");var e=this.props;null!=e.ref&&r.removeComponentAsRefFrom(this,e.ref,this._owner),u(this._rootNodeID),this._rootNodeID=null,this._lifeCycleState=l.UNMOUNTED},receiveComponent:function(e,t){o(this.isMounted(),"receiveComponent(...): Can only update a mounted component."),this._pendingDescriptor=e,this.performUpdateIfNecessary(t)},performUpdateIfNecessary:function(e){if(null!=this._pendingDescriptor){var t=this._descriptor,n=this._pendingDescriptor;this._descriptor=n,this.props=n.props,this._owner=n._owner,this._pendingDescriptor=null,this.updateComponent(e,t)}},updateComponent:function(e,t){var n=this._descriptor;(n._owner!==t._owner||n.props.ref!==t.props.ref)&&(null!=t.props.ref&&r.removeComponentAsRefFrom(this,t.props.ref,t._owner),null!=n.props.ref&&r.addComponentAsRefTo(this,n.props.ref,n._owner))},mountComponentIntoNode:function(e,t,n){var r=i.ReactReconcileTransaction.getPooled();r.perform(this._mountComponentIntoNode,this,e,t,r,n),i.ReactReconcileTransaction.release(r)},_mountComponentIntoNode:function(e,t,n,r){var i=this.mountComponent(e,n,0);d(i,t,r)},isOwnedBy:function(e){return this._owner===e},getSiblingByRef:function(e){var t=this._owner;return t&&t.refs?t.refs[e]:null}}};t.exports=p},{"./ReactDescriptor":56,"./ReactOwner":70,"./ReactUpdates":87,"./invariant":134,"./keyMirror":140,"./merge":144}],36:[function(e,t){"use strict";var n=e("./ReactDOMIDOperations"),r=e("./ReactMarkupChecksum"),i=e("./ReactMount"),o=e("./ReactPerf"),a=e("./ReactReconcileTransaction"),s=e("./getReactRootElementInContainer"),l=e("./invariant"),c=e("./setInnerHTML"),u=1,d=9,p={ReactReconcileTransaction:a,BackendIDOperations:n,unmountIDFromEnvironment:function(e){i.purgeID(e)},mountImageIntoNode:o.measure("ReactComponentBrowserEnvironment","mountImageIntoNode",function(e,t,n){if(l(t&&(t.nodeType===u||t.nodeType===d),"mountComponentIntoNode(...): Target container is not valid."),n){if(r.canReuseMarkup(e,s(t)))return;l(t.nodeType!==d,"You're trying to render a component to the document using server rendering but the checksum was invalid. This usually means you rendered a different component type or props on the client from the one on the server, or your render() methods are impure. React cannot handle this case due to cross-browser quirks by rendering at the document root. You should look for environment dependent code in your components and ensure the props are the same client and server side."),console.warn("React attempted to use reuse markup in a container but the checksum was invalid. This generally means that you are using server rendering and the markup generated on the server was not what the client was expecting. React injected new markup to compensate which works but you have lost many of the benefits of server rendering. Instead, figure out why the markup being generated is different on the client or server.")}l(t.nodeType!==d,"You're trying to render a component to the document but you didn't use server rendering. We can't do this without using server rendering due to cross-browser quirks. See renderComponentToString() for server rendering."),c(t,e)})};t.exports=p},{"./ReactDOMIDOperations":45,"./ReactMarkupChecksum":66,"./ReactMount":67,"./ReactPerf":71,"./ReactReconcileTransaction":77,"./getReactRootElementInContainer":128,"./invariant":134,"./setInnerHTML":152}],37:[function(e,t){"use strict";var n=e("./shallowEqual"),r={shouldComponentUpdate:function(e,t){return!n(this.props,e)||!n(this.state,t)}};t.exports=r},{"./shallowEqual":153}],38:[function(e,t){"use strict";function n(e){var t=e._owner||null;return t&&t.constructor&&t.constructor.displayName?" Check the render method of `"+t.constructor.displayName+"`.":""}function r(e,t,n){for(var r in t)t.hasOwnProperty(r)&&C("function"==typeof t[r],"%s: %s type `%s` is invalid; it must be a function, usually from React.PropTypes.",e.displayName||"ReactCompositeComponent",S[n],r)}function i(e,t){var n=P.hasOwnProperty(t)?P[t]:null;U.hasOwnProperty(t)&&C(n===x.OVERRIDE_BASE,"ReactCompositeComponentInterface: You are attempting to override `%s` from your class specification. Ensure that your method names do not overlap with React methods.",t),e.hasOwnProperty(t)&&C(n===x.DEFINE_MANY||n===x.DEFINE_MANY_MERGED,"ReactCompositeComponentInterface: You are attempting to define `%s` on your component more than once. This conflict may be due to a mixin.",t)}function o(e){var t=e._compositeLifeCycleState;C(e.isMounted()||t===F.MOUNTING,"replaceState(...): Can only update a mounted or mounting component."),C(t!==F.RECEIVING_STATE,"replaceState(...): Cannot update during an existing state transition (such as within `render`). This could potentially cause an infinite loop so it is forbidden."),C(t!==F.UNMOUNTING,"replaceState(...): Cannot update while unmounting component. This usually means you called setState() on an unmounted component.")}function a(e,t){C(!f.isValidFactory(t),"ReactCompositeComponent: You're attempting to use a component class as a mixin. Instead, just use a regular object."),C(!f.isValidDescriptor(t),"ReactCompositeComponent: You're attempting to use a component as a mixin. Instead, just use a regular object.");var n=e.prototype;for(var r in t){var o=t[r];if(t.hasOwnProperty(r))if(i(n,r),k.hasOwnProperty(r))k[r](e,o);else{var a=P.hasOwnProperty(r),s=n.hasOwnProperty(r),l=o&&o.__reactDontBind,d="function"==typeof o,p=d&&!a&&!s&&!l;if(p)n.__reactAutoBindMap||(n.__reactAutoBindMap={}),n.__reactAutoBindMap[r]=o,n[r]=o;else if(s){var h=P[r];C(a&&(h===x.DEFINE_MANY_MERGED||h===x.DEFINE_MANY),"ReactCompositeComponent: Unexpected spec policy %s for key %s when mixing in component specs.",h,r),h===x.DEFINE_MANY_MERGED?n[r]=c(n[r],o):h===x.DEFINE_MANY&&(n[r]=u(n[r],o))}else n[r]=o,"function"==typeof o&&t.displayName&&(n[r].displayName=t.displayName+"_"+r)}}}function s(e,t){if(t)for(var n in t){var r=t[n];if(t.hasOwnProperty(n)){var i=n in e,o=r;if(i){var a=e[n],s=typeof a,l=typeof r;C("function"===s&&"function"===l,"ReactCompositeComponent: You are attempting to define `%s` on your component more than once, but that is only supported for functions, which are chained together. This conflict may be due to a mixin.",n),o=u(a,r)}e[n]=o}}}function l(e,t){return C(e&&t&&"object"==typeof e&&"object"==typeof t,"mergeObjectsWithNoDuplicateKeys(): Cannot merge non-objects"),L(t,function(t,n){C(void 0===e[n],"mergeObjectsWithNoDuplicateKeys(): Tried to merge two objects with the same key: %s",n),e[n]=t}),e}function c(e,t){return function(){var n=e.apply(this,arguments),r=t.apply(this,arguments);return null==n?r:null==r?n:l(n,r)}}function u(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}var d=e("./ReactComponent"),p=e("./ReactContext"),h=e("./ReactCurrentOwner"),f=e("./ReactDescriptor"),m=e("./ReactDescriptorValidator"),g=e("./ReactEmptyComponent"),v=e("./ReactErrorUtils"),y=e("./ReactOwner"),_=e("./ReactPerf"),E=e("./ReactPropTransferer"),b=e("./ReactPropTypeLocations"),S=e("./ReactPropTypeLocationNames"),I=e("./ReactUpdates"),w=e("./instantiateReactComponent"),C=e("./invariant"),D=e("./keyMirror"),T=e("./merge"),O=e("./mixInto"),M=e("./monitorCodeUse"),L=e("./mapObject"),R=e("./shouldUpdateReactComponent"),N=e("./warning"),x=D({DEFINE_ONCE:null,DEFINE_MANY:null,OVERRIDE_BASE:null,DEFINE_MANY_MERGED:null}),A=[],P={mixins:x.DEFINE_MANY,statics:x.DEFINE_MANY,propTypes:x.DEFINE_MANY,contextTypes:x.DEFINE_MANY,childContextTypes:x.DEFINE_MANY,getDefaultProps:x.DEFINE_MANY_MERGED,getInitialState:x.DEFINE_MANY_MERGED,getChildContext:x.DEFINE_MANY_MERGED,render:x.DEFINE_ONCE,componentWillMount:x.DEFINE_MANY,componentDidMount:x.DEFINE_MANY,componentWillReceiveProps:x.DEFINE_MANY,shouldComponentUpdate:x.DEFINE_ONCE,componentWillUpdate:x.DEFINE_MANY,componentDidUpdate:x.DEFINE_MANY,componentWillUnmount:x.DEFINE_MANY,updateComponent:x.OVERRIDE_BASE},k={displayName:function(e,t){e.displayName=t},mixins:function(e,t){if(t)for(var n=0;n<t.length;n++)a(e,t[n])},childContextTypes:function(e,t){r(e,t,b.childContext),e.childContextTypes=T(e.childContextTypes,t)},contextTypes:function(e,t){r(e,t,b.context),e.contextTypes=T(e.contextTypes,t)},getDefaultProps:function(e,t){e.getDefaultProps=e.getDefaultProps?c(e.getDefaultProps,t):t},propTypes:function(e,t){r(e,t,b.prop),e.propTypes=T(e.propTypes,t)},statics:function(e,t){s(e,t)}},F=D({MOUNTING:null,UNMOUNTING:null,RECEIVING_PROPS:null,RECEIVING_STATE:null}),U={construct:function(){d.Mixin.construct.apply(this,arguments),y.Mixin.construct.apply(this,arguments),this.state=null,this._pendingState=null,this.context=null,this._compositeLifeCycleState=null},isMounted:function(){return d.Mixin.isMounted.call(this)&&this._compositeLifeCycleState!==F.MOUNTING},mountComponent:_.measure("ReactCompositeComponent","mountComponent",function(e,t,n){d.Mixin.mountComponent.call(this,e,t,n),this._compositeLifeCycleState=F.MOUNTING,this.__reactAutoBindMap&&this._bindAutoBindMethods(),this.context=this._processContext(this._descriptor._context),this.props=this._processProps(this.props),this.state=this.getInitialState?this.getInitialState():null,C("object"==typeof this.state&&!Array.isArray(this.state),"%s.getInitialState(): must return an object or null",this.constructor.displayName||"ReactCompositeComponent"),this._pendingState=null,this._pendingForceUpdate=!1,this.componentWillMount&&(this.componentWillMount(),this._pendingState&&(this.state=this._pendingState,this._pendingState=null)),this._renderedComponent=w(this._renderValidatedComponent()),this._compositeLifeCycleState=null;var r=this._renderedComponent.mountComponent(e,t,n+1);return this.componentDidMount&&t.getReactMountReady().enqueue(this.componentDidMount,this),r}),unmountComponent:function(){this._compositeLifeCycleState=F.UNMOUNTING,this.componentWillUnmount&&this.componentWillUnmount(),this._compositeLifeCycleState=null,this._renderedComponent.unmountComponent(),this._renderedComponent=null,d.Mixin.unmountComponent.call(this)},setState:function(e,t){C("object"==typeof e||null==e,"setState(...): takes an object of state variables to update."),N(null!=e,"setState(...): You passed an undefined or null state object; instead, use forceUpdate()."),this.replaceState(T(this._pendingState||this.state,e),t)},replaceState:function(e,t){o(this),this._pendingState=e,this._compositeLifeCycleState!==F.MOUNTING&&I.enqueueUpdate(this,t)},_processContext:function(e){var t=null,n=this.constructor.contextTypes;if(n){t={};for(var r in n)t[r]=e[r];this._checkPropTypes(n,t,b.context)}return t},_processChildContext:function(e){var t=this.getChildContext&&this.getChildContext(),n=this.constructor.displayName||"ReactCompositeComponent";if(t){C("object"==typeof this.constructor.childContextTypes,"%s.getChildContext(): childContextTypes must be defined in order to use getChildContext().",n),this._checkPropTypes(this.constructor.childContextTypes,t,b.childContext);for(var r in t)C(r in this.constructor.childContextTypes,'%s.getChildContext(): key "%s" is not defined in childContextTypes.',n,r);return T(e,t)}return e},_processProps:function(e){var t,n=this.constructor.defaultProps;if(n){t=T(e);for(var r in n)"undefined"==typeof t[r]&&(t[r]=n[r])}else t=e;var i=this.constructor.propTypes;return i&&this._checkPropTypes(i,t,b.prop),t},_checkPropTypes:function(e,t,r){var i=this.constructor.displayName;for(var o in e)if(e.hasOwnProperty(o)){var a=e[o](t,o,i,r);if(a instanceof Error){var s=n(this);N(!1,a.message+s)}}},performUpdateIfNecessary:function(e){var t=this._compositeLifeCycleState;if(t!==F.MOUNTING&&t!==F.RECEIVING_PROPS&&(null!=this._pendingDescriptor||null!=this._pendingState||this._pendingForceUpdate)){var n=this.context,r=this.props,i=this._descriptor;
null!=this._pendingDescriptor&&(i=this._pendingDescriptor,n=this._processContext(i._context),r=this._processProps(i.props),this._pendingDescriptor=null,this._compositeLifeCycleState=F.RECEIVING_PROPS,this.componentWillReceiveProps&&this.componentWillReceiveProps(r,n)),this._compositeLifeCycleState=F.RECEIVING_STATE;var o=this._pendingState||this.state;this._pendingState=null;try{var a=this._pendingForceUpdate||!this.shouldComponentUpdate||this.shouldComponentUpdate(r,o,n);"undefined"==typeof a&&console.warn((this.constructor.displayName||"ReactCompositeComponent")+".shouldComponentUpdate(): Returned undefined instead of a boolean value. Make sure to return true or false."),a?(this._pendingForceUpdate=!1,this._performComponentUpdate(i,r,o,n,e)):(this._descriptor=i,this.props=r,this.state=o,this.context=n,this._owner=i._owner)}finally{this._compositeLifeCycleState=null}}},_performComponentUpdate:function(e,t,n,r,i){var o=this._descriptor,a=this.props,s=this.state,l=this.context;this.componentWillUpdate&&this.componentWillUpdate(t,n,r),this._descriptor=e,this.props=t,this.state=n,this.context=r,this._owner=e._owner,this.updateComponent(i,o),this.componentDidUpdate&&i.getReactMountReady().enqueue(this.componentDidUpdate.bind(this,a,s,l),this)},receiveComponent:function(e,t){(e!==this._descriptor||null==e._owner)&&d.Mixin.receiveComponent.call(this,e,t)},updateComponent:_.measure("ReactCompositeComponent","updateComponent",function(e,t){d.Mixin.updateComponent.call(this,e,t);var n=this._renderedComponent,r=n._descriptor,i=this._renderValidatedComponent();if(R(r,i))n.receiveComponent(i,e);else{var o=this._rootNodeID,a=n._rootNodeID;n.unmountComponent(),this._renderedComponent=w(i);var s=this._renderedComponent.mountComponent(o,e,this._mountDepth+1);d.BackendIDOperations.dangerouslyReplaceNodeWithMarkupByID(a,s)}}),forceUpdate:function(e){var t=this._compositeLifeCycleState;C(this.isMounted()||t===F.MOUNTING,"forceUpdate(...): Can only force an update on mounted or mounting components."),C(t!==F.RECEIVING_STATE&&t!==F.UNMOUNTING,"forceUpdate(...): Cannot force an update while unmounting component or during an existing state transition (such as within `render`)."),this._pendingForceUpdate=!0,I.enqueueUpdate(this,e)},_renderValidatedComponent:_.measure("ReactCompositeComponent","_renderValidatedComponent",function(){var e,t=p.current;p.current=this._processChildContext(this._descriptor._context),h.current=this;try{e=this.render(),null===e||e===!1?(e=g.getEmptyComponent(),g.registerNullComponentID(this._rootNodeID)):g.deregisterNullComponentID(this._rootNodeID)}finally{p.current=t,h.current=null}return C(f.isValidDescriptor(e),"%s.render(): A valid ReactComponent must be returned. You may have returned undefined, an array or some other invalid object.",this.constructor.displayName||"ReactCompositeComponent"),e}),_bindAutoBindMethods:function(){for(var e in this.__reactAutoBindMap)if(this.__reactAutoBindMap.hasOwnProperty(e)){var t=this.__reactAutoBindMap[e];this[e]=this._bindAutoBindMethod(v.guard(t,this.constructor.displayName+"."+e))}},_bindAutoBindMethod:function(e){var t=this,n=function(){return e.apply(t,arguments)};n.__reactBoundContext=t,n.__reactBoundMethod=e,n.__reactBoundArguments=null;var r=t.constructor.displayName,i=n.bind;return n.bind=function(o){var a=Array.prototype.slice.call(arguments,1);if(o!==t&&null!==o)M("react_bind_warning",{component:r}),console.warn("bind(): React component methods may only be bound to the component instance. See "+r);else if(!a.length)return M("react_bind_warning",{component:r}),console.warn("bind(): You are binding a component method to the component. React does this for you automatically in a high-performance way, so you can safely remove this call. See "+r),n;var s=i.apply(n,arguments);return s.__reactBoundContext=t,s.__reactBoundMethod=e,s.__reactBoundArguments=a,s},n}},j=function(){};O(j,d.Mixin),O(j,y.Mixin),O(j,E.Mixin),O(j,U);var $={LifeCycle:F,Base:j,createClass:function(e){var t=function(e,t){this.construct(e,t)};t.prototype=new j,t.prototype.constructor=t,A.forEach(a.bind(null,t)),a(t,e),t.getDefaultProps&&(t.defaultProps=t.getDefaultProps()),C(t.prototype.render,"createClass(...): Class specification must implement a `render` method."),t.prototype.componentShouldUpdate&&(M("react_component_should_update_warning",{component:e.displayName}),console.warn((e.displayName||"A component")+" has a method called componentShouldUpdate(). Did you mean shouldComponentUpdate()? The name is phrased as a question because the function is expected to return a value."));for(var n in P)t.prototype[n]||(t.prototype[n]=null);var r=f.createFactory(t);return m.createFactory(r,t.propTypes,t.contextTypes)},injection:{injectMixin:function(e){A.push(e)}}};t.exports=$},{"./ReactComponent":35,"./ReactContext":39,"./ReactCurrentOwner":40,"./ReactDescriptor":56,"./ReactDescriptorValidator":57,"./ReactEmptyComponent":58,"./ReactErrorUtils":59,"./ReactOwner":70,"./ReactPerf":71,"./ReactPropTransferer":72,"./ReactPropTypeLocationNames":73,"./ReactPropTypeLocations":74,"./ReactUpdates":87,"./instantiateReactComponent":133,"./invariant":134,"./keyMirror":140,"./mapObject":142,"./merge":144,"./mixInto":147,"./monitorCodeUse":148,"./shouldUpdateReactComponent":154,"./warning":158}],39:[function(e,t){"use strict";var n=e("./merge"),r={current:{},withContext:function(e,t){var i,o=r.current;r.current=n(o,e);try{i=t()}finally{r.current=o}return i}};t.exports=r},{"./merge":144}],40:[function(e,t){"use strict";var n={current:null};t.exports=n},{}],41:[function(e,t){"use strict";function n(e,t){var n=function(e){this.construct(e)};n.prototype=new o(t,e),n.prototype.constructor=n,n.displayName=t;var a=r.createFactory(n);return i.createFactory(a)}var r=e("./ReactDescriptor"),i=e("./ReactDescriptorValidator"),o=e("./ReactDOMComponent"),a=e("./mergeInto"),s=e("./mapObject"),l=s({a:!1,abbr:!1,address:!1,area:!0,article:!1,aside:!1,audio:!1,b:!1,base:!0,bdi:!1,bdo:!1,big:!1,blockquote:!1,body:!1,br:!0,button:!1,canvas:!1,caption:!1,cite:!1,code:!1,col:!0,colgroup:!1,data:!1,datalist:!1,dd:!1,del:!1,details:!1,dfn:!1,dialog:!1,div:!1,dl:!1,dt:!1,em:!1,embed:!0,fieldset:!1,figcaption:!1,figure:!1,footer:!1,form:!1,h1:!1,h2:!1,h3:!1,h4:!1,h5:!1,h6:!1,head:!1,header:!1,hr:!0,html:!1,i:!1,iframe:!1,img:!0,input:!0,ins:!1,kbd:!1,keygen:!0,label:!1,legend:!1,li:!1,link:!0,main:!1,map:!1,mark:!1,menu:!1,menuitem:!1,meta:!0,meter:!1,nav:!1,noscript:!1,object:!1,ol:!1,optgroup:!1,option:!1,output:!1,p:!1,param:!0,picture:!1,pre:!1,progress:!1,q:!1,rp:!1,rt:!1,ruby:!1,s:!1,samp:!1,script:!1,section:!1,select:!1,small:!1,source:!0,span:!1,strong:!1,style:!1,sub:!1,summary:!1,sup:!1,table:!1,tbody:!1,td:!1,textarea:!1,tfoot:!1,th:!1,thead:!1,time:!1,title:!1,tr:!1,track:!0,u:!1,ul:!1,"var":!1,video:!1,wbr:!0,circle:!1,defs:!1,ellipse:!1,g:!1,line:!1,linearGradient:!1,mask:!1,path:!1,pattern:!1,polygon:!1,polyline:!1,radialGradient:!1,rect:!1,stop:!1,svg:!1,text:!1,tspan:!1},n),c={injectComponentClasses:function(e){a(l,e)}};l.injection=c,t.exports=l},{"./ReactDOMComponent":43,"./ReactDescriptor":56,"./ReactDescriptorValidator":57,"./mapObject":142,"./mergeInto":146}],42:[function(e,t){"use strict";var n=e("./AutoFocusMixin"),r=e("./ReactBrowserComponentMixin"),i=e("./ReactCompositeComponent"),o=e("./ReactDOM"),a=e("./keyMirror"),s=o.button,l=a({onClick:!0,onDoubleClick:!0,onMouseDown:!0,onMouseMove:!0,onMouseUp:!0,onClickCapture:!0,onDoubleClickCapture:!0,onMouseDownCapture:!0,onMouseMoveCapture:!0,onMouseUpCapture:!0}),c=i.createClass({displayName:"ReactDOMButton",mixins:[n,r],render:function(){var e={};for(var t in this.props)!this.props.hasOwnProperty(t)||this.props.disabled&&l[t]||(e[t]=this.props[t]);return s(e,this.props.children)}});t.exports=c},{"./AutoFocusMixin":1,"./ReactBrowserComponentMixin":30,"./ReactCompositeComponent":38,"./ReactDOM":41,"./keyMirror":140}],43:[function(e,t){"use strict";function n(e){e&&(m(null==e.children||null==e.dangerouslySetInnerHTML,"Can only set one of `children` or `props.dangerouslySetInnerHTML`."),m(null==e.style||"object"==typeof e.style,"The `style` prop expects a mapping from style properties to values, not a string."))}function r(e,t,n,r){var i=d.findReactContainerForID(e);if(i){var o=i.nodeType===w?i.ownerDocument:i;E(t,o)}r.getPutListenerQueue().enqueuePutListener(e,t,n)}function i(e,t){this._tagOpen="<"+e,this._tagClose=t?"":"</"+e+">",this.tagName=e.toUpperCase()}var o=e("./CSSPropertyOperations"),a=e("./DOMProperty"),s=e("./DOMPropertyOperations"),l=e("./ReactBrowserComponentMixin"),c=e("./ReactComponent"),u=e("./ReactBrowserEventEmitter"),d=e("./ReactMount"),p=e("./ReactMultiChild"),h=e("./ReactPerf"),f=e("./escapeTextForBrowser"),m=e("./invariant"),g=e("./keyOf"),v=e("./merge"),y=e("./mixInto"),_=u.deleteListener,E=u.listenTo,b=u.registrationNameModules,S={string:!0,number:!0},I=g({style:null}),w=1;i.Mixin={mountComponent:h.measure("ReactDOMComponent","mountComponent",function(e,t,r){return c.Mixin.mountComponent.call(this,e,t,r),n(this.props),this._createOpenTagMarkupAndPutListeners(t)+this._createContentMarkup(t)+this._tagClose}),_createOpenTagMarkupAndPutListeners:function(e){var t=this.props,n=this._tagOpen;for(var i in t)if(t.hasOwnProperty(i)){var a=t[i];if(null!=a)if(b.hasOwnProperty(i))r(this._rootNodeID,i,a,e);else{i===I&&(a&&(a=t.style=v(t.style)),a=o.createMarkupForStyles(a));var l=s.createMarkupForProperty(i,a);l&&(n+=" "+l)}}if(e.renderToStaticMarkup)return n+">";var c=s.createMarkupForID(this._rootNodeID);return n+" "+c+">"},_createContentMarkup:function(e){var t=this.props.dangerouslySetInnerHTML;if(null!=t){if(null!=t.__html)return t.__html}else{var n=S[typeof this.props.children]?this.props.children:null,r=null!=n?null:this.props.children;if(null!=n)return f(n);if(null!=r){var i=this.mountChildren(r,e);return i.join("")}}return""},receiveComponent:function(e,t){(e!==this._descriptor||null==e._owner)&&c.Mixin.receiveComponent.call(this,e,t)},updateComponent:h.measure("ReactDOMComponent","updateComponent",function(e,t){n(this._descriptor.props),c.Mixin.updateComponent.call(this,e,t),this._updateDOMProperties(t.props,e),this._updateDOMChildren(t.props,e)}),_updateDOMProperties:function(e,t){var n,i,o,s=this.props;for(n in e)if(!s.hasOwnProperty(n)&&e.hasOwnProperty(n))if(n===I){var l=e[n];for(i in l)l.hasOwnProperty(i)&&(o=o||{},o[i]="")}else b.hasOwnProperty(n)?_(this._rootNodeID,n):(a.isStandardName[n]||a.isCustomAttribute(n))&&c.BackendIDOperations.deletePropertyByID(this._rootNodeID,n);for(n in s){var u=s[n],d=e[n];if(s.hasOwnProperty(n)&&u!==d)if(n===I)if(u&&(u=s.style=v(u)),d){for(i in d)!d.hasOwnProperty(i)||u&&u.hasOwnProperty(i)||(o=o||{},o[i]="");for(i in u)u.hasOwnProperty(i)&&d[i]!==u[i]&&(o=o||{},o[i]=u[i])}else o=u;else b.hasOwnProperty(n)?r(this._rootNodeID,n,u,t):(a.isStandardName[n]||a.isCustomAttribute(n))&&c.BackendIDOperations.updatePropertyByID(this._rootNodeID,n,u)}o&&c.BackendIDOperations.updateStylesByID(this._rootNodeID,o)},_updateDOMChildren:function(e,t){var n=this.props,r=S[typeof e.children]?e.children:null,i=S[typeof n.children]?n.children:null,o=e.dangerouslySetInnerHTML&&e.dangerouslySetInnerHTML.__html,a=n.dangerouslySetInnerHTML&&n.dangerouslySetInnerHTML.__html,s=null!=r?null:e.children,l=null!=i?null:n.children,u=null!=r||null!=o,d=null!=i||null!=a;null!=s&&null==l?this.updateChildren(null,t):u&&!d&&this.updateTextContent(""),null!=i?r!==i&&this.updateTextContent(""+i):null!=a?o!==a&&c.BackendIDOperations.updateInnerHTMLByID(this._rootNodeID,a):null!=l&&this.updateChildren(l,t)},unmountComponent:function(){this.unmountChildren(),u.deleteAllListeners(this._rootNodeID),c.Mixin.unmountComponent.call(this)}},y(i,c.Mixin),y(i,i.Mixin),y(i,p.Mixin),y(i,l),t.exports=i},{"./CSSPropertyOperations":5,"./DOMProperty":11,"./DOMPropertyOperations":12,"./ReactBrowserComponentMixin":30,"./ReactBrowserEventEmitter":31,"./ReactComponent":35,"./ReactMount":67,"./ReactMultiChild":68,"./ReactPerf":71,"./escapeTextForBrowser":118,"./invariant":134,"./keyOf":141,"./merge":144,"./mixInto":147}],44:[function(e,t){"use strict";var n=e("./EventConstants"),r=e("./LocalEventTrapMixin"),i=e("./ReactBrowserComponentMixin"),o=e("./ReactCompositeComponent"),a=e("./ReactDOM"),s=a.form,l=o.createClass({displayName:"ReactDOMForm",mixins:[i,r],render:function(){return this.transferPropsTo(s(null,this.props.children))},componentDidMount:function(){this.trapBubbledEvent(n.topLevelTypes.topReset,"reset"),this.trapBubbledEvent(n.topLevelTypes.topSubmit,"submit")}});t.exports=l},{"./EventConstants":16,"./LocalEventTrapMixin":26,"./ReactBrowserComponentMixin":30,"./ReactCompositeComponent":38,"./ReactDOM":41}],45:[function(e,t){"use strict";var n=e("./CSSPropertyOperations"),r=e("./DOMChildrenOperations"),i=e("./DOMPropertyOperations"),o=e("./ReactMount"),a=e("./ReactPerf"),s=e("./invariant"),l=e("./setInnerHTML"),c={dangerouslySetInnerHTML:"`dangerouslySetInnerHTML` must be set using `updateInnerHTMLByID()`.",style:"`style` must be set using `updateStylesByID()`."},u={updatePropertyByID:a.measure("ReactDOMIDOperations","updatePropertyByID",function(e,t,n){var r=o.getNode(e);s(!c.hasOwnProperty(t),"updatePropertyByID(...): %s",c[t]),null!=n?i.setValueForProperty(r,t,n):i.deleteValueForProperty(r,t)}),deletePropertyByID:a.measure("ReactDOMIDOperations","deletePropertyByID",function(e,t,n){var r=o.getNode(e);s(!c.hasOwnProperty(t),"updatePropertyByID(...): %s",c[t]),i.deleteValueForProperty(r,t,n)}),updateStylesByID:a.measure("ReactDOMIDOperations","updateStylesByID",function(e,t){var r=o.getNode(e);n.setValueForStyles(r,t)}),updateInnerHTMLByID:a.measure("ReactDOMIDOperations","updateInnerHTMLByID",function(e,t){var n=o.getNode(e);l(n,t)}),updateTextContentByID:a.measure("ReactDOMIDOperations","updateTextContentByID",function(e,t){var n=o.getNode(e);r.updateTextContent(n,t)}),dangerouslyReplaceNodeWithMarkupByID:a.measure("ReactDOMIDOperations","dangerouslyReplaceNodeWithMarkupByID",function(e,t){var n=o.getNode(e);r.dangerouslyReplaceNodeWithMarkup(n,t)}),dangerouslyProcessChildrenUpdates:a.measure("ReactDOMIDOperations","dangerouslyProcessChildrenUpdates",function(e,t){for(var n=0;n<e.length;n++)e[n].parentNode=o.getNode(e[n].parentID);r.processUpdates(e,t)})};t.exports=u},{"./CSSPropertyOperations":5,"./DOMChildrenOperations":10,"./DOMPropertyOperations":12,"./ReactMount":67,"./ReactPerf":71,"./invariant":134,"./setInnerHTML":152}],46:[function(e,t){"use strict";var n=e("./EventConstants"),r=e("./LocalEventTrapMixin"),i=e("./ReactBrowserComponentMixin"),o=e("./ReactCompositeComponent"),a=e("./ReactDOM"),s=a.img,l=o.createClass({displayName:"ReactDOMImg",tagName:"IMG",mixins:[i,r],render:function(){return s(this.props)},componentDidMount:function(){this.trapBubbledEvent(n.topLevelTypes.topLoad,"load"),this.trapBubbledEvent(n.topLevelTypes.topError,"error")}});t.exports=l},{"./EventConstants":16,"./LocalEventTrapMixin":26,"./ReactBrowserComponentMixin":30,"./ReactCompositeComponent":38,"./ReactDOM":41}],47:[function(e,t){"use strict";var n=e("./AutoFocusMixin"),r=e("./DOMPropertyOperations"),i=e("./LinkedValueUtils"),o=e("./ReactBrowserComponentMixin"),a=e("./ReactCompositeComponent"),s=e("./ReactDOM"),l=e("./ReactMount"),c=e("./invariant"),u=e("./merge"),d=s.input,p={},h=a.createClass({displayName:"ReactDOMInput",mixins:[n,i.Mixin,o],getInitialState:function(){var e=this.props.defaultValue;return{checked:this.props.defaultChecked||!1,value:null!=e?e:null}},shouldComponentUpdate:function(){return!this._isChanging},render:function(){var e=u(this.props);e.defaultChecked=null,e.defaultValue=null;var t=i.getValue(this);e.value=null!=t?t:this.state.value;var n=i.getChecked(this);return e.checked=null!=n?n:this.state.checked,e.onChange=this._handleChange,d(e,this.props.children)},componentDidMount:function(){var e=l.getID(this.getDOMNode());p[e]=this},componentWillUnmount:function(){var e=this.getDOMNode(),t=l.getID(e);delete p[t]},componentDidUpdate:function(){var e=this.getDOMNode();null!=this.props.checked&&r.setValueForProperty(e,"checked",this.props.checked||!1);var t=i.getValue(this);null!=t&&r.setValueForProperty(e,"value",""+t)},_handleChange:function(e){var t,n=i.getOnChange(this);n&&(this._isChanging=!0,t=n.call(this,e),this._isChanging=!1),this.setState({checked:e.target.checked,value:e.target.value});var r=this.props.name;if("radio"===this.props.type&&null!=r){for(var o=this.getDOMNode(),a=o;a.parentNode;)a=a.parentNode;for(var s=a.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),u=0,d=s.length;d>u;u++){var h=s[u];if(h!==o&&h.form===o.form){var f=l.getID(h);c(f,"ReactDOMInput: Mixing React and non-React radio inputs with the same `name` is not supported.");var m=p[f];c(m,"ReactDOMInput: Unknown radio button ID %s.",f),m.setState({checked:!1})}}}return t}});t.exports=h},{"./AutoFocusMixin":1,"./DOMPropertyOperations":12,"./LinkedValueUtils":25,"./ReactBrowserComponentMixin":30,"./ReactCompositeComponent":38,"./ReactDOM":41,"./ReactMount":67,"./invariant":134,"./merge":144}],48:[function(e,t){"use strict";var n=e("./ReactBrowserComponentMixin"),r=e("./ReactCompositeComponent"),i=e("./ReactDOM"),o=e("./warning"),a=i.option,s=r.createClass({displayName:"ReactDOMOption",mixins:[n],componentWillMount:function(){o(null==this.props.selected,"Use the `defaultValue` or `value` props on <select> instead of setting `selected` on <option>.")},render:function(){return a(this.props,this.props.children)}});t.exports=s},{"./ReactBrowserComponentMixin":30,"./ReactCompositeComponent":38,"./ReactDOM":41,"./warning":158}],49:[function(e,t){"use strict";function n(e,t){if(null!=e[t])if(e.multiple){if(!Array.isArray(e[t]))return new Error("The `"+t+"` prop supplied to <select> must be an array if `multiple` is true.")}else if(Array.isArray(e[t]))return new Error("The `"+t+"` prop supplied to <select> must be a scalar value if `multiple` is false.")}function r(e,t){var n,r,i,o=e.props.multiple,a=null!=t?t:e.state.value,s=e.getDOMNode().options;if(o)for(n={},r=0,i=a.length;i>r;++r)n[""+a[r]]=!0;else n=""+a;for(r=0,i=s.length;i>r;r++){var l=o?n.hasOwnProperty(s[r].value):s[r].value===n;l!==s[r].selected&&(s[r].selected=l)}}var i=e("./AutoFocusMixin"),o=e("./LinkedValueUtils"),a=e("./ReactBrowserComponentMixin"),s=e("./ReactCompositeComponent"),l=e("./ReactDOM"),c=e("./merge"),u=l.select,d=s.createClass({displayName:"ReactDOMSelect",mixins:[i,o.Mixin,a],propTypes:{defaultValue:n,value:n},getInitialState:function(){return{value:this.props.defaultValue||(this.props.multiple?[]:"")}},componentWillReceiveProps:function(e){!this.props.multiple&&e.multiple?this.setState({value:[this.state.value]}):this.props.multiple&&!e.multiple&&this.setState({value:this.state.value[0]})},shouldComponentUpdate:function(){return!this._isChanging},render:function(){var e=c(this.props);return e.onChange=this._handleChange,e.value=null,u(e,this.props.children)},componentDidMount:function(){r(this,o.getValue(this))},componentDidUpdate:function(e){var t=o.getValue(this),n=!!e.multiple,i=!!this.props.multiple;(null!=t||n!==i)&&r(this,t)},_handleChange:function(e){var t,n=o.getOnChange(this);n&&(this._isChanging=!0,t=n.call(this,e),this._isChanging=!1);var r;if(this.props.multiple){r=[];for(var i=e.target.options,a=0,s=i.length;s>a;a++)i[a].selected&&r.push(i[a].value)}else r=e.target.value;return this.setState({value:r}),t}});t.exports=d},{"./AutoFocusMixin":1,"./LinkedValueUtils":25,"./ReactBrowserComponentMixin":30,"./ReactCompositeComponent":38,"./ReactDOM":41,"./merge":144}],50:[function(e,t){"use strict";function n(e,t,n,r){return e===n&&t===r}function r(e){var t=document.selection,n=t.createRange(),r=n.text.length,i=n.duplicate();i.moveToElementText(e),i.setEndPoint("EndToStart",n);var o=i.text.length,a=o+r;return{start:o,end:a}}function i(e){var t=window.getSelection();if(0===t.rangeCount)return null;var r=t.anchorNode,i=t.anchorOffset,o=t.focusNode,a=t.focusOffset,s=t.getRangeAt(0),l=n(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),c=l?0:s.toString().length,u=s.cloneRange();u.selectNodeContents(e),u.setEnd(s.startContainer,s.startOffset);var d=n(u.startContainer,u.startOffset,u.endContainer,u.endOffset),p=d?0:u.toString().length,h=p+c,f=document.createRange();f.setStart(r,i),f.setEnd(o,a);var m=f.collapsed;return f.detach(),{start:m?h:p,end:m?p:h}}function o(e,t){var n,r,i=document.selection.createRange().duplicate();"undefined"==typeof t.end?(n=t.start,r=n):t.start>t.end?(n=t.end,r=t.start):(n=t.start,r=t.end),i.moveToElementText(e),i.moveStart("character",n),i.setEndPoint("EndToStart",i),i.moveEnd("character",r-n),i.select()}function a(e,t){var n=window.getSelection(),r=e[c()].length,i=Math.min(t.start,r),o="undefined"==typeof t.end?i:Math.min(t.end,r);if(!n.extend&&i>o){var a=o;o=i,i=a}var s=l(e,i),u=l(e,o);if(s&&u){var d=document.createRange();d.setStart(s.node,s.offset),n.removeAllRanges(),i>o?(n.addRange(d),n.extend(u.node,u.offset)):(d.setEnd(u.node,u.offset),n.addRange(d)),d.detach()}}var s=e("./ExecutionEnvironment"),l=e("./getNodeForCharacterOffset"),c=e("./getTextContentAccessor"),u=s.canUseDOM&&document.selection,d={getOffsets:u?r:i,setOffsets:u?o:a};t.exports=d},{"./ExecutionEnvironment":22,"./getNodeForCharacterOffset":127,"./getTextContentAccessor":129}],51:[function(e,t){"use strict";var n=e("./AutoFocusMixin"),r=e("./DOMPropertyOperations"),i=e("./LinkedValueUtils"),o=e("./ReactBrowserComponentMixin"),a=e("./ReactCompositeComponent"),s=e("./ReactDOM"),l=e("./invariant"),c=e("./merge"),u=e("./warning"),d=s.textarea,p=a.createClass({displayName:"ReactDOMTextarea",mixins:[n,i.Mixin,o],getInitialState:function(){var e=this.props.defaultValue,t=this.props.children;null!=t&&(u(!1,"Use the `defaultValue` or `value` props instead of setting children on <textarea>."),l(null==e,"If you supply `defaultValue` on a <textarea>, do not pass children."),Array.isArray(t)&&(l(t.length<=1,"<textarea> can only have at most one child."),t=t[0]),e=""+t),null==e&&(e="");var n=i.getValue(this);return{initialValue:""+(null!=n?n:e)}},shouldComponentUpdate:function(){return!this._isChanging},render:function(){var e=c(this.props);return l(null==e.dangerouslySetInnerHTML,"`dangerouslySetInnerHTML` does not make sense on <textarea>."),e.defaultValue=null,e.value=null,e.onChange=this._handleChange,d(e,this.state.initialValue)},componentDidUpdate:function(){var e=i.getValue(this);if(null!=e){var t=this.getDOMNode();r.setValueForProperty(t,"value",""+e)}},_handleChange:function(e){var t,n=i.getOnChange(this);return n&&(this._isChanging=!0,t=n.call(this,e),this._isChanging=!1),this.setState({value:e.target.value}),t}});t.exports=p},{"./AutoFocusMixin":1,"./DOMPropertyOperations":12,"./LinkedValueUtils":25,"./ReactBrowserComponentMixin":30,"./ReactCompositeComponent":38,"./ReactDOM":41,"./invariant":134,"./merge":144,"./warning":158}],52:[function(e,t){"use strict";function n(){this.reinitializeTransaction()}var r=e("./ReactUpdates"),i=e("./Transaction"),o=e("./emptyFunction"),a=e("./mixInto"),s={initialize:o,close:function(){d.isBatchingUpdates=!1}},l={initialize:o,close:r.flushBatchedUpdates.bind(r)},c=[l,s];a(n,i.Mixin),a(n,{getTransactionWrappers:function(){return c}});var u=new n,d={isBatchingUpdates:!1,batchedUpdates:function(e,t,n){var r=d.isBatchingUpdates;d.isBatchingUpdates=!0,r?e(t,n):u.perform(e,null,t,n)}};t.exports=d},{"./ReactUpdates":87,"./Transaction":104,"./emptyFunction":116,"./mixInto":147}],53:[function(e,t){"use strict";function n(){w.EventEmitter.injectReactEventListener(I),w.EventPluginHub.injectEventPluginOrder(s),w.EventPluginHub.injectInstanceHandle(C),w.EventPluginHub.injectMount(D),w.EventPluginHub.injectEventPluginsByName({SimpleEventPlugin:M,EnterLeaveEventPlugin:l,ChangeEventPlugin:i,CompositionEventPlugin:a,MobileSafariClickEventPlugin:d,SelectEventPlugin:T,BeforeInputEventPlugin:r}),w.DOM.injectComponentClasses({button:g,form:v,img:y,input:_,option:E,select:b,textarea:S,html:R(m.html),head:R(m.head),body:R(m.body)}),w.CompositeComponent.injectMixin(p),w.DOMProperty.injectDOMPropertyConfig(u),w.DOMProperty.injectDOMPropertyConfig(L),w.EmptyComponent.injectEmptyComponent(m.noscript),w.Updates.injectReconcileTransaction(h.ReactReconcileTransaction),w.Updates.injectBatchingStrategy(f),w.RootIndex.injectCreateReactRootIndex(c.canUseDOM?o.createReactRootIndex:O.createReactRootIndex),w.Component.injectEnvironment(h);var t=c.canUseDOM&&window.location.href||"";if(/[?&]react_perf\b/.test(t)){var n=e("./ReactDefaultPerf");n.start()}}var r=e("./BeforeInputEventPlugin"),i=e("./ChangeEventPlugin"),o=e("./ClientReactRootIndex"),a=e("./CompositionEventPlugin"),s=e("./DefaultEventPluginOrder"),l=e("./EnterLeaveEventPlugin"),c=e("./ExecutionEnvironment"),u=e("./HTMLDOMPropertyConfig"),d=e("./MobileSafariClickEventPlugin"),p=e("./ReactBrowserComponentMixin"),h=e("./ReactComponentBrowserEnvironment"),f=e("./ReactDefaultBatchingStrategy"),m=e("./ReactDOM"),g=e("./ReactDOMButton"),v=e("./ReactDOMForm"),y=e("./ReactDOMImg"),_=e("./ReactDOMInput"),E=e("./ReactDOMOption"),b=e("./ReactDOMSelect"),S=e("./ReactDOMTextarea"),I=e("./ReactEventListener"),w=e("./ReactInjection"),C=e("./ReactInstanceHandles"),D=e("./ReactMount"),T=e("./SelectEventPlugin"),O=e("./ServerReactRootIndex"),M=e("./SimpleEventPlugin"),L=e("./SVGDOMPropertyConfig"),R=e("./createFullPageComponent");t.exports={inject:n}},{"./BeforeInputEventPlugin":2,"./ChangeEventPlugin":7,"./ClientReactRootIndex":8,"./CompositionEventPlugin":9,"./DefaultEventPluginOrder":14,"./EnterLeaveEventPlugin":15,"./ExecutionEnvironment":22,"./HTMLDOMPropertyConfig":23,"./MobileSafariClickEventPlugin":27,"./ReactBrowserComponentMixin":30,"./ReactComponentBrowserEnvironment":36,"./ReactDOM":41,"./ReactDOMButton":42,"./ReactDOMForm":44,"./ReactDOMImg":46,"./ReactDOMInput":47,"./ReactDOMOption":48,"./ReactDOMSelect":49,"./ReactDOMTextarea":51,"./ReactDefaultBatchingStrategy":52,"./ReactDefaultPerf":54,"./ReactEventListener":61,"./ReactInjection":62,"./ReactInstanceHandles":64,"./ReactMount":67,"./SVGDOMPropertyConfig":89,"./SelectEventPlugin":90,"./ServerReactRootIndex":91,"./SimpleEventPlugin":92,"./createFullPageComponent":112}],54:[function(e,t){"use strict";function n(e){return Math.floor(100*e)/100}function r(e,t,n){e[t]=(e[t]||0)+n}var i=e("./DOMProperty"),o=e("./ReactDefaultPerfAnalysis"),a=e("./ReactMount"),s=e("./ReactPerf"),l=e("./performanceNow"),c={_allMeasurements:[],_mountStack:[0],_injected:!1,start:function(){c._injected||s.injection.injectMeasure(c.measure),c._allMeasurements.length=0,s.enableMeasure=!0},stop:function(){s.enableMeasure=!1},getLastMeasurements:function(){return c._allMeasurements},printExclusive:function(e){e=e||c._allMeasurements;var t=o.getExclusiveSummary(e);console.table(t.map(function(e){return{"Component class name":e.componentName,"Total inclusive time (ms)":n(e.inclusive),"Exclusive mount time (ms)":n(e.exclusive),"Exclusive render time (ms)":n(e.render),"Mount time per instance (ms)":n(e.exclusive/e.count),"Render time per instance (ms)":n(e.render/e.count),Instances:e.count}}))},printInclusive:function(e){e=e||c._allMeasurements;var t=o.getInclusiveSummary(e);console.table(t.map(function(e){return{"Owner > component":e.componentName,"Inclusive time (ms)":n(e.time),Instances:e.count}})),console.log("Total time:",o.getTotalTime(e).toFixed(2)+" ms")},printWasted:function(e){e=e||c._allMeasurements;var t=o.getInclusiveSummary(e,!0);console.table(t.map(function(e){return{"Owner > component":e.componentName,"Wasted time (ms)":e.time,Instances:e.count}})),console.log("Total time:",o.getTotalTime(e).toFixed(2)+" ms")},printDOM:function(e){e=e||c._allMeasurements;var t=o.getDOMSummary(e);console.table(t.map(function(e){var t={};return t[i.ID_ATTRIBUTE_NAME]=e.id,t.type=e.type,t.args=JSON.stringify(e.args),t})),console.log("Total time:",o.getTotalTime(e).toFixed(2)+" ms")},_recordWrite:function(e,t,n,r){var i=c._allMeasurements[c._allMeasurements.length-1].writes;i[e]=i[e]||[],i[e].push({type:t,time:n,args:r})},measure:function(e,t,n){return function(){var i,o,s,u=Array.prototype.slice.call(arguments,0);if("_renderNewRootComponent"===t||"flushBatchedUpdates"===t)return c._allMeasurements.push({exclusive:{},inclusive:{},render:{},counts:{},writes:{},displayNames:{},totalTime:0}),s=l(),o=n.apply(this,u),c._allMeasurements[c._allMeasurements.length-1].totalTime=l()-s,o;if("ReactDOMIDOperations"===e||"ReactComponentBrowserEnvironment"===e){if(s=l(),o=n.apply(this,u),i=l()-s,"mountImageIntoNode"===t){var d=a.getID(u[1]);c._recordWrite(d,t,i,u[0])}else"dangerouslyProcessChildrenUpdates"===t?u[0].forEach(function(e){var t={};null!==e.fromIndex&&(t.fromIndex=e.fromIndex),null!==e.toIndex&&(t.toIndex=e.toIndex),null!==e.textContent&&(t.textContent=e.textContent),null!==e.markupIndex&&(t.markup=u[1][e.markupIndex]),c._recordWrite(e.parentID,e.type,i,t)}):c._recordWrite(u[0],t,i,Array.prototype.slice.call(u,1));return o}if("ReactCompositeComponent"!==e||"mountComponent"!==t&&"updateComponent"!==t&&"_renderValidatedComponent"!==t)return n.apply(this,u);var p="mountComponent"===t?u[0]:this._rootNodeID,h="_renderValidatedComponent"===t,f="mountComponent"===t,m=c._mountStack,g=c._allMeasurements[c._allMeasurements.length-1];if(h?r(g.counts,p,1):f&&m.push(0),s=l(),o=n.apply(this,u),i=l()-s,h)r(g.render,p,i);else if(f){var v=m.pop();m[m.length-1]+=i,r(g.exclusive,p,i-v),r(g.inclusive,p,i)}else r(g.inclusive,p,i);return g.displayNames[p]={current:this.constructor.displayName,owner:this._owner?this._owner.constructor.displayName:"<root>"},o}}};t.exports=c},{"./DOMProperty":11,"./ReactDefaultPerfAnalysis":55,"./ReactMount":67,"./ReactPerf":71,"./performanceNow":151}],55:[function(e,t){function n(e){for(var t=0,n=0;n<e.length;n++){var r=e[n];t+=r.totalTime}return t}function r(e){for(var t=[],n=0;n<e.length;n++){var r,i=e[n];for(r in i.writes)i.writes[r].forEach(function(e){t.push({id:r,type:c[e.type]||e.type,args:e.args})})}return t}function i(e){for(var t,n={},r=0;r<e.length;r++){var i=e[r],o=s(i.exclusive,i.inclusive);for(var a in o)t=i.displayNames[a].current,n[t]=n[t]||{componentName:t,inclusive:0,exclusive:0,render:0,count:0},i.render[a]&&(n[t].render+=i.render[a]),i.exclusive[a]&&(n[t].exclusive+=i.exclusive[a]),i.inclusive[a]&&(n[t].inclusive+=i.inclusive[a]),i.counts[a]&&(n[t].count+=i.counts[a])}var c=[];for(t in n)n[t].exclusive>=l&&c.push(n[t]);return c.sort(function(e,t){return t.exclusive-e.exclusive}),c}function o(e,t){for(var n,r={},i=0;i<e.length;i++){var o,c=e[i],u=s(c.exclusive,c.inclusive);t&&(o=a(c));for(var d in u)if(!t||o[d]){var p=c.displayNames[d];n=p.owner+" > "+p.current,r[n]=r[n]||{componentName:n,time:0,count:0},c.inclusive[d]&&(r[n].time+=c.inclusive[d]),c.counts[d]&&(r[n].count+=c.counts[d])}}var h=[];for(n in r)r[n].time>=l&&h.push(r[n]);return h.sort(function(e,t){return t.time-e.time}),h}function a(e){var t={},n=Object.keys(e.writes),r=s(e.exclusive,e.inclusive);for(var i in r){for(var o=!1,a=0;a<n.length;a++)if(0===n[a].indexOf(i)){o=!0;break}!o&&e.counts[i]>0&&(t[i]=!0)}return t}var s=e("./merge"),l=1.2,c={mountImageIntoNode:"set innerHTML",INSERT_MARKUP:"set innerHTML",MOVE_EXISTING:"move",REMOVE_NODE:"remove",TEXT_CONTENT:"set textContent",updatePropertyByID:"update attribute",deletePropertyByID:"delete attribute",updateStylesByID:"update styles",updateInnerHTMLByID:"set innerHTML",dangerouslyReplaceNodeWithMarkupByID:"replace"},u={getExclusiveSummary:i,getInclusiveSummary:o,getDOMSummary:r,getTotalTime:n};t.exports=u},{"./merge":144}],56:[function(e,t){"use strict";function n(e,t){Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:function(){return this._store?this._store[t]:null},set:function(e){l(!1,"Don't set the "+t+" property of the component. Mutate the existing props object instead."),this._store[t]=e}})}function r(e){try{var t={props:!0};for(var r in t)n(e,r);c=!0}catch(i){}}function i(e,t){if("function"==typeof t)for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];
if("function"==typeof r){var i=r.bind(t);for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o]);e[n]=i}else e[n]=r}}var o=e("./ReactContext"),a=e("./ReactCurrentOwner"),s=e("./merge"),l=e("./warning"),c=!1,u=function(){};r(u.prototype),u.createFactory=function(e){var t=Object.create(u.prototype),n=function(e,n){null==e?e={}:"object"==typeof e&&(e=s(e));var r=arguments.length-1;if(1===r)e.children=n;else if(r>1){for(var i=Array(r),l=0;r>l;l++)i[l]=arguments[l+1];e.children=i}var u=Object.create(t);return u._owner=a.current,u._context=o.current,u._store={validated:!1,props:e},c?(Object.freeze(u),u):(u.props=e,u)};return n.prototype=t,n.type=e,t.type=e,i(n,e),t.constructor=n,n},u.cloneAndReplaceProps=function(e,t){var n=Object.create(e.constructor.prototype);return n._owner=e._owner,n._context=e._context,n._store={validated:e._store.validated,props:t},c?(Object.freeze(n),n):(n.props=t,n)},u.isValidFactory=function(e){return"function"==typeof e&&e.prototype instanceof u},u.isValidDescriptor=function(e){return e instanceof u},t.exports=u},{"./ReactContext":39,"./ReactCurrentOwner":40,"./merge":144,"./warning":158}],57:[function(e,t){"use strict";function n(){var e=d.current;return e&&e.constructor.displayName||void 0}function r(e,t){e._store.validated||null!=e.props.key||(e._store.validated=!0,o("react_key_warning",'Each child in an array should have a unique "key" prop.',e,t))}function i(e,t,n){g.test(e)&&o("react_numeric_key_warning","Child objects should have non-numeric keys so ordering is preserved.",t,n)}function o(e,t,r,i){var o=n(),a=i.displayName,s=o||a,l=h[e];if(!l.hasOwnProperty(s)){l[s]=!0,t+=o?" Check the render method of "+o+".":" Check the renderComponent call using <"+a+">.";var c=null;r._owner&&r._owner!==d.current&&(c=r._owner.constructor.displayName,t+=" It was passed a child from "+c+"."),t+=" See http://fb.me/react-warning-keys for more information.",p(e,{component:s,componentOwner:c}),console.warn(t)}}function a(){var e=n()||"";f.hasOwnProperty(e)||(f[e]=!0,p("react_object_map_children"))}function s(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++){var o=e[n];c.isValidDescriptor(o)&&r(o,t)}else if(c.isValidDescriptor(e))e._store.validated=!0;else if(e&&"object"==typeof e){a();for(var s in e)i(s,e[s],t)}}function l(e,t,n,r){for(var i in t)if(t.hasOwnProperty(i)){var o;try{o=t[i](n,i,e,r)}catch(a){o=a}o instanceof Error&&!(o.message in m)&&(m[o.message]=!0,p("react_failed_descriptor_type_check",{message:o.message}))}}var c=e("./ReactDescriptor"),u=e("./ReactPropTypeLocations"),d=e("./ReactCurrentOwner"),p=e("./monitorCodeUse"),h={react_key_warning:{},react_numeric_key_warning:{}},f={},m={},g=/^\d+$/,v={createFactory:function(e,t,n){var r=function(){for(var r=e.apply(this,arguments),i=1;i<arguments.length;i++)s(arguments[i],r.type);var o=r.type.displayName;return t&&l(o,t,r.props,u.prop),n&&l(o,n,r._context,u.context),r};r.prototype=e.prototype,r.type=e.type;for(var i in e)e.hasOwnProperty(i)&&(r[i]=e[i]);return r}};t.exports=v},{"./ReactCurrentOwner":40,"./ReactDescriptor":56,"./ReactPropTypeLocations":74,"./monitorCodeUse":148}],58:[function(e,t){"use strict";function n(){return s(a,"Trying to return null from a render, but no null placeholder component was injected."),a()}function r(e){l[e]=!0}function i(e){delete l[e]}function o(e){return l[e]}var a,s=e("./invariant"),l={},c={injectEmptyComponent:function(e){a=e}},u={deregisterNullComponentID:i,getEmptyComponent:n,injection:c,isNullComponentID:o,registerNullComponentID:r};t.exports=u},{"./invariant":134}],59:[function(e,t){"use strict";var n={guard:function(e){return e}};t.exports=n},{}],60:[function(e,t){"use strict";function n(e){r.enqueueEvents(e),r.processEventQueue()}var r=e("./EventPluginHub"),i={handleTopLevel:function(e,t,i,o){var a=r.extractEvents(e,t,i,o);n(a)}};t.exports=i},{"./EventPluginHub":18}],61:[function(e,t){"use strict";function n(e){var t=u.getID(e),n=c.getReactRootIDFromNodeID(t),r=u.findReactContainerForID(n),i=u.getFirstReactDOM(r);return i}function r(e,t){this.topLevelType=e,this.nativeEvent=t,this.ancestors=[]}function i(e){for(var t=u.getFirstReactDOM(p(e.nativeEvent))||window,r=t;r;)e.ancestors.push(r),r=n(r);for(var i=0,o=e.ancestors.length;o>i;i++){t=e.ancestors[i];var a=u.getID(t)||"";m._handleTopLevel(e.topLevelType,t,a,e.nativeEvent)}}function o(e){var t=h(window);e(t)}var a=e("./EventListener"),s=e("./ExecutionEnvironment"),l=e("./PooledClass"),c=e("./ReactInstanceHandles"),u=e("./ReactMount"),d=e("./ReactUpdates"),p=e("./getEventTarget"),h=e("./getUnboundedScrollPosition"),f=e("./mixInto");f(r,{destructor:function(){this.topLevelType=null,this.nativeEvent=null,this.ancestors.length=0}}),l.addPoolingTo(r,l.twoArgumentPooler);var m={_enabled:!0,_handleTopLevel:null,WINDOW_HANDLE:s.canUseDOM?window:null,setHandleTopLevel:function(e){m._handleTopLevel=e},setEnabled:function(e){m._enabled=!!e},isEnabled:function(){return m._enabled},trapBubbledEvent:function(e,t,n){var r=n;if(r)return a.listen(r,t,m.dispatchEvent.bind(null,e))},trapCapturedEvent:function(e,t,n){var r=n;if(r)return a.capture(r,t,m.dispatchEvent.bind(null,e))},monitorScrollValue:function(e){var t=o.bind(null,e);a.listen(window,"scroll",t),a.listen(window,"resize",t)},dispatchEvent:function(e,t){if(m._enabled){var n=r.getPooled(e,t);try{d.batchedUpdates(i,n)}finally{r.release(n)}}}};t.exports=m},{"./EventListener":17,"./ExecutionEnvironment":22,"./PooledClass":28,"./ReactInstanceHandles":64,"./ReactMount":67,"./ReactUpdates":87,"./getEventTarget":125,"./getUnboundedScrollPosition":130,"./mixInto":147}],62:[function(e,t){"use strict";var n=e("./DOMProperty"),r=e("./EventPluginHub"),i=e("./ReactComponent"),o=e("./ReactCompositeComponent"),a=e("./ReactDOM"),s=e("./ReactEmptyComponent"),l=e("./ReactBrowserEventEmitter"),c=e("./ReactPerf"),u=e("./ReactRootIndex"),d=e("./ReactUpdates"),p={Component:i.injection,CompositeComponent:o.injection,DOMProperty:n.injection,EmptyComponent:s.injection,EventPluginHub:r.injection,DOM:a.injection,EventEmitter:l.injection,Perf:c.injection,RootIndex:u.injection,Updates:d.injection};t.exports=p},{"./DOMProperty":11,"./EventPluginHub":18,"./ReactBrowserEventEmitter":31,"./ReactComponent":35,"./ReactCompositeComponent":38,"./ReactDOM":41,"./ReactEmptyComponent":58,"./ReactPerf":71,"./ReactRootIndex":78,"./ReactUpdates":87}],63:[function(e,t){"use strict";function n(e){return i(document.documentElement,e)}var r=e("./ReactDOMSelection"),i=e("./containsNode"),o=e("./focusNode"),a=e("./getActiveElement"),s={hasSelectionCapabilities:function(e){return e&&("INPUT"===e.nodeName&&"text"===e.type||"TEXTAREA"===e.nodeName||"true"===e.contentEditable)},getSelectionInformation:function(){var e=a();return{focusedElem:e,selectionRange:s.hasSelectionCapabilities(e)?s.getSelection(e):null}},restoreSelection:function(e){var t=a(),r=e.focusedElem,i=e.selectionRange;t!==r&&n(r)&&(s.hasSelectionCapabilities(r)&&s.setSelection(r,i),o(r))},getSelection:function(e){var t;if("selectionStart"in e)t={start:e.selectionStart,end:e.selectionEnd};else if(document.selection&&"INPUT"===e.nodeName){var n=document.selection.createRange();n.parentElement()===e&&(t={start:-n.moveStart("character",-e.value.length),end:-n.moveEnd("character",-e.value.length)})}else t=r.getOffsets(e);return t||{start:0,end:0}},setSelection:function(e,t){var n=t.start,i=t.end;if("undefined"==typeof i&&(i=n),"selectionStart"in e)e.selectionStart=n,e.selectionEnd=Math.min(i,e.value.length);else if(document.selection&&"INPUT"===e.nodeName){var o=e.createTextRange();o.collapse(!0),o.moveStart("character",n),o.moveEnd("character",i-n),o.select()}else r.setOffsets(e,t)}};t.exports=s},{"./ReactDOMSelection":50,"./containsNode":109,"./focusNode":120,"./getActiveElement":122}],64:[function(e,t){"use strict";function n(e){return p+e.toString(36)}function r(e,t){return e.charAt(t)===p||t===e.length}function i(e){return""===e||e.charAt(0)===p&&e.charAt(e.length-1)!==p}function o(e,t){return 0===t.indexOf(e)&&r(t,e.length)}function a(e){return e?e.substr(0,e.lastIndexOf(p)):""}function s(e,t){if(d(i(e)&&i(t),"getNextDescendantID(%s, %s): Received an invalid React DOM ID.",e,t),d(o(e,t),"getNextDescendantID(...): React has made an invalid assumption about the DOM hierarchy. Expected `%s` to be an ancestor of `%s`.",e,t),e===t)return e;for(var n=e.length+h,a=n;a<t.length&&!r(t,a);a++);return t.substr(0,a)}function l(e,t){var n=Math.min(e.length,t.length);if(0===n)return"";for(var o=0,a=0;n>=a;a++)if(r(e,a)&&r(t,a))o=a;else if(e.charAt(a)!==t.charAt(a))break;var s=e.substr(0,o);return d(i(s),"getFirstCommonAncestorID(%s, %s): Expected a valid React DOM ID: %s",e,t,s),s}function c(e,t,n,r,i,l){e=e||"",t=t||"",d(e!==t,"traverseParentPath(...): Cannot traverse from and to the same ID, `%s`.",e);var c=o(t,e);d(c||o(e,t),"traverseParentPath(%s, %s, ...): Cannot traverse from two IDs that do not have a parent path.",e,t);for(var u=0,p=c?a:s,h=e;;h=p(h,t)){var m;if(i&&h===e||l&&h===t||(m=n(h,c,r)),m===!1||h===t)break;d(u++<f,"traverseParentPath(%s, %s, ...): Detected an infinite loop while traversing the React DOM ID tree. This may be due to malformed IDs: %s",e,t)}}var u=e("./ReactRootIndex"),d=e("./invariant"),p=".",h=p.length,f=100,m={createReactRootID:function(){return n(u.createReactRootIndex())},createReactID:function(e,t){return e+t},getReactRootIDFromNodeID:function(e){if(e&&e.charAt(0)===p&&e.length>1){var t=e.indexOf(p,1);return t>-1?e.substr(0,t):e}return null},traverseEnterLeave:function(e,t,n,r,i){var o=l(e,t);o!==e&&c(e,o,n,r,!1,!0),o!==t&&c(o,t,n,i,!0,!1)},traverseTwoPhase:function(e,t,n){e&&(c("",e,t,n,!0,!1),c(e,"",t,n,!1,!0))},traverseAncestors:function(e,t,n){c("",e,t,n,!0,!1)},_getFirstCommonAncestorID:l,_getNextDescendantID:s,isAncestorIDOf:o,SEPARATOR:p};t.exports=m},{"./ReactRootIndex":78,"./invariant":134}],65:[function(e,t){"use strict";function n(e,t){this.value=e,this.requestChange=t}function r(e){var t={value:"undefined"==typeof e?i.PropTypes.any.isRequired:e.isRequired,requestChange:i.PropTypes.func.isRequired};return i.PropTypes.shape(t)}var i=e("./React");n.PropTypes={link:r},t.exports=n},{"./React":29}],66:[function(e,t){"use strict";var n=e("./adler32"),r={CHECKSUM_ATTR_NAME:"data-react-checksum",addChecksumToMarkup:function(e){var t=n(e);return e.replace(">"," "+r.CHECKSUM_ATTR_NAME+'="'+t+'">')},canReuseMarkup:function(e,t){var i=t.getAttribute(r.CHECKSUM_ATTR_NAME);i=i&&parseInt(i,10);var o=n(e);return o===i}};t.exports=r},{"./adler32":107}],67:[function(e,t){"use strict";function n(e){var t=y(e);return t&&x.getID(t)}function r(e){var t=i(e);if(t)if(C.hasOwnProperty(t)){var n=C[t];n!==e&&(E(!s(n,t),"ReactMount: Two valid but unequal nodes with the same `%s`: %s",w,t),C[t]=e)}else C[t]=e;return t}function i(e){return e&&e.getAttribute&&e.getAttribute(w)||""}function o(e,t){var n=i(e);n!==t&&delete C[n],e.setAttribute(w,t),C[t]=e}function a(e){return C.hasOwnProperty(e)&&s(C[e],e)||(C[e]=x.findReactNodeByID(e)),C[e]}function s(e,t){if(e){E(i(e)===t,"ReactMount: Unexpected modification of `%s`",w);var n=x.findReactContainerForID(t);if(n&&v(n,e))return!0}return!1}function l(e){delete C[e]}function c(e){var t=C[e];return t&&s(t,e)?void(N=t):!1}function u(e){N=null,m.traverseAncestors(e,c);var t=N;return N=null,t}var d=e("./DOMProperty"),p=e("./ReactBrowserEventEmitter"),h=e("./ReactCurrentOwner"),f=e("./ReactDescriptor"),m=e("./ReactInstanceHandles"),g=e("./ReactPerf"),v=e("./containsNode"),y=e("./getReactRootElementInContainer"),_=e("./instantiateReactComponent"),E=e("./invariant"),b=e("./shouldUpdateReactComponent"),S=e("./warning"),I=m.SEPARATOR,w=d.ID_ATTRIBUTE_NAME,C={},D=1,T=9,O={},M={},L={},R=[],N=null,x={_instancesByReactRootID:O,scrollMonitor:function(e,t){t()},_updateRootComponent:function(e,t,r,i){var o=t.props;return x.scrollMonitor(r,function(){e.replaceProps(o,i)}),L[n(r)]=y(r),e},_registerComponent:function(e,t){E(t&&(t.nodeType===D||t.nodeType===T),"_registerComponent(...): Target container is not a DOM element."),p.ensureScrollValueMonitoring();var n=x.registerContainer(t);return O[n]=e,n},_renderNewRootComponent:g.measure("ReactMount","_renderNewRootComponent",function(e,t,n){S(null==h.current,"_renderNewRootComponent(): Render methods should be a pure function of props and state; triggering nested component updates from render is not allowed. If necessary, trigger nested updates in componentDidUpdate.");var r=_(e),i=x._registerComponent(r,t);return r.mountComponentIntoNode(i,t,n),L[i]=y(t),r}),renderComponent:function(e,t,r){E(f.isValidDescriptor(e),"renderComponent(): Invalid component descriptor.%s",f.isValidFactory(e)?" Instead of passing a component class, make sure to instantiate it first by calling it with props.":"undefined"!=typeof e.props?" This may be caused by unintentionally loading two independent copies of React.":"");var i=O[n(t)];if(i){var o=i._descriptor;if(b(o,e))return x._updateRootComponent(i,e,t,r);x.unmountComponentAtNode(t)}var a=y(t),s=a&&x.isRenderedByReact(a),l=s&&!i,c=x._renderNewRootComponent(e,t,l);return r&&r.call(c),c},constructAndRenderComponent:function(e,t,n){return x.renderComponent(e(t),n)},constructAndRenderComponentByID:function(e,t,n){var r=document.getElementById(n);return E(r,'Tried to get element with id of "%s" but it is not present on the page.',n),x.constructAndRenderComponent(e,t,r)},registerContainer:function(e){var t=n(e);return t&&(t=m.getReactRootIDFromNodeID(t)),t||(t=m.createReactRootID()),M[t]=e,t},unmountComponentAtNode:function(e){S(null==h.current,"unmountComponentAtNode(): Render methods should be a pure function of props and state; triggering nested component updates from render is not allowed. If necessary, trigger nested updates in componentDidUpdate.");var t=n(e),r=O[t];return r?(x.unmountComponentFromNode(r,e),delete O[t],delete M[t],delete L[t],!0):!1},unmountComponentFromNode:function(e,t){for(e.unmountComponent(),t.nodeType===T&&(t=t.documentElement);t.lastChild;)t.removeChild(t.lastChild)},findReactContainerForID:function(e){var t=m.getReactRootIDFromNodeID(e),n=M[t],r=L[t];if(r&&r.parentNode!==n){E(i(r)===t,"ReactMount: Root element ID differed from reactRootID.");var o=n.firstChild;o&&t===i(o)?L[t]=o:console.warn("ReactMount: Root element has been removed from its original container. New container:",r.parentNode)}return n},findReactNodeByID:function(e){var t=x.findReactContainerForID(e);return x.findComponentRoot(t,e)},isRenderedByReact:function(e){if(1!==e.nodeType)return!1;var t=x.getID(e);return t?t.charAt(0)===I:!1},getFirstReactDOM:function(e){for(var t=e;t&&t.parentNode!==t;){if(x.isRenderedByReact(t))return t;t=t.parentNode}return null},findComponentRoot:function(e,t){var n=R,r=0,i=u(t)||e;for(n[0]=i.firstChild,n.length=1;r<n.length;){for(var o,a=n[r++];a;){var s=x.getID(a);s?t===s?o=a:m.isAncestorIDOf(s,t)&&(n.length=r=0,n.push(a.firstChild)):n.push(a.firstChild),a=a.nextSibling}if(o)return n.length=0,o}n.length=0,E(!1,"findComponentRoot(..., %s): Unable to find element. This probably means the DOM was unexpectedly mutated (e.g., by the browser), usually due to forgetting a <tbody> when using tables, nesting <p> or <a> tags, or using non-SVG elements in an <svg> parent. Try inspecting the child nodes of the element with React ID `%s`.",t,x.getID(e))},getReactRootID:n,getID:r,setID:o,getNode:a,purgeID:l};t.exports=x},{"./DOMProperty":11,"./ReactBrowserEventEmitter":31,"./ReactCurrentOwner":40,"./ReactDescriptor":56,"./ReactInstanceHandles":64,"./ReactPerf":71,"./containsNode":109,"./getReactRootElementInContainer":128,"./instantiateReactComponent":133,"./invariant":134,"./shouldUpdateReactComponent":154,"./warning":158}],68:[function(e,t){"use strict";function n(e,t,n){f.push({parentID:e,parentNode:null,type:c.INSERT_MARKUP,markupIndex:m.push(t)-1,textContent:null,fromIndex:null,toIndex:n})}function r(e,t,n){f.push({parentID:e,parentNode:null,type:c.MOVE_EXISTING,markupIndex:null,textContent:null,fromIndex:t,toIndex:n})}function i(e,t){f.push({parentID:e,parentNode:null,type:c.REMOVE_NODE,markupIndex:null,textContent:null,fromIndex:t,toIndex:null})}function o(e,t){f.push({parentID:e,parentNode:null,type:c.TEXT_CONTENT,markupIndex:null,textContent:t,fromIndex:null,toIndex:null})}function a(){f.length&&(l.BackendIDOperations.dangerouslyProcessChildrenUpdates(f,m),s())}function s(){f.length=0,m.length=0}var l=e("./ReactComponent"),c=e("./ReactMultiChildUpdateTypes"),u=e("./flattenChildren"),d=e("./instantiateReactComponent"),p=e("./shouldUpdateReactComponent"),h=0,f=[],m=[],g={Mixin:{mountChildren:function(e,t){var n=u(e),r=[],i=0;this._renderedChildren=n;for(var o in n){var a=n[o];if(n.hasOwnProperty(o)){var s=d(a);n[o]=s;var l=this._rootNodeID+o,c=s.mountComponent(l,t,this._mountDepth+1);s._mountIndex=i,r.push(c),i++}}return r},updateTextContent:function(e){h++;var t=!0;try{var n=this._renderedChildren;for(var r in n)n.hasOwnProperty(r)&&this._unmountChildByName(n[r],r);this.setTextContent(e),t=!1}finally{h--,h||(t?s():a())}},updateChildren:function(e,t){h++;var n=!0;try{this._updateChildren(e,t),n=!1}finally{h--,h||(n?s():a())}},_updateChildren:function(e,t){var n=u(e),r=this._renderedChildren;if(n||r){var i,o=0,a=0;for(i in n)if(n.hasOwnProperty(i)){var s=r&&r[i],l=s&&s._descriptor,c=n[i];if(p(l,c))this.moveChild(s,a,o),o=Math.max(s._mountIndex,o),s.receiveComponent(c,t),s._mountIndex=a;else{s&&(o=Math.max(s._mountIndex,o),this._unmountChildByName(s,i));var h=d(c);this._mountChildByNameAtIndex(h,i,a,t)}a++}for(i in r)!r.hasOwnProperty(i)||n&&n[i]||this._unmountChildByName(r[i],i)}},unmountChildren:function(){var e=this._renderedChildren;for(var t in e){var n=e[t];n.unmountComponent&&n.unmountComponent()}this._renderedChildren=null},moveChild:function(e,t,n){e._mountIndex<n&&r(this._rootNodeID,e._mountIndex,t)},createChild:function(e,t){n(this._rootNodeID,t,e._mountIndex)},removeChild:function(e){i(this._rootNodeID,e._mountIndex)},setTextContent:function(e){o(this._rootNodeID,e)},_mountChildByNameAtIndex:function(e,t,n,r){var i=this._rootNodeID+t,o=e.mountComponent(i,r,this._mountDepth+1);e._mountIndex=n,this.createChild(e,o),this._renderedChildren=this._renderedChildren||{},this._renderedChildren[t]=e},_unmountChildByName:function(e,t){this.removeChild(e),e._mountIndex=null,e.unmountComponent(),delete this._renderedChildren[t]}}};t.exports=g},{"./ReactComponent":35,"./ReactMultiChildUpdateTypes":69,"./flattenChildren":119,"./instantiateReactComponent":133,"./shouldUpdateReactComponent":154}],69:[function(e,t){"use strict";var n=e("./keyMirror"),r=n({INSERT_MARKUP:null,MOVE_EXISTING:null,REMOVE_NODE:null,TEXT_CONTENT:null});t.exports=r},{"./keyMirror":140}],70:[function(e,t){"use strict";var n=e("./emptyObject"),r=e("./invariant"),i={isValidOwner:function(e){return!(!e||"function"!=typeof e.attachRef||"function"!=typeof e.detachRef)},addComponentAsRefTo:function(e,t,n){r(i.isValidOwner(n),"addComponentAsRefTo(...): Only a ReactOwner can have refs. This usually means that you're trying to add a ref to a component that doesn't have an owner (that is, was not created inside of another component's `render` method). Try rendering this component inside of a new top-level component which will hold the ref."),n.attachRef(t,e)},removeComponentAsRefFrom:function(e,t,n){r(i.isValidOwner(n),"removeComponentAsRefFrom(...): Only a ReactOwner can have refs. This usually means that you're trying to remove a ref to a component that doesn't have an owner (that is, was not created inside of another component's `render` method). Try rendering this component inside of a new top-level component which will hold the ref."),n.refs[t]===e&&n.detachRef(t)},Mixin:{construct:function(){this.refs=n},attachRef:function(e,t){r(t.isOwnedBy(this),"attachRef(%s, ...): Only a component's owner can store a ref to it.",e);var i=this.refs===n?this.refs={}:this.refs;i[e]=t},detachRef:function(e){delete this.refs[e]}}};t.exports=i},{"./emptyObject":117,"./invariant":134}],71:[function(e,t){"use strict";function n(e,t,n){return n}var r={enableMeasure:!1,storedMeasure:n,measure:function(e,t,n){var i=null;return function(){return r.enableMeasure?(i||(i=r.storedMeasure(e,t,n)),i.apply(this,arguments)):n.apply(this,arguments)}},injection:{injectMeasure:function(e){r.storedMeasure=e}}};t.exports=r},{}],72:[function(e,t){"use strict";function n(e){return function(t,n,r){t[n]=t.hasOwnProperty(n)?e(t[n],r):r}}function r(e,t){for(var n in t)if(t.hasOwnProperty(n)){var r=c[n];r&&c.hasOwnProperty(n)?r(e,n,t[n]):e.hasOwnProperty(n)||(e[n]=t[n])}return e}var i=e("./emptyFunction"),o=e("./invariant"),a=e("./joinClasses"),s=e("./merge"),l=n(function(e,t){return s(t,e)}),c={children:i,className:n(a),key:i,ref:i,style:l},u={TransferStrategies:c,mergeProps:function(e,t){return r(s(e),t)},Mixin:{transferPropsTo:function(e){return o(e._owner===this,"%s: You can't call transferPropsTo() on a component that you don't own, %s. This usually means you are calling transferPropsTo() on a component passed in as props or children.",this.constructor.displayName,e.type.displayName),r(e.props,this.props),e}}};t.exports=u},{"./emptyFunction":116,"./invariant":134,"./joinClasses":139,"./merge":144}],73:[function(e,t){"use strict";var n={};n={prop:"prop",context:"context",childContext:"child context"},t.exports=n},{}],74:[function(e,t){"use strict";var n=e("./keyMirror"),r=n({prop:null,context:null,childContext:null});t.exports=r},{"./keyMirror":140}],75:[function(e,t){"use strict";function n(e){function t(t,n,r,i,o){if(i=i||_,null!=n[r])return e(n,r,i,o);var a=v[o];return t?new Error("Required "+a+" `"+r+"` was not specified in "+("`"+i+"`.")):void 0}var n=t.bind(null,!1);return n.isRequired=t.bind(null,!0),n}function r(e){function t(t,n,r,i){var o=t[n],a=f(o);if(a!==e){var s=v[i],l=m(o);return new Error("Invalid "+s+" `"+n+"` of type `"+l+"` "+("supplied to `"+r+"`, expected `"+e+"`."))}}return n(t)}function i(){return n(y.thatReturns())}function o(e){function t(t,n,r,i){var o=t[n];if(!Array.isArray(o)){var a=v[i],s=f(o);return new Error("Invalid "+a+" `"+n+"` of type "+("`"+s+"` supplied to `"+r+"`, expected an array."))}for(var l=0;l<o.length;l++){var c=e(o,l,r,i);if(c instanceof Error)return c}}return n(t)}function a(){function e(e,t,n,r){if(!g.isValidDescriptor(e[t])){var i=v[r];return new Error("Invalid "+i+" `"+t+"` supplied to "+("`"+n+"`, expected a React component."))}}return n(e)}function s(e){function t(t,n,r,i){if(!(t[n]instanceof e)){var o=v[i],a=e.name||_;return new Error("Invalid "+o+" `"+n+"` supplied to "+("`"+r+"`, expected instance of `"+a+"`."))}}return n(t)}function l(e){function t(t,n,r,i){for(var o=t[n],a=0;a<e.length;a++)if(o===e[a])return;var s=v[i],l=JSON.stringify(e);return new Error("Invalid "+s+" `"+n+"` of value `"+o+"` "+("supplied to `"+r+"`, expected one of "+l+"."))}return n(t)}function c(e){function t(t,n,r,i){var o=t[n],a=f(o);if("object"!==a){var s=v[i];return new Error("Invalid "+s+" `"+n+"` of type "+("`"+a+"` supplied to `"+r+"`, expected an object."))}for(var l in o)if(o.hasOwnProperty(l)){var c=e(o,l,r,i);if(c instanceof Error)return c}}return n(t)}function u(e){function t(t,n,r,i){for(var o=0;o<e.length;o++){var a=e[o];if(null==a(t,n,r,i))return}var s=v[i];return new Error("Invalid "+s+" `"+n+"` supplied to "+("`"+r+"`."))}return n(t)}function d(){function e(e,t,n,r){if(!h(e[t])){var i=v[r];return new Error("Invalid "+i+" `"+t+"` supplied to "+("`"+n+"`, expected a renderable prop."))}}return n(e)}function p(e){function t(t,n,r,i){var o=t[n],a=f(o);if("object"!==a){var s=v[i];return new Error("Invalid "+s+" `"+n+"` of type `"+a+"` "+("supplied to `"+r+"`, expected `object`."))}for(var l in e){var c=e[l];if(c){var u=c(o,l,r,i);if(u)return u}}}return n(t,"expected `object`")}function h(e){switch(typeof e){case"number":case"string":return!0;case"boolean":return!e;case"object":if(Array.isArray(e))return e.every(h);if(g.isValidDescriptor(e))return!0;for(var t in e)if(!h(e[t]))return!1;return!0;default:return!1}}function f(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":t}function m(e){var t=f(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}var g=e("./ReactDescriptor"),v=e("./ReactPropTypeLocationNames"),y=e("./emptyFunction"),_="<<anonymous>>",E={array:r("array"),bool:r("boolean"),func:r("function"),number:r("number"),object:r("object"),string:r("string"),any:i(),arrayOf:o,component:a(),instanceOf:s,objectOf:c,oneOf:l,oneOfType:u,renderable:d(),shape:p};t.exports=E},{"./ReactDescriptor":56,"./ReactPropTypeLocationNames":73,"./emptyFunction":116}],76:[function(e,t){"use strict";function n(){this.listenersToPut=[]}var r=e("./PooledClass"),i=e("./ReactBrowserEventEmitter"),o=e("./mixInto");o(n,{enqueuePutListener:function(e,t,n){this.listenersToPut.push({rootNodeID:e,propKey:t,propValue:n})},putListeners:function(){for(var e=0;e<this.listenersToPut.length;e++){var t=this.listenersToPut[e];i.putListener(t.rootNodeID,t.propKey,t.propValue)}},reset:function(){this.listenersToPut.length=0},destructor:function(){this.reset()}}),r.addPoolingTo(n),t.exports=n},{"./PooledClass":28,"./ReactBrowserEventEmitter":31,"./mixInto":147}],77:[function(e,t){"use strict";function n(){this.reinitializeTransaction(),this.renderToStaticMarkup=!1,this.reactMountReady=r.getPooled(null),this.putListenerQueue=s.getPooled()}var r=e("./CallbackQueue"),i=e("./PooledClass"),o=e("./ReactBrowserEventEmitter"),a=e("./ReactInputSelection"),s=e("./ReactPutListenerQueue"),l=e("./Transaction"),c=e("./mixInto"),u={initialize:a.getSelectionInformation,close:a.restoreSelection},d={initialize:function(){var e=o.isEnabled();return o.setEnabled(!1),e},close:function(e){o.setEnabled(e)}},p={initialize:function(){this.reactMountReady.reset()},close:function(){this.reactMountReady.notifyAll()}},h={initialize:function(){this.putListenerQueue.reset()},close:function(){this.putListenerQueue.putListeners()}},f=[h,u,d,p],m={getTransactionWrappers:function(){return f},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){r.release(this.reactMountReady),this.reactMountReady=null,s.release(this.putListenerQueue),this.putListenerQueue=null}};c(n,l.Mixin),c(n,m),i.addPoolingTo(n),t.exports=n},{"./CallbackQueue":6,"./PooledClass":28,"./ReactBrowserEventEmitter":31,"./ReactInputSelection":63,"./ReactPutListenerQueue":76,"./Transaction":104,"./mixInto":147}],78:[function(e,t){"use strict";var n={injectCreateReactRootIndex:function(e){r.createReactRootIndex=e}},r={createReactRootIndex:null,injection:n};t.exports=r},{}],79:[function(e,t){"use strict";function n(e){c(i.isValidDescriptor(e),"renderComponentToString(): You must pass a valid ReactComponent."),c(!(2===arguments.length&&"function"==typeof arguments[1]),"renderComponentToString(): This function became synchronous and now returns the generated markup. Please remove the second parameter.");var t;try{var n=o.createReactRootID();return t=s.getPooled(!1),t.perform(function(){var r=l(e),i=r.mountComponent(n,t,0);return a.addChecksumToMarkup(i)},null)}finally{s.release(t)}}function r(e){c(i.isValidDescriptor(e),"renderComponentToStaticMarkup(): You must pass a valid ReactComponent.");var t;try{var n=o.createReactRootID();return t=s.getPooled(!0),t.perform(function(){var r=l(e);return r.mountComponent(n,t,0)},null)}finally{s.release(t)}}var i=e("./ReactDescriptor"),o=e("./ReactInstanceHandles"),a=e("./ReactMarkupChecksum"),s=e("./ReactServerRenderingTransaction"),l=e("./instantiateReactComponent"),c=e("./invariant");t.exports={renderComponentToString:n,renderComponentToStaticMarkup:r}},{"./ReactDescriptor":56,"./ReactInstanceHandles":64,"./ReactMarkupChecksum":66,"./ReactServerRenderingTransaction":80,"./instantiateReactComponent":133,"./invariant":134}],80:[function(e,t){"use strict";function n(e){this.reinitializeTransaction(),this.renderToStaticMarkup=e,this.reactMountReady=i.getPooled(null),this.putListenerQueue=o.getPooled()}var r=e("./PooledClass"),i=e("./CallbackQueue"),o=e("./ReactPutListenerQueue"),a=e("./Transaction"),s=e("./emptyFunction"),l=e("./mixInto"),c={initialize:function(){this.reactMountReady.reset()},close:s},u={initialize:function(){this.putListenerQueue.reset()},close:s},d=[u,c],p={getTransactionWrappers:function(){return d},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){i.release(this.reactMountReady),this.reactMountReady=null,o.release(this.putListenerQueue),this.putListenerQueue=null}};l(n,a.Mixin),l(n,p),r.addPoolingTo(n),t.exports=n},{"./CallbackQueue":6,"./PooledClass":28,"./ReactPutListenerQueue":76,"./Transaction":104,"./emptyFunction":116,"./mixInto":147}],81:[function(e,t){"use strict";function n(e,t){var n={};return function(r){n[t]=r,e.setState(n)}}var r={createStateSetter:function(e,t){return function(n,r,i,o,a,s){var l=t.call(e,n,r,i,o,a,s);l&&e.setState(l)}},createStateKeySetter:function(e,t){var r=e.__keySetters||(e.__keySetters={});return r[t]||(r[t]=n(e,t))}};r.Mixin={createStateSetter:function(e){return r.createStateSetter(this,e)},createStateKeySetter:function(e){return r.createStateKeySetter(this,e)}},t.exports=r},{}],82:[function(e,t){"use strict";function n(){}function r(e){return function(t,r){var i;E.isDOMComponent(t)?i=t.getDOMNode():t.tagName&&(i=t);var o=new n;o.target=i;var a=new g(p.eventNameDispatchConfigs[e],h.getID(i),o);v(a,r),l.accumulateTwoPhaseDispatches(a),m.batchedUpdates(function(){s.enqueueEvents(a),s.processEventQueue()})}}function i(){E.Simulate={};var e;for(e in p.eventNameDispatchConfigs)E.Simulate[e]=r(e)}function o(e){return function(t,r){var i=new n(e);v(i,r),E.isDOMComponent(t)?E.simulateNativeEventOnDOMComponent(e,t,i):t.tagName&&E.simulateNativeEventOnNode(e,t,i)}}var a=e("./EventConstants"),s=e("./EventPluginHub"),l=e("./EventPropagators"),c=e("./React"),u=e("./ReactDescriptor"),d=e("./ReactDOM"),p=e("./ReactBrowserEventEmitter"),h=e("./ReactMount"),f=e("./ReactTextComponent"),m=e("./ReactUpdates"),g=e("./SyntheticEvent"),v=e("./mergeInto"),y=e("./copyProperties"),_=a.topLevelTypes,E={renderIntoDocument:function(e){var t=document.createElement("div");return c.renderComponent(e,t)},isDescriptor:function(e){return u.isValidDescriptor(e)},isDescriptorOfType:function(e,t){return u.isValidDescriptor(e)&&e.type===t.type},isDOMComponent:function(e){return!!(e&&e.mountComponent&&e.tagName)},isDOMComponentDescriptor:function(e){return!!(e&&u.isValidDescriptor(e)&&e.tagName)},isCompositeComponent:function(e){return"function"==typeof e.render&&"function"==typeof e.setState},isCompositeComponentWithType:function(e,t){return!(!E.isCompositeComponent(e)||e.constructor!==t.type)},isCompositeComponentDescriptor:function(e){if(!u.isValidDescriptor(e))return!1;var t=e.type.prototype;return"function"==typeof t.render&&"function"==typeof t.setState},isCompositeComponentDescriptorWithType:function(e,t){return!(!E.isCompositeComponentDescriptor(e)||e.constructor!==t)},isTextComponent:function(e){return e instanceof f.type},findAllInRenderedTree:function(e,t){if(!e)return[];var n=t(e)?[e]:[];if(E.isDOMComponent(e)){var r,i=e._renderedChildren;for(r in i)i.hasOwnProperty(r)&&(n=n.concat(E.findAllInRenderedTree(i[r],t)))}else E.isCompositeComponent(e)&&(n=n.concat(E.findAllInRenderedTree(e._renderedComponent,t)));return n},scryRenderedDOMComponentsWithClass:function(e,t){return E.findAllInRenderedTree(e,function(e){var n=e.props.className;return E.isDOMComponent(e)&&n&&-1!==(" "+n+" ").indexOf(" "+t+" ")})},findRenderedDOMComponentWithClass:function(e,t){var n=E.scryRenderedDOMComponentsWithClass(e,t);if(1!==n.length)throw new Error("Did not find exactly one match for class:"+t);return n[0]},scryRenderedDOMComponentsWithTag:function(e,t){return E.findAllInRenderedTree(e,function(e){return E.isDOMComponent(e)&&e.tagName===t.toUpperCase()})},findRenderedDOMComponentWithTag:function(e,t){var n=E.scryRenderedDOMComponentsWithTag(e,t);
if(1!==n.length)throw new Error("Did not find exactly one match for tag:"+t);return n[0]},scryRenderedComponentsWithType:function(e,t){return E.findAllInRenderedTree(e,function(e){return E.isCompositeComponentWithType(e,t)})},findRenderedComponentWithType:function(e,t){var n=E.scryRenderedComponentsWithType(e,t);if(1!==n.length)throw new Error("Did not find exactly one match for componentType:"+t);return n[0]},mockComponent:function(e){var t=c.createClass({render:function(){var t=t||e.mockTagName||"div";return d[t](null,this.props.children)}});return y(e,t),e.mockImplementation(t),this},simulateNativeEventOnNode:function(e,t,n){n.target=t,p.ReactEventListener.dispatchEvent(e,n)},simulateNativeEventOnDOMComponent:function(e,t,n){E.simulateNativeEventOnNode(e,t.getDOMNode(),n)},nativeTouchData:function(e,t){return{touches:[{pageX:e,pageY:t}]}},Simulate:null,SimulateNative:{}},b=s.injection.injectEventPluginOrder;s.injection.injectEventPluginOrder=function(){b.apply(this,arguments),i()};var S=s.injection.injectEventPluginsByName;s.injection.injectEventPluginsByName=function(){S.apply(this,arguments),i()},i();var I;for(I in _){var w=0===I.indexOf("top")?I.charAt(3).toLowerCase()+I.substr(4):I;E.SimulateNative[w]=o(I)}t.exports=E},{"./EventConstants":16,"./EventPluginHub":18,"./EventPropagators":21,"./React":29,"./ReactBrowserEventEmitter":31,"./ReactDOM":41,"./ReactDescriptor":56,"./ReactMount":67,"./ReactTextComponent":83,"./ReactUpdates":87,"./SyntheticEvent":96,"./copyProperties":110,"./mergeInto":146}],83:[function(e,t){"use strict";var n=e("./DOMPropertyOperations"),r=e("./ReactBrowserComponentMixin"),i=e("./ReactComponent"),o=e("./ReactDescriptor"),a=e("./escapeTextForBrowser"),s=e("./mixInto"),l=function(e){this.construct(e)};s(l,i.Mixin),s(l,r),s(l,{mountComponent:function(e,t,r){i.Mixin.mountComponent.call(this,e,t,r);var o=a(this.props);return t.renderToStaticMarkup?o:"<span "+n.createMarkupForID(e)+">"+o+"</span>"},receiveComponent:function(e){var t=e.props;t!==this.props&&(this.props=t,i.BackendIDOperations.updateTextContentByID(this._rootNodeID,t))}}),t.exports=o.createFactory(l)},{"./DOMPropertyOperations":12,"./ReactBrowserComponentMixin":30,"./ReactComponent":35,"./ReactDescriptor":56,"./escapeTextForBrowser":118,"./mixInto":147}],84:[function(e,t){"use strict";var n=e("./ReactChildren"),r={getChildMapping:function(e){return n.map(e,function(e){return e})},mergeChildMappings:function(e,t){function n(n){return t.hasOwnProperty(n)?t[n]:e[n]}e=e||{},t=t||{};var r={},i=[];for(var o in e)t.hasOwnProperty(o)?i.length&&(r[o]=i,i=[]):i.push(o);var a,s={};for(var l in t){if(r.hasOwnProperty(l))for(a=0;a<r[l].length;a++){var c=r[l][a];s[r[l][a]]=n(c)}s[l]=n(l)}for(a=0;a<i.length;a++)s[i[a]]=n(i[a]);return s}};t.exports=r},{"./ReactChildren":34}],85:[function(e,t){"use strict";function n(){var e=document.createElement("div"),t=e.style;"AnimationEvent"in window||delete a.animationend.animation,"TransitionEvent"in window||delete a.transitionend.transition;for(var n in a){var r=a[n];for(var i in r)if(i in t){s.push(r[i]);break}}}function r(e,t,n){e.addEventListener(t,n,!1)}function i(e,t,n){e.removeEventListener(t,n,!1)}var o=e("./ExecutionEnvironment"),a={transitionend:{transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd"},animationend:{animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"mozAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd"}},s=[];o.canUseDOM&&n();var l={addEndEventListener:function(e,t){return 0===s.length?void window.setTimeout(t,0):void s.forEach(function(n){r(e,n,t)})},removeEndEventListener:function(e,t){0!==s.length&&s.forEach(function(n){i(e,n,t)})}};t.exports=l},{"./ExecutionEnvironment":22}],86:[function(e,t){"use strict";var n=e("./React"),r=e("./ReactTransitionChildMapping"),i=e("./cloneWithProps"),o=e("./emptyFunction"),a=e("./merge"),s=n.createClass({displayName:"ReactTransitionGroup",propTypes:{component:n.PropTypes.func,childFactory:n.PropTypes.func},getDefaultProps:function(){return{component:n.DOM.span,childFactory:o.thatReturnsArgument}},getInitialState:function(){return{children:r.getChildMapping(this.props.children)}},componentWillReceiveProps:function(e){var t=r.getChildMapping(e.children),n=this.state.children;this.setState({children:r.mergeChildMappings(n,t)});var i;for(i in t){var o=n&&n.hasOwnProperty(i);!t[i]||o||this.currentlyTransitioningKeys[i]||this.keysToEnter.push(i)}for(i in n){var a=t&&t.hasOwnProperty(i);!n[i]||a||this.currentlyTransitioningKeys[i]||this.keysToLeave.push(i)}},componentWillMount:function(){this.currentlyTransitioningKeys={},this.keysToEnter=[],this.keysToLeave=[]},componentDidUpdate:function(){var e=this.keysToEnter;this.keysToEnter=[],e.forEach(this.performEnter);var t=this.keysToLeave;this.keysToLeave=[],t.forEach(this.performLeave)},performEnter:function(e){this.currentlyTransitioningKeys[e]=!0;var t=this.refs[e];t.componentWillEnter?t.componentWillEnter(this._handleDoneEntering.bind(this,e)):this._handleDoneEntering(e)},_handleDoneEntering:function(e){var t=this.refs[e];t.componentDidEnter&&t.componentDidEnter(),delete this.currentlyTransitioningKeys[e];var n=r.getChildMapping(this.props.children);n&&n.hasOwnProperty(e)||this.performLeave(e)},performLeave:function(e){this.currentlyTransitioningKeys[e]=!0;var t=this.refs[e];t.componentWillLeave?t.componentWillLeave(this._handleDoneLeaving.bind(this,e)):this._handleDoneLeaving(e)},_handleDoneLeaving:function(e){var t=this.refs[e];t.componentDidLeave&&t.componentDidLeave(),delete this.currentlyTransitioningKeys[e];var n=r.getChildMapping(this.props.children);if(n&&n.hasOwnProperty(e))this.performEnter(e);else{var i=a(this.state.children);delete i[e],this.setState({children:i})}},render:function(){var e={};for(var t in this.state.children){var n=this.state.children[t];n&&(e[t]=i(this.props.childFactory(n),{ref:t}))}return this.transferPropsTo(this.props.component(null,e))}});t.exports=s},{"./React":29,"./ReactTransitionChildMapping":84,"./cloneWithProps":108,"./emptyFunction":116,"./merge":144}],87:[function(e,t){"use strict";function n(){h(I.ReactReconcileTransaction&&v,"ReactUpdates: must inject a reconcile transaction class and batching strategy")}function r(){this.reinitializeTransaction(),this.dirtyComponentsLength=null,this.callbackQueue=l.getPooled(null),this.reconcileTransaction=I.ReactReconcileTransaction.getPooled()}function i(e,t,r){n(),v.batchedUpdates(e,t,r)}function o(e,t){return e._mountDepth-t._mountDepth}function a(e){var t=e.dirtyComponentsLength;h(t===g.length,"Expected flush transaction's stored dirty-components length (%s) to match dirty-components array length (%s).",t,g.length),g.sort(o);for(var n=0;t>n;n++){var r=g[n];if(r.isMounted()){var i=r._pendingCallbacks;if(r._pendingCallbacks=null,r.performUpdateIfNecessary(e.reconcileTransaction),i)for(var a=0;a<i.length;a++)e.callbackQueue.enqueue(i[a],r)}}}function s(e,t){return h(!t||"function"==typeof t,"enqueueUpdate(...): You called `setProps`, `replaceProps`, `setState`, `replaceState`, or `forceUpdate` with a callback that isn't callable."),n(),m(null==u.current,"enqueueUpdate(): Render methods should be a pure function of props and state; triggering nested component updates from render is not allowed. If necessary, trigger nested updates in componentDidUpdate."),v.isBatchingUpdates?(g.push(e),void(t&&(e._pendingCallbacks?e._pendingCallbacks.push(t):e._pendingCallbacks=[t]))):void v.batchedUpdates(s,e,t)}var l=e("./CallbackQueue"),c=e("./PooledClass"),u=e("./ReactCurrentOwner"),d=e("./ReactPerf"),p=e("./Transaction"),h=e("./invariant"),f=e("./mixInto"),m=e("./warning"),g=[],v=null,y={initialize:function(){this.dirtyComponentsLength=g.length},close:function(){this.dirtyComponentsLength!==g.length?(g.splice(0,this.dirtyComponentsLength),b()):g.length=0}},_={initialize:function(){this.callbackQueue.reset()},close:function(){this.callbackQueue.notifyAll()}},E=[y,_];f(r,p.Mixin),f(r,{getTransactionWrappers:function(){return E},destructor:function(){this.dirtyComponentsLength=null,l.release(this.callbackQueue),this.callbackQueue=null,I.ReactReconcileTransaction.release(this.reconcileTransaction),this.reconcileTransaction=null},perform:function(e,t,n){return p.Mixin.perform.call(this,this.reconcileTransaction.perform,this.reconcileTransaction,e,t,n)}}),c.addPoolingTo(r);var b=d.measure("ReactUpdates","flushBatchedUpdates",function(){for(;g.length;){var e=r.getPooled();e.perform(a,null,e),r.release(e)}}),S={injectReconcileTransaction:function(e){h(e,"ReactUpdates: must provide a reconcile transaction class"),I.ReactReconcileTransaction=e},injectBatchingStrategy:function(e){h(e,"ReactUpdates: must provide a batching strategy"),h("function"==typeof e.batchedUpdates,"ReactUpdates: must provide a batchedUpdates() function"),h("boolean"==typeof e.isBatchingUpdates,"ReactUpdates: must provide an isBatchingUpdates boolean attribute"),v=e}},I={ReactReconcileTransaction:null,batchedUpdates:i,enqueueUpdate:s,flushBatchedUpdates:b,injection:S};t.exports=I},{"./CallbackQueue":6,"./PooledClass":28,"./ReactCurrentOwner":40,"./ReactPerf":71,"./Transaction":104,"./invariant":134,"./mixInto":147,"./warning":158}],88:[function(e,t){"use strict";var n=e("./LinkedStateMixin"),r=e("./React"),i=e("./ReactComponentWithPureRenderMixin"),o=e("./ReactCSSTransitionGroup"),a=e("./ReactTransitionGroup"),s=e("./cx"),l=e("./cloneWithProps"),c=e("./update");r.addons={CSSTransitionGroup:o,LinkedStateMixin:n,PureRenderMixin:i,TransitionGroup:a,classSet:s,cloneWithProps:l,update:c},r.addons.Perf=e("./ReactDefaultPerf"),r.addons.TestUtils=e("./ReactTestUtils"),t.exports=r},{"./LinkedStateMixin":24,"./React":29,"./ReactCSSTransitionGroup":32,"./ReactComponentWithPureRenderMixin":37,"./ReactDefaultPerf":54,"./ReactTestUtils":82,"./ReactTransitionGroup":86,"./cloneWithProps":108,"./cx":114,"./update":157}],89:[function(e,t){"use strict";var n=e("./DOMProperty"),r=n.injection.MUST_USE_ATTRIBUTE,i={Properties:{cx:r,cy:r,d:r,dx:r,dy:r,fill:r,fillOpacity:r,fontFamily:r,fontSize:r,fx:r,fy:r,gradientTransform:r,gradientUnits:r,markerEnd:r,markerMid:r,markerStart:r,offset:r,opacity:r,patternContentUnits:r,patternUnits:r,points:r,preserveAspectRatio:r,r:r,rx:r,ry:r,spreadMethod:r,stopColor:r,stopOpacity:r,stroke:r,strokeDasharray:r,strokeLinecap:r,strokeOpacity:r,strokeWidth:r,textAnchor:r,transform:r,version:r,viewBox:r,x1:r,x2:r,x:r,y1:r,y2:r,y:r},DOMAttributeNames:{fillOpacity:"fill-opacity",fontFamily:"font-family",fontSize:"font-size",gradientTransform:"gradientTransform",gradientUnits:"gradientUnits",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",patternContentUnits:"patternContentUnits",patternUnits:"patternUnits",preserveAspectRatio:"preserveAspectRatio",spreadMethod:"spreadMethod",stopColor:"stop-color",stopOpacity:"stop-opacity",strokeDasharray:"stroke-dasharray",strokeLinecap:"stroke-linecap",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",textAnchor:"text-anchor",viewBox:"viewBox"}};t.exports=i},{"./DOMProperty":11}],90:[function(e,t){"use strict";function n(e){if("selectionStart"in e&&a.hasSelectionCapabilities(e))return{start:e.selectionStart,end:e.selectionEnd};if(document.selection){var t=document.selection.createRange();return{parentElement:t.parentElement(),text:t.text,top:t.boundingTop,left:t.boundingLeft}}var n=window.getSelection();return{anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}}function r(e){if(!v&&null!=f&&f==l()){var t=n(f);if(!g||!d(g,t)){g=t;var r=s.getPooled(h.select,m,e);return r.type="select",r.target=f,o.accumulateTwoPhaseDispatches(r),r}}}var i=e("./EventConstants"),o=e("./EventPropagators"),a=e("./ReactInputSelection"),s=e("./SyntheticEvent"),l=e("./getActiveElement"),c=e("./isTextInputElement"),u=e("./keyOf"),d=e("./shallowEqual"),p=i.topLevelTypes,h={select:{phasedRegistrationNames:{bubbled:u({onSelect:null}),captured:u({onSelectCapture:null})},dependencies:[p.topBlur,p.topContextMenu,p.topFocus,p.topKeyDown,p.topMouseDown,p.topMouseUp,p.topSelectionChange]}},f=null,m=null,g=null,v=!1,y={eventTypes:h,extractEvents:function(e,t,n,i){switch(e){case p.topFocus:(c(t)||"true"===t.contentEditable)&&(f=t,m=n,g=null);break;case p.topBlur:f=null,m=null,g=null;break;case p.topMouseDown:v=!0;break;case p.topContextMenu:case p.topMouseUp:return v=!1,r(i);case p.topSelectionChange:case p.topKeyDown:case p.topKeyUp:return r(i)}}};t.exports=y},{"./EventConstants":16,"./EventPropagators":21,"./ReactInputSelection":63,"./SyntheticEvent":96,"./getActiveElement":122,"./isTextInputElement":137,"./keyOf":141,"./shallowEqual":153}],91:[function(e,t){"use strict";var n=Math.pow(2,53),r={createReactRootIndex:function(){return Math.ceil(Math.random()*n)}};t.exports=r},{}],92:[function(e,t){"use strict";var n=e("./EventConstants"),r=e("./EventPluginUtils"),i=e("./EventPropagators"),o=e("./SyntheticClipboardEvent"),a=e("./SyntheticEvent"),s=e("./SyntheticFocusEvent"),l=e("./SyntheticKeyboardEvent"),c=e("./SyntheticMouseEvent"),u=e("./SyntheticDragEvent"),d=e("./SyntheticTouchEvent"),p=e("./SyntheticUIEvent"),h=e("./SyntheticWheelEvent"),f=e("./invariant"),m=e("./keyOf"),g=n.topLevelTypes,v={blur:{phasedRegistrationNames:{bubbled:m({onBlur:!0}),captured:m({onBlurCapture:!0})}},click:{phasedRegistrationNames:{bubbled:m({onClick:!0}),captured:m({onClickCapture:!0})}},contextMenu:{phasedRegistrationNames:{bubbled:m({onContextMenu:!0}),captured:m({onContextMenuCapture:!0})}},copy:{phasedRegistrationNames:{bubbled:m({onCopy:!0}),captured:m({onCopyCapture:!0})}},cut:{phasedRegistrationNames:{bubbled:m({onCut:!0}),captured:m({onCutCapture:!0})}},doubleClick:{phasedRegistrationNames:{bubbled:m({onDoubleClick:!0}),captured:m({onDoubleClickCapture:!0})}},drag:{phasedRegistrationNames:{bubbled:m({onDrag:!0}),captured:m({onDragCapture:!0})}},dragEnd:{phasedRegistrationNames:{bubbled:m({onDragEnd:!0}),captured:m({onDragEndCapture:!0})}},dragEnter:{phasedRegistrationNames:{bubbled:m({onDragEnter:!0}),captured:m({onDragEnterCapture:!0})}},dragExit:{phasedRegistrationNames:{bubbled:m({onDragExit:!0}),captured:m({onDragExitCapture:!0})}},dragLeave:{phasedRegistrationNames:{bubbled:m({onDragLeave:!0}),captured:m({onDragLeaveCapture:!0})}},dragOver:{phasedRegistrationNames:{bubbled:m({onDragOver:!0}),captured:m({onDragOverCapture:!0})}},dragStart:{phasedRegistrationNames:{bubbled:m({onDragStart:!0}),captured:m({onDragStartCapture:!0})}},drop:{phasedRegistrationNames:{bubbled:m({onDrop:!0}),captured:m({onDropCapture:!0})}},focus:{phasedRegistrationNames:{bubbled:m({onFocus:!0}),captured:m({onFocusCapture:!0})}},input:{phasedRegistrationNames:{bubbled:m({onInput:!0}),captured:m({onInputCapture:!0})}},keyDown:{phasedRegistrationNames:{bubbled:m({onKeyDown:!0}),captured:m({onKeyDownCapture:!0})}},keyPress:{phasedRegistrationNames:{bubbled:m({onKeyPress:!0}),captured:m({onKeyPressCapture:!0})}},keyUp:{phasedRegistrationNames:{bubbled:m({onKeyUp:!0}),captured:m({onKeyUpCapture:!0})}},load:{phasedRegistrationNames:{bubbled:m({onLoad:!0}),captured:m({onLoadCapture:!0})}},error:{phasedRegistrationNames:{bubbled:m({onError:!0}),captured:m({onErrorCapture:!0})}},mouseDown:{phasedRegistrationNames:{bubbled:m({onMouseDown:!0}),captured:m({onMouseDownCapture:!0})}},mouseMove:{phasedRegistrationNames:{bubbled:m({onMouseMove:!0}),captured:m({onMouseMoveCapture:!0})}},mouseOut:{phasedRegistrationNames:{bubbled:m({onMouseOut:!0}),captured:m({onMouseOutCapture:!0})}},mouseOver:{phasedRegistrationNames:{bubbled:m({onMouseOver:!0}),captured:m({onMouseOverCapture:!0})}},mouseUp:{phasedRegistrationNames:{bubbled:m({onMouseUp:!0}),captured:m({onMouseUpCapture:!0})}},paste:{phasedRegistrationNames:{bubbled:m({onPaste:!0}),captured:m({onPasteCapture:!0})}},reset:{phasedRegistrationNames:{bubbled:m({onReset:!0}),captured:m({onResetCapture:!0})}},scroll:{phasedRegistrationNames:{bubbled:m({onScroll:!0}),captured:m({onScrollCapture:!0})}},submit:{phasedRegistrationNames:{bubbled:m({onSubmit:!0}),captured:m({onSubmitCapture:!0})}},touchCancel:{phasedRegistrationNames:{bubbled:m({onTouchCancel:!0}),captured:m({onTouchCancelCapture:!0})}},touchEnd:{phasedRegistrationNames:{bubbled:m({onTouchEnd:!0}),captured:m({onTouchEndCapture:!0})}},touchMove:{phasedRegistrationNames:{bubbled:m({onTouchMove:!0}),captured:m({onTouchMoveCapture:!0})}},touchStart:{phasedRegistrationNames:{bubbled:m({onTouchStart:!0}),captured:m({onTouchStartCapture:!0})}},wheel:{phasedRegistrationNames:{bubbled:m({onWheel:!0}),captured:m({onWheelCapture:!0})}}},y={topBlur:v.blur,topClick:v.click,topContextMenu:v.contextMenu,topCopy:v.copy,topCut:v.cut,topDoubleClick:v.doubleClick,topDrag:v.drag,topDragEnd:v.dragEnd,topDragEnter:v.dragEnter,topDragExit:v.dragExit,topDragLeave:v.dragLeave,topDragOver:v.dragOver,topDragStart:v.dragStart,topDrop:v.drop,topError:v.error,topFocus:v.focus,topInput:v.input,topKeyDown:v.keyDown,topKeyPress:v.keyPress,topKeyUp:v.keyUp,topLoad:v.load,topMouseDown:v.mouseDown,topMouseMove:v.mouseMove,topMouseOut:v.mouseOut,topMouseOver:v.mouseOver,topMouseUp:v.mouseUp,topPaste:v.paste,topReset:v.reset,topScroll:v.scroll,topSubmit:v.submit,topTouchCancel:v.touchCancel,topTouchEnd:v.touchEnd,topTouchMove:v.touchMove,topTouchStart:v.touchStart,topWheel:v.wheel};for(var _ in y)y[_].dependencies=[_];var E={eventTypes:v,executeDispatch:function(e,t,n){var i=r.executeDispatch(e,t,n);i===!1&&(e.stopPropagation(),e.preventDefault())},extractEvents:function(e,t,n,r){var m=y[e];if(!m)return null;var v;switch(e){case g.topInput:case g.topLoad:case g.topError:case g.topReset:case g.topSubmit:v=a;break;case g.topKeyPress:if(0===r.charCode)return null;case g.topKeyDown:case g.topKeyUp:v=l;break;case g.topBlur:case g.topFocus:v=s;break;case g.topClick:if(2===r.button)return null;case g.topContextMenu:case g.topDoubleClick:case g.topMouseDown:case g.topMouseMove:case g.topMouseOut:case g.topMouseOver:case g.topMouseUp:v=c;break;case g.topDrag:case g.topDragEnd:case g.topDragEnter:case g.topDragExit:case g.topDragLeave:case g.topDragOver:case g.topDragStart:case g.topDrop:v=u;break;case g.topTouchCancel:case g.topTouchEnd:case g.topTouchMove:case g.topTouchStart:v=d;break;case g.topScroll:v=p;break;case g.topWheel:v=h;break;case g.topCopy:case g.topCut:case g.topPaste:v=o}f(v,"SimpleEventPlugin: Unhandled event type, `%s`.",e);var _=v.getPooled(m,n,r);return i.accumulateTwoPhaseDispatches(_),_}};t.exports=E},{"./EventConstants":16,"./EventPluginUtils":20,"./EventPropagators":21,"./SyntheticClipboardEvent":93,"./SyntheticDragEvent":95,"./SyntheticEvent":96,"./SyntheticFocusEvent":97,"./SyntheticKeyboardEvent":99,"./SyntheticMouseEvent":100,"./SyntheticTouchEvent":101,"./SyntheticUIEvent":102,"./SyntheticWheelEvent":103,"./invariant":134,"./keyOf":141}],93:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticEvent"),i={clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}};r.augmentClass(n,i),t.exports=n},{"./SyntheticEvent":96}],94:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticEvent"),i={data:null};r.augmentClass(n,i),t.exports=n},{"./SyntheticEvent":96}],95:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticMouseEvent"),i={dataTransfer:null};r.augmentClass(n,i),t.exports=n},{"./SyntheticMouseEvent":100}],96:[function(e,t){"use strict";function n(e,t,n){this.dispatchConfig=e,this.dispatchMarker=t,this.nativeEvent=n;var r=this.constructor.Interface;for(var o in r)if(r.hasOwnProperty(o)){var a=r[o];this[o]=a?a(n):n[o]}var s=null!=n.defaultPrevented?n.defaultPrevented:n.returnValue===!1;this.isDefaultPrevented=s?i.thatReturnsTrue:i.thatReturnsFalse,this.isPropagationStopped=i.thatReturnsFalse}var r=e("./PooledClass"),i=e("./emptyFunction"),o=e("./getEventTarget"),a=e("./merge"),s=e("./mergeInto"),l={type:null,target:o,currentTarget:i.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};s(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e.preventDefault?e.preventDefault():e.returnValue=!1,this.isDefaultPrevented=i.thatReturnsTrue},stopPropagation:function(){var e=this.nativeEvent;e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this.isPropagationStopped=i.thatReturnsTrue},persist:function(){this.isPersistent=i.thatReturnsTrue},isPersistent:i.thatReturnsFalse,destructor:function(){var e=this.constructor.Interface;for(var t in e)this[t]=null;this.dispatchConfig=null,this.dispatchMarker=null,this.nativeEvent=null}}),n.Interface=l,n.augmentClass=function(e,t){var n=this,i=Object.create(n.prototype);s(i,e.prototype),e.prototype=i,e.prototype.constructor=e,e.Interface=a(n.Interface,t),e.augmentClass=n.augmentClass,r.addPoolingTo(e,r.threeArgumentPooler)},r.addPoolingTo(n,r.threeArgumentPooler),t.exports=n},{"./PooledClass":28,"./emptyFunction":116,"./getEventTarget":125,"./merge":144,"./mergeInto":146}],97:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticUIEvent"),i={relatedTarget:null};r.augmentClass(n,i),t.exports=n},{"./SyntheticUIEvent":102}],98:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticEvent"),i={data:null};r.augmentClass(n,i),t.exports=n},{"./SyntheticEvent":96}],99:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticUIEvent"),i=e("./getEventKey"),o=e("./getEventModifierState"),a={key:i,location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:o,charCode:function(e){return"keypress"===e.type?"charCode"in e?e.charCode:e.keyCode:0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return e.keyCode||e.charCode}};r.augmentClass(n,a),t.exports=n},{"./SyntheticUIEvent":102,"./getEventKey":123,"./getEventModifierState":124}],100:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticUIEvent"),i=e("./ViewportMetrics"),o=e("./getEventModifierState"),a={screenX:null,screenY:null,clientX:null,clientY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:o,button:function(e){var t=e.button;return"which"in e?t:2===t?2:4===t?1:0},buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},pageX:function(e){return"pageX"in e?e.pageX:e.clientX+i.currentScrollLeft},pageY:function(e){return"pageY"in e?e.pageY:e.clientY+i.currentScrollTop}};r.augmentClass(n,a),t.exports=n},{"./SyntheticUIEvent":102,"./ViewportMetrics":105,"./getEventModifierState":124}],101:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticUIEvent"),i=e("./getEventModifierState"),o={touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:i};r.augmentClass(n,o),t.exports=n},{"./SyntheticUIEvent":102,"./getEventModifierState":124}],102:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticEvent"),i=e("./getEventTarget"),o={view:function(e){if(e.view)return e.view;var t=i(e);if(null!=t&&t.window===t)return t;var n=t.ownerDocument;return n?n.defaultView||n.parentWindow:window},detail:function(e){return e.detail||0}};r.augmentClass(n,o),t.exports=n},{"./SyntheticEvent":96,"./getEventTarget":125}],103:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticMouseEvent"),i={deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null};r.augmentClass(n,i),t.exports=n},{"./SyntheticMouseEvent":100}],104:[function(e,t){"use strict";var n=e("./invariant"),r={reinitializeTransaction:function(){this.transactionWrappers=this.getTransactionWrappers(),this.wrapperInitData?this.wrapperInitData.length=0:this.wrapperInitData=[],this._isInTransaction=!1},_isInTransaction:!1,getTransactionWrappers:null,isInTransaction:function(){return!!this._isInTransaction},perform:function(e,t,r,i,o,a,s,l){n(!this.isInTransaction(),"Transaction.perform(...): Cannot initialize a transaction when there is already an outstanding transaction.");var c,u;try{this._isInTransaction=!0,c=!0,this.initializeAll(0),u=e.call(t,r,i,o,a,s,l),c=!1}finally{try{if(c)try{this.closeAll(0)}catch(d){}else this.closeAll(0)}finally{this._isInTransaction=!1}}return u},initializeAll:function(e){for(var t=this.transactionWrappers,n=e;n<t.length;n++){var r=t[n];try{this.wrapperInitData[n]=i.OBSERVED_ERROR,this.wrapperInitData[n]=r.initialize?r.initialize.call(this):null}finally{if(this.wrapperInitData[n]===i.OBSERVED_ERROR)try{this.initializeAll(n+1)}catch(o){}}}},closeAll:function(e){n(this.isInTransaction(),"Transaction.closeAll(): Cannot close transaction when none are open.");for(var t=this.transactionWrappers,r=e;r<t.length;r++){var o,a=t[r],s=this.wrapperInitData[r];try{o=!0,s!==i.OBSERVED_ERROR&&a.close&&a.close.call(this,s),o=!1}finally{if(o)try{this.closeAll(r+1)}catch(l){}}}this.wrapperInitData.length=0}},i={Mixin:r,OBSERVED_ERROR:{}};t.exports=i},{"./invariant":134}],105:[function(e,t){"use strict";var n=e("./getUnboundedScrollPosition"),r={currentScrollLeft:0,currentScrollTop:0,refreshScrollValues:function(){var e=n(window);r.currentScrollLeft=e.x,r.currentScrollTop=e.y}};t.exports=r},{"./getUnboundedScrollPosition":130}],106:[function(e,t){"use strict";function n(e,t){if(r(null!=t,"accumulate(...): Accumulated items must be not be null or undefined."),null==e)return t;var n=Array.isArray(e),i=Array.isArray(t);return n?e.concat(t):i?[e].concat(t):[e,t]}var r=e("./invariant");t.exports=n},{"./invariant":134}],107:[function(e,t){"use strict";function n(e){for(var t=1,n=0,i=0;i<e.length;i++)t=(t+e.charCodeAt(i))%r,n=(n+t)%r;return t|n<<16}var r=65521;t.exports=n},{}],108:[function(e,t){"use strict";function n(e,t){o(!e.props.ref,"You are calling cloneWithProps() on a child with a ref. This is dangerous because you're creating a new child which will not be added as a ref to its parent.");var n=r.mergeProps(t,e.props);return!n.hasOwnProperty(a)&&e.props.hasOwnProperty(a)&&(n.children=e.props.children),e.constructor(n)}var r=e("./ReactPropTransferer"),i=e("./keyOf"),o=e("./warning"),a=i({children:null});t.exports=n},{"./ReactPropTransferer":72,"./keyOf":141,"./warning":158}],109:[function(e,t){function n(e,t){return e&&t?e===t?!0:r(e)?!1:r(t)?n(e,t.parentNode):e.contains?e.contains(t):e.compareDocumentPosition?!!(16&e.compareDocumentPosition(t)):!1:!1}var r=e("./isTextNode");t.exports=n},{"./isTextNode":138}],110:[function(e,t){function n(e,t,n,r,i,o,a){if(e=e||{},a)throw new Error("Too many arguments passed to copyProperties");for(var s,l=[t,n,r,i,o],c=0;l[c];){s=l[c++];for(var u in s)e[u]=s[u];s.hasOwnProperty&&s.hasOwnProperty("toString")&&"undefined"!=typeof s.toString&&e.toString!==s.toString&&(e.toString=s.toString)}return e}t.exports=n},{}],111:[function(e,t){function n(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"length"in e&&!("setInterval"in e)&&"number"!=typeof e.nodeType&&(Array.isArray(e)||"callee"in e||"item"in e)}function r(e){return n(e)?Array.isArray(e)?e.slice():i(e):[e]}var i=e("./toArray");t.exports=r},{"./toArray":155}],112:[function(e,t){"use strict";function n(e){var t=r.createClass({displayName:"ReactFullPageComponent"+(e.type.displayName||""),componentWillUnmount:function(){i(!1,"%s tried to unmount. Because of cross-browser quirks it is impossible to unmount some top-level components (eg <html>, <head>, and <body>) reliably and efficiently. To fix this, have a single top-level component that never unmounts render these elements.",this.constructor.displayName)},render:function(){return this.transferPropsTo(e(null,this.props.children))}});return t}var r=e("./ReactCompositeComponent"),i=e("./invariant");t.exports=n},{"./ReactCompositeComponent":38,"./invariant":134}],113:[function(e,t){function n(e){var t=e.match(c);return t&&t[1].toLowerCase()}function r(e,t){var r=l;s(!!l,"createNodesFromMarkup dummy not initialized");var i=n(e),c=i&&a(i);if(c){r.innerHTML=c[1]+e+c[2];for(var u=c[0];u--;)r=r.lastChild}else r.innerHTML=e;var d=r.getElementsByTagName("script");d.length&&(s(t,"createNodesFromMarkup(...): Unexpected <script> element rendered."),o(d).forEach(t));for(var p=o(r.childNodes);r.lastChild;)r.removeChild(r.lastChild);return p}var i=e("./ExecutionEnvironment"),o=e("./createArrayFrom"),a=e("./getMarkupWrap"),s=e("./invariant"),l=i.canUseDOM?document.createElement("div"):null,c=/^\s*<(\w+)/;t.exports=r},{"./ExecutionEnvironment":22,"./createArrayFrom":111,"./getMarkupWrap":126,"./invariant":134}],114:[function(e,t){function n(e){return"object"==typeof e?Object.keys(e).filter(function(t){return e[t]}).join(" "):Array.prototype.join.call(arguments," ")}t.exports=n},{}],115:[function(e,t){"use strict";function n(e,t){var n=null==t||"boolean"==typeof t||""===t;if(n)return"";var r=isNaN(t);return r||0===t||i.hasOwnProperty(e)&&i[e]?""+t:("string"==typeof t&&(t=t.trim()),t+"px")}var r=e("./CSSProperty"),i=r.isUnitlessNumber;t.exports=n},{"./CSSProperty":4}],116:[function(e,t){function n(e){return function(){return e}}function r(){}var i=e("./copyProperties");i(r,{thatReturns:n,thatReturnsFalse:n(!1),thatReturnsTrue:n(!0),thatReturnsNull:n(null),thatReturnsThis:function(){return this},thatReturnsArgument:function(e){return e}}),t.exports=r},{"./copyProperties":110}],117:[function(e,t){"use strict";var n={};Object.freeze(n),t.exports=n},{}],118:[function(e,t){"use strict";function n(e){return i[e]}function r(e){return(""+e).replace(o,n)}var i={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},o=/[&><"']/g;t.exports=r},{}],119:[function(e,t){"use strict";function n(e,t,n){var r=e,i=!r.hasOwnProperty(n);o(i,"flattenChildren(...): Encountered two children with the same key, `%s`. Child keys must be unique; when two children share a key, only the first child will be used.",n),i&&null!=t&&(r[n]=t)}function r(e){if(null==e)return e;var t={};return i(e,n,t),t}var i=e("./traverseAllChildren"),o=e("./warning");t.exports=r},{"./traverseAllChildren":156,"./warning":158}],120:[function(e,t){"use strict";function n(e){e.disabled||e.focus()}t.exports=n},{}],121:[function(e,t){"use strict";var n=function(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)};t.exports=n},{}],122:[function(e,t){function n(){try{return document.activeElement||document.body}catch(e){return document.body}}t.exports=n},{}],123:[function(e,t){"use strict";function n(e){if(e.key){var t=i[e.key]||e.key;if("Unidentified"!==t)return t}if("keypress"===e.type){var n="charCode"in e?e.charCode:e.keyCode;return 13===n?"Enter":String.fromCharCode(n)}return"keydown"===e.type||"keyup"===e.type?o[e.keyCode]||"Unidentified":void r(!1,"Unexpected keyboard event type: %s",e.type)}var r=e("./invariant"),i={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},o={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};t.exports=n},{"./invariant":134}],124:[function(e,t){"use strict";function n(e){var t=this,n=t.nativeEvent;if(n.getModifierState)return n.getModifierState(e);var r=i[e];return r?!!n[r]:!1}function r(){return n
}var i={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};t.exports=r},{}],125:[function(e,t){"use strict";function n(e){var t=e.target||e.srcElement||window;return 3===t.nodeType?t.parentNode:t}t.exports=n},{}],126:[function(e,t){function n(e){return i(!!o,"Markup wrapping node not initialized"),d.hasOwnProperty(e)||(e="*"),a.hasOwnProperty(e)||(o.innerHTML="*"===e?"<link />":"<"+e+"></"+e+">",a[e]=!o.firstChild),a[e]?d[e]:null}var r=e("./ExecutionEnvironment"),i=e("./invariant"),o=r.canUseDOM?document.createElement("div"):null,a={circle:!0,defs:!0,ellipse:!0,g:!0,line:!0,linearGradient:!0,path:!0,polygon:!0,polyline:!0,radialGradient:!0,rect:!0,stop:!0,text:!0},s=[1,'<select multiple="true">',"</select>"],l=[1,"<table>","</table>"],c=[3,"<table><tbody><tr>","</tr></tbody></table>"],u=[1,"<svg>","</svg>"],d={"*":[1,"?<div>","</div>"],area:[1,"<map>","</map>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],param:[1,"<object>","</object>"],tr:[2,"<table><tbody>","</tbody></table>"],optgroup:s,option:s,caption:l,colgroup:l,tbody:l,tfoot:l,thead:l,td:c,th:c,circle:u,defs:u,ellipse:u,g:u,line:u,linearGradient:u,path:u,polygon:u,polyline:u,radialGradient:u,rect:u,stop:u,text:u};t.exports=n},{"./ExecutionEnvironment":22,"./invariant":134}],127:[function(e,t){"use strict";function n(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function r(e){for(;e;){if(e.nextSibling)return e.nextSibling;e=e.parentNode}}function i(e,t){for(var i=n(e),o=0,a=0;i;){if(3==i.nodeType){if(a=o+i.textContent.length,t>=o&&a>=t)return{node:i,offset:t-o};o=a}i=n(r(i))}}t.exports=i},{}],128:[function(e,t){"use strict";function n(e){return e?e.nodeType===r?e.documentElement:e.firstChild:null}var r=9;t.exports=n},{}],129:[function(e,t){"use strict";function n(){return!i&&r.canUseDOM&&(i="textContent"in document.documentElement?"textContent":"innerText"),i}var r=e("./ExecutionEnvironment"),i=null;t.exports=n},{"./ExecutionEnvironment":22}],130:[function(e,t){"use strict";function n(e){return e===window?{x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}:{x:e.scrollLeft,y:e.scrollTop}}t.exports=n},{}],131:[function(e,t){function n(e){return e.replace(r,"-$1").toLowerCase()}var r=/([A-Z])/g;t.exports=n},{}],132:[function(e,t){"use strict";function n(e){return r(e).replace(i,"-ms-")}var r=e("./hyphenate"),i=/^ms-/;t.exports=n},{"./hyphenate":131}],133:[function(e,t){"use strict";function n(e){return e&&"function"==typeof e.type&&"function"==typeof e.type.prototype.mountComponent&&"function"==typeof e.type.prototype.receiveComponent}function r(e){return i(n(e),"Only React Components are valid for mounting."),new e.type(e)}var i=e("./invariant");t.exports=r},{"./invariant":134}],134:[function(e,t){"use strict";var n=function(e,t,n,r,i,o,a,s){if(void 0===t)throw new Error("invariant requires an error message argument");if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,i,o,a,s],u=0;l=new Error("Invariant Violation: "+t.replace(/%s/g,function(){return c[u++]}))}throw l.framesToPop=1,l}};t.exports=n},{}],135:[function(e,t){"use strict";function n(e,t){if(!i.canUseDOM||t&&!("addEventListener"in document))return!1;var n="on"+e,o=n in document;if(!o){var a=document.createElement("div");a.setAttribute(n,"return;"),o="function"==typeof a[n]}return!o&&r&&"wheel"===e&&(o=document.implementation.hasFeature("Events.wheel","3.0")),o}var r,i=e("./ExecutionEnvironment");i.canUseDOM&&(r=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0),t.exports=n},{"./ExecutionEnvironment":22}],136:[function(e,t){function n(e){return!(!e||!("function"==typeof Node?e instanceof Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName))}t.exports=n},{}],137:[function(e,t){"use strict";function n(e){return e&&("INPUT"===e.nodeName&&r[e.type]||"TEXTAREA"===e.nodeName)}var r={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};t.exports=n},{}],138:[function(e,t){function n(e){return r(e)&&3==e.nodeType}var r=e("./isNode");t.exports=n},{"./isNode":136}],139:[function(e,t){"use strict";function n(e){e||(e="");var t,n=arguments.length;if(n>1)for(var r=1;n>r;r++)t=arguments[r],t&&(e+=" "+t);return e}t.exports=n},{}],140:[function(e,t){"use strict";var n=e("./invariant"),r=function(e){var t,r={};n(e instanceof Object&&!Array.isArray(e),"keyMirror(...): Argument must be an object.");for(t in e)e.hasOwnProperty(t)&&(r[t]=t);return r};t.exports=r},{"./invariant":134}],141:[function(e,t){var n=function(e){var t;for(t in e)if(e.hasOwnProperty(t))return t;return null};t.exports=n},{}],142:[function(e,t){"use strict";function n(e,t,n){if(!e)return null;var r=0,i={};for(var o in e)e.hasOwnProperty(o)&&(i[o]=t.call(n,e[o],o,r++));return i}t.exports=n},{}],143:[function(e,t){"use strict";function n(e){var t={};return function(n){return t.hasOwnProperty(n)?t[n]:t[n]=e.call(this,n)}}t.exports=n},{}],144:[function(e,t){"use strict";var n=e("./mergeInto"),r=function(e,t){var r={};return n(r,e),n(r,t),r};t.exports=r},{"./mergeInto":146}],145:[function(e,t){"use strict";var n=e("./invariant"),r=e("./keyMirror"),i=36,o=function(e){return"object"!=typeof e||null===e},a={MAX_MERGE_DEPTH:i,isTerminal:o,normalizeMergeArg:function(e){return void 0===e||null===e?{}:e},checkMergeArrayArgs:function(e,t){n(Array.isArray(e)&&Array.isArray(t),"Tried to merge arrays, instead got %s and %s.",e,t)},checkMergeObjectArgs:function(e,t){a.checkMergeObjectArg(e),a.checkMergeObjectArg(t)},checkMergeObjectArg:function(e){n(!o(e)&&!Array.isArray(e),"Tried to merge an object, instead got %s.",e)},checkMergeIntoObjectArg:function(e){n(!(o(e)&&"function"!=typeof e||Array.isArray(e)),"Tried to merge into an object, instead got %s.",e)},checkMergeLevel:function(e){n(i>e,"Maximum deep merge depth exceeded. You may be attempting to merge circular structures in an unsupported way.")},checkArrayStrategy:function(e){n(void 0===e||e in a.ArrayStrategies,"You must provide an array strategy to deep merge functions to instruct the deep merge how to resolve merging two arrays.")},ArrayStrategies:r({Clobber:!0,IndexByIndex:!0})};t.exports=a},{"./invariant":134,"./keyMirror":140}],146:[function(e,t){"use strict";function n(e,t){if(o(e),null!=t){i(t);for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}}var r=e("./mergeHelpers"),i=r.checkMergeObjectArg,o=r.checkMergeIntoObjectArg;t.exports=n},{"./mergeHelpers":145}],147:[function(e,t){"use strict";var n=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e.prototype[n]=t[n])};t.exports=n},{}],148:[function(e,t){"use strict";function n(e){r(e&&!/[^a-z0-9_]/.test(e),"You must provide an eventName using only the characters [a-z0-9_]")}var r=e("./invariant");t.exports=n},{"./invariant":134}],149:[function(e,t){"use strict";function n(e){return i(r.isValidDescriptor(e),"onlyChild must be passed a children with exactly one child."),e}var r=e("./ReactDescriptor"),i=e("./invariant");t.exports=n},{"./ReactDescriptor":56,"./invariant":134}],150:[function(e,t){"use strict";var n,r=e("./ExecutionEnvironment");r.canUseDOM&&(n=window.performance||window.msPerformance||window.webkitPerformance),t.exports=n||{}},{"./ExecutionEnvironment":22}],151:[function(e,t){var n=e("./performance");n&&n.now||(n=Date);var r=n.now.bind(n);t.exports=r},{"./performance":150}],152:[function(e,t){"use strict";var n=e("./ExecutionEnvironment"),r=function(e,t){e.innerHTML=t};if(n.canUseDOM){var i=document.createElement("div");i.innerHTML=" ",""===i.innerHTML&&(r=function(e,t){if(e.parentNode&&e.parentNode.replaceChild(e,e),t.match(/^[ \r\n\t\f]/)||"<"===t[0]&&(-1!==t.indexOf("<noscript")||-1!==t.indexOf("<script")||-1!==t.indexOf("<style")||-1!==t.indexOf("<meta")||-1!==t.indexOf("<link"))){e.innerHTML=""+t;var n=e.firstChild;1===n.data.length?e.removeChild(n):n.deleteData(0,1)}else e.innerHTML=t})}t.exports=r},{"./ExecutionEnvironment":22}],153:[function(e,t){"use strict";function n(e,t){if(e===t)return!0;var n;for(n in e)if(e.hasOwnProperty(n)&&(!t.hasOwnProperty(n)||e[n]!==t[n]))return!1;for(n in t)if(t.hasOwnProperty(n)&&!e.hasOwnProperty(n))return!1;return!0}t.exports=n},{}],154:[function(e,t){"use strict";function n(e,t){return e&&t&&e.type===t.type&&(e.props&&e.props.key)===(t.props&&t.props.key)&&e._owner===t._owner?!0:!1}t.exports=n},{}],155:[function(e,t){function n(e){var t=e.length;if(r(!Array.isArray(e)&&("object"==typeof e||"function"==typeof e),"toArray: Array-like object expected"),r("number"==typeof t,"toArray: Object needs a length property"),r(0===t||t-1 in e,"toArray: Object should have keys for indices"),e.hasOwnProperty)try{return Array.prototype.slice.call(e)}catch(n){}for(var i=Array(t),o=0;t>o;o++)i[o]=e[o];return i}var r=e("./invariant");t.exports=n},{"./invariant":134}],156:[function(e,t){"use strict";function n(e){return p[e]}function r(e,t){return e&&e.props&&null!=e.props.key?o(e.props.key):t.toString(36)}function i(e){return(""+e).replace(h,n)}function o(e){return"$"+i(e)}function a(e,t,n){return null==e?0:f(e,"",0,t,n)}var s=e("./ReactInstanceHandles"),l=e("./ReactTextComponent"),c=e("./invariant"),u=s.SEPARATOR,d=":",p={"=":"=0",".":"=1",":":"=2"},h=/[=.:]/g,f=function(e,t,n,i,a){var s=0;if(Array.isArray(e))for(var p=0;p<e.length;p++){var h=e[p],m=t+(t?d:u)+r(h,p),g=n+s;s+=f(h,m,g,i,a)}else{var v=typeof e,y=""===t,_=y?u+r(e,0):t;if(null==e||"boolean"===v)i(a,null,_,n),s=1;else if(e.type&&e.type.prototype&&e.type.prototype.mountComponentIntoNode)i(a,e,_,n),s=1;else if("object"===v){c(!e||1!==e.nodeType,"traverseAllChildren(...): Encountered an invalid child; DOM elements are not valid children of React components.");for(var E in e)e.hasOwnProperty(E)&&(s+=f(e[E],t+(t?d:u)+o(E)+d+r(e[E],0),n+s,i,a))}else if("string"===v){var b=l(e);i(a,b,_,n),s+=1}else if("number"===v){var S=l(""+e);i(a,S,_,n),s+=1}}return s};t.exports=a},{"./ReactInstanceHandles":64,"./ReactTextComponent":83,"./invariant":134}],157:[function(e,t){"use strict";function n(e){return Array.isArray(e)?e.concat():e&&"object"==typeof e?o(new e.constructor,e):e}function r(e,t,n){s(Array.isArray(e),"update(): expected target of %s to be an array; got %s.",n,e);var r=t[n];s(Array.isArray(r),"update(): expected spec of %s to be an array; got %s. Did you forget to wrap your parameter in an array?",n,r)}function i(e,t){if(s("object"==typeof t,"update(): You provided a key path to update() that did not contain one of %s. Did you forget to include {%s: ...}?",f.join(", "),d),t.hasOwnProperty(d))return s(1===Object.keys(t).length,"Cannot have more than one key in an object with %s",d),t[d];var a=n(e);if(t.hasOwnProperty(p)){var g=t[p];s(g&&"object"==typeof g,"update(): %s expects a spec of type 'object'; got %s",p,g),s(a&&"object"==typeof a,"update(): %s expects a target of type 'object'; got %s",p,a),o(a,t[p])}t.hasOwnProperty(l)&&(r(e,t,l),t[l].forEach(function(e){a.push(e)})),t.hasOwnProperty(c)&&(r(e,t,c),t[c].forEach(function(e){a.unshift(e)})),t.hasOwnProperty(u)&&(s(Array.isArray(e),"Expected %s target to be an array; got %s",u,e),s(Array.isArray(t[u]),"update(): expected spec of %s to be an array of arrays; got %s. Did you forget to wrap your parameters in an array?",u,t[u]),t[u].forEach(function(e){s(Array.isArray(e),"update(): expected spec of %s to be an array of arrays; got %s. Did you forget to wrap your parameters in an array?",u,t[u]),a.splice.apply(a,e)})),t.hasOwnProperty(h)&&(s("function"==typeof t[h],"update(): expected spec of %s to be a function; got %s.",h,t[h]),a=t[h](a));for(var v in t)m.hasOwnProperty(v)&&m[v]||(a[v]=i(e[v],t[v]));return a}var o=e("./copyProperties"),a=e("./keyOf"),s=e("./invariant"),l=a({$push:null}),c=a({$unshift:null}),u=a({$splice:null}),d=a({$set:null}),p=a({$merge:null}),h=a({$apply:null}),f=[l,c,u,d,p,h],m={};f.forEach(function(e){m[e]=!0}),t.exports=i},{"./copyProperties":110,"./invariant":134,"./keyOf":141}],158:[function(e,t){"use strict";var n=e("./emptyFunction"),r=n;r=function(e,t){var n=Array.prototype.slice.call(arguments,2);if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(!e){var r=0;console.warn("Warning: "+t.replace(/%s/g,function(){return n[r++]}))}},t.exports=r},{"./emptyFunction":116}]},{},[88])(88)}),define("project/FileTreeView",["require","exports","module","thirdparty/react","thirdparty/immutable","thirdparty/lodash","file/FileUtils","language/LanguageManager","project/FileTreeViewModel","utils/ViewUtils","utils/KeyEvent"],function(e,t){"use strict";function n(e,t){return""!==t?e.substring(0,e.length-t.length-1):e}function r(e){var t=$("<span />",{css:{position:"absolute",top:"-200px",left:"-1000px",visibility:"hidden","white-space":"pre"}}).appendTo("body");t.text("pW"+e);var n=t.width();return t.remove(),n}function i(e){return void 0!==e}function o(e){function t(t,n){var r=y.isFile(e.get(t)),i=y.isFile(e.get(n));return!r&&i?-1:r&&!i?1:g.compareFilenames(t,n)}return t}function a(e,t){return e.keySeq().sort(t?o(e):g.compareFilenames)}function s(e,t,n,r,i,o){n&&h.renderComponent(P({treeData:t.treeData,selectionViewInfo:t.selectionViewInfo,sortDirectoriesFirst:t.sortDirectoriesFirst,parentPath:n.fullPath,actions:r,extensions:S,platform:o,forceRender:i}),e)}function l(e,t){if(!t||"function"!=typeof t)return void console.error("Attempt to add FileTreeView",e,"extension without a callback function");var n=S.get(e);n||(n=f.Vector()),n=n.push(t),S=S.set(e,n)}function c(e){l("icons",e)}function u(e){l("addClass",e)}var d,p,h=e("thirdparty/react"),f=e("thirdparty/immutable"),m=e("thirdparty/lodash"),g=e("file/FileUtils"),v=e("language/LanguageManager"),y=e("project/FileTreeViewModel"),_=e("utils/ViewUtils"),E=e("utils/KeyEvent"),b=h.DOM,S=f.Map(),I=500,w=2,C=0,D={myPath:function(){var e=this.props.parentPath+this.props.name;return y.isFile(this.props.entry)||"/"===m.last(e)||(e+="/"),e}},T={handleClick:function(e){return e.stopPropagation(),e.button!==C?!1:!0},handleKeyDown:function(e){e.keyCode===E.DOM_VK_ESCAPE?this.props.actions.cancelRename():e.keyCode===E.DOM_VK_RETURN&&this.props.actions.performRename()},handleInput:function(e){if(this.props.actions.setRenameValue(this.refs.name.getDOMNode().value.trim()),e.keyCode!==E.DOM_VK_LEFT&&e.keyCode!==E.DOM_VK_RIGHT){var t=this.refs.name.getDOMNode(),n=r(t.value);$(t).width(n)}},handleBlur:function(){this.props.actions.performRename()}},O=h.createClass({mixins:[T],componentDidMount:function(){var e=this.props.name,t=v.getCompoundFileExtension(e),r=this.refs.name.getDOMNode();r.setSelectionRange(0,n(e,t).length),_.scrollElementIntoView($("#project-files-container"),$(r),!0)},render:function(){var e=r(this.props.name);return b.input({className:"jstree-rename-input",type:"text",defaultValue:this.props.name,autoFocus:!0,onKeyDown:this.handleKeyDown,onInput:this.handleInput,onClick:this.handleClick,onBlur:this.handleBlur,style:{width:e},ref:"name"})}}),M={handleMouseDown:function(e){return e.button===w||"mac"===this.props.platform&&e.button===C&&e.ctrlKey?(this.props.actions.setContext(this.myPath()),!1):this.props.entry.get("rename")?(e.stopPropagation(),!0):!1}},L={getIcons:function(){var e,t=this.props.extensions;if(t&&t.get("icons")){var n=this.getDataForExtension();e=t.get("icons").map(function(e){try{var t=e(n);return t&&!h.isValidComponent(t)&&(t=h.DOM.span({dangerouslySetInnerHTML:{__html:$(t)[0].outerHTML}})),t}catch(r){console.error("Exception thrown in FileTreeView icon provider: "+r,r.stack)}}).filter(i).toArray()}return e&&0!==e.length||(e=[b.ins({className:"jstree-icon"}," ")]),e},getClasses:function(e){var t=this.props.extensions;if(t&&t.get("addClass")){var n=this.getDataForExtension();e=e+" "+t.get("addClass").map(function(e){try{return e(n)}catch(t){console.error("Exception thrown in FileTreeView addClass provider: "+t,t.stack)}}).filter(i).toArray().join(" ")}return e}},R=h.createClass({mixins:[M,D,L],getInitialState:function(){return{clickTimer:null}},shouldComponentUpdate:function(e){return e.forceRender||this.props.entry!==e.entry||this.props.extensions!==e.extensions},componentDidUpdate:function(e){var t=e.entry.get("selected"),n=this.props.entry.get("selected");n&&!t?_.scrollElementIntoView($("#project-files-container"),$(this.getDOMNode()),!0):!n&&t&&null!==this.state.clickTimer&&this.clearTimer()},clearTimer:function(){null!==this.state.clickTimer&&(window.clearTimeout(this.state.clickTimer),this.setState({clickTimer:null}))},startRename:function(){this.props.entry.get("rename")||this.props.actions.startRename(this.myPath()),this.clearTimer()},handleClick:function(e){if(this.props.entry.get("rename"))return!0;if(e.button===C){if(this.props.entry.get("selected")){if(null===this.state.clickTimer&&!this.props.entry.get("rename")){var t=window.setTimeout(this.startRename,I);this.setState({clickTimer:t})}}else this.props.actions.setSelected(this.myPath());return!1}},handleDoubleClick:function(){this.props.entry.get("rename")||(null!==this.state.clickTimer&&this.clearTimer(),this.props.actions.selectInWorkingSet(this.myPath()))},getDataForExtension:function(){return{name:this.props.name,isFile:!0,fullPath:this.myPath()}},render:function(){var e=this.props.name,t=v.getCompoundFileExtension(e),r=n(e,t);t&&(t=b.span({className:"extension"},"."+t));var i,o=h.addons.classSet,a=o({"jstree-clicked selected-node":this.props.entry.get("selected"),"context-node":this.props.entry.get("context")});if(this.props.entry.get("rename"))i=O({actions:this.props.actions,entry:this.props.entry,name:this.props.name,parentPath:this.props.parentPath});else{var s=m.flatten([{href:"#",className:a},this.getIcons(),r,t],!0);i=b.a.apply(b.a,s)}return b.li({className:this.getClasses("jstree-leaf"),onClick:this.handleClick,onMouseDown:this.handleMouseDown,onDoubleClick:this.handleDoubleClick},b.ins({className:"jstree-icon"}," "),i)}}),N=h.createClass({mixins:[T],componentDidMount:function(){var e=this.props.name,t=this.refs.name.getDOMNode();t.setSelectionRange(0,e.length),_.scrollElementIntoView($("#project-files-container"),$(t),!0)},render:function(){var e=r(this.props.name);return b.input({className:"jstree-rename-input",type:"text",defaultValue:this.props.name,autoFocus:!0,onKeyDown:this.handleKeyDown,onInput:this.handleInput,onBlur:this.handleBlur,style:{width:e},onClick:this.handleClick,ref:"name"})}});d=h.createClass({mixins:[M,D,L],shouldComponentUpdate:function(e){return e.forceRender||this.props.entry!==e.entry||this.props.sortDirectoriesFirst!==e.sortDirectoriesFirst||this.props.extensions!==e.extensions},handleClick:function(e){if(e.button===C){var t=this.props.entry.get("open"),n=t?!1:!0;return e.metaKey||e.ctrlKey?e.altKey?n?(this.props.actions.toggleSubdirectories(this.myPath(),n),this.props.actions.setDirectoryOpen(this.myPath(),n)):this.props.actions.closeSubtree(this.myPath()):this.props.actions.toggleSubdirectories(this.props.parentPath,n):this.props.actions.setDirectoryOpen(this.myPath(),n),!1}},getDataForExtension:function(){return{name:this.props.name,isFile:!1,fullPath:this.myPath()}},render:function(){var e,t,n=this.props.entry,r=n.get("children"),i=n.get("open"),o="";i&&r?(e="open",t=p({parentPath:this.myPath(),contents:r,extensions:this.props.extensions,actions:this.props.actions,forceRender:this.props.forceRender,platform:this.props.platform,sortDirectoriesFirst:this.props.sortDirectoriesFirst})):e="closed",this.props.entry.get("selected")&&(o+=" jstree-clicked sidebar-selection"),n.get("context")&&(o+=" context-node");var a,s;n.get("rename")&&(s=N({actions:this.props.actions,entry:this.props.entry,name:this.props.name,parentPath:this.props.parentPath}));var l=m.flatten([{href:"#",className:o},this.getIcons()],!0);return n.get("rename")||l.push(this.props.name),a=b.a.apply(b.a,l),b.li({className:this.getClasses("jstree-"+e),onClick:this.handleClick,onMouseDown:this.handleMouseDown},b.ins({className:"jstree-icon"}," "),s,a,t)}}),p=h.createClass({shouldComponentUpdate:function(e){return e.forceRender||this.props.contents!==e.contents||this.props.sortDirectoriesFirst!==e.sortDirectoriesFirst||this.props.extensions!==e.extensions},render:function(){var e=this.props.extensions,t=e&&e.get("icons")?"jstree-icons":"jstree-no-icons",n=this.props.isRoot?{className:"jstree-brackets jstree-no-dots "+t}:null,r=this.props.contents,i=a(r,this.props.sortDirectoriesFirst);return b.ul(n,i.map(function(e){var t=r.get(e);return y.isFile(t)?R({parentPath:this.props.parentPath,name:e,entry:t,actions:this.props.actions,extensions:this.props.extensions,forceRender:this.props.forceRender,platform:this.props.platform,key:e}):d({parentPath:this.props.parentPath,name:e,entry:t,actions:this.props.actions,extensions:this.props.extensions,sortDirectoriesFirst:this.props.sortDirectoriesFirst,forceRender:this.props.forceRender,platform:this.props.platform,key:e})}.bind(this)).toArray())}});var x=h.createClass({componentDidUpdate:function(){if(this.props.visible){var e=this.getDOMNode(),t=$(e.parentNode).find(this.props.selectedClassName),n=this.props.selectionViewInfo;0!==t.length&&(e.style.top=t.offset().top-n.get("offsetTop")+n.get("scrollTop")-t.position().top+"px")}},render:function(){var e=this.props.selectionViewInfo,t=e.get("scrollLeft"),n=e.get("width"),r=e.get("scrollWidth");return t+n>r&&(t=r-n),b.div({style:{overflow:"auto",left:t,width:n,display:this.props.visible?"block":"none"},className:this.props.className})}}),A=h.createClass({componentDidUpdate:function(){if(this.props.visible){var e=this.getDOMNode(),t=$(e.parentNode).find(this.props.selectedClassName),n=this.props.selectionViewInfo;if(0!==t.length){var r=t.offset().top,i=e.dataset.initialHeight,o=i,a=n.get("offsetTop");if(i||(i=$(e).outerHeight(),e.dataset.initialHeight=i,o=i),a-i>r)return void(e.style.display="none");if(e.style.display="block",a>r){var s=a-r;r+=s,o=parseInt(o,10),o-=s}e.style.top=r+"px",e.style.height=o+"px",e.style.left=n.get("width")-$(e).outerWidth()+"px"}}},render:function(){return b.div({style:{display:this.props.visible?"block":"none"},className:this.props.className})}}),P=h.createClass({shouldComponentUpdate:function(e){return e.forceRender||this.props.treeData!==e.treeData||this.props.sortDirectoriesFirst!==e.sortDirectoriesFirst||this.props.extensions!==e.extensions||this.props.selectionViewInfo!==e.selectionViewInfo},render:function(){var e=x({ref:"selectionBackground",selectionViewInfo:this.props.selectionViewInfo,className:"filetree-selection",visible:this.props.selectionViewInfo.get("hasSelection"),selectedClassName:".selected-node",forceUpdate:!0}),t=x({ref:"contextBackground",selectionViewInfo:this.props.selectionViewInfo,className:"filetree-context",visible:this.props.selectionViewInfo.get("hasContext"),selectedClassName:".context-node",forceUpdate:!0}),n=A({selectionViewInfo:this.props.selectionViewInfo,selectedClassName:".selected-node",visible:this.props.selectionViewInfo.get("hasSelection"),forceUpdate:!0,className:"filetree-selection-extension"}),r=A({selectionViewInfo:this.props.selectionViewInfo,selectedClassName:".context-node",visible:this.props.selectionViewInfo.get("hasContext"),forceUpdate:!0,className:"filetree-context-extension"}),i=p({isRoot:!0,parentPath:this.props.parentPath,sortDirectoriesFirst:this.props.sortDirectoriesFirst,contents:this.props.treeData,extensions:this.props.extensions,actions:this.props.actions,forceRender:this.props.forceRender,platform:this.props.platform});return b.div(null,e,t,n,r,i)}});t._sortFormattedDirectory=a,t._fileNode=R,t._directoryNode=d,t._directoryContents=p,t._fileTreeView=P,t.addIconProvider=c,t.addClassesProvider=u,t.render=s}),define("command/DefaultMenus",["require","exports","module","utils/AppInit","command/Commands","command/Menus","strings"],function(e){"use strict";var t=e("utils/AppInit"),n=e("command/Commands"),r=e("command/Menus"),i=e("strings");t.htmlReady(function(){var t;t=r.addMenu(i.FILE_MENU,r.AppMenuBar.FILE_MENU),t.addMenuItem(n.FILE_NEW_UNTITLED),t.addMenuItem(n.FILE_OPEN),t.addMenuItem(n.FILE_OPEN_FOLDER),t.addMenuItem(n.FILE_CLOSE),t.addMenuItem(n.FILE_CLOSE_ALL),t.addMenuDivider(),t.addMenuItem(n.FILE_SAVE),t.addMenuItem(n.FILE_SAVE_ALL),t.addMenuItem(n.FILE_SAVE_AS),t.addMenuDivider(),t.addMenuItem(n.FILE_LIVE_FILE_PREVIEW),t.addMenuItem(n.TOGGLE_LIVE_PREVIEW_MB_MODE),t.addMenuItem(n.FILE_PROJECT_SETTINGS),t.addMenuDivider(),t.addMenuItem(n.FILE_EXTENSION_MANAGER),"mac"===brackets.platform&&brackets.nativeMenus||(t.addMenuDivider(),t.addMenuItem(n.FILE_QUIT)),t=r.addMenu(i.EDIT_MENU,r.AppMenuBar.EDIT_MENU),t.addMenuItem(n.EDIT_UNDO),t.addMenuItem(n.EDIT_REDO),t.addMenuDivider(),brackets.nativeMenus&&(t.addMenuItem(n.EDIT_CUT),t.addMenuItem(n.EDIT_COPY),t.addMenuItem(n.EDIT_PASTE),t.addMenuDivider()),t.addMenuItem(n.EDIT_SELECT_ALL),t.addMenuItem(n.EDIT_SELECT_LINE),t.addMenuItem(n.EDIT_SPLIT_SEL_INTO_LINES),t.addMenuItem(n.EDIT_ADD_CUR_TO_PREV_LINE),t.addMenuItem(n.EDIT_ADD_CUR_TO_NEXT_LINE),t.addMenuDivider(),t.addMenuItem(n.EDIT_INDENT),t.addMenuItem(n.EDIT_UNINDENT),t.addMenuItem(n.EDIT_DUPLICATE),t.addMenuItem(n.EDIT_DELETE_LINES),t.addMenuItem(n.EDIT_LINE_UP),t.addMenuItem(n.EDIT_LINE_DOWN),t.addMenuDivider(),t.addMenuItem(n.EDIT_LINE_COMMENT),t.addMenuItem(n.EDIT_BLOCK_COMMENT),t.addMenuDivider(),t.addMenuItem(n.SHOW_CODE_HINTS),t.addMenuDivider(),t.addMenuItem(n.TOGGLE_CLOSE_BRACKETS),t=r.addMenu(i.FIND_MENU,r.AppMenuBar.FIND_MENU),t.addMenuItem(n.CMD_FIND),t.addMenuItem(n.CMD_FIND_NEXT),t.addMenuItem(n.CMD_FIND_PREVIOUS),t.addMenuItem(n.CMD_FIND_ALL_AND_SELECT),t.addMenuItem(n.CMD_ADD_NEXT_MATCH),t.addMenuItem(n.CMD_SKIP_CURRENT_MATCH),t.addMenuDivider(),t.addMenuItem(n.CMD_FIND_IN_FILES),t.addMenuItem(n.CMD_FIND_IN_SELECTED),t.addMenuDivider(),t.addMenuItem(n.CMD_REPLACE),t.addMenuItem(n.CMD_REPLACE_IN_FILES),t.addMenuItem(n.CMD_REPLACE_IN_SELECTED),t=r.addMenu(i.VIEW_MENU,r.AppMenuBar.VIEW_MENU),t.addMenuItem(n.CMD_THEMES_OPEN_SETTINGS),t.addMenuDivider(),t.addMenuItem(n.CMD_SPLITVIEW_NONE),t.addMenuItem(n.CMD_SPLITVIEW_VERTICAL),t.addMenuItem(n.CMD_SPLITVIEW_HORIZONTAL),t.addMenuDivider(),t.addMenuItem(n.VIEW_HIDE_SIDEBAR),t.addMenuDivider(),t.addMenuItem(n.VIEW_INCREASE_FONT_SIZE),t.addMenuItem(n.VIEW_DECREASE_FONT_SIZE),t.addMenuItem(n.VIEW_RESTORE_FONT_SIZE),t.addMenuDivider(),t.addMenuItem(n.TOGGLE_ACTIVE_LINE),t.addMenuItem(n.TOGGLE_LINE_NUMBERS),t.addMenuItem(n.TOGGLE_WORD_WRAP),t.addMenuDivider(),t.addMenuItem(n.FILE_LIVE_HIGHLIGHT),t.addMenuDivider(),t.addMenuItem(n.VIEW_TOGGLE_INSPECTION),t=r.addMenu(i.NAVIGATE_MENU,r.AppMenuBar.NAVIGATE_MENU),t.addMenuItem(n.NAVIGATE_QUICK_OPEN),t.addMenuItem(n.NAVIGATE_GOTO_LINE),t.addMenuItem(n.NAVIGATE_GOTO_DEFINITION),t.addMenuItem(n.NAVIGATE_JUMPTO_DEFINITION),t.addMenuItem(n.NAVIGATE_GOTO_FIRST_PROBLEM),t.addMenuDivider(),t.addMenuItem(n.NAVIGATE_NEXT_DOC),t.addMenuItem(n.NAVIGATE_PREV_DOC),t.addMenuDivider(),t.addMenuItem(n.NAVIGATE_SHOW_IN_FILE_TREE),t.addMenuDivider(),t.addMenuItem(n.TOGGLE_QUICK_EDIT),t.addMenuItem(n.QUICK_EDIT_PREV_MATCH),t.addMenuItem(n.QUICK_EDIT_NEXT_MATCH),t.addMenuItem(n.CSS_QUICK_EDIT_NEW_RULE),t.addMenuDivider(),t.addMenuItem(n.TOGGLE_QUICK_DOCS),t=r.addMenu(i.HELP_MENU,r.AppMenuBar.HELP_MENU),t.addMenuItem(n.HELP_CHECK_FOR_UPDATE),t.addMenuDivider(),brackets.config.how_to_use_url&&t.addMenuItem(n.HELP_HOW_TO_USE_BRACKETS),brackets.config.support_url&&t.addMenuItem(n.HELP_SUPPORT),brackets.config.suggest_feature_url&&t.addMenuItem(n.HELP_SUGGEST),brackets.config.release_notes_url&&t.addMenuItem(n.HELP_RELEASE_NOTES),brackets.config.get_involved_url&&t.addMenuItem(n.HELP_GET_INVOLVED),t.addMenuDivider(),t.addMenuItem(n.HELP_SHOW_EXT_FOLDER);var o="mac"!==brackets.platform||!brackets.nativeMenus;(o||brackets.config.homepage_url||brackets.config.twitter_url)&&t.addMenuDivider(),brackets.config.homepage_url&&t.addMenuItem(n.HELP_HOMEPAGE),brackets.config.twitter_url&&t.addMenuItem(n.HELP_TWITTER),o&&t.addMenuItem(n.HELP_ABOUT);var a=r.registerContextMenu(r.ContextMenuIds.WORKING_SET_CONTEXT_MENU);a.addMenuItem(n.FILE_SAVE),a.addMenuItem(n.FILE_SAVE_AS),a.addMenuItem(n.FILE_RENAME),a.addMenuItem(n.NAVIGATE_SHOW_IN_FILE_TREE),a.addMenuItem(n.NAVIGATE_SHOW_IN_OS),a.addMenuDivider(),a.addMenuItem(n.CMD_FIND_IN_SUBTREE),a.addMenuItem(n.CMD_REPLACE_IN_SUBTREE),a.addMenuDivider(),a.addMenuItem(n.FILE_CLOSE);var s=r.registerContextMenu(r.ContextMenuIds.WORKING_SET_CONFIG_MENU);s.addMenuItem(n.CMD_WORKINGSET_SORT_BY_ADDED),s.addMenuItem(n.CMD_WORKINGSET_SORT_BY_NAME),s.addMenuItem(n.CMD_WORKINGSET_SORT_BY_TYPE),s.addMenuDivider(),s.addMenuItem(n.CMD_WORKING_SORT_TOGGLE_AUTO);var l=r.registerContextMenu(r.ContextMenuIds.SPLITVIEW_MENU);l.addMenuItem(n.CMD_SPLITVIEW_NONE),l.addMenuItem(n.CMD_SPLITVIEW_VERTICAL),l.addMenuItem(n.CMD_SPLITVIEW_HORIZONTAL);var c=r.registerContextMenu(r.ContextMenuIds.PROJECT_MENU);c.addMenuItem(n.FILE_NEW),c.addMenuItem(n.FILE_NEW_FOLDER),c.addMenuItem(n.FILE_RENAME),c.addMenuItem(n.FILE_DELETE),c.addMenuItem(n.NAVIGATE_SHOW_IN_OS),c.addMenuDivider(),c.addMenuItem(n.CMD_FIND_IN_SUBTREE),c.addMenuItem(n.CMD_REPLACE_IN_SUBTREE),c.addMenuDivider(),c.addMenuItem(n.FILE_REFRESH);var u=r.registerContextMenu(r.ContextMenuIds.EDITOR_MENU);u.addMenuItem(n.TOGGLE_QUICK_EDIT),u.addMenuItem(n.TOGGLE_QUICK_DOCS),u.addMenuItem(n.EDIT_SELECT_ALL);var d=r.registerContextMenu(r.ContextMenuIds.INLINE_EDITOR_MENU);d.addMenuItem(n.TOGGLE_QUICK_EDIT),d.addMenuItem(n.EDIT_SELECT_ALL),d.addMenuDivider(),d.addMenuItem(n.QUICK_EDIT_PREV_MATCH),d.addMenuItem(n.QUICK_EDIT_NEXT_MATCH),$("#editor-holder").on("contextmenu",function(t){e(["editor/EditorManager"],function(e){if(0===$(t.target).parents(".CodeMirror-gutter").length){var n=e.getFocusedEditor(),r=e.getFocusedInlineWidget();n&&(n.hasSelection()||n.selectWordAt(n.getCursorPos()),r?d.open(t):u.open(t))}})}),$("#project-files-container").on("contextmenu",function(e){c.open(e)}),r.ContextMenu.assignContextMenuToSelector(".working-set-option-btn",s),r.ContextMenu.assignContextMenuToSelector(".working-set-splitview-btn",l),$(window).contextmenu(function(e){e.preventDefault()}),$(window.document).on("mousedown",".dropdown",function(e){e.preventDefault()}),$(window.document).on("mouseenter","#titlebar .dropdown",function(){var e=$(this).siblings(".open");e.length>0&&(e.removeClass("open"),$(this).addClass("open"))})})}),define("project/ProjectManager",["require","exports","module","utils/Global","thirdparty/lodash","utils/AppInit","utils/Async","preferences/PreferencesDialogs","preferences/PreferencesManager","document/DocumentManager","view/MainViewManager","command/CommandManager","command/Commands","widgets/Dialogs","widgets/DefaultDialogs","utils/EventDispatcher","language/LanguageManager","command/Menus","utils/StringUtils","strings","filesystem/FileSystem","project/FileViewController","utils/PerfUtils","file/FileUtils","filesystem/FileSystemError","project/FileSyncManager","project/ProjectModel","project/FileTreeView","utils/ViewUtils","command/DefaultMenus"],function(e,t,n){"use strict";function r(){return at.getFileSelectionFocus()===at.PROJECT_MANAGER}function i(e,t){window.setTimeout(function(){var e=t.type,n=t.isFolder,r=t.name;if(e===ct.ALREADY_EXISTS)gt(Ct,n,null,r);else if(e===dt.ERROR_INVALID_FILENAME)gt(Nt,n,dt._invalidChars);else{var i=e===ct.NOT_WRITABLE?it.NO_MODIFICATION_ALLOWED_ERR:rt.format(it.GENERIC_ERROR,e);gt(wt,n,i,r).getPromise()}},10)}function o(e,t){xt.setSelected(e),t&&at.setFileViewFocus(at.WORKING_SET_VIEW)}function a(e){this.model=e,this._bindEvents()}function s(){var e=xt.getContext();return e||(e=xt.getSelected()),e||(e=Y.getCurrentlyViewedFile()),e}function l(){Pt.setFocused(r()),_t()}function c(){var e=Y.getCurrentlyViewedPath(Y.ACTIVE_PANE);e&&r()?Pt.setSelected(e,!0):Pt.setSelected(null),l()}function u(e,t){Pt.setCurrentFile(t)
}function d(){return{location:{scope:"user",layer:"project",layerID:xt.projectRoot.fullPath}}}function p(){return xt.getBaseUrl()}function h(e){var t=d();e=xt.setBaseUrl(e),q.setViewState("project.baseUrl",e,t)}function f(e){return xt.isWithinProject(e)}function m(e){return xt.makeProjectRelativeIfPossible(e)}function g(){return xt.projectRoot}function v(e){var t=new $.Deferred;return xt.setProjectRoot(e).then(function(){t.resolve(),xt.reopenNodes(q.getViewState("project.treeState",d()))}),t.promise()}function y(){return"/"}function _(e){var t=dt._addWelcomeProjectPath(e,q.getViewState("welcomeProjects"));q.setViewState("welcomeProjects",t)}function E(e){return dt._isWelcomeProjectPath(e,y(),q.getViewState("welcomeProjects"))}function b(e){return E(e)?y():e}function S(){function e(e){var t=new $.Deferred,n=ot.getDirectoryForPath(e);return n.exists(function(e,n){!e&&n?t.resolve():t.reject()}),t.promise()}var t=[],n=q.getViewState("recentProjects")||[],r=new $.Deferred;return n.length>1&&t.push(n[1]),t.push(y()),G.firstSequentially(t,e).done(function(e){r.resolve(e)}).fail(function(){r.resolve(lt.getNativeBracketsDirectoryPath())}),r.promise()}function I(){return"/"}function w(e){ot.on("change",ft),ot.on("rename",mt),ot.watch(ot.getDirectoryForPath(e),dt._shouldShowName,function(t){t===ct.TOO_MANY_ENTRIES?At||(gt(Lt),At=!0):t&&console.error("Error watching project root: ",e,t)}),xt._resetCache()}function C(){var e=new $.Deferred;return xt.projectRoot?(ot.off("change",ft),ot.off("rename",mt),ot.unwatch(xt.projectRoot,function(t){t?(console.error("Error unwatching project root: ",xt.projectRoot.fullPath,t),e.reject(t)):e.resolve()}),xt._resetCache()):e.reject(),e.promise()}function D(){var e=g();e?q._setProjectSettingsFile(e.fullPath+St):q._setProjectSettingsFile()}function T(e,n){var r=new $.Deferred,i=new $.Deferred;if(e=dt._ensureTrailingSlash(e),n)i.resolve();else{if(xt.projectRoot&&xt.projectRoot.fullPath===e)return(new $.Deferred).resolve().promise();xt.projectRoot&&t.trigger("beforeProjectClose",xt.projectRoot),Y._closeAll(Y.ALL_PANES),C().always(function(){xt.projectRoot&&(tt._resetPathLanguageOverrides(),q._reloadUserPrefs(xt.projectRoot),t.trigger("projectClose",xt.projectRoot)),i.resolve()})}return i.done(function(){var i={location:{scope:"user",layer:"project"}};n||q._stateProjectLayer.setProjectPath(e),n||w(e);var o=ot.getDirectoryForPath(e);o.exists(function(n,a){if(a){var s=!xt.projectRoot||!o||xt.projectRoot.fullPath!==o.fullPath,l=st.markStart("Load Project: "+e);At=!1,v(o).always(function(){xt.setBaseUrl(q.getViewState("project.baseUrl",i)||""),s&&(D(),q._setCurrentFile(e)),e===y()&&_(e),s?(t.trigger("projectOpen",xt.projectRoot),r.resolve()):(t.trigger("projectRefresh",xt.projectRoot),r.resolve()),st.addMeasurement(l)})}else console.log("error loading project"),gt(Mt,!0,n||ct.NOT_FOUND,e).done(function(){xt.projectRoot=null,S().done(function(e){T(e).always(function(){r.reject()})})})})}),r.promise()}function O(e){return xt.showInTree(e).then(vt)}function M(e){var t=new $.Deferred;return X.execute(Q.FILE_CLOSE_ALL,{promptOnly:!0}).done(function(){e?T(e,!1).then(t.resolve,t.reject):ot.showOpenDialog(!1,!0,it.CHOOSE_FOLDER,xt.projectRoot.fullPath,null,function(e,n){e?(gt(Rt,null,e),t.reject()):n.length>0?T(n[0]).then(t.resolve,t.reject):t.reject()})}).fail(function(){t.reject()}),t.promise()}function L(){return K.showProjectPreferencesDialog(p()).getPromise()}function R(e,t,n,r){return e=xt.getDirectoryInProject(e),n?xt.createAtPath(e+t,r):Pt.startCreating(e,t,r)}function N(e){var t=new $.Deferred;return e.moveToTrash(function(n){n?(gt(Tt,e.isDirectory,lt.getFileErrorString(n),e.fullPath),t.reject(n)):(z.notifyPathDeleted(e.fullPath),t.resolve())}),t.promise()}function x(e){return function(t){var n=tt.getLanguageForPath(t.fullPath).getId();return"string"==typeof e?n===e:-1!==e.indexOf(n)}}function A(){Pt.performRename()}function P(e){xt.setSelectionWidth(e),_t()}function k(e){var t,n="projectTreeState_";return 0===e.indexOf(n)?(t=e.substr(n.length),"user project.treeState "+t):(n="projectBaseUrl_",0===e.indexOf(n)?(t=e.substr(e.indexOf(" ")+1),t=t.substr(0,t.length-1),"user project.baseUrl "+t):null)}function F(){return xt.getContext()}function U(e,t){var n,r;return void 0===t&&"function"!=typeof e&&(t=e,e=null),t&&(n=Y.getWorkingSet(Y.ALL_PANES)),r=new $.Deferred,xt.getAllFiles(e,n).done(function(e){r.resolve(e)}).fail(function(e){e!==ct.TOO_MANY_ENTRIES||At||(gt(Lt),At=!0),r.resolve([])}),r.promise()}function j(e){return pt.addIconProvider(e)}function V(e){return pt.addClassesProvider(e)}function B(){_t(!0)}e("utils/Global");var H=e("thirdparty/lodash"),W=e("utils/AppInit"),G=e("utils/Async"),K=e("preferences/PreferencesDialogs"),q=e("preferences/PreferencesManager"),z=e("document/DocumentManager"),Y=e("view/MainViewManager"),X=e("command/CommandManager"),Q=e("command/Commands"),J=e("widgets/Dialogs"),Z=e("widgets/DefaultDialogs"),et=e("utils/EventDispatcher"),tt=e("language/LanguageManager"),nt=e("command/Menus"),rt=e("utils/StringUtils"),it=e("strings"),ot=e("filesystem/FileSystem"),at=e("project/FileViewController"),st=e("utils/PerfUtils"),lt=e("file/FileUtils"),ct=e("filesystem/FileSystemError"),ut=e("project/FileSyncManager"),dt=e("project/ProjectModel"),pt=e("project/FileTreeView"),ht=e("utils/ViewUtils");e("command/DefaultMenus");var ft,mt,gt,vt,yt,_t,Et,bt,St="."+q.SETTINGS_FILENAME,It="sortDirectoriesFirst",wt=1,Ct=2,Dt=3,Tt=4,Ot=5,Mt=6,Lt=7,Rt=8,Nt=9,xt=new dt.ProjectModel({focused:r()}),At=!1;a.prototype._bindEvents=function(){this.model.on(dt.EVENT_CHANGE,function(){_t()}),this.model.on(dt.EVENT_SHOULD_SELECT,function(e,t){t.add?at.openFileAndAddToWorkingSet(t.path).fail(H.partial(o,t.previousPath,!t.hadFocus)):at.openAndSelectDocument(t.path,at.PROJECT_MANAGER).fail(H.partial(o,t.previousPath,!t.hadFocus))}),this.model.on(dt.EVENT_SHOULD_FOCUS,function(){at.setFileViewFocus(at.PROJECT_MANAGER)}),this.model.on(dt.ERROR_CREATION,i)},a.prototype.setDirectoryOpen=function(e,t){this.model.setDirectoryOpen(e,t).then(vt)},a.prototype.setSelected=function(e,t){this.model.setSelected(e,t)},a.prototype.selectInWorkingSet=function(e){this.model.selectInWorkingSet(e)},a.prototype.setContext=function(e){this.model.setContext(e)},a.prototype.restoreContext=function(){this.model.restoreContext()},a.prototype.startRename=function(e){yt(e)},a.prototype.setRenameValue=function(e){this.model.setRenameValue(e)},a.prototype.cancelRename=function(){this.model.cancelRename()},a.prototype.performRename=function(){return this.model.performRename()},a.prototype.startCreating=function(e,t,n){return this.model.startCreating(e,t,n)},a.prototype.setSortDirectoriesFirst=function(e){this.model.setSortDirectoriesFirst(e)},a.prototype.setFocused=function(e){this.model.setFocused(e)},a.prototype.setCurrentFile=function(e){this.model.setCurrentFile(e)},a.prototype.toggleSubdirectories=function(e,t){this.model.toggleSubdirectories(e,t).then(vt)},a.prototype.closeSubtree=function(e){this.model.closeSubtree(e),vt()},a.prototype.refresh=function(){this.model.refresh()};var Pt=new a(xt),kt=function(){q.setViewState("projectPath",xt.projectRoot.fullPath)};vt=function(){var e=d(),t=xt.getOpenNodes();q.setViewState("project.treeState",t,e)},gt=function(e,t,n,r){var i,o,a=t?it.DIRECTORY_TITLE:it.FILE_TITLE,s=t?it.DIRECTORY:it.FILE;switch(r=rt.breakableUrl(r),e){case wt:i=rt.format(it.ERROR_CREATING_FILE_TITLE,a),o=rt.format(it.ERROR_CREATING_FILE,s,r,n);break;case Ct:i=rt.format(it.INVALID_FILENAME_TITLE,a),o=rt.format(it.ENTRY_WITH_SAME_NAME_EXISTS,r);break;case Dt:i=rt.format(it.ERROR_RENAMING_FILE_TITLE,a),o=rt.format(it.ERROR_RENAMING_FILE,r,n,s);break;case Tt:i=rt.format(it.ERROR_DELETING_FILE_TITLE,a),o=rt.format(it.ERROR_DELETING_FILE,r,n,s);break;case Ot:i=it.ERROR_LOADING_PROJECT,o=rt.format(it.READ_DIRECTORY_ENTRIES_ERROR,r,n);break;case Mt:i=it.ERROR_LOADING_PROJECT,o=rt.format(it.REQUEST_NATIVE_FILE_SYSTEM_ERROR,r,n);break;case Lt:i=it.ERROR_MAX_FILES_TITLE,o=it.ERROR_MAX_FILES;break;case Rt:i=it.ERROR_LOADING_PROJECT,o=rt.format(it.OPEN_DIALOG_ERROR,n);break;case Nt:i=rt.format(it.INVALID_FILENAME_TITLE,t?it.DIRECTORY_NAME:it.FILENAME),o=rt.format(it.INVALID_FILENAME_MESSAGE,t?it.DIRECTORY_NAMES_LEDE:it.FILENAMES_LEDE,n)}return i&&o?J.showModalDialog(Z.DIALOG_ID_ERROR,i,o):null};var Ft=100;_t=function(e){var t=g();t&&(xt.setScrollerInfo(Et[0].scrollWidth,Et.scrollTop(),Et.scrollLeft(),Et.offset().top),pt.render(bt,xt._viewModel,t,Pt,e,brackets.platform))},_t=H.debounce(_t,Ft);var Ut=1e3,jt=function(){return ot.clearAllCaches(),(new $.Deferred).resolve().promise()};jt=H.debounce(jt,Ut),ft=function(e,t,n,r){ut.syncOpenDocuments(),xt.handleFSEvent(t,n,r),r&&r.forEach(function(e){z.notifyPathDeleted(e.fullPath)})},mt=function(e,t,n){z.notifyPathNameChanged(t,n)},W.htmlReady(function(){Et=$("#project-files-container"),Et.addClass("jstree jstree-brackets"),Et.css("overflow","auto"),Et.css("position","relative"),bt=$("<div>").appendTo(Et)[0],xt.setSelectionWidth(Et.width()),$(".main-view").click(function(e){e.target.classList.contains("jstree-rename-input")||(A(),Pt.setContext(null))}),$("#working-set-list-container").on("contentChanged",function(){Et.trigger("contentChanged")}),nt.getContextMenu(nt.ContextMenuIds.PROJECT_MENU).on("beforeContextMenuOpen",function(){Pt.restoreContext()}),nt.getContextMenu(nt.ContextMenuIds.PROJECT_MENU).on("beforeContextMenuClose",function(){xt.setContext(null,!1,!0)}),Et.on("contextmenu",function(){A()}),$("#project-context-menu").on("click.dropdown-menu",function(){xt.setContext(null,!0)}),Et.on("scroll",function(){$(".dropdown.open").length>0&&(nt.closeAll(),Pt.setContext(null)),_t()}),_t(),ht.addScrollerShadow(Et[0])}),et.makeEventDispatcher(t),q.stateManager.definePreference("projectPath","string",y()),q.convertPreferences(n,{projectPath:"user",projectTreeState_:"user",welcomeProjects:"user",projectBaseUrl_:"user"},!0,k),t.on("projectOpen",D),t.on("projectOpen",kt),t.on("beforeAppClose",C),et.on_duringInit(at,"documentSelectionFocusChange",c),et.on_duringInit(at,"fileViewFocusChange",l),et.on_duringInit(Y,"currentFileChange",u),X.register(it.CMD_OPEN_FOLDER,Q.FILE_OPEN_FOLDER,M),X.register(it.CMD_PROJECT_SETTINGS,Q.FILE_PROJECT_SETTINGS,L),X.register(it.CMD_FILE_REFRESH,Q.FILE_REFRESH,jt),q.definePreference(It,"boolean","mac"!==brackets.platform).on("change",function(){Pt.setSortDirectoriesFirst(q.get(It))}),Pt.setSortDirectoriesFirst(q.get(It)),yt=function(e){var t=new $.Deferred;return xt.startRename(e).done(function(){t.resolve()}).fail(function(e){window.setTimeout(function(){if(e.type===dt.ERROR_INVALID_FILENAME)gt(Nt,e.isFolder,dt._invalidChars);else{var t=e.type===ct.ALREADY_EXISTS?it.FILE_EXISTS_ERR:lt.getFileErrorString(e.type);gt(Dt,e.isFolder,t,e.fullPath)}},10),t.reject(e)}),t.promise()},t._actionCreator=Pt,t._RENDER_DEBOUNCE_TIME=Ft,t._setFileTreeSelectionWidth=P,t.getProjectRoot=g,t.getBaseUrl=p,t.setBaseUrl=h,t.isWithinProject=f,t.makeProjectRelativeIfPossible=m,t.shouldShow=dt.shouldShow,t.openProject=M,t.getSelectedItem=s,t.getContext=F,t.getInitialProjectPath=I,t.isWelcomeProjectPath=E,t.updateWelcomeProjectPath=b,t.createNewItem=R,t.renameItemInline=yt,t.deleteItem=N,t.forceFinishRename=A,t.showInTree=O,t.refreshFileTree=jt,t.getAllFiles=U,t.getLanguageFilter=x,t.addIconProvider=j,t.addClassesProvider=V,t.rerenderTree=B}),define("document/ChangedDocumentTracker",["require","exports","module","document/DocumentManager","project/ProjectManager"],function(e,t,n){"use strict";function r(){var e=this;this._changedPaths={},this._windowFocus=!0,this._addListener=this._addListener.bind(this),this._removeListener=this._removeListener.bind(this),this._onChange=this._onChange.bind(this),this._onWindowFocus=this._onWindowFocus.bind(this),i.on("afterDocumentCreate",function(t,n){o.isWithinProject(n.file.fullPath)&&e._addListener(n)}),i.on("beforeDocumentDelete",function(t,n){e._removeListener(n)}),$(window).focus(this._onWindowFocus)}var i=e("document/DocumentManager"),o=e("project/ProjectManager");r.prototype._addListener=function(e){e.on("change",this._onChange)},r.prototype._removeListener=function(e){e.off("change",this._onChange)},r.prototype._onWindowFocus=function(){this._windowFocus=!0},r.prototype._onChange=function(e,t){this._changedPaths[t.file.fullPath]=!0},r.prototype.reset=function(){this._changedPaths={},this._windowFocus=!1},r.prototype.isPathChanged=function(e){return this._windowFocus||this._changedPaths[e]},r.prototype.getChangedPaths=function(){return $.makeArray(this._changedPaths)},n.exports=r}),define("language/JSUtils",["require","exports","module","thirdparty/lodash","thirdparty/CodeMirror2/lib/codemirror","utils/Async","document/DocumentManager","document/ChangedDocumentTracker","filesystem/FileSystem","file/FileUtils","utils/PerfUtils","utils/StringUtils"],function(e,t){"use strict";function n(e){var t,n,r={};for(_.markStart(_.JSUTILS_REGEXP);null!==(n=S.exec(e));)t=(n[2]||n[5]).trim(),Array.isArray(r[t])||(r[t]=[]),r[t].push({offsetStart:n.index});return _.addMeasurement(_.JSUTILS_REGEXP),r}function r(e,t){function n(){if(i&&(u++,u>=d))return!1;s=u;var t=e.indexOf("\n",s);return-1===t&&(t=d),i=new h.StringStream(e.slice(u,t)),!0}function r(){if(u>=d)return!1;for(i&&(i.start=i.pos);!i||i.eol();)if(!n())return!1;return o=l.token(i,c),a=i.current(),u=s+i.pos,!0}for(var i,o,a,s,l=h.getMode({},"javascript"),c=h.startState(l),u=t,d=e.length,p=0,f=!1;r();)if("comment"!==o&&"regexp"!==o&&"string"!==o&&("{"===a?(f=!0,p++):"}"===a&&p--),f&&0>=p)return u;return d}function i(e,t,n,i){var o=e.getText(),a=E.getLines(o);n.forEach(function(n){n.offsetEnd||(_.markStart(_.JSUTILS_END_OFFSET),n.offsetEnd=r(o,n.offsetStart),n.lineStart=E.offsetToLineNum(a,n.offsetStart),n.lineEnd=E.offsetToLineNum(a,n.offsetEnd),_.addMeasurement(_.JSUTILS_END_OFFSET)),i.push({document:e,name:t,lineStart:n.lineStart,lineEnd:n.lineEnd})})}function o(e,t){m.getDocumentForPath(e.fullPath).done(function(r){var i=n(r.getText());e.JSUtils={},e.JSUtils.functions=i,e.JSUtils.timestamp=r.diskTimestamp,t.resolve({doc:r,functions:i})}).fail(function(e){t.reject(e)})}function a(e){var t=new $.Deferred,n=b.isPathChanged(e.fullPath);if(n&&e.JSUtils){var r=m.getOpenDocumentForPath(e.fullPath);if(r&&r.isDirty)t.resolve(!1);else{var i=v.getFileForPath(e.fullPath);i.stat(function(n,r){n?t.reject(n):t.resolve(e.JSUtils.timestamp.getTime()===r.mtime.getTime())})}}else t.resolve(!n&&e.JSUtils);return t.promise()}function s(e,t){var n=new $.Deferred,r=[],o=[];return e.forEach(function(e){if(p.has(e.functions,t)){var n=e.functions[t];r.push({doc:e.doc,fileInfo:e.fileInfo,functions:n})}}),f.doInParallel(r,function(e){var n=e.doc,r=new $.Deferred;return n?(i(n,t,e.functions,o),r.resolve()):m.getDocumentForPath(e.fileInfo.fullPath).done(function(n){i(n,t,e.functions,o)}).always(function(){r.resolve()}),r.promise()}).done(function(){n.resolve(o)}),n.promise()}function l(e){var t=new $.Deferred;return a(e).done(function(n){n?t.resolve({fileInfo:e,functions:e.JSUtils.functions}):o(e,t)}).fail(function(e){t.reject(e)}),t.promise()}function c(e){var t=new $.Deferred,n=[];return _.markStart(_.JSUTILS_GET_ALL_FUNCTIONS),f.doInParallel(e,function(e){var t=new $.Deferred;return l(e).done(function(e){n.push(e)}).always(function(){t.resolve()}),t.promise()}).always(function(){b.reset(),_.addMeasurement(_.JSUTILS_GET_ALL_FUNCTIONS),t.resolve(n)}),t.promise()}function u(e,t,n){var r=new $.Deferred,i=[];return i=n?t:t.filter(function(e){return"js"===y.getFileExtension(e.fullPath).toLowerCase()}),c(i).done(function(t){s(t,e).done(function(e){r.resolve(e)})}),r.promise()}function d(e,t){var i=n(e),o=[],a=e.split("\n");return p.forEach(i,function(n,i){(i===t||"*"===t)&&n.forEach(function(t){var n=r(e,t.offsetStart);o.push({name:i,lineStart:E.offsetToLineNum(a,t.offsetStart),lineEnd:E.offsetToLineNum(a,n)})})}),o}var p=e("thirdparty/lodash"),h=e("thirdparty/CodeMirror2/lib/codemirror"),f=e("utils/Async"),m=e("document/DocumentManager"),g=e("document/ChangedDocumentTracker"),v=e("filesystem/FileSystem"),y=e("file/FileUtils"),_=e("utils/PerfUtils"),E=e("utils/StringUtils"),b=new g,S=/(function\s+([$_A-Za-z\u007F-\uFFFF][$_A-Za-z0-9\u007F-\uFFFF]*)\s*(\([^)]*\)))|(([$_A-Za-z\u007F-\uFFFF][$_A-Za-z0-9\u007F-\uFFFF]*)\s*[:=]\s*function\s*(\([^)]*\)))/g;_.createPerfMeasurement("JSUTILS_GET_ALL_FUNCTIONS","Parallel file search across project"),_.createPerfMeasurement("JSUTILS_REGEXP","RegExp search for all functions"),_.createPerfMeasurement("JSUTILS_END_OFFSET","Find end offset for a single matched function"),t.findAllMatchingFunctionsInText=d,t._getFunctionEndOffset=r,t.findMatchingFunctions=u}),define("text!htmlContent/working-set.html",[],function(){return'<div class="working-set-view" id="{{id}}">\n    <div class="working-set-header"><span class="working-set-header-title">{{WORKING_FILES}}</span></div>\n    <div class="open-files-container">\n        <!-- This will contain runtime-generated <li>\'s for each file in the working set -->\n        <ul>\n        </ul>\n    </div>\n<div>'}),define("project/WorkingSetView",["require","exports","module","utils/AppInit","document/DocumentManager","view/MainViewManager","command/CommandManager","command/Commands","command/Menus","project/FileViewController","utils/ViewUtils","utils/KeyEvent","text!htmlContent/working-set.html","strings","thirdparty/lodash"],function(e,t){"use strict";function n(e){O.forEach(M,function(t){var n=t.$openFilesContainer.scrollTop();e?t._rebuildViewList(!0):t._redraw(),t.$openFilesContainer.scrollTop(n)})}function r(){O.forEach(M,function(e){e.$openFilesContainer.triggerHandler("scroll")})}function i(e,t){var n=t&&$(e).data(A).fullPath===t.fullPath;w.toggleClass($(e),"selected",n)}function o(e){var t=y.getOpenDocumentForPath(e.fullPath);return t&&t.isDirty}function a(){return I.getFileSelectionFocus()===I.WORKING_SET_VIEW}function s(e){O.forEach(M,function(t){t.suppressSortRedraw=e})}function l(e){O.forEach(M,function(t){e?w.removeScrollerShadow(t.$openFilesContainer[0],null):t.$openFilesContainer[0].scrollHeight>t.$openFilesContainer[0].clientHeight&&w.addScrollerShadow(t.$openFilesContainer[0],null,!0)})}function c(e){O.forEach(M,function(t){e?t.$el.hasClass("active")&&(t.$el.removeClass("active").addClass("reactivate"),t.$openFilesList.trigger("selectionHide")):(t.$el.hasClass("reactivate")&&t.$el.removeClass("reactivate").addClass("active"),t._fireSelectionChanged(!1))})}function u(e){e.hasClass("working-set-view")||(e=e.parents(".working-set-view"));var t=e.attr("id").match(/working\-set\-list\-([\w]+[\w\d\-\.\:\_]*)/).pop();return M[t]}function d(e){function t(){i&&(window.clearInterval(i),i=void 0)}function r(e,n,r,o){var a=e[0],s=a.scrollHeight-a.clientHeight;s&&r&&!i&&(i=window.setInterval(function(){var i=e.scrollTop();-1===r&&0>=i||1===r&&i>=s?t(n):(e.scrollTop(i+7*r),o(n))},50))}var i,o=e.data(A);e.mousedown(function(i){function d(){w=e.height(),D=e.offset(),T=e.clone(),O=$("<div class='open-files-container wsv-drag-ghost' style='overflow: hidden; display: inline-block;'>").append($("<ul>").append(T).css("padding","0")),L=e.hasClass("selected")&&J.paneId===X,L&&a()&&O.addClass("dragging-current-file"),O.css({top:D.top,left:D.left,width:e.width()+8}),O.appendTo($("body"))}function p(e){Z=u(e.which)}function h(t){function n(e){var t=e.offset().top,n=e.height();return t+n/2>S}function r(e){var t=e.offset().top,n=f;return I>0&&(n+=m),t+w/2>=n}function i(e){var t=e.offset().top,n=f;return I>0&&(n+=m),n>=t+w/2}function o(e,t){var n=e.offset().top,r=t.offset().top;return n>=r+t.height()}function a(){return 0===d.length||o(d,g)}function s(){return d.is(".working-set-view")||d.is(".open-files-container")||d.is("ul")&&d.parent().is(".open-files-container")}function l(){return d.is(".working-set-header")||d.is(".working-set-header-title")||d.is(".scroller-shadow")||d.is(".scroller-shadow")}function c(e){return e.is(".working-set-view")?e:e.parents(".working-set-view")}var u,d,p,h,f,m,v,y,_,E,b,S=O.offset().top,I=t.pageY-K,C={where:P},D=0,T=!1,M=!1,L=!1;if(t.pageX<0||t.pageX>g.width())return C;do O.hide(),d=$(window.document.elementFromPoint(t.pageX,S)),h=d.closest(".working-set-view"),p=d.closest("#working-set-list-container li"),O.show(),u=h.children(".open-files-container"),u.length&&(_=u.offset(),E={top:_.top-14,bottom:_.top+7},b={top:_.top+u.height()-7,bottom:_.top+u.height()+14}),p[0]===e[0]&&(I>0?(p=p.next(),p.length&&(S+=w)):(p=p.prev(),p.length&&(S-=w))),p.length||(S+=w);while(!p.length&&++D<2);if(0===p.length&&(d.is("a")||d.is("span"))&&(p=d.parents("#working-set-list-container li")),f=O.offset().top,m=O.height(),v=f+m,y=S-t.pageY,T=p.length&&u.length&&u[0].scrollHeight>u[0].clientHeight,M=T&&E&&(f>=E.top&&f<=E.bottom||v>=E.top&&v<=E.bottom),L=T&&b&&(f>=b.top&&f<=b.bottom||v>=b.top&&v<=b.bottom),p.length)M&&(0>=I||q.where===j)?C={where:j,which:p}:L&&(I>=0||q.where===V)?C={where:V,which:p}:r(p)?C={where:F,which:p}:i(p)&&(C={where:U,which:p});else if(e.parent()[0]!==d[0]){if(h=e.parents(".working-set-view"),l()){if(!(0>I))return C;if(i(d))return C}if(a())return C;if(s())return C=n(d)?{where:H,which:c(d)}:{where:B,which:c(d)};var R=h.prev(),N=h.next();0>I?R.length&&(C={where:B,which:R}):I>0?N.length&&(C={where:H,which:N}):C=n(h)?{where:H,which:h}:{where:B,which:h}}else C={where:k,which:d};return C}function f(){var e=Z.$openFilesContainer,t=e[0],n=t.scrollHeight-t.clientHeight;n&&e.scrollTop(n)}function m(){window.onmousewheel=window.document.onmousewheel=null,$(window).off(".wsvdragging"),A&&(g.removeClass("dragging"),g.find(".drag-show-as-selected").removeClass("drag-show-as-selected"),t(e),c(!1),O.remove(),e.css("opacity",""),0===e.next().length&&f())}function v(e){A&&(s(!1),l(!1)),e||n(!0),_.focusActivePane()}function y(){m(),J.paneId===Z.paneId&&et===e.index()?A?v(!0):z||i.which===x?E.execute(b.FILE_CLOSE,{file:o,paneId:J.paneId}).always(function(){v()}):(I.setFileViewFocus(I.WORKING_SET_VIEW),E.execute(b.FILE_OPEN,{fullPath:o.fullPath,paneId:Z.paneId}).always(function(){v()})):J.paneId===Z.paneId?(_._moveWorkingSetItem(J.paneId,et,e.index()),v()):_._moveView(J.paneId,Z.paneId,o,e.index()).always(function(){L?E.execute(b.FILE_OPEN,{fullPath:o.fullPath,paneId:Z.paneId}).always(function(){v()}):v()})}var w,D,T,O,L,R=0,A=!1,G=i.pageY,K=G,q={where:P},z=$(i.target).hasClass("can-close"),Y=_.getCurrentlyViewedFile(),X=_.getActivePaneId(),Q=M[X],J=u(e),Z=J,et=e.index();return $(window).on("mousemove.wsvdragging",function(n){function i(n){switch(A||(d(),s(!0),l(!0),c(!0),g.addClass("dragging"),L||I.getFileSelectionFocus()!==I.WORKING_SET_VIEW||$(Q._findListItemFromFile(Y)).addClass("drag-show-as-selected"),A=!0),R=0,q=h(n),q.where){case P:case B:case H:e.css({opacity:".75"}),O.css("opacity",".25");break;default:e.css({opacity:".0001"}),O.css("opacity","")}switch(q.where){case j:case F:q.where===j&&(R=-1),e.insertBefore(q.which),p(q);break;case V:case U:q.where===V&&(R=1),e.insertAfter(q.which),p(q);break;case B:e.appendTo(q.which.find("ul")),p(q);break;case H:e.prependTo(q.which.find("ul")),p(q)}R?r(Z.$openFilesContainer,e,R,function(){i(n)}):t(e)}O&&O.css("top",O.offset().top+(n.pageY-K)),(A||Math.abs(n.pageY-G)>W)&&i(n),K=n.pageY,n.stopPropagation()}),i.preventDefault(),$(window).on("mouseup.wsvdragging",function(){y()}),$(window).on("keydown.wsvdragging",function(e){e.keyCode===C.DOM_VK_ESCAPE&&(m(),v(),e.stopPropagation())}),window.onmousewheel=window.document.onmousewheel=function(e){e.preventDefault()},S.closeAll(),i.which!==N||i.ctrlKey&&"mac"===brackets.platform?void y():void i.stopPropagation()})}function p(e,t){var n="working-set-list-"+t;this.$header=null,this.$openFilesList=null,this.$container=e,this.$el=e.append(Mustache.render(D,O.extend({id:n},T))).find("#"+n),this.suppressSortRedraw=!1,this.paneId=t,this.init()}function h(e,t){var n=M[t];n||(n=new p(e,t),M[n.paneId]=n)}function f(e){e&&(L.push(e),n(!0))}function m(e){e&&(R.push(e),n(!0))}var g,v=e("utils/AppInit"),y=e("document/DocumentManager"),_=e("view/MainViewManager"),E=e("command/CommandManager"),b=e("command/Commands"),S=e("command/Menus"),I=e("project/FileViewController"),w=e("utils/ViewUtils"),C=e("utils/KeyEvent"),D=e("text!htmlContent/working-set.html"),T=e("strings"),O=e("thirdparty/lodash"),M={},L=[],R=[],N=1,x=2,A="file",P="nomansland",k="nomoveitem",F="aboveitem",U="belowitem",j="topscroll",V="bottomscroll",B="belowview",H="aboveview",W=3;p.prototype._updateVisibility=function(){var e=_.getWorkingSet(this.paneId);1!==_.getPaneCount()||e&&0!==e.length?(this.$openFilesContainer.show(),this.$workingSetListViewHeader.show(),this._checkForDuplicatesInWorkingTree()):(this.$openFilesContainer.hide(),this.$workingSetListViewHeader.hide())},p.prototype._handlePaneLayoutChange=function(){var e=this.$el.find(".working-set-header-title"),t=T.WORKING_FILES;this._updateVisibility(),_.getPaneCount()>1&&(t=_.getPaneTitle(this.paneId)),e.text(t)},p.prototype._findListItemFromFile=function(e){var t=null;if(e){var n=this.$openFilesContainer.find("ul").children();n.each(function(){var n=$(this);return n.data(A).fullPath===e.fullPath?(t=n,!1):void 0})}return t},p.prototype._makeEventName=function(e){return e+".paneList"+this.paneId},p.prototype._scrollSelectedFileIntoView=function(){if(a()){var e=_.getCurrentlyViewedFile(this.paneId),t=this._findListItemFromFile(e);t&&w.scrollElementIntoView(this.$openFilesContainer,t,!1)}},p.prototype._fireSelectionChanged=function(e){var t=void 0===e||e===!0;t&&this._scrollSelectedFileIntoView(),a()&&this.$el.hasClass("active")?this.$openFilesList.trigger("selectionChanged",t):this.$openFilesList.trigger("selectionHide"),this.$openFilesContainer.trigger("contentChanged")},p.prototype._adjustForScrollbars=function(){this.$openFilesContainer[0].scrollHeight>this.$openFilesContainer[0].clientHeight?this.$openFilesContainer.hasClass("vertical-scroll")||this.$openFilesContainer.addClass("vertical-scroll"):this.$openFilesContainer.removeClass("vertical-scroll")},p.prototype._addDirectoryNamesToWorkingTreeFiles=function(e){if(!(e.length<=1)){var t=w.getDirNamesForDuplicateFiles(e);this.$openFilesContainer.find("ul > li").each(function(){var n=$(this),r=e.indexOf(n.data(A));if(-1!==r){var i=t[r].split("/");i.length>3&&(t[r]=i[0]+"/…/"+i[i.length-1]);var o=$("<span class='directory'/>").html(" &mdash; "+t[r]);n.children("a").append(o)}})}},p.prototype._checkForDuplicatesInWorkingTree=function(){var e=this,t={},n=_.getWorkingSet(_.ALL_PANES);this.$openFilesContainer.find("ul > li > a > span.directory").remove(),n.forEach(function(e){var n=w.getFileEntryDisplay(e);t[n]||(t[n]=[]),t[n].push(e)}),O.forEach(t,function(t){t.length>1&&e._addDirectoryNamesToWorkingTreeFiles(t)})},p.prototype._redraw=function(){this._updateViewState(),this._updateVisibility(),this._updateItemClasses(),this._adjustForScrollbars(),this._fireSelectionChanged()},p.prototype._handleActivePaneChange=function(){this._redraw()},p.prototype._updateFileStatusIcon=function(e,t,n){var r=e.find(".file-status-icon"),i=t||n;i||0===r.length?i&&0===r.length&&(r=$("<div class='file-status-icon'></div>").prependTo(e)):(r.remove(),r=null),r&&(w.toggleClass(r,"dirty",t),w.toggleClass(r,"can-close",n))},p.prototype._updateItemClasses=function(){R.length>0&&this.$openFilesContainer.find("ul > li").each(function(){var e=$(this),t=e.data(A),n={fullPath:t.fullPath,name:t.name,isFile:t.isFile};e.removeAttr("class"),R.forEach(function(t){e.addClass(t(n))})})},p.prototype._createNewListItem=function(e){var t=this,n=_.getCurrentlyViewedFile(this.paneId),r={fullPath:e.fullPath,name:e.name,isFile:e.isFile},a=$("<a href='#'></a>").html(w.getFileEntryDisplay(e));L.forEach(function(e){var t=e(r);t&&a.prepend($(t))});var s=$("<li></li>").append(a).data(A,e);this.$openFilesContainer.find("ul").append(s),R.forEach(function(e){s.addClass(e(r))}),this._updateFileStatusIcon(s,o(e),!1),i(s,n),d(s),s.hover(function(){t._updateFileStatusIcon($(this),o(e),!0)},function(){t._updateFileStatusIcon($(this),o(e),!1)})},p.prototype._rebuildViewList=function(e){var t=this,n=_.getWorkingSet(this.paneId);this.$openFilesContainer.find("ul").empty(),n.forEach(function(e){t._createNewListItem(e)}),e&&t._redraw()},p.prototype._updateViewState=function(){var e=_.getActivePaneId();a()&&e===this.paneId?(this.$el.addClass("active"),this.$openFilesContainer.addClass("active")):(this.$el.removeClass("active"),this.$openFilesContainer.removeClass("active"))},p.prototype._updateListSelection=function(){var e=_.getCurrentlyViewedFile(this.paneId);this._updateViewState(),this.$openFilesContainer.find("ul").children().each(function(){i(this,e)}),this._scrollSelectedFileIntoView(),this._fireSelectionChanged()},p.prototype._handleFileAdded=function(e,t,n,r){r===this.paneId?this._rebuildViewList(!0):this._checkForDuplicatesInWorkingTree()},p.prototype._handleFileListAdded=function(e,t,n){n===this.paneId?this._rebuildViewList(!0):this._checkForDuplicatesInWorkingTree()},p.prototype._handleFileRemoved=function(e,t,n,r){if(r===this.paneId){if(!n){var i=this._findListItemFromFile(t);if(i){var a=i.next();if(a&&a.length>0){var s=1===i.find(".can-close").length,l=o(a.data(A));this._updateFileStatusIcon(a,l,s)}i.remove()}this._redraw()}}else this._checkForDuplicatesInWorkingTree()},p.prototype._handleRemoveList=function(e,t,n){var r=this;n===this.paneId?(t.forEach(function(e){var t=r._findListItemFromFile(e);t&&t.remove()}),this._redraw()):this._checkForDuplicatesInWorkingTree()},p.prototype._handleWorkingSetSort=function(e,t){this.suppressSortRedraw||t!==this.paneId||this._rebuildViewList(!0)},p.prototype._handleDirtyFlagChanged=function(e,t){var n=this._findListItemFromFile(t.file);if(n){var r=1===$(n).find(".can-close").length;this._updateFileStatusIcon(n,t.isDirty,r)}},p.prototype._handleWorkingSetUpdate=function(e,t){this.paneId===t?this._rebuildViewList(!0):this._checkForDuplicatesInWorkingTree()},p.prototype.init=function(){this.$openFilesContainer=this.$el.find(".open-files-container"),this.$workingSetListViewHeader=this.$el.find(".working-set-header"),this.$openFilesList=this.$el.find("ul"),_.on(this._makeEventName("workingSetAdd"),O.bind(this._handleFileAdded,this)),_.on(this._makeEventName("workingSetAddList"),O.bind(this._handleFileListAdded,this)),_.on(this._makeEventName("workingSetRemove"),O.bind(this._handleFileRemoved,this)),_.on(this._makeEventName("workingSetRemoveList"),O.bind(this._handleRemoveList,this)),_.on(this._makeEventName("workingSetSort"),O.bind(this._handleWorkingSetSort,this)),_.on(this._makeEventName("activePaneChange"),O.bind(this._handleActivePaneChange,this)),_.on(this._makeEventName("paneLayoutChange"),O.bind(this._handlePaneLayoutChange,this)),_.on(this._makeEventName("workingSetUpdate"),O.bind(this._handleWorkingSetUpdate,this)),y.on(this._makeEventName("dirtyFlagChange"),O.bind(this._handleDirtyFlagChanged,this)),I.on(this._makeEventName("documentSelectionFocusChange")+" "+this._makeEventName("fileViewFocusChange"),O.bind(this._updateListSelection,this)),w.addScrollerShadow(this.$openFilesContainer[0],null,!0),w.sidebarList(this.$openFilesContainer),this.$openFilesContainer.css("overflow-x","hidden"),this.$openFilesContainer.on("contextmenu.workingSetView",function(e){S.getContextMenu(S.ContextMenuIds.WORKING_SET_CONTEXT_MENU).open(e)}),this._redraw()},p.prototype.destroy=function(){w.removeScrollerShadow(this.$openFilesContainer[0],null),this.$openFilesContainer.off(".workingSetView"),this.$el.remove(),_.off(this._makeEventName("")),y.off(this._makeEventName("")),I.off(this._makeEventName(""))},_.on("paneDestroy",function(e,t){var n=M[t];delete M[n.paneId],n.destroy()}),v.htmlReady(function(){g=$("#working-set-list-container")}),t.createWorkingSetViewForPane=h,t.refresh=n,t.addIconProvider=f,t.addClassProvider=m,t.syncSelectionIndicator=r}),define("text!LiveDevelopment/Inspector/Inspector.json",[],function(){return'{\n    "version": { "major": "1", "minor": "1" },\n    "domains": [{\n        "domain": "Inspector",\n        "hidden": true,\n        "types": [],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables inspector domain notifications."\n            },\n            {\n                "name": "disable",\n                "description": "Disables inspector domain notifications."\n            },\n            {\n                "name": "reset",\n                "description": "Resets all domains."\n            }\n        ],\n        "events": [\n            {\n                "name": "evaluateForTestInFrontend",\n                "parameters": [\n                    { "name": "testCallId", "type": "integer" },\n                    { "name": "script", "type": "string" }\n                ]\n            },\n            {\n                "name": "inspect",\n                "parameters": [\n                    { "name": "object", "$ref": "Runtime.RemoteObject" },\n                    { "name": "hints", "type": "object" }\n                ]\n            },\n            {\n                "name": "detached",\n                "description": "Fired when remote debugging connection is about to be terminated. Contains detach reason.",\n                "parameters": [\n                    { "name": "reason", "type": "string", "description": "The reason why connection has been terminated." }\n                ]\n            },\n            {\n                "name": "targetCrashed",\n                "description": "Fired when debugging target has crashed"\n            }\n        ]\n    },\n    {\n        "domain": "Memory",\n        "hidden": true,\n        "types": [\n            {\n                "id": "MemoryBlock",\n                "type": "object",\n                "properties": [\n                    { "name": "size", "type": "number", "optional": true, "description": "Size of the block in bytes if available" },\n                    { "name": "name", "type": "string", "description": "Unique name used to identify the component that allocated this block" },\n                    { "name": "children", "type": "array", "optional": true, "items": { "$ref": "MemoryBlock" }}\n                ]\n            },\n            {\n                "id": "HeapSnapshotChunk",\n                "type": "object",\n                "properties": [\n                    { "name": "strings", "type": "array", "items": { "type": "string" }, "description": "An array of strings that were found since last update." },\n                    { "name": "nodes", "type": "array", "items": { "type": "integer" }, "description": "An array of nodes that were found since last update." },\n                    { "name": "edges", "type": "array", "items": { "type": "integer" }, "description": "An array of edges that were found since last update." },\n                    { "name": "baseToRealNodeId", "type": "array", "items": { "type": "integer" }, "description": "An array of integers for nodeId remapping. Even nodeId has to be mapped to the following odd nodeId." }\n                ]\n            }\n        ],\n        "commands": [\n            {\n                "name": "getDOMCounters",\n                "returns": [\n                    { "name": "documents", "type": "integer" },\n                    { "name": "nodes", "type": "integer" },\n                    { "name": "jsEventListeners", "type": "integer" }\n                ]\n            }\n        ],\n        "events": [\n            {\n                "name": "addNativeSnapshotChunk",\n                "parameters": [\n                    { "name": "chunk", "$ref": "HeapSnapshotChunk", "description": "A chunk of the serialized the snapshot." }\n                ]\n            }\n        ]\n    },\n    {\n        "domain": "Page",\n        "description": "Actions and events related to the inspected page belong to the page domain.",\n        "types": [\n            {\n                "id": "ResourceType",\n                "type": "string",\n                "enum": ["Document", "Stylesheet", "Image", "Font", "Script", "XHR", "WebSocket", "Other"],\n                "description": "Resource type as it was perceived by the rendering engine."\n            },\n            {\n              "id": "FrameId",\n              "type": "string",\n              "description": "Unique frame identifier."\n            },\n            {\n                "id": "Frame",\n                "type": "object",\n                "description": "Information about the Frame on the page.",\n                "properties": [\n                    { "name": "id", "type": "string", "description": "Frame unique identifier." },\n                    { "name": "parentId", "type": "string", "optional": true, "description": "Parent frame identifier." },\n                    { "name": "loaderId", "$ref": "Network.LoaderId", "description": "Identifier of the loader associated with this frame." },\n                    { "name": "name", "type": "string", "optional": true, "description": "Frame\'s name as specified in the tag." },\n                    { "name": "url", "type": "string", "description": "Frame document\'s URL." },\n                    { "name": "securityOrigin", "type": "string", "description": "Frame document\'s security origin." },\n                    { "name": "mimeType", "type": "string", "description": "Frame document\'s mimeType as determined by the browser." }\n                ]\n            },\n            {\n                "id": "FrameResourceTree",\n                "type": "object",\n                "description": "Information about the Frame hierarchy along with their cached resources.",\n                "properties": [\n                    { "name": "frame", "$ref": "Frame", "description": "Frame information for this tree item." },\n                    { "name": "childFrames", "type": "array", "optional": true, "items": { "$ref": "FrameResourceTree" }, "description": "Child frames." },\n                    { "name": "resources", "type": "array",\n                        "items": {\n                            "type": "object",\n                            "properties": [\n                                { "name": "url", "type": "string", "description": "Resource URL." },\n                                { "name": "type", "$ref": "ResourceType", "description": "Type of this resource." },\n                                { "name": "mimeType", "type": "string", "description": "Resource mimeType as determined by the browser." },\n                                { "name": "failed", "type": "boolean", "optional": true, "description": "True if the resource failed to load." },\n                                { "name": "canceled", "type": "boolean", "optional": true, "description": "True if the resource was canceled during loading." }\n                            ]\n                        },\n                        "description": "Information about frame resources."\n                    }\n                ],\n                "hidden": true\n            },\n            {\n                "id": "SearchMatch",\n                "type": "object",\n                "description": "Search match for resource.",\n                "properties": [\n                    { "name": "lineNumber", "type": "number", "description": "Line number in resource content." },\n                    { "name": "lineContent", "type": "string", "description": "Line with match content." }\n                ],\n                "hidden": true\n            },\n            {\n                "id": "SearchResult",\n                "type": "object",\n                "description": "Search result for resource.",\n                "properties": [\n                    { "name": "url", "type": "string", "description": "Resource URL." },\n                    { "name": "frameId", "$ref": "FrameId", "description": "Resource frame id." },\n                    { "name": "matchesCount", "type": "number", "description": "Number of matches in the resource content." }\n                ],\n                "hidden": true\n            },\n            {\n                "id": "Cookie",\n                "type": "object",\n                "description": "Cookie object",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Cookie name." },\n                    { "name": "value", "type": "string", "description": "Cookie value." },\n                    { "name": "domain", "type": "string", "description": "Cookie domain." },\n                    { "name": "path", "type": "string", "description": "Cookie path." },\n                    { "name": "expires", "type": "number", "description": "Cookie expires." },\n                    { "name": "size", "type": "integer", "description": "Cookie size." },\n                    { "name": "httpOnly", "type": "boolean", "description": "True if cookie is http-only." },\n                    { "name": "secure", "type": "boolean", "description": "True if cookie is secure." },\n                    { "name": "session", "type": "boolean", "description": "True in case of session cookie." }\n                ],\n                "hidden": true\n            },\n            {\n                "id": "ScriptIdentifier",\n                "type": "string",\n                "description": "Unique script identifier.",\n                "hidden": true\n            },\n            {\n                "id": "NavigationEntry",\n                "type": "object",\n                "description": "Navigation history entry.",\n                "properties": [\n                  { "name": "id", "type": "integer", "description": "Unique id of the navigation history entry." },\n                  { "name": "url", "type": "string", "description": "URL of the navigation history entry." },\n                  { "name": "title", "type": "string", "description": "Title of the navigation history entry." }\n                ],\n                "hidden": true\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables page domain notifications."\n            },\n            {\n                "name": "disable",\n                "description": "Disables page domain notifications."\n            },\n            {\n                "name": "addScriptToEvaluateOnLoad",\n                "parameters": [\n                    { "name": "scriptSource", "type": "string" }\n                ],\n                "returns": [\n                    { "name": "identifier", "$ref": "ScriptIdentifier", "description": "Identifier of the added script." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "removeScriptToEvaluateOnLoad",\n                "parameters": [\n                    { "name": "identifier", "$ref": "ScriptIdentifier" }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "reload",\n                "parameters": [\n                    { "name": "ignoreCache", "type": "boolean", "optional": true, "description": "If true, browser cache is ignored (as if the user pressed Shift+refresh)." },\n                    { "name": "scriptToEvaluateOnLoad", "type": "string", "optional": true, "description": "If set, the script will be injected into all frames of the inspected page after reload." },\n                    { "name": "scriptPreprocessor", "type": "string", "optional": true, "description": "Script body that should evaluate to function that will preprocess all the scripts before their compilation.", "hidden": true }\n                ],\n                "description": "Reloads given page optionally ignoring the cache."\n            },\n            {\n                "name": "navigate",\n                "parameters": [\n                    { "name": "url", "type": "string", "description": "URL to navigate the page to." }\n                ],\n                "description": "Navigates current page to the given URL."\n            },\n            {\n              "name": "getNavigationHistory",\n              "parameters": [],\n              "returns": [\n                { "name": "currentIndex", "type": "integer", "description": "Index of the current navigation history entry." },\n                { "name": "entries", "type": "array", "items": { "$ref": "NavigationEntry"}, "description": "Array of navigation history entries." }\n              ],\n              "description": "Returns navigation history for the current page.",\n              "hidden": true\n            },\n            {\n              "name": "navigateToHistoryEntry",\n              "parameters": [\n                  { "name": "entryId", "type": "integer", "description": "Unique id of the entry to navigate to." }\n              ],\n              "description": "Navigates current page to the given history entry.",\n              "hidden": true\n            },\n            {\n                "name": "getCookies",\n                "returns": [\n                    { "name": "cookies", "type": "array", "items": { "$ref": "Cookie"}, "description": "Array of cookie objects." },\n                    { "name": "cookiesString", "type": "string", "description": "document.cookie string representation of the cookies." }\n                ],\n                "description": "Returns all browser cookies. Depending on the backend support, will either return detailed cookie information in the <code>cookie</code> field or string cookie representation using <code>cookieString</code>.",\n                "hidden": true\n            },\n            {\n                "name": "deleteCookie",\n                "parameters": [\n                    { "name": "cookieName", "type": "string", "description": "Name of the cookie to remove." },\n                    { "name": "url", "type": "string", "description": "URL to match cooke domain and path." }\n                ],\n                "description": "Deletes browser cookie with given name, domain and path.",\n                "hidden": true\n            },\n            {\n                "name": "getResourceTree",\n                "description": "Returns present frame / resource tree structure.",\n                "returns": [\n                    { "name": "frameTree", "$ref": "FrameResourceTree", "description": "Present frame / resource tree structure." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "getResourceContent",\n                "description": "Returns content of the given resource.",\n                "parameters": [\n                    { "name": "frameId", "$ref": "FrameId", "description": "Frame id to get resource for." },\n                    { "name": "url", "type": "string", "description": "URL of the resource to get content for." }\n                ],\n                "returns": [\n                    { "name": "content", "type": "string", "description": "Resource content." },\n                    { "name": "base64Encoded", "type": "boolean", "description": "True, if content was served as base64." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "searchInResource",\n                "description": "Searches for given string in resource content.",\n                "parameters": [\n                    { "name": "frameId", "$ref": "FrameId", "description": "Frame id for resource to search in." },\n                    { "name": "url", "type": "string", "description": "URL of the resource to search in." },\n                    { "name": "query", "type": "string", "description": "String to search for."  },\n                    { "name": "caseSensitive", "type": "boolean", "optional": true, "description": "If true, search is case sensitive." },\n                    { "name": "isRegex", "type": "boolean", "optional": true, "description": "If true, treats string parameter as regex." }\n                ],\n                "returns": [\n                    { "name": "result", "type": "array", "items": { "$ref": "SearchMatch" }, "description": "List of search matches." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "searchInResources",\n                "description": "Searches for given string in frame / resource tree structure.",\n                "parameters": [\n                    { "name": "text", "type": "string", "description": "String to search for."  },\n                    { "name": "caseSensitive", "type": "boolean", "optional": true, "description": "If true, search is case sensitive." },\n                    { "name": "isRegex", "type": "boolean", "optional": true, "description": "If true, treats string parameter as regex." }\n                ],\n                "returns": [\n                    { "name": "result", "type": "array", "items": { "$ref": "SearchResult" }, "description": "List of search results." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setDocumentContent",\n                "description": "Sets given markup as the document\'s HTML.",\n                "parameters": [\n                    { "name": "frameId", "$ref": "FrameId", "description": "Frame id to set HTML for." },\n                    { "name": "html", "type": "string", "description": "HTML content to set."  }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setDeviceMetricsOverride",\n                "description": "Overrides the values of device screen dimensions (window.screen.width, window.screen.height, window.innerWidth, window.innerHeight, and \\"device-width\\"/\\"device-height\\"-related CSS media query results) and the font scale factor.",\n                "parameters": [\n                    { "name": "width", "type": "integer", "description": "Overriding width value in pixels (minimum 0, maximum 10000000). 0 disables the override." },\n                    { "name": "height", "type": "integer", "description": "Overriding height value in pixels (minimum 0, maximum 10000000). 0 disables the override." },\n                    { "name": "fontScaleFactor", "type": "number", "description": "Overriding font scale factor value (must be positive). 1 disables the override." },\n                    { "name": "fitWindow", "type": "boolean", "description": "Whether a view that exceeds the available browser window area should be scaled down to fit." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setShowPaintRects",\n                "description": "Requests that backend shows paint rectangles",\n                "parameters": [\n                    { "name": "result", "type": "boolean", "description": "True for showing paint rectangles" }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setShowDebugBorders",\n                "description": "Requests that backend shows debug borders on layers",\n                "parameters": [\n                    { "name": "show", "type": "boolean", "description": "True for showing debug borders" }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setShowFPSCounter",\n                "description": "Requests that backend shows the FPS counter",\n                "parameters": [\n                    { "name": "show", "type": "boolean", "description": "True for showing the FPS counter" }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setContinuousPaintingEnabled",\n                "description": "Requests that backend enables continuous painting",\n                "parameters": [\n                    { "name": "enabled", "type": "boolean", "description": "True for enabling cointinuous painting" }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setShowScrollBottleneckRects",\n                "description": "Requests that backend shows scroll bottleneck rects",\n                "parameters": [\n                    { "name": "show", "type": "boolean", "description": "True for showing scroll bottleneck rects" }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "getScriptExecutionStatus",\n                "description": "Determines if scripts can be executed in the page.",\n                "returns": [\n                    { "name": "result", "type": "string", "enum": ["allowed", "disabled", "forbidden"], "description": "Script execution status: \\"allowed\\" if scripts can be executed, \\"disabled\\" if script execution has been disabled through page settings, \\"forbidden\\" if script execution for the given page is not possible for other reasons." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setScriptExecutionDisabled",\n                "description": "Switches script execution in the page.",\n                "parameters": [\n                    { "name": "value", "type": "boolean", "description": "Whether script execution should be disabled in the page." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setGeolocationOverride",\n                "description": "Overrides the Geolocation Position or Error.",\n                "parameters": [\n                    { "name": "latitude", "type": "number", "optional": true, "description": "Mock longitude"},\n                    { "name": "longitude", "type": "number", "optional": true, "description": "Mock latitude"},\n                    { "name": "accuracy", "type": "number", "optional": true, "description": "Mock accuracy"}\n                ]\n            },\n            {\n                "name": "clearGeolocationOverride",\n                "description": "Clears the overriden Geolocation Position and Error."\n            },\n            {\n                "name": "setDeviceOrientationOverride",\n                "description": "Overrides the Device Orientation.",\n                "parameters": [\n                    { "name": "alpha", "type": "number", "description": "Mock alpha"},\n                    { "name": "beta", "type": "number", "description": "Mock beta"},\n                    { "name": "gamma", "type": "number", "description": "Mock gamma"}\n                ],\n                "hidden": true\n            },\n            {\n                "name": "clearDeviceOrientationOverride",\n                "description": "Clears the overridden Device Orientation.",\n                "hidden": true\n            },\n            {\n                "name": "setTouchEmulationEnabled",\n                "parameters": [\n                    { "name": "enabled", "type": "boolean", "description": "Whether the touch event emulation should be enabled." }\n                ],\n                "description": "Toggles mouse event-based touch event emulation.",\n                "hidden": true\n            },\n            {\n                "name": "setEmulatedMedia",\n                "parameters": [\n                    { "name": "media", "type": "string", "description": "Media type to emulate. Empty string disables the override." }\n                ],\n                "description": "Emulates the given media for CSS media queries.",\n                "hidden": true\n            },\n            {\n                "name": "captureScreenshot",\n                "description": "Capture page screenshot.",\n                "parameters": [\n                    { "name": "format", "type": "string", "optional": true, "enum": ["jpeg", "png"], "description": "Image compression format." },\n                    { "name": "quality", "type": "integer", "optional": true, "description": "Compression quality from range [0..100]." },\n                    { "name": "maxWidth", "type": "integer", "optional": true, "description": "Maximum screenshot width." },\n                    { "name": "maxHeight", "type": "integer", "optional": true, "description": "Maximum screenshot height." }\n                ],\n                "returns": [\n                    { "name": "data", "type": "string", "description": "Base64-encoded image data (PNG)." },\n                    { "name": "deviceScaleFactor", "type": "number", "hidden": true, "description": "Device scale factor." },\n                    { "name": "pageScaleFactor", "type": "number", "hidden": true, "description": "Page scale factor." },\n                    { "name": "viewport", "$ref": "DOM.Rect", "hidden": true, "description": "Viewport in CSS pixels." }\n                ]\n            },\n            {\n                "name": "startScreencast",\n                "description": "Starts sending each frame using the <code>screencastFrame</code> event.",\n                "parameters": [\n                    { "name": "format", "type": "string", "optional": true, "enum": ["jpeg", "png"], "description": "Image compression format." },\n                    { "name": "quality", "type": "integer", "optional": true, "description": "Compression quality from range [0..100]." },\n                    { "name": "maxWidth", "type": "integer", "optional": true, "description": "Maximum screenshot width." },\n                    { "name": "maxHeight", "type": "integer", "optional": true, "description": "Maximum screenshot height." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "stopScreencast",\n                "description": "Stops sending each frame in the <code>screencastFrame</code>.",\n                "hidden": true\n            },\n            {\n                "name": "handleJavaScriptDialog",\n                "description": "Accepts or dismisses a JavaScript initiated dialog (alert, confirm, prompt, or onbeforeunload).",\n                "parameters": [\n                    { "name": "accept", "type": "boolean", "description": "Whether to accept or dismiss the dialog." },\n                    { "name": "promptText", "type": "string", "optional": true, "description": "The text to enter into the dialog prompt before accepting. Used only if this is a prompt dialog." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setShowViewportSizeOnResize",\n                "description": "Paints viewport size upon main frame resize.",\n                "parameters": [\n                    { "name": "show", "type": "boolean", "description": "Whether to paint size or not." },\n                    { "name": "showGrid", "type": "boolean", "optional": true, "description": "Whether to paint grid as well." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "setForceCompositingMode",\n                "description": "Force accelerated compositing mode for inspected page.",\n                "parameters": [\n                    { "name": "force", "type": "boolean", "description": "Whether to force accelerated compositing or not." }\n                ],\n                "hidden": true\n            }\n        ],\n        "events": [\n            {\n                "name": "domContentEventFired",\n                "parameters": [\n                    { "name": "timestamp", "type": "number" }\n                ]\n            },\n            {\n                "name": "loadEventFired",\n                "parameters": [\n                    { "name": "timestamp", "type": "number" }\n                ]\n            },\n            {\n                "name": "frameAttached",\n                "description": "Fired when frame has been attached to its parent.",\n                "parameters": [\n                    { "name": "frameId", "$ref": "FrameId", "description": "Id of the frame that has been attached." }\n                ]\n            },\n            {\n                "name": "frameNavigated",\n                "description": "Fired once navigation of the frame has completed. Frame is now associated with the new loader.",\n                "parameters": [\n                    { "name": "frame", "$ref": "Frame", "description": "Frame object." }\n                ]\n            },\n            {\n                "name": "frameDetached",\n                "description": "Fired when frame has been detached from its parent.",\n                "parameters": [\n                    { "name": "frameId", "$ref": "FrameId", "description": "Id of the frame that has been detached." }\n                ]\n            },\n            {\n                "name": "frameStartedLoading",\n                "description": "Fired when frame has started loading.",\n                "parameters": [\n                    { "name": "frameId", "$ref": "FrameId", "description": "Id of the frame that has started loading." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "frameStoppedLoading",\n                "description": "Fired when frame has stopped loading.",\n                "parameters": [\n                    { "name": "frameId", "$ref": "FrameId", "description": "Id of the frame that has stopped loading." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "frameScheduledNavigation",\n                "description": "Fired when frame schedules a potential navigation.",\n                "parameters": [\n                    { "name": "frameId", "$ref": "FrameId", "description": "Id of the frame that has scheduled a navigation." },\n                    { "name": "delay", "type": "number", "description": "Delay (in seconds) until the navigation is scheduled to begin. The navigation is not guaranteed to start." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "frameClearedScheduledNavigation",\n                "description": "Fired when frame no longer has a scheduled navigation.",\n                "parameters": [\n                    { "name": "frameId", "$ref": "FrameId", "description": "Id of the frame that has cleared its scheduled navigation." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "javascriptDialogOpening",\n                "description": "Fired when a JavaScript initiated dialog (alert, confirm, prompt, or onbeforeunload) is about to open.",\n                "parameters": [\n                    { "name": "message", "type": "string", "description": "Message that will be displayed by the dialog." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "javascriptDialogClosed",\n                "description": "Fired when a JavaScript initiated dialog (alert, confirm, prompt, or onbeforeunload) has been closed.",\n                "hidden": true\n            },\n            {\n                "name": "scriptsEnabled",\n                "description": "Fired when the JavaScript is enabled/disabled on the page",\n                "parameters": [\n                    { "name": "isEnabled", "type": "boolean", "description": "Whether script execution is enabled or disabled on the page." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "screencastFrame",\n                "description": "Compressed image data requested by the <code>startScreencast</code>.",\n                "parameters": [\n                    { "name": "data", "type": "string", "description": "Base64-encoded compressed image." },\n                    { "name": "deviceScaleFactor", "type": "number", "hidden": true, "optional": true, "description": "Device scale factor." },\n                    { "name": "pageScaleFactor", "type": "number", "hidden": true, "optional": true, "description": "Page scale factor." },\n                    { "name": "viewport", "$ref": "DOM.Rect", "hidden": true, "optional": true, "description": "Viewport in CSS pixels." },\n                    { "name": "offsetTop", "type": "number", "hidden": true, "optional": true, "description": "Top offset in DIP." },\n                    { "name": "offsetBottom", "type": "number", "hidden": true, "optional": true, "description": "Bottom offset in DIP." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "screencastVisibilityChanged",\n                "description": "Fired when the page with currently enabled screencast was shown or hidden </code>.",\n                "parameters": [\n                    { "name": "visible", "type": "boolean", "description": "True if the page is visible." }\n                ],\n                "hidden": true\n            }\n        ]\n    },\n    {\n        "domain": "Runtime",\n        "description": "Runtime domain exposes JavaScript runtime by means of remote evaluation and mirror objects. Evaluation results are returned as mirror object that expose object type, string representation and unique identifier that can be used for further object reference. Original objects are maintained in memory unless they are either explicitly released or are released along with the other objects in their object group.",\n        "types": [\n            {\n                "id": "RemoteObjectId",\n                "type": "string",\n                "description": "Unique object identifier."\n            },\n            {\n                "id": "RemoteObject",\n                "type": "object",\n                "description": "Mirror object referencing original JavaScript object.",\n                "properties": [\n                    { "name": "type", "type": "string", "enum": ["object", "function", "undefined", "string", "number", "boolean"], "description": "Object type." },\n                    { "name": "subtype", "type": "string", "optional": true, "enum": ["array", "null", "node", "regexp", "date"], "description": "Object subtype hint. Specified for <code>object</code> type values only." },\n                    { "name": "className", "type": "string", "optional": true, "description": "Object class (constructor) name. Specified for <code>object</code> type values only." },\n                    { "name": "value", "type": "any", "optional": true, "description": "Remote object value (in case of primitive values or JSON values if it was requested)." },\n                    { "name": "description", "type": "string", "optional": true, "description": "String representation of the object." },\n                    { "name": "objectId", "$ref": "RemoteObjectId", "optional": true, "description": "Unique object identifier (for non-primitive values)." },\n                    { "name": "preview", "$ref": "ObjectPreview", "optional": true, "description": "Preview containing abbreviated property values.", "hidden": true }\n                ]\n            },\n            {\n                "id": "ObjectPreview",\n                "type": "object",\n                "hidden": true,\n                "description": "Object containing abbreviated remote object value.",\n                "properties": [\n                    { "name": "lossless", "type": "boolean", "description": "Determines whether preview is lossless (contains all information of the original object)." },\n                    { "name": "overflow", "type": "boolean", "description": "True iff some of the properties of the original did not fit." },\n                    { "name": "properties", "type": "array", "items": { "$ref": "PropertyPreview" }, "description": "List of the properties." }\n                ]\n            },\n            {\n                "id": "PropertyPreview",\n                "type": "object",\n                "hidden": true,\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Property name." },\n                    { "name": "type", "type": "string", "enum": ["object", "function", "undefined", "string", "number", "boolean"], "description": "Object type." },\n                    { "name": "value", "type": "string", "optional": true, "description": "User-friendly property value string." },\n                    { "name": "valuePreview", "$ref": "ObjectPreview", "optional": true, "description": "Nested value preview." },\n                    { "name": "subtype", "type": "string", "optional": true, "enum": ["array", "null", "node", "regexp", "date"], "description": "Object subtype hint. Specified for <code>object</code> type values only." }\n                ]\n            },\n            {\n                "id": "PropertyDescriptor",\n                "type": "object",\n                "description": "Object property descriptor.",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Property name." },\n                    { "name": "value", "$ref": "RemoteObject", "optional": true, "description": "The value associated with the property." },\n                    { "name": "writable", "type": "boolean", "optional": true, "description": "True if the value associated with the property may be changed (data descriptors only)." },\n                    { "name": "get", "$ref": "RemoteObject", "optional": true, "description": "A function which serves as a getter for the property, or <code>undefined</code> if there is no getter (accessor descriptors only)." },\n                    { "name": "set", "$ref": "RemoteObject", "optional": true, "description": "A function which serves as a setter for the property, or <code>undefined</code> if there is no setter (accessor descriptors only)." },\n                    { "name": "configurable", "type": "boolean", "description": "True if the type of this property descriptor may be changed and if the property may be deleted from the corresponding object." },\n                    { "name": "enumerable", "type": "boolean", "description": "True if this property shows up during enumeration of the properties on the corresponding object." },\n                    { "name": "wasThrown", "type": "boolean", "optional": true, "description": "True if the result was thrown during the evaluation." },\n                    { "name": "isOwn", "optional": true, "type": "boolean", "description": "True if the property is owned for the object.", "hidden": true }\n\n                ]\n            },\n            {\n                "id": "InternalPropertyDescriptor",\n                "type": "object",\n                "description": "Object internal property descriptor. This property isn\'t normally visible in JavaScript code.",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Conventional property name." },\n                    { "name": "value", "$ref": "RemoteObject", "optional": true, "description": "The value associated with the property." }\n                ],\n                "hidden": true\n            },\n            {\n                "id": "CallArgument",\n                "type": "object",\n                "description": "Represents function call argument. Either remote object id <code>objectId</code> or primitive <code>value</code> or neither of (for undefined) them should be specified.",\n                "properties": [\n                    { "name": "value", "type": "any", "optional": true, "description": "Primitive value." },\n                    { "name": "objectId", "$ref": "RemoteObjectId", "optional": true, "description": "Remote object handle." }\n                ]\n            },\n            {\n                "id": "ExecutionContextId",\n                "type": "integer",\n                "description": "Id of an execution context."\n            },\n            {\n                "id": "ExecutionContextDescription",\n                "type": "object",\n                "description": "Description of an isolated world.",\n                "properties": [\n                    { "name": "id", "$ref": "ExecutionContextId", "description": "Unique id of the execution context. It can be used to specify in which execution context script evaluation should be performed." },\n                    { "name": "isPageContext", "type": "boolean", "description": "True if this is a context where inpspected web page scripts run. False if it is a content script isolated context.", "hidden": true },\n                    { "name": "name", "type": "string", "description": "Human readable name describing given context.", "hidden": true},\n                    { "name": "frameId", "$ref": "Page.FrameId", "description": "Id of the owning frame." }\n                ]\n            }\n\n        ],\n        "commands": [\n            {\n                "name": "evaluate",\n                "parameters": [\n                    { "name": "expression", "type": "string", "description": "Expression to evaluate." },\n                    { "name": "objectGroup", "type": "string", "optional": true, "description": "Symbolic group name that can be used to release multiple objects." },\n                    { "name": "includeCommandLineAPI", "type": "boolean", "optional": true, "description": "Determines whether Command Line API should be available during the evaluation.", "hidden": true },\n                    { "name": "doNotPauseOnExceptionsAndMuteConsole", "type": "boolean", "optional": true, "description": "Specifies whether evaluation should stop on exceptions and mute console. Overrides setPauseOnException state.", "hidden": true },\n                    { "name": "contextId", "$ref": "Runtime.ExecutionContextId", "optional": true, "description": "Specifies in which isolated context to perform evaluation. Each content script lives in an isolated context and this parameter may be used to specify one of those contexts. If the parameter is omitted or 0 the evaluation will be performed in the context of the inspected page." },\n                    { "name": "returnByValue", "type": "boolean", "optional": true, "description": "Whether the result is expected to be a JSON object that should be sent by value." },\n                    { "name": "generatePreview", "type": "boolean", "optional": true, "hidden": true, "description": "Whether preview should be generated for the result." }\n                ],\n                "returns": [\n                    { "name": "result", "$ref": "RemoteObject", "description": "Evaluation result." },\n                    { "name": "wasThrown", "type": "boolean", "optional": true, "description": "True if the result was thrown during the evaluation." }\n                ],\n                "description": "Evaluates expression on global object."\n            },\n            {\n                "name": "callFunctionOn",\n                "parameters": [\n                    { "name": "objectId", "$ref": "RemoteObjectId", "description": "Identifier of the object to call function on." },\n                    { "name": "functionDeclaration", "type": "string", "description": "Declaration of the function to call." },\n                    { "name": "arguments", "type": "array", "items": { "$ref": "CallArgument", "description": "Call argument." }, "optional": true, "description": "Call arguments. All call arguments must belong to the same JavaScript world as the target object." },\n                    { "name": "doNotPauseOnExceptionsAndMuteConsole", "type": "boolean", "optional": true, "description": "Specifies whether function call should stop on exceptions and mute console. Overrides setPauseOnException state.", "hidden": true },\n                    { "name": "returnByValue", "type": "boolean", "optional": true, "description": "Whether the result is expected to be a JSON object which should be sent by value." },\n                    { "name": "generatePreview", "type": "boolean", "optional": true, "hidden": true, "description": "Whether preview should be generated for the result." }\n                ],\n                "returns": [\n                    { "name": "result", "$ref": "RemoteObject", "description": "Call result." },\n                    { "name": "wasThrown", "type": "boolean", "optional": true, "description": "True if the result was thrown during the evaluation." }\n                ],\n                "description": "Calls function with given declaration on the given object. Object group of the result is inherited from the target object."\n            },\n            {\n                "name": "getProperties",\n                "parameters": [\n                    { "name": "objectId", "$ref": "RemoteObjectId", "description": "Identifier of the object to return properties for." },\n                    { "name": "ownProperties", "optional": true, "type": "boolean", "description": "If true, returns properties belonging only to the element itself, not to its prototype chain." },\n                    { "name": "accessorPropertiesOnly", "optional": true, "type": "boolean", "description": "If true, returns accessor properties (with getter/setter) only; internal properties are not returned either.", "hidden": true }\n                ],\n                "returns": [\n                    { "name": "result", "type": "array", "items": { "$ref": "PropertyDescriptor"}, "description": "Object properties." },\n                    { "name": "internalProperties", "optional": true, "type": "array", "items": { "$ref": "InternalPropertyDescriptor"}, "description": "Internal object properties (only of the element itself).", "hidden": true }\n                ],\n                "description": "Returns properties of a given object. Object group of the result is inherited from the target object."\n            },\n            {\n                "name": "releaseObject",\n                "parameters": [\n                    { "name": "objectId", "$ref": "RemoteObjectId", "description": "Identifier of the object to release." }\n                ],\n                "description": "Releases remote object with given id."\n            },\n            {\n                "name": "releaseObjectGroup",\n                "parameters": [\n                    { "name": "objectGroup", "type": "string", "description": "Symbolic object group name." }\n                ],\n                "description": "Releases all remote objects that belong to a given group."\n            },\n            {\n                "name": "run",\n                "hidden": true,\n                "description": "Tells inspected instance(worker or page) that it can run in case it was started paused."\n            },\n            {\n                "name": "enable",\n                "description": "Enables reporting of execution contexts creation by means of <code>executionContextCreated</code> event. When the reporting gets enabled the event will be sent immediately for each existing execution context."\n            },\n            {\n                "name": "disable",\n                "hidden": true,\n                "description": "Disables reporting of execution contexts creation."\n            }\n        ],\n        "events": [\n            {\n                "name": "executionContextCreated",\n                "parameters": [\n                    { "name": "context", "$ref": "ExecutionContextDescription", "description": "A newly created execution contex." }\n                ],\n                "description": "Issued when new execution context is created."\n            }\n        ]\n    },\n    {\n        "domain": "Console",\n        "description": "Console domain defines methods and events for interaction with the JavaScript console. Console collects messages created by means of the <a href=\'http://getfirebug.com/wiki/index.php/Console_API\'>JavaScript Console API</a>. One needs to enable this domain using <code>enable</code> command in order to start receiving the console messages. Browser collects messages issued while console domain is not enabled as well and reports them using <code>messageAdded</code> notification upon enabling.",\n        "types": [\n            {\n                "id": "Timestamp",\n                "type": "number",\n                "description": "Number of seconds since epoch.",\n                "hidden": true\n            },\n            {\n                "id": "ConsoleMessage",\n                "type": "object",\n                "description": "Console message.",\n                "properties": [\n                    { "name": "source", "type": "string", "enum": ["xml", "javascript", "network", "console-api", "storage", "appcache", "rendering", "css", "security", "other", "deprecation"], "description": "Message source." },\n                    { "name": "level", "type": "string", "enum": ["log", "warning", "error", "debug"], "description": "Message severity." },\n                    { "name": "text", "type": "string", "description": "Message text." },\n                    { "name": "type", "type": "string", "optional": true, "enum": ["log", "dir", "dirxml", "table", "trace", "clear", "startGroup", "startGroupCollapsed", "endGroup", "assert", "profile", "profileEnd"], "description": "Console message type." },\n                    { "name": "url", "type": "string", "optional": true, "description": "URL of the message origin." },\n                    { "name": "line", "type": "integer", "optional": true, "description": "Line number in the resource that generated this message." },\n                    { "name": "column", "type": "integer", "optional": true, "description": "Column number in the resource that generated this message." },\n                    { "name": "repeatCount", "type": "integer", "optional": true, "description": "Repeat count for repeated messages." },\n                    { "name": "parameters", "type": "array", "items": { "$ref": "Runtime.RemoteObject" }, "optional": true, "description": "Message parameters in case of the formatted message." },\n                    { "name": "stackTrace", "$ref": "StackTrace", "optional": true, "description": "JavaScript stack trace for assertions and error messages." },\n                    { "name": "networkRequestId", "$ref": "Network.RequestId", "optional": true, "description": "Identifier of the network request associated with this message." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp, when this message was fired.", "hidden": true }\n                ]\n            },\n            {\n                "id": "CallFrame",\n                "type": "object",\n                "description": "Stack entry for console errors and assertions.",\n                "properties": [\n                    { "name": "functionName", "type": "string", "description": "JavaScript function name." },\n                    { "name": "scriptId", "type": "string", "description": "JavaScript script id." },\n                    { "name": "url", "type": "string", "description": "JavaScript script name or url." },\n                    { "name": "lineNumber", "type": "integer", "description": "JavaScript script line number." },\n                    { "name": "columnNumber", "type": "integer", "description": "JavaScript script column number." }\n                ]\n            },\n            {\n                "id": "StackTrace",\n                "type": "array",\n                "items": { "$ref": "CallFrame" },\n                "description": "Call frames for assertions or error messages."\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables console domain, sends the messages collected so far to the client by means of the <code>messageAdded</code> notification."\n            },\n            {\n                "name": "disable",\n                "description": "Disables console domain, prevents further console messages from being reported to the client."\n            },\n            {\n                "name": "clearMessages",\n                "description": "Clears console messages collected in the browser."\n            },\n            {\n                "name": "setMonitoringXHREnabled",\n                "parameters": [\n                    { "name": "enabled", "type": "boolean", "description": "Monitoring enabled state." }\n                ],\n                "description": "Toggles monitoring of XMLHttpRequest. If <code>true</code>, console will receive messages upon each XHR issued.",\n                "hidden": true\n            },\n            {\n                "name": "addInspectedNode",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "DOM.NodeId", "description": "DOM node id to be accessible by means of $x command line API." }\n                ],\n                "description": "Enables console to refer to the node with given id via $x (see Command Line API for more details $x functions).",\n                "hidden": true\n            },\n            {\n                "name": "addInspectedHeapObject",\n                "parameters": [\n                    { "name": "heapObjectId", "type": "integer" }\n                ],\n                "hidden": true\n            }\n        ],\n        "events": [\n            {\n                "name": "messageAdded",\n                "parameters": [\n                    { "name": "message", "$ref": "ConsoleMessage", "description": "Console message that has been added." }\n                ],\n                "description": "Issued when new console message is added."\n            },\n            {\n                "name": "messageRepeatCountUpdated",\n                "parameters": [\n                    { "name": "count", "type": "integer", "description": "New repeat count value." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp of most recent message in batch.", "hidden": true }\n                ],\n                "description": "Issued when subsequent message(s) are equal to the previous one(s)."\n            },\n            {\n                "name": "messagesCleared",\n                "description": "Issued when console is cleared. This happens either upon <code>clearMessages</code> command or after page navigation."\n            }\n        ]\n    },\n    {\n        "domain": "Network",\n        "description": "Network domain allows tracking network activities of the page. It exposes information about http, file, data and other requests and responses, their headers, bodies, timing, etc.",\n        "types": [\n            {\n                "id": "LoaderId",\n                "type": "string",\n                "description": "Unique loader identifier."\n            },\n            {\n                "id": "RequestId",\n                "type": "string",\n                "description": "Unique request identifier."\n            },\n            {\n                "id": "Timestamp",\n                "type": "number",\n                "description": "Number of seconds since epoch."\n            },\n            {\n                "id": "Headers",\n                "type": "object",\n                "description": "Request / response headers as keys / values of JSON object."\n            },\n            {\n                "id": "ResourceTiming",\n                "type": "object",\n                "description": "Timing information for the request.",\n                "properties": [\n                    { "name": "requestTime", "type": "number", "description": "Timing\'s requestTime is a baseline in seconds, while the other numbers are ticks in milliseconds relatively to this requestTime." },\n                    { "name": "proxyStart", "type": "number", "description": "Started resolving proxy." },\n                    { "name": "proxyEnd", "type": "number", "description": "Finished resolving proxy." },\n                    { "name": "dnsStart", "type": "number", "description": "Started DNS address resolve." },\n                    { "name": "dnsEnd", "type": "number", "description": "Finished DNS address resolve." },\n                    { "name": "connectStart", "type": "number", "description": "Started connecting to the remote host." },\n                    { "name": "connectEnd", "type": "number", "description": "Connected to the remote host." },\n                    { "name": "sslStart", "type": "number", "description": "Started SSL handshake." },\n                    { "name": "sslEnd", "type": "number", "description": "Finished SSL handshake." },\n                    { "name": "sendStart", "type": "number", "description": "Started sending request." },\n                    { "name": "sendEnd", "type": "number", "description": "Finished sending request." },\n                    { "name": "receiveHeadersEnd", "type": "number", "description": "Finished receiving response headers." }\n                ]\n            },\n            {\n                "id": "Request",\n                "type": "object",\n                "description": "HTTP request data.",\n                "properties": [\n                    { "name": "url", "type": "string", "description": "Request URL." },\n                    { "name": "method", "type": "string", "description": "HTTP request method." },\n                    { "name": "headers", "$ref": "Headers", "description": "HTTP request headers." },\n                    { "name": "postData", "type": "string", "optional": true, "description": "HTTP POST request data." }\n                ]\n            },\n            {\n                "id": "Response",\n                "type": "object",\n                "description": "HTTP response data.",\n                "properties": [\n                    { "name": "url", "type": "string", "description": "Response URL. This URL can be different from CachedResource.url in case of redirect." },\n                    { "name": "status", "type": "number", "description": "HTTP response status code." },\n                    { "name": "statusText", "type": "string", "description": "HTTP response status text." },\n                    { "name": "headers", "$ref": "Headers", "description": "HTTP response headers." },\n                    { "name": "headersText", "type": "string", "optional": true, "description": "HTTP response headers text." },\n                    { "name": "mimeType", "type": "string", "description": "Resource mimeType as determined by the browser." },\n                    { "name": "requestHeaders", "$ref": "Headers", "optional": true, "description": "Refined HTTP request headers that were actually transmitted over the network." },\n                    { "name": "requestHeadersText", "type": "string", "optional": true, "description": "HTTP request headers text." },\n                    { "name": "connectionReused", "type": "boolean", "description": "Specifies whether physical connection was actually reused for this request." },\n                    { "name": "connectionId", "type": "number", "description": "Physical connection id that was actually used for this request." },\n                    { "name": "fromDiskCache", "type": "boolean", "optional": true, "description": "Specifies that the request was served from the disk cache." },\n                    { "name": "timing", "$ref": "ResourceTiming", "optional": true, "description": "Timing information for the given request." }\n                ]\n            },\n            {\n                "id": "WebSocketRequest",\n                "type": "object",\n                "description": "WebSocket request data.",\n                "hidden": true,\n                "properties": [\n                    { "name": "headers", "$ref": "Headers", "description": "HTTP response headers." }\n                ]\n            },\n            {\n                "id": "WebSocketResponse",\n                "type": "object",\n                "description": "WebSocket response data.",\n                "hidden": true,\n                "properties": [\n                    { "name": "status", "type": "number", "description": "HTTP response status code." },\n                    { "name": "statusText", "type": "string", "description": "HTTP response status text." },\n                    { "name": "headers", "$ref": "Headers", "description": "HTTP response headers." }\n                ]\n            },\n            {\n                "id": "WebSocketFrame",\n                "type": "object",\n                "description": "WebSocket frame data.",\n                "hidden": true,\n                "properties": [\n                    { "name": "opcode", "type": "number", "description": "WebSocket frame opcode." },\n                    { "name": "mask", "type": "boolean", "description": "WebSocke frame mask." },\n                    { "name": "payloadData", "type": "string", "description": "WebSocke frame payload data." }\n                ]\n            },\n            {\n                "id": "CachedResource",\n                "type": "object",\n                "description": "Information about the cached resource.",\n                "properties": [\n                    { "name": "url", "type": "string", "description": "Resource URL. This is the url of the original network request." },\n                    { "name": "type", "$ref": "Page.ResourceType", "description": "Type of this resource." },\n                    { "name": "response", "$ref": "Response", "optional": true, "description": "Cached response data." },\n                    { "name": "bodySize", "type": "number", "description": "Cached response body size." }\n                ]\n            },\n            {\n                "id": "Initiator",\n                "type": "object",\n                "description": "Information about the request initiator.",\n                "properties": [\n                    { "name": "type", "type": "string", "enum": ["parser", "script", "other"], "description": "Type of this initiator." },\n                    { "name": "stackTrace", "$ref": "Console.StackTrace", "optional": true, "description": "Initiator JavaScript stack trace, set for Script only." },\n                    { "name": "url", "type": "string", "optional": true, "description": "Initiator URL, set for Parser type only." },\n                    { "name": "lineNumber", "type": "number", "optional": true, "description": "Initiator line number, set for Parser type only." }\n                ]\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables network tracking, network events will now be delivered to the client."\n            },\n            {\n                "name": "disable",\n                "description": "Disables network tracking, prevents network events from being sent to the client."\n            },\n            {\n                "name": "setUserAgentOverride",\n                "description": "Allows overriding user agent with the given string.",\n                "parameters": [\n                    { "name": "userAgent", "type": "string", "description": "User agent to use." }\n                ]\n            },\n            {\n                "name": "setExtraHTTPHeaders",\n                "description": "Specifies whether to always send extra HTTP headers with the requests from this page.",\n                "parameters": [\n                    { "name": "headers", "$ref": "Headers", "description": "Map with extra HTTP headers." }\n                ]\n            },\n            {\n                "name": "getResponseBody",\n                "description": "Returns content served for the given request.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Identifier of the network request to get content for." }\n                ],\n                "returns": [\n                    { "name": "body", "type": "string", "description": "Response body." },\n                    { "name": "base64Encoded", "type": "boolean", "description": "True, if content was sent as base64." }\n                ]\n            },\n            {\n                "name": "replayXHR",\n                "description": "This method sends a new XMLHttpRequest which is identical to the original one. The following parameters should be identical: method, url, async, request body, extra headers, withCredentials attribute, user, password.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Identifier of XHR to replay." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "canClearBrowserCache",\n                "description": "Tells whether clearing browser cache is supported.",\n                "returns": [\n                    { "name": "result", "type": "boolean", "description": "True if browser cache can be cleared." }\n                ]\n            },\n            {\n                "name": "clearBrowserCache",\n                "description": "Clears browser cache."\n            },\n            {\n                "name": "canClearBrowserCookies",\n                "description": "Tells whether clearing browser cookies is supported.",\n                "returns": [\n                    { "name": "result", "type": "boolean", "description": "True if browser cookies can be cleared." }\n                ]\n            },\n            {\n                "name": "clearBrowserCookies",\n                "description": "Clears browser cookies."\n            },\n            {\n                "name": "setCacheDisabled",\n                "parameters": [\n                    { "name": "cacheDisabled", "type": "boolean", "description": "Cache disabled state." }\n                ],\n                "description": "Toggles ignoring cache for each request. If <code>true</code>, cache will not be used."\n            },  \n            {\n                "name": "loadResourceForFrontend",\n                "async": true,\n                "parameters": [\n                    { "name": "frameId", "$ref": "Page.FrameId", "description": "Frame to load the resource from." },\n                    { "name": "url", "type": "string", "description": "URL of the resource to load." },\n                    { "name": "requestHeaders", "$ref": "Network.Headers", "optional": true, "description": "Request headers." }\n                ],\n                "returns": [\n                    { "name": "statusCode", "type": "number", "description": "HTTP status code." },\n                    { "name": "responseHeaders", "$ref": "Network.Headers", "description": "Response headers." },\n                    { "name": "content", "type": "string", "description": "Resource content." }\n                ],\n                "description": "Loads a resource in the context of a frame on the inspected page without cross origin checks.",\n                "hidden": true\n            }\n        ],\n        "events": [\n            {\n                "name": "requestWillBeSent",\n                "description": "Fired when page is about to send HTTP request.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "frameId", "$ref": "Page.FrameId", "description": "Frame identifier.", "hidden": true },\n                    { "name": "loaderId", "$ref": "LoaderId", "description": "Loader identifier." },\n                    { "name": "documentURL", "type": "string", "description": "URL of the document this request is loaded for." },\n                    { "name": "request", "$ref": "Request", "description": "Request data." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." },\n                    { "name": "initiator", "$ref": "Initiator", "description": "Request initiator." },\n                    { "name": "redirectResponse", "optional": true, "$ref": "Response", "description": "Redirect response data." }\n                ]\n            },\n            {\n                "name": "requestServedFromCache",\n                "description": "Fired if request ended up loading from cache.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." }\n                ]\n            },\n            {\n                "name": "responseReceived",\n                "description": "Fired when HTTP response is available.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "frameId", "$ref": "Page.FrameId", "description": "Frame identifier.", "hidden": true },\n                    { "name": "loaderId", "$ref": "LoaderId", "description": "Loader identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." },\n                    { "name": "type", "$ref": "Page.ResourceType", "description": "Resource type." },\n                    { "name": "response", "$ref": "Response", "description": "Response data." }\n                ]\n            },\n            {\n                "name": "dataReceived",\n                "description": "Fired when data chunk was received over the network.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." },\n                    { "name": "dataLength", "type": "integer", "description": "Data chunk length." },\n                    { "name": "encodedDataLength", "type": "integer", "description": "Actual bytes received (might be less than dataLength for compressed encodings)." }\n                ]\n            },\n            {\n                "name": "loadingFinished",\n                "description": "Fired when HTTP request has finished loading.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." }\n                ]\n            },\n            {\n                "name": "loadingFailed",\n                "description": "Fired when HTTP request has failed to load.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." },\n                    { "name": "errorText", "type": "string", "description": "User friendly error message." },\n                    { "name": "canceled", "type": "boolean", "optional": true, "description": "True if loading was canceled." }\n                ]\n            },\n            {\n                "name": "webSocketWillSendHandshakeRequest",\n                "description": "Fired when WebSocket is about to initiate handshake.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." },\n                    { "name": "request", "$ref": "WebSocketRequest", "description": "WebSocket request data." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "webSocketHandshakeResponseReceived",\n                "description": "Fired when WebSocket handshake response becomes available.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." },\n                    { "name": "response", "$ref": "WebSocketResponse", "description": "WebSocket response data." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "webSocketCreated",\n                "description": "Fired upon WebSocket creation.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "url", "type": "string", "description": "WebSocket request URL." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "webSocketClosed",\n                "description": "Fired when WebSocket is closed.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "webSocketFrameReceived",\n                "description": "Fired when WebSocket frame is received.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." },\n                    { "name": "response", "$ref": "WebSocketFrame", "description": "WebSocket response data." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "webSocketFrameError",\n                "description": "Fired when WebSocket frame error occurs.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." },\n                    { "name": "errorMessage", "type": "string", "description": "WebSocket frame error message." }\n                ],\n                "hidden": true\n            },\n            {\n                "name": "webSocketFrameSent",\n                "description": "Fired when WebSocket frame is sent.",\n                "parameters": [\n                    { "name": "requestId", "$ref": "RequestId", "description": "Request identifier." },\n                    { "name": "timestamp", "$ref": "Timestamp", "description": "Timestamp." },\n                    { "name": "response", "$ref": "WebSocketFrame", "description": "WebSocket response data." }\n                ],\n                "hidden": true\n            }\n        ]\n    },\n    {\n        "domain": "Database",\n        "hidden": true,\n        "types": [\n            {\n                "id": "DatabaseId",\n                "type": "string",\n                "description": "Unique identifier of Database object.",\n                "hidden": true\n            },\n            {\n                "id": "Database",\n                "type": "object",\n                "description": "Database object.",\n                "hidden": true,\n                "properties": [\n                    { "name": "id", "$ref": "DatabaseId", "description": "Database ID." },\n                    { "name": "domain", "type": "string", "description": "Database domain." },\n                    { "name": "name", "type": "string", "description": "Database name." },\n                    { "name": "version", "type": "string", "description": "Database version." }\n                ]\n            },\n            {\n                "id": "Error",\n                "type": "object",\n                "description": "Database error.",\n                "properties": [\n                    { "name": "message", "type": "string", "description": "Error message." },\n                    { "name": "code", "type": "integer", "description": "Error code." }\n                ]\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables database tracking, database events will now be delivered to the client."\n            },\n            {\n                "name": "disable",\n                "description": "Disables database tracking, prevents database events from being sent to the client."\n            },\n            {\n                "name": "getDatabaseTableNames",\n                "parameters": [\n                    { "name": "databaseId", "$ref": "DatabaseId" }\n                ],\n                "returns": [\n                    { "name": "tableNames", "type": "array", "items": { "type": "string" } }\n                ]\n            },\n            {\n                "name": "executeSQL",\n                "async": true,\n                "parameters": [\n                    { "name": "databaseId", "$ref": "DatabaseId" },\n                    { "name": "query", "type": "string" }\n                ],\n                "returns": [\n                    { "name": "columnNames", "type": "array", "optional": true, "items": { "type": "string" } },\n                    { "name": "values", "type": "array", "optional": true, "items": { "type": "any" }},\n                    { "name": "sqlError", "$ref": "Error", "optional": true }\n                ]\n            }\n        ],\n        "events": [\n            {\n                "name": "addDatabase",\n                "parameters": [\n                    { "name": "database", "$ref": "Database" }\n                ]\n            }\n        ]\n    },\n    {\n        "domain": "IndexedDB",\n        "hidden": true,\n        "types": [\n            {\n                "id": "DatabaseWithObjectStores",\n                "type": "object",\n                "description": "Database with an array of object stores.",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Database name." },\n                    { "name": "version", "type": "string", "description": "Deprecated string database version." },\n                    { "name": "intVersion", "type": "integer", "description": "Integer database version." },\n                    { "name": "objectStores", "type": "array", "items": { "$ref": "ObjectStore" }, "description": "Object stores in this database." }\n                ]\n            },\n            {\n                "id": "ObjectStore",\n                "type": "object",\n                "description": "Object store.",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Object store name." },\n                    { "name": "keyPath", "$ref": "KeyPath", "description": "Object store key path." },\n                    { "name": "autoIncrement", "type": "boolean", "description": "If true, object store has auto increment flag set." },\n                    { "name": "indexes", "type": "array", "items": { "$ref": "ObjectStoreIndex" }, "description": "Indexes in this object store." }\n                ]\n            },\n            {\n                "id": "ObjectStoreIndex",\n                "type": "object",\n                "description": "Object store index.",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Index name." },\n                    { "name": "keyPath", "$ref": "KeyPath", "description": "Index key path." },\n                    { "name": "unique", "type": "boolean", "description": "If true, index is unique." },\n                    { "name": "multiEntry", "type": "boolean", "description": "If true, index allows multiple entries for a key." }\n                ]\n            },\n            {\n                "id": "Key",\n                "type": "object",\n                "description": "Key.",\n                "properties": [\n                    { "name": "type", "type": "string", "enum": ["number", "string", "date", "array"], "description": "Key type." },\n                    { "name": "number", "type": "number", "optional": true, "description": "Number value." },\n                    { "name": "string", "type": "string", "optional": true, "description": "String value." },\n                    { "name": "date", "type": "number", "optional": true, "description": "Date value." },\n                    { "name": "array", "type": "array", "optional": true, "items": { "$ref": "Key" }, "description": "Array value." }\n                ]\n            },\n            {\n                "id": "KeyRange",\n                "type": "object",\n                "description": "Key range.",\n                "properties": [\n                    { "name": "lower", "$ref": "Key", "optional": true, "description": "Lower bound." },\n                    { "name": "upper", "$ref": "Key", "optional": true, "description": "Upper bound." },\n                    { "name": "lowerOpen", "type": "boolean", "description": "If true lower bound is open." },\n                    { "name": "upperOpen", "type": "boolean", "description": "If true upper bound is open." }\n                ]\n            },\n            {\n                "id": "DataEntry",\n                "type": "object",\n                "description": "Data entry.",\n                "properties": [\n                    { "name": "key", "$ref": "Runtime.RemoteObject", "description": "Key." },\n                    { "name": "primaryKey", "$ref": "Runtime.RemoteObject", "description": "Primary key." },\n                    { "name": "value", "$ref": "Runtime.RemoteObject", "description": "Value." }\n                ]\n            },\n            {\n                "id": "KeyPath",\n                "type": "object",\n                "description": "Key path.",\n                "properties": [\n                    { "name": "type", "type": "string", "enum": ["null", "string", "array"], "description": "Key path type." },\n                    { "name": "string", "type": "string", "optional": true, "description": "String value." },\n                    { "name": "array", "type": "array", "optional": true, "items": { "type": "string" }, "description": "Array value." }\n                ]\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables events from backend."\n            },\n            {\n                "name": "disable",\n                "description": "Disables events from backend."\n            },\n            {\n                "name": "requestDatabaseNames",\n                "async": true,\n                "parameters": [\n                    { "name": "securityOrigin", "type": "string", "description": "Security origin." }\n                ],\n                "returns": [\n                    { "name": "databaseNames", "type": "array", "items": { "type": "string" }, "description": "Database names for origin." }\n                ],\n                "description": "Requests database names for given security origin."\n            },\n            {\n                "name": "requestDatabase",\n                "async": true,\n                "parameters": [\n                    { "name": "securityOrigin", "type": "string", "description": "Security origin." },\n                    { "name": "databaseName", "type": "string", "description": "Database name." }\n                ],\n                "returns": [\n                    { "name": "databaseWithObjectStores", "$ref": "DatabaseWithObjectStores", "description": "Database with an array of object stores." }\n                ],\n                "description": "Requests database with given name in given frame."\n            },\n            {\n                "name": "requestData",\n                "async": true,\n                "parameters": [\n                    { "name": "securityOrigin", "type": "string", "description": "Security origin." },\n                    { "name": "databaseName", "type": "string", "description": "Database name." },\n                    { "name": "objectStoreName", "type": "string", "description": "Object store name." },\n                    { "name": "indexName", "type": "string", "description": "Index name, empty string for object store data requests." },\n                    { "name": "skipCount", "type": "integer", "description": "Number of records to skip." },\n                    { "name": "pageSize", "type": "integer", "description": "Number of records to fetch." },\n                    { "name": "keyRange", "$ref": "KeyRange", "optional": true, "description": "Key range." }\n                ],\n                "returns": [\n                    { "name": "objectStoreDataEntries", "type": "array", "items": { "$ref": "DataEntry" }, "description": "Array of object store data entries." },\n                    { "name": "hasMore", "type": "boolean", "description": "If true, there are more entries to fetch in the given range." }\n                ],\n                "description": "Requests data from object store or index."\n            },\n            {\n                "name": "clearObjectStore",\n                "async": true,\n                "parameters": [\n                    { "name": "securityOrigin", "type": "string", "description": "Security origin." },\n                    { "name": "databaseName", "type": "string", "description": "Database name." },\n                    { "name": "objectStoreName", "type": "string", "description": "Object store name." }\n                ],\n                "returns": [\n                ],\n                "description": "Clears all entries from an object store."\n            }\n        ]\n    },\n    {\n        "domain": "DOMStorage",\n        "hidden": true,\n        "description": "Query and modify DOM storage.",\n        "types": [\n            {\n                "id": "StorageId",\n                "type": "object",\n                "description": "DOM Storage identifier.",\n                "hidden": true,\n                "properties": [\n                    { "name": "securityOrigin", "type": "string", "description": "Security origin for the storage." },\n                    { "name": "isLocalStorage", "type": "boolean", "description": "Whether the storage is local storage (not session storage)." }\n                ]\n            },\n            {\n                "id": "Item",\n                "type": "array",\n                "description": "DOM Storage item.",\n                "hidden": true,\n                "items": { "type": "string" }\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables storage tracking, storage events will now be delivered to the client."\n            },\n            {\n                "name": "disable",\n                "description": "Disables storage tracking, prevents storage events from being sent to the client."\n            },\n            {\n                "name": "getDOMStorageItems",\n                "parameters": [\n                    { "name": "storageId", "$ref": "StorageId" }\n                ],\n                "returns": [\n                    { "name": "entries", "type": "array", "items": { "$ref": "Item" } }\n                ]\n            },\n            {\n                "name": "setDOMStorageItem",\n                "parameters": [\n                    { "name": "storageId", "$ref": "StorageId" },\n                    { "name": "key", "type": "string" },\n                    { "name": "value", "type": "string" }\n                ]\n            },\n            {\n                "name": "removeDOMStorageItem",\n                "parameters": [\n                    { "name": "storageId", "$ref": "StorageId" },\n                    { "name": "key", "type": "string" }\n                ]\n            }\n        ],\n        "events": [\n            {\n                "name": "domStorageItemsCleared",\n                "parameters": [\n                    { "name": "storageId",  "$ref": "StorageId" }\n                ]\n            },\n            {\n                "name": "domStorageItemRemoved",\n                "parameters": [\n                    { "name": "storageId",  "$ref": "StorageId" },\n                    { "name": "key", "type": "string" }\n                ]\n            },\n            {\n                "name": "domStorageItemAdded",\n                "parameters": [\n                    { "name": "storageId",  "$ref": "StorageId" },\n                    { "name": "key", "type": "string" },\n                    { "name": "newValue", "type": "string" }\n                ]\n            },\n            {\n                "name": "domStorageItemUpdated",\n                "parameters": [\n                    { "name": "storageId",  "$ref": "StorageId" },\n                    { "name": "key", "type": "string" },\n                    { "name": "oldValue", "type": "string" },\n                    { "name": "newValue", "type": "string" }\n                ]\n            }\n        ]\n    },\n    {\n        "domain": "ApplicationCache",\n        "hidden": true,\n        "types": [\n            {\n                "id": "ApplicationCacheResource",\n                "type": "object",\n                "description": "Detailed application cache resource information.",\n                "properties": [\n                    { "name": "url", "type": "string", "description": "Resource url." },\n                    { "name": "size", "type": "integer", "description": "Resource size." },\n                    { "name": "type", "type": "string", "description": "Resource type." }\n                ]\n            },\n            {\n                "id": "ApplicationCache",\n                "type": "object",\n                "description": "Detailed application cache information.",\n                "properties": [\n                    { "name": "manifestURL", "type": "string", "description": "Manifest URL." },\n                    { "name": "size", "type": "number", "description": "Application cache size." },\n                    { "name": "creationTime", "type": "number", "description": "Application cache creation time." },\n                    { "name": "updateTime", "type": "number", "description": "Application cache update time." },\n                    { "name": "resources", "type": "array", "items": { "$ref": "ApplicationCacheResource" }, "description": "Application cache resources." }\n                ]\n            },\n            {\n                "id": "FrameWithManifest",\n                "type": "object",\n                "description": "Frame identifier - manifest URL pair.",\n                "properties": [\n                    { "name": "frameId", "$ref": "Page.FrameId", "description": "Frame identifier." },\n                    { "name": "manifestURL", "type": "string", "description": "Manifest URL." },\n                    { "name": "status", "type": "integer", "description": "Application cache status." }\n                ]\n            }\n        ],\n        "commands": [\n            {\n                "name": "getFramesWithManifests",\n                "returns": [\n                    { "name": "frameIds", "type": "array", "items": { "$ref": "FrameWithManifest" }, "description": "Array of frame identifiers with manifest urls for each frame containing a document associated with some application cache." }\n                ],\n                "description": "Returns array of frame identifiers with manifest urls for each frame containing a document associated with some application cache."\n            },\n            {\n                "name": "enable",\n                "description": "Enables application cache domain notifications."\n            },\n            {\n                "name": "getManifestForFrame",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Page.FrameId", "description": "Identifier of the frame containing document whose manifest is retrieved." }\n                ],\n                "returns": [\n                    { "name": "manifestURL", "type": "string", "description": "Manifest URL for document in the given frame." }\n                ],\n                "description": "Returns manifest URL for document in the given frame."\n            },\n            {\n                "name": "getApplicationCacheForFrame",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Page.FrameId", "description": "Identifier of the frame containing document whose application cache is retrieved." }\n                ],\n                "returns": [\n                    { "name": "applicationCache", "$ref": "ApplicationCache", "description": "Relevant application cache data for the document in given frame." }\n                ],\n                "description": "Returns relevant application cache data for the document in given frame."\n            }\n        ],\n        "events": [\n            {\n                "name": "applicationCacheStatusUpdated",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Page.FrameId", "description": "Identifier of the frame containing document whose application cache updated status." },\n                    { "name": "manifestURL", "type": "string", "description": "Manifest URL." },\n                    { "name": "status", "type": "integer", "description": "Updated application cache status." }\n                ]\n            },\n            {\n                "name": "networkStateUpdated",\n                "parameters": [\n                    { "name": "isNowOnline", "type": "boolean" }\n                ]\n            }\n        ]\n    },\n    {\n        "domain": "FileSystem",\n        "hidden": true,\n        "types": [\n            {\n                "id": "Entry",\n                "type": "object",\n                "properties": [\n                    { "name": "url", "type": "string", "description": "filesystem: URL for the entry." },\n                    { "name": "name", "type": "string", "description": "The name of the file or directory." },\n                    { "name": "isDirectory", "type": "boolean", "description": "True if the entry is a directory." },\n                    { "name": "mimeType", "type": "string", "optional": true, "description": "MIME type of the entry, available for a file only." },\n                    { "name": "resourceType", "$ref": "Page.ResourceType", "optional": true, "description": "ResourceType of the entry, available for a file only." },\n                    { "name": "isTextFile", "type": "boolean", "optional": true, "description": "True if the entry is a text file." }\n                ],\n                "description": "Represents a browser side file or directory."\n            },\n            {\n                "id": "Metadata",\n                "type": "object",\n                "properties": [\n                    { "name": "modificationTime", "type": "number", "description": "Modification time." },\n                    { "name": "size", "type": "number", "description": "File size. This field is always zero for directories." }\n                ],\n                "description": "Represents metadata of a file or entry."\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables events from backend."\n            },\n            {\n                "name": "disable",\n                "description": "Disables events from backend."\n            },\n            {\n                "name": "requestFileSystemRoot",\n                "async": true,\n                "parameters": [\n                    { "name": "origin", "type": "string", "description": "Security origin of requesting FileSystem. One of frames in current page needs to have this security origin." },\n                    { "name": "type", "type": "string", "enum": ["temporary", "persistent"], "description": "FileSystem type of requesting FileSystem." }\n                ],\n                "returns": [\n                    { "name": "errorCode", "type": "integer", "description": "0, if no error. Otherwise, errorCode is set to FileError::ErrorCode value." },\n                    { "name": "root", "$ref": "Entry", "optional": true, "description": "Contains root of the requested FileSystem if the command completed successfully." }\n                ],\n                "description": "Returns root directory of the FileSystem, if exists."\n            },\n            {\n                "name": "requestDirectoryContent",\n                "async": true,\n                "parameters": [\n                    { "name": "url", "type": "string", "description": "URL of the directory that the frontend is requesting to read from." }\n                ],\n                "returns": [\n                    { "name": "errorCode", "type": "integer", "description": "0, if no error. Otherwise, errorCode is set to FileError::ErrorCode value." },\n                    { "name": "entries", "type": "array", "items": { "$ref": "Entry" }, "optional": true, "description": "Contains all entries on directory if the command completed successfully." }\n                ],\n                "description": "Returns content of the directory."\n            },\n            {\n                "name": "requestMetadata",\n                "async": true,\n                "parameters": [\n                    { "name": "url", "type": "string", "description": "URL of the entry that the frontend is requesting to get metadata from." }\n                ],\n                "returns": [\n                    { "name": "errorCode", "type": "integer", "description": "0, if no error. Otherwise, errorCode is set to FileError::ErrorCode value." },\n                    { "name": "metadata", "$ref": "Metadata", "optional": true, "description": "Contains metadata of the entry if the command completed successfully." }\n                ],\n                "description": "Returns metadata of the entry."\n            },\n            {\n                "name": "requestFileContent",\n                "async": true,\n                "parameters": [\n                    { "name": "url", "type": "string", "description": "URL of the file that the frontend is requesting to read from." },\n                    { "name": "readAsText", "type": "boolean", "description": "True if the content should be read as text, otherwise the result will be returned as base64 encoded text." },\n                    { "name": "start", "type": "integer", "optional": true, "description": "Specifies the start of range to read." },\n                    { "name": "end", "type": "integer", "optional": true, "description": "Specifies the end of range to read exclusively." },\n                    { "name": "charset", "type": "string", "optional": true, "description": "Overrides charset of the content when content is served as text." }\n                ],\n                "returns": [\n                    { "name": "errorCode", "type": "integer", "description": "0, if no error. Otherwise, errorCode is set to FileError::ErrorCode value." },\n                    { "name": "content", "type": "string", "optional": true, "description": "Content of the file." },\n                    { "name": "charset", "type": "string", "optional": true, "description": "Charset of the content if it is served as text." }\n                ],\n                "description": "Returns content of the file. Result should be sliced into [start, end)."\n            },\n            {\n                "name": "deleteEntry",\n                "async": true,\n                "parameters": [\n                    { "name": "url", "type": "string", "description": "URL of the entry to delete." }\n                ],\n                "returns": [\n                    { "name": "errorCode", "type": "integer", "description": "0, if no error. Otherwise errorCode is set to FileError::ErrorCode value." }\n                ],\n                "description": "Deletes specified entry. If the entry is a directory, the agent deletes children recursively."\n            }\n        ]\n    },\n    {\n        "domain": "DOM",\n        "description": "This domain exposes DOM read/write operations. Each DOM Node is represented with its mirror object that has an <code>id</code>. This <code>id</code> can be used to get additional information on the Node, resolve it into the JavaScript object wrapper, etc. It is important that client receives DOM events only for the nodes that are known to the client. Backend keeps track of the nodes that were sent to the client and never sends the same node twice. It is client\'s responsibility to collect information about the nodes that were sent to the client.<p>Note that <code>iframe</code> owner elements will return corresponding document elements as their child nodes.</p>",\n        "types": [\n            {\n                "id": "NodeId",\n                "type": "integer",\n                "description": "Unique DOM node identifier."\n            },\n            {\n                "id": "BackendNodeId",\n                "type": "integer",\n                "description": "Unique DOM node identifier used to reference a node that may not have been pushed to the front-end.",\n                "hidden": true\n            },\n            {\n                "id": "PseudoType",\n                "type": "string",\n                "enum": ["before", "after"],\n                "description": "Pseudo element type."\n            },\n            {\n                "id": "Node",\n                "type": "object",\n                "properties": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Node identifier that is passed into the rest of the DOM messages as the <code>nodeId</code>. Backend will only push node with given <code>id</code> once. It is aware of all requested nodes and will only fire DOM events for nodes known to the client." },\n                    { "name": "nodeType", "type": "integer", "description": "<code>Node</code>\'s nodeType." },\n                    { "name": "nodeName", "type": "string", "description": "<code>Node</code>\'s nodeName." },\n                    { "name": "localName", "type": "string", "description": "<code>Node</code>\'s localName." },\n                    { "name": "nodeValue", "type": "string", "description": "<code>Node</code>\'s nodeValue." },\n                    { "name": "childNodeCount", "type": "integer", "optional": true, "description": "Child count for <code>Container</code> nodes." },\n                    { "name": "children", "type": "array", "optional": true, "items": { "$ref": "Node" }, "description": "Child nodes of this node when requested with children." },\n                    { "name": "attributes", "type": "array", "optional": true, "items": { "type": "string" }, "description": "Attributes of the <code>Element</code> node in the form of flat array <code>[name1, value1, name2, value2]</code>." },\n                    { "name": "documentURL", "type": "string", "optional": true, "description": "Document URL that <code>Document</code> or <code>FrameOwner</code> node points to." },\n                    { "name": "baseURL", "type": "string", "optional": true, "description": "Base URL that <code>Document</code> or <code>FrameOwner</code> node uses for URL completion.", "hidden": true },\n                    { "name": "publicId", "type": "string", "optional": true, "description": "<code>DocumentType</code>\'s publicId." },\n                    { "name": "systemId", "type": "string", "optional": true, "description": "<code>DocumentType</code>\'s systemId." },\n                    { "name": "internalSubset", "type": "string", "optional": true, "description": "<code>DocumentType</code>\'s internalSubset." },\n                    { "name": "xmlVersion", "type": "string", "optional": true, "description": "<code>Document</code>\'s XML version in case of XML documents." },\n                    { "name": "name", "type": "string", "optional": true, "description": "<code>Attr</code>\'s name." },\n                    { "name": "value", "type": "string", "optional": true, "description": "<code>Attr</code>\'s value." },\n                    { "name": "pseudoType", "$ref": "PseudoType", "optional": true, "description": "Pseudo element type for this node." },\n                    { "name": "frameId", "$ref": "Page.FrameId", "optional": true, "description": "Frame ID for frame owner elements.", "hidden": true },\n                    { "name": "contentDocument", "$ref": "Node", "optional": true, "description": "Content document for frame owner elements." },\n                    { "name": "shadowRoots", "type": "array", "optional": true, "items": { "$ref": "Node" }, "description": "Shadow root list for given element host.", "hidden": true },\n                    { "name": "templateContent", "$ref": "Node", "optional": true, "description": "Content document fragment for template elements.", "hidden": true },\n                    { "name": "pseudoElements", "type": "array", "items": { "$ref": "Node" }, "optional": true, "description": "Pseudo elements associated with this node.", "hidden": true }\n                ],\n                "description": "DOM interaction is implemented in terms of mirror objects that represent the actual DOM nodes. DOMNode is a base node mirror type."\n            },\n            {\n                "id": "EventListener",\n                "type": "object",\n                "hidden": true,\n                "properties": [\n                    { "name": "type", "type": "string", "description": "<code>EventListener</code>\'s type." },\n                    { "name": "useCapture", "type": "boolean", "description": "<code>EventListener</code>\'s useCapture." },\n                    { "name": "isAttribute", "type": "boolean", "description": "<code>EventListener</code>\'s isAttribute." },\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Target <code>DOMNode</code> id." },\n                    { "name": "handlerBody", "type": "string", "description": "Event handler function body." },\n                    { "name": "location", "$ref": "Debugger.Location", "optional": true, "description": "Handler code location." },\n                    { "name": "sourceName", "type": "string", "optional": true, "description": "Source script URL." },\n                    { "name": "handler", "$ref": "Runtime.RemoteObject", "optional": true, "description": "Event handler function value." }\n                ],\n                "description": "DOM interaction is implemented in terms of mirror objects that represent the actual DOM nodes. DOMNode is a base node mirror type."\n            },\n            {\n                "id": "RGBA",\n                "type": "object",\n                "properties": [\n                    { "name": "r", "type": "integer", "description": "The red component, in the [0-255] range." },\n                    { "name": "g", "type": "integer", "description": "The green component, in the [0-255] range." },\n                    { "name": "b", "type": "integer", "description": "The blue component, in the [0-255] range." },\n                    { "name": "a", "type": "number", "optional": true, "description": "The alpha component, in the [0-1] range (default: 1)." }\n                ],\n                "description": "A structure holding an RGBA color."\n            },\n            {\n                "id": "Quad",\n                "type": "array",\n                "items": { "type": "number" },\n                "minItems": 8,\n                "maxItems": 8,\n                "description": "An array of quad vertices, x immediately followed by y for each point, points clock-wise.",\n                "hidden": true\n            },\n            {\n                "id": "BoxModel",\n                "type": "object",\n                "hidden": true,\n                "properties": [\n                    { "name": "content", "$ref": "Quad", "description": "Content box" },\n                    { "name": "padding", "$ref": "Quad", "description": "Padding box" },\n                    { "name": "border", "$ref": "Quad", "description": "Border box" },\n                    { "name": "margin", "$ref": "Quad", "description": "Margin box" },\n                    { "name": "width", "type": "integer", "description": "Node width" },\n                    { "name": "height", "type": "integer", "description": "Node height" }\n                ],\n                "description": "Box model."\n            },\n            {\n                "id": "Rect",\n                "type": "object",\n                "hidden": true,\n                "properties": [\n                    { "name": "x", "type": "number", "description": "X coordinate" },\n                    { "name": "y", "type": "number", "description": "Y coordinate" },\n                    { "name": "width", "type": "number", "description": "Rectangle width" },\n                    { "name": "height", "type": "number", "description": "Rectangle height" }\n                ],\n                "description": "Rectangle."\n            },\n            {\n                "id": "HighlightConfig",\n                "type": "object",\n                "properties": [\n                    { "name": "showInfo", "type": "boolean", "optional": true, "description": "Whether the node info tooltip should be shown (default: false)." },\n                    { "name": "contentColor", "$ref": "RGBA", "optional": true, "description": "The content box highlight fill color (default: transparent)." },\n                    { "name": "paddingColor", "$ref": "RGBA", "optional": true, "description": "The padding highlight fill color (default: transparent)." },\n                    { "name": "borderColor", "$ref": "RGBA", "optional": true, "description": "The border highlight fill color (default: transparent)." },\n                    { "name": "marginColor", "$ref": "RGBA", "optional": true, "description": "The margin highlight fill color (default: transparent)." },\n                    { "name": "eventTargetColor", "$ref": "RGBA", "optional": true, "hidden": true, "description": "The event target element highlight fill color (default: transparent)." }\n                ],\n                "description": "Configuration data for the highlighting of page elements."\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables DOM agent for the given page."\n            },\n            {\n                "name": "disable",\n                "description": "Disables DOM agent for the given page."\n            },\n            {\n                "name": "getDocument",\n                "returns": [\n                    { "name": "root", "$ref": "Node", "description": "Resulting node." }\n                ],\n                "description": "Returns the root DOM node to the caller."\n            },\n            {\n                "name": "requestChildNodes",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to get children for." },\n                    { "name": "depth", "type": "integer", "optional": true, "description": "The maximum depth at which children should be retrieved, defaults to 1. Use -1 for the entire subtree or provide an integer larger than 0.", "hidden": true }\n                ],\n                "description": "Requests that children of the node with given id are returned to the caller in form of <code>setChildNodes</code> events where not only immediate children are retrieved, but all children down to the specified depth."\n            },\n            {\n                "name": "querySelector",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to query upon." },\n                    { "name": "selector", "type": "string", "description": "Selector string." }\n                ],\n                "returns": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Query selector result." }\n                ],\n                "description": "Executes <code>querySelector</code> on a given node."\n            },\n            {\n                "name": "querySelectorAll",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to query upon." },\n                    { "name": "selector", "type": "string", "description": "Selector string." }\n                ],\n                "returns": [\n                    { "name": "nodeIds", "type": "array", "items": { "$ref": "NodeId" }, "description": "Query selector result." }\n                ],\n                "description": "Executes <code>querySelectorAll</code> on a given node."\n            },\n            {\n                "name": "setNodeName",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to set name for." },\n                    { "name": "name", "type": "string", "description": "New node\'s name." }\n                ],\n                "returns": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "New node\'s id." }\n                ],\n                "description": "Sets node name for a node with given id."\n            },\n            {\n                "name": "setNodeValue",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to set value for." },\n                    { "name": "value", "type": "string", "description": "New node\'s value." }\n                ],\n                "description": "Sets node value for a node with given id."\n            },\n            {\n                "name": "removeNode",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to remove." }\n                ],\n                "description": "Removes node with given id."\n            },\n            {\n                "name": "setAttributeValue",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the element to set attribute for." },\n                    { "name": "name", "type": "string", "description": "Attribute name." },\n                    { "name": "value", "type": "string", "description": "Attribute value." }\n                ],\n                "description": "Sets attribute for an element with given id."\n            },\n            {\n                "name": "setAttributesAsText",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the element to set attributes for." },\n                    { "name": "text", "type": "string", "description": "Text with a number of attributes. Will parse this text using HTML parser." },\n                    { "name": "name", "type": "string", "optional": true, "description": "Attribute name to replace with new attributes derived from text in case text parsed successfully." }\n                ],\n                "description": "Sets attributes on element with given id. This method is useful when user edits some existing attribute value and types in several attribute name/value pairs."\n            },\n            {\n                "name": "removeAttribute",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the element to remove attribute from." },\n                    { "name": "name", "type": "string", "description": "Name of the attribute to remove." }\n                ],\n                "description": "Removes attribute with given name from an element with given id."\n            },\n            {\n                "name": "getEventListenersForNode",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to get listeners for." },\n                    { "name": "objectGroup", "type": "string", "optional": true, "description": "Symbolic group name for handler value. Handler value is not returned without this parameter specified." }\n                ],\n                "returns": [\n                    { "name": "listeners", "type": "array", "items": { "$ref": "EventListener"}, "description": "Array of relevant listeners." }\n                ],\n                "description": "Returns event listeners relevant to the node.",\n                "hidden": true\n            },\n            {\n                "name": "getOuterHTML",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to get markup for." }\n                ],\n                "returns": [\n                    { "name": "outerHTML", "type": "string", "description": "Outer HTML markup." }\n                ],\n                "description": "Returns node\'s HTML markup."\n            },\n            {\n                "name": "setOuterHTML",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to set markup for." },\n                    { "name": "outerHTML", "type": "string", "description": "Outer HTML markup to set." }\n                ],\n                "description": "Sets node HTML markup, returns new node id."\n            },\n            {\n                "name": "performSearch",\n                "parameters": [\n                    { "name": "query", "type": "string", "description": "Plain text or query selector or XPath search query." }\n                ],\n                "returns": [\n                    { "name": "searchId", "type": "string", "description": "Unique search session identifier." },\n                    { "name": "resultCount", "type": "integer", "description": "Number of search results." }\n                ],\n                "description": "Searches for a given string in the DOM tree. Use <code>getSearchResults</code> to access search results or <code>cancelSearch</code> to end this search session.",\n                "hidden": true\n            },\n            {\n                "name": "getSearchResults",\n                "parameters": [\n                    { "name": "searchId", "type": "string", "description": "Unique search session identifier." },\n                    { "name": "fromIndex", "type": "integer", "description": "Start index of the search result to be returned." },\n                    { "name": "toIndex", "type": "integer", "description": "End index of the search result to be returned." }\n                ],\n                "returns": [\n                    { "name": "nodeIds", "type": "array", "items": { "$ref": "NodeId" }, "description": "Ids of the search result nodes." }\n                ],\n                "description": "Returns search results from given <code>fromIndex</code> to given <code>toIndex</code> from the sarch with the given identifier.",\n                "hidden": true\n            },\n            {\n                "name": "discardSearchResults",\n                "parameters": [\n                    { "name": "searchId", "type": "string", "description": "Unique search session identifier." }\n                ],\n                "description": "Discards search results from the session with the given id. <code>getSearchResults</code> should no longer be called for that search.",\n                "hidden": true\n            },\n            {\n                "name": "requestNode",\n                "parameters": [\n                    { "name": "objectId", "$ref": "Runtime.RemoteObjectId", "description": "JavaScript object id to convert into node." }\n                ],\n                "returns": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Node id for given object." }\n                ],\n                "description": "Requests that the node is sent to the caller given the JavaScript node object reference. All nodes that form the path from the node to the root are also sent to the client as a series of <code>setChildNodes</code> notifications."\n            },\n            {\n                "name": "setInspectModeEnabled",\n                "hidden": true,\n                "parameters": [\n                    { "name": "enabled", "type": "boolean", "description": "True to enable inspection mode, false to disable it." },\n                    { "name": "inspectShadowDOM", "type": "boolean", "optional": true, "description": "True to enable inspection mode for shadow DOM." },\n                    { "name": "highlightConfig", "$ref": "HighlightConfig", "optional": true, "description": "A descriptor for the highlight appearance of hovered-over nodes. May be omitted if <code>enabled == false</code>." }\n                ],\n                "description": "Enters the \'inspect\' mode. In this mode, elements that user is hovering over are highlighted. Backend then generates \'inspectNodeRequested\' event upon element selection."\n            },\n            {\n                "name": "highlightRect",\n                "parameters": [\n                    { "name": "x", "type": "integer", "description": "X coordinate" },\n                    { "name": "y", "type": "integer", "description": "Y coordinate" },\n                    { "name": "width", "type": "integer", "description": "Rectangle width" },\n                    { "name": "height", "type": "integer", "description": "Rectangle height" },\n                    { "name": "color", "$ref": "RGBA", "optional": true, "description": "The highlight fill color (default: transparent)." },\n                    { "name": "outlineColor", "$ref": "RGBA", "optional": true, "description": "The highlight outline color (default: transparent)." }\n                ],\n                "description": "Highlights given rectangle. Coordinates are absolute with respect to the main frame viewport."\n            },\n            {\n                "name": "highlightQuad",\n                "parameters": [\n                    { "name": "quad", "$ref": "Quad", "description": "Quad to highlight" },\n                    { "name": "color", "$ref": "RGBA", "optional": true, "description": "The highlight fill color (default: transparent)." },\n                    { "name": "outlineColor", "$ref": "RGBA", "optional": true, "description": "The highlight outline color (default: transparent)." }\n                ],\n                "description": "Highlights given quad. Coordinates are absolute with respect to the main frame viewport.",\n                "hidden": true\n            },\n            {\n                "name": "highlightNode",\n                "parameters": [\n                    { "name": "highlightConfig", "$ref": "HighlightConfig",  "description": "A descriptor for the highlight appearance." },\n                    { "name": "nodeId", "$ref": "NodeId", "optional": true, "description": "Identifier of the node to highlight." },\n                    { "name": "objectId", "$ref": "Runtime.RemoteObjectId", "optional": true, "description": "JavaScript object id of the node to be highlighted.", "hidden": true }\n                ],\n                "description": "Highlights DOM node with given id or with the given JavaScript object wrapper. Either nodeId or objectId must be specified."\n            },\n            {\n                "name": "hideHighlight",\n                "description": "Hides DOM node highlight."\n            },\n            {\n                "name": "highlightFrame",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Page.FrameId", "description": "Identifier of the frame to highlight." },\n                    { "name": "contentColor", "$ref": "RGBA", "optional": true, "description": "The content box highlight fill color (default: transparent)." },\n                    { "name": "contentOutlineColor", "$ref": "RGBA", "optional": true, "description": "The content box highlight outline color (default: transparent)." }\n                ],\n                "description": "Highlights owner element of the frame with given id.",\n                "hidden": true\n            },\n            {\n                "name": "pushNodeByPathToFrontend",\n                "parameters": [\n                    { "name": "path", "type": "string", "description": "Path to node in the proprietary format." }\n                ],\n                "returns": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node for given path." }\n                ],\n                "description": "Requests that the node is sent to the caller given its path. // FIXME, use XPath",\n                "hidden": true\n            },\n            {\n                "name": "pushNodeByBackendIdToFrontend",\n                "parameters": [\n                    { "name": "backendNodeId", "$ref": "BackendNodeId", "description": "The backend node id of the node." }\n                ],\n                "returns": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "The pushed node\'s id." }\n                ],\n                "description": "Requests that the node is sent to the caller given its backend node id.",\n                "hidden": true\n            },\n            {\n                "name": "releaseBackendNodeIds",\n                "parameters": [\n                    { "name": "nodeGroup", "type": "string", "description": "The backend node ids group name." }\n                ],\n                "description": "Requests that group of <code>BackendNodeIds</code> is released.",\n                "hidden": true\n            },\n            {\n                "name": "resolveNode",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to resolve." },\n                    { "name": "objectGroup", "type": "string", "optional": true, "description": "Symbolic group name that can be used to release multiple objects." }\n                ],\n                "returns": [\n                    { "name": "object", "$ref": "Runtime.RemoteObject", "description": "JavaScript object wrapper for given node." }\n                ],\n                "description": "Resolves JavaScript node object for given node id."\n            },\n            {\n                "name": "getAttributes",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to retrieve attibutes for." }\n                ],\n                "returns": [\n                    { "name": "attributes", "type": "array", "items": { "type": "string" }, "description": "An interleaved array of node attribute names and values." }\n                ],\n                "description": "Returns attributes for the specified node."\n            },\n            {\n                "name": "moveTo",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to drop." },\n                    { "name": "targetNodeId", "$ref": "NodeId", "description": "Id of the element to drop into." },\n                    { "name": "insertBeforeNodeId", "$ref": "NodeId", "optional": true, "description": "Drop node before given one." }\n                ],\n                "returns": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "New id of the moved node." }\n                ],\n                "description": "Moves node into the new container, places it before the given anchor."\n            },\n            {\n                "name": "undo",\n                "description": "Undoes the last performed action.",\n                "hidden": true\n            },\n            {\n                "name": "redo",\n                "description": "Re-does the last undone action.",\n                "hidden": true\n            },\n            {\n                "name": "markUndoableState",\n                "description": "Marks last undoable state.",\n                "hidden": true\n            },\n            {\n                "name": "focus",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to focus." }\n                ],\n                "description": "Focuses the given element.",\n                "hidden": true\n            },\n            {\n                "name": "setFileInputFiles",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the file input node to set files for." },\n                    { "name": "files", "type": "array", "items": { "type": "string" }, "description": "Array of file paths to set." }\n                ],\n                "description": "Sets files for the given file input element.",\n                "hidden": true\n            },\n            {\n                "name": "getBoxModel",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to get box model for." }\n                ],\n                "returns": [\n                    { "name": "model", "$ref": "BoxModel", "description": "Box model for the node." }\n                ],\n                "description": "Returns boxes for the currently selected nodes.",\n                "hidden": true\n            },\n            {\n                "name": "getNodeForLocation",\n                "parameters": [\n                    { "name": "x", "type": "integer", "description": "X coordinate." },\n                    { "name": "y", "type": "integer", "description": "Y coordinate." }\n                ],\n                "returns": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node at given coordinates." }\n                ],\n                "description": "Returns node id at given location.",\n                "hidden": true\n            }\n        ],\n        "events": [\n            {\n                "name": "documentUpdated",\n                "description": "Fired when <code>Document</code> has been totally updated. Node ids are no longer valid."\n            },\n            {\n                "name": "inspectNodeRequested",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node to inspect." }\n                ],\n                "description": "Fired when the node should be inspected. This happens after call to <code>setInspectModeEnabled</code>.",\n                "hidden" : true\n            },\n            {\n                "name": "setChildNodes",\n                "parameters": [\n                    { "name": "parentId", "$ref": "NodeId", "description": "Parent node id to populate with children." },\n                    { "name": "nodes", "type": "array", "items": { "$ref": "Node"}, "description": "Child nodes array." }\n                ],\n                "description": "Fired when backend wants to provide client with the missing DOM structure. This happens upon most of the calls requesting node ids."\n            },\n            {\n                "name": "attributeModified",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node that has changed." },\n                    { "name": "name", "type": "string", "description": "Attribute name." },\n                    { "name": "value", "type": "string", "description": "Attribute value." }\n                ],\n                "description": "Fired when <code>Element</code>\'s attribute is modified."\n            },\n            {\n                "name": "attributeRemoved",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node that has changed." },\n                    { "name": "name", "type": "string", "description": "A ttribute name." }\n                ],\n                "description": "Fired when <code>Element</code>\'s attribute is removed."\n            },\n            {\n                "name": "inlineStyleInvalidated",\n                "parameters": [\n                    { "name": "nodeIds", "type": "array", "items": { "$ref": "NodeId" }, "description": "Ids of the nodes for which the inline styles have been invalidated." }\n                ],\n                "description": "Fired when <code>Element</code>\'s inline style is modified via a CSS property modification.",\n                "hidden": true\n            },\n            {\n                "name": "characterDataModified",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node that has changed." },\n                    { "name": "characterData", "type": "string", "description": "New text value." }\n                ],\n                "description": "Mirrors <code>DOMCharacterDataModified</code> event."\n            },\n            {\n                "name": "childNodeCountUpdated",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node that has changed." },\n                    { "name": "childNodeCount", "type": "integer", "description": "New node count." }\n                ],\n                "description": "Fired when <code>Container</code>\'s child node count has changed."\n            },\n            {\n                "name": "childNodeInserted",\n                "parameters": [\n                    { "name": "parentNodeId", "$ref": "NodeId", "description": "Id of the node that has changed." },\n                    { "name": "previousNodeId", "$ref": "NodeId", "description": "If of the previous siblint." },\n                    { "name": "node", "$ref": "Node", "description": "Inserted node data." }\n                ],\n                "description": "Mirrors <code>DOMNodeInserted</code> event."\n            },\n            {\n                "name": "childNodeRemoved",\n                "parameters": [\n                    { "name": "parentNodeId", "$ref": "NodeId", "description": "Parent id." },\n                    { "name": "nodeId", "$ref": "NodeId", "description": "Id of the node that has been removed." }\n                ],\n                "description": "Mirrors <code>DOMNodeRemoved</code> event."\n            },\n            {\n                "name": "shadowRootPushed",\n                "parameters": [\n                    { "name": "hostId", "$ref": "NodeId", "description": "Host element id." },\n                    { "name": "root", "$ref": "Node", "description": "Shadow root." }\n                ],\n                "description": "Called when shadow root is pushed into the element.",\n                "hidden": true\n            },\n            {\n                "name": "shadowRootPopped",\n                "parameters": [\n                    { "name": "hostId", "$ref": "NodeId", "description": "Host element id." },\n                    { "name": "rootId", "$ref": "NodeId", "description": "Shadow root id." }\n                ],\n                "description": "Called when shadow root is popped from the element.",\n                "hidden": true\n            },\n            {\n                "name": "pseudoElementAdded",\n                "parameters": [\n                    { "name": "parentId", "$ref": "NodeId", "description": "Pseudo element\'s parent element id." },\n                    { "name": "pseudoElement", "$ref": "Node", "description": "The added pseudo element." }\n                ],\n                "description": "Called when a pseudo element is added to an element.",\n                "hidden": true\n            },\n            {\n                "name": "pseudoElementRemoved",\n                "parameters": [\n                    { "name": "parentId", "$ref": "NodeId", "description": "Pseudo element\'s parent element id." },\n                    { "name": "pseudoElementId", "$ref": "NodeId", "description": "The removed pseudo element id." }\n                ],\n                "description": "Called when a pseudo element is removed from an element.",\n                "hidden": true\n            }\n        ]\n    },\n    {\n        "domain": "CSS",\n        "hidden": true,\n        "description": "This domain exposes CSS read/write operations. All CSS objects (stylesheets, rules, and styles) have an associated <code>id</code> used in subsequent operations on the related object. Each object type has a specific <code>id</code> structure, and those are not interchangeable between objects of different kinds. CSS objects can be loaded using the <code>get*ForNode()</code> calls (which accept a DOM node id). A client can also discover all the existing stylesheets with the <code>getAllStyleSheets()</code> method (or keeping track of the <code>styleSheetAdded</code>/<code>styleSheetRemoved</code> events) and subsequently load the required stylesheet contents using the <code>getStyleSheet[Text]()</code> methods.",\n        "types": [\n            {\n                "id": "StyleSheetId",\n                "type": "string"\n            },\n            {\n                "id": "CSSStyleId",\n                "type": "object",\n                "properties": [\n                    { "name": "styleSheetId", "$ref": "StyleSheetId", "description": "Enclosing stylesheet identifier." },\n                    { "name": "ordinal", "type": "integer", "description": "The style ordinal within the stylesheet." }\n                ],\n                "description": "This object identifies a CSS style in a unique way."\n            },\n            {\n                "id": "StyleSheetOrigin",\n                "type": "string",\n                "enum": ["user", "user-agent", "inspector", "regular"],\n                "description": "Stylesheet type: \\"user\\" for user stylesheets, \\"user-agent\\" for user-agent stylesheets, \\"inspector\\" for stylesheets created by the inspector (i.e. those holding the \\"via inspector\\" rules), \\"regular\\" for regular stylesheets."\n            },\n            {\n                "id": "CSSRuleId",\n                "type": "object",\n                "properties": [\n                    { "name": "styleSheetId", "$ref": "StyleSheetId", "description": "Enclosing stylesheet identifier." },\n                    { "name": "ordinal", "type": "integer", "description": "The rule ordinal within the stylesheet." }\n                ],\n                "description": "This object identifies a CSS rule in a unique way."\n            },\n            {\n                "id": "PseudoIdMatches",\n                "type": "object",\n                "properties": [\n                    { "name": "pseudoId", "type": "integer", "description": "Pseudo style identifier (see <code>enum PseudoId</code> in <code>RenderStyleConstants.h</code>)."},\n                    { "name": "matches", "type": "array", "items": { "$ref": "RuleMatch" }, "description": "Matches of CSS rules applicable to the pseudo style."}\n                ],\n                "description": "CSS rule collection for a single pseudo style."\n            },\n            {\n                "id": "InheritedStyleEntry",\n                "type": "object",\n                "properties": [\n                    { "name": "inlineStyle", "$ref": "CSSStyle", "optional": true, "description": "The ancestor node\'s inline style, if any, in the style inheritance chain." },\n                    { "name": "matchedCSSRules", "type": "array", "items": { "$ref": "RuleMatch" }, "description": "Matches of CSS rules matching the ancestor node in the style inheritance chain." }\n                ],\n                "description": "CSS rule collection for a single pseudo style."\n            },\n            {\n                "id": "RuleMatch",\n                "type": "object",\n                "properties": [\n                    { "name": "rule", "$ref": "CSSRule", "description": "CSS rule in the match." },\n                    { "name": "matchingSelectors", "type": "array", "items": { "type": "integer" }, "description": "Matching selector indices in the rule\'s selectorList selectors (0-based)." }\n                ],\n                "description": "Match data for a CSS rule."\n            },\n            {\n                "id": "SelectorList",\n                "type": "object",\n                "properties": [\n                    { "name": "selectors", "type": "array", "items": { "type": "string" }, "description": "Selectors in the list." },\n                    { "name": "text", "type": "string", "description": "Rule selector text." },\n                    { "name": "range", "$ref": "SourceRange", "optional": true, "description": "Rule selector range in the underlying resource (if available)." }\n                ],\n                "description": "Selector list data."\n            },\n            {\n                "id": "CSSStyleAttribute",\n                "type": "object",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "DOM attribute name (e.g. \\"width\\")."},\n                    { "name": "style", "$ref": "CSSStyle", "description": "CSS style generated by the respective DOM attribute."}\n                ],\n                "description": "CSS style information for a DOM style attribute."\n            },\n            {\n                "id": "CSSStyleSheetHeader",\n                "type": "object",\n                "properties": [\n                    { "name": "styleSheetId", "$ref": "StyleSheetId", "description": "The stylesheet identifier."},\n                    { "name": "frameId", "$ref": "Page.FrameId", "description": "Owner frame identifier."},\n                    { "name": "sourceURL", "type": "string", "description": "Stylesheet resource URL."},\n                    { "name": "sourceMapURL", "type": "string", "optional": true, "description": "URL of source map associated with the stylesheet (if any)." },\n                    { "name": "origin", "$ref": "StyleSheetOrigin", "description": "Stylesheet origin."},\n                    { "name": "title", "type": "string", "description": "Stylesheet title."},\n                    { "name": "disabled", "type": "boolean", "description": "Denotes whether the stylesheet is disabled."},\n                    { "name": "hasSourceURL", "type": "boolean", "optional": true, "description": "Whether the sourceURL field value comes from the sourceURL comment." },\n                    { "name": "isInline", "type": "boolean", "description": "Whether this stylesheet is created for STYLE tag by parser. This flag is not set for document.written STYLE tags." },\n                    { "name": "startLine", "type": "number", "description": "Line offset of the stylesheet within the resource (zero based)." },\n                    { "name": "startColumn", "type": "number", "description": "Column offset of the stylesheet within the resource (zero based)." }\n                ],\n                "description": "CSS stylesheet metainformation."\n            },\n            {\n                "id": "CSSStyleSheetBody",\n                "type": "object",\n                "properties": [\n                    { "name": "styleSheetId", "$ref": "StyleSheetId", "description": "The stylesheet identifier."},\n                    { "name": "rules", "type": "array", "items": { "$ref": "CSSRule" }, "description": "Stylesheet resource URL."},\n                    { "name": "text", "type": "string", "optional": true, "description": "Stylesheet resource contents (if available)."}\n                ],\n                "description": "CSS stylesheet contents."\n            },\n            {\n                "id": "CSSRule",\n                "type": "object",\n                "properties": [\n                    { "name": "ruleId", "$ref": "CSSRuleId", "optional": true, "description": "The CSS rule identifier (absent for user agent stylesheet and user-specified stylesheet rules)."},\n                    { "name": "selectorList", "$ref": "SelectorList", "description": "Rule selector data." },\n                    { "name": "sourceURL", "type": "string", "optional": true, "description": "Parent stylesheet resource URL (for regular rules)."},\n                    { "name": "origin", "$ref": "StyleSheetOrigin", "description": "Parent stylesheet\'s origin."},\n                    { "name": "style", "$ref": "CSSStyle", "description": "Associated style declaration." },\n                    { "name": "media", "type": "array", "items": { "$ref": "CSSMedia" }, "optional": true, "description": "Media list array (for rules involving media queries). The array enumerates media queries starting with the innermost one, going outwards." }\n                ],\n                "description": "CSS rule representation."\n            },\n            {\n                "id": "SourceRange",\n                "type": "object",\n                "properties": [\n                    { "name": "startLine", "type": "integer", "description": "Start line of range." },\n                    { "name": "startColumn", "type": "integer", "description": "Start column of range (inclusive)." },\n                    { "name": "endLine", "type": "integer", "description": "End line of range" },\n                    { "name": "endColumn", "type": "integer", "description": "End column of range (exclusive)." }\n                ],\n                "description": "Text range within a resource. All numbers are zero-based."\n            },\n            {\n                "id": "ShorthandEntry",\n                "type": "object",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Shorthand name." },\n                    { "name": "value", "type": "string", "description": "Shorthand value." }\n                ]\n            },\n            {\n                "id": "CSSPropertyInfo",\n                "type": "object",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Property name." },\n                    { "name": "longhands", "type": "array", "optional": true, "items": { "type": "string" }, "description": "Longhand property names." }\n                ]\n            },\n            {\n                "id": "CSSComputedStyleProperty",\n                "type": "object",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "Computed style property name." },\n                    { "name": "value", "type": "string", "description": "Computed style property value." }\n                ]\n            },\n            {\n                "id": "CSSStyle",\n                "type": "object",\n                "properties": [\n                    { "name": "styleId", "$ref": "CSSStyleId", "optional": true, "description": "The CSS style identifier (absent for attribute styles)." },\n                    { "name": "cssProperties", "type": "array", "items": { "$ref": "CSSProperty" }, "description": "CSS properties in the style." },\n                    { "name": "shorthandEntries", "type": "array", "items": { "$ref": "ShorthandEntry" }, "description": "Computed values for all shorthands found in the style." },\n                    { "name": "cssText", "type": "string", "optional": true, "description": "Style declaration text (if available)." },\n                    { "name": "range", "$ref": "SourceRange", "optional": true, "description": "Style declaration range in the enclosing stylesheet (if available)." },\n                    { "name": "width", "type": "string", "optional": true, "description": "The effective \\"width\\" property value from this style." },\n                    { "name": "height", "type": "string", "optional": true, "description": "The effective \\"height\\" property value from this style." }\n                ],\n                "description": "CSS style representation."\n            },\n            {\n                "id": "CSSProperty",\n                "type": "object",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "The property name." },\n                    { "name": "value", "type": "string", "description": "The property value." },\n                    { "name": "priority", "type": "string", "optional": true, "description": "The property priority (implies \\"\\" if absent)." },\n                    { "name": "implicit", "type": "boolean", "optional": true, "description": "Whether the property is implicit (implies <code>false</code> if absent)." },\n                    { "name": "text", "type": "string", "optional": true, "description": "The full property text as specified in the style." },\n                    { "name": "parsedOk", "type": "boolean", "optional": true, "description": "Whether the property is understood by the browser (implies <code>true</code> if absent)." },\n                    { "name": "status", "type": "string", "enum": ["active", "inactive", "disabled", "style"], "optional": true, "description": "The property status: \\"active\\" if the property is effective in the style, \\"inactive\\" if the property is overridden by a same-named property in this style later on, \\"disabled\\" if the property is disabled by the user, \\"style\\" (implied if absent) if the property is reported by the browser rather than by the CSS source parser." },\n                    { "name": "range", "$ref": "SourceRange", "optional": true, "description": "The entire property range in the enclosing style declaration (if available)." }\n                ],\n                "description": "CSS property declaration data."\n            },\n            {\n                "id": "CSSMedia",\n                "type": "object",\n                "properties": [\n                    { "name": "text", "type": "string", "description": "Media query text." },\n                    { "name": "source", "type": "string", "enum": ["mediaRule", "importRule", "linkedSheet", "inlineSheet"], "description": "Source of the media query: \\"mediaRule\\" if specified by a @media rule, \\"importRule\\" if specified by an @import rule, \\"linkedSheet\\" if specified by a \\"media\\" attribute in a linked stylesheet\'s LINK tag, \\"inlineSheet\\" if specified by a \\"media\\" attribute in an inline stylesheet\'s STYLE tag." },\n                    { "name": "sourceURL", "type": "string", "optional": true, "description": "URL of the document containing the media query description." },\n                    { "name": "range", "$ref": "SourceRange", "optional": true, "description": "The associated rule (@media or @import) header range in the enclosing stylesheet (if available)." },\n                    { "name": "parentStyleSheetId", "$ref": "StyleSheetId", "optional": true, "description": "Identifier of the stylesheet containing this object (if exists)." }\n                ],\n                "description": "CSS media query descriptor."\n            },\n            {\n                "id": "SelectorProfileEntry",\n                "type": "object",\n                "properties": [\n                    { "name": "selector", "type": "string", "description": "CSS selector of the corresponding rule." },\n                    { "name": "url", "type": "string", "description": "URL of the resource containing the corresponding rule." },\n                    { "name": "lineNumber", "type": "integer", "description": "Selector line number in the resource for the corresponding rule." },\n                    { "name": "time", "type": "number", "description": "Total time this rule handling contributed to the browser running time during profiling (in milliseconds)." },\n                    { "name": "hitCount", "type": "integer", "description": "Number of times this rule was considered a candidate for matching against DOM elements." },\n                    { "name": "matchCount", "type": "integer", "description": "Number of times this rule actually matched a DOM element." }\n                ],\n                "description": "CSS selector profile entry."\n            },\n            {\n                "id": "SelectorProfile",\n                "type": "object",\n                "properties": [\n                    { "name": "totalTime", "type": "number", "description": "Total processing time for all selectors in the profile (in milliseconds)." },\n                    { "name": "data", "type": "array", "items": { "$ref": "SelectorProfileEntry" }, "description": "CSS selector profile entries." }\n                ]\n            },\n            {\n                "id": "Region",\n                "type": "object",\n                "properties": [\n                    { "name": "regionOverset", "type": "string", "enum": ["overset", "fit", "empty"], "description": "The \\"overset\\" attribute of a Named Flow." },\n                    { "name": "nodeId", "$ref": "DOM.NodeId", "description": "The corresponding DOM node id." }\n                ],\n                "description": "This object represents a region that flows from a Named Flow.",\n                "hidden": true\n            },\n            {\n                "id": "NamedFlow",\n                "type": "object",\n                "properties": [\n                    { "name": "documentNodeId", "$ref": "DOM.NodeId", "description": "The document node id." },\n                    { "name": "name", "type": "string", "description": "Named Flow identifier." },\n                    { "name": "overset", "type": "boolean", "description": "The \\"overset\\" attribute of a Named Flow." },\n                    { "name": "content", "type": "array", "items": { "$ref": "DOM.NodeId" }, "description": "An array of nodes that flow into the Named Flow." },\n                    { "name": "regions", "type": "array", "items": { "$ref": "Region" }, "description": "An array of regions associated with the Named Flow." }\n                ],\n                "description": "This object represents a Named Flow.",\n                "hidden": true\n            },\n            {\n                "id": "PlatformFontUsage",\n                "type": "object",\n                "properties": [\n                    { "name": "familyName", "type": "string", "description": "Font\'s family name reported by platform."},\n                    { "name": "glyphCount", "type": "number", "description": "Amount of glyphs that were rendered with this font."}\n                ],\n                "description": "Information about amount of glyphs that were rendered with given font."\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "async": true,\n                "description": "Enables the CSS agent for the given page. Clients should not assume that the CSS agent has been enabled until the result of this command is received."\n            },\n            {\n                "name": "disable",\n                "description": "Disables the CSS agent for the given page."\n            },\n            {\n                "name": "getMatchedStylesForNode",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "DOM.NodeId" },\n                    { "name": "includePseudo", "type": "boolean", "optional": true, "description": "Whether to include pseudo styles (default: true)." },\n                    { "name": "includeInherited", "type": "boolean", "optional": true, "description": "Whether to include inherited styles (default: true)." }\n                ],\n                "returns": [\n                    { "name": "matchedCSSRules", "type": "array", "items": { "$ref": "RuleMatch" }, "optional": true, "description": "CSS rules matching this node, from all applicable stylesheets." },\n                    { "name": "pseudoElements", "type": "array", "items": { "$ref": "PseudoIdMatches" }, "optional": true, "description": "Pseudo style matches for this node." },\n                    { "name": "inherited", "type": "array", "items": { "$ref": "InheritedStyleEntry" }, "optional": true, "description": "A chain of inherited styles (from the immediate node parent up to the DOM tree root)." }\n                ],\n                "description": "Returns requested styles for a DOM node identified by <code>nodeId</code>."\n            },\n            {\n                "name": "getInlineStylesForNode",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "DOM.NodeId" }\n                ],\n                "returns": [\n                    { "name": "inlineStyle", "$ref": "CSSStyle", "optional": true, "description": "Inline style for the specified DOM node." },\n                    { "name": "attributesStyle", "$ref": "CSSStyle", "optional": true, "description": "Attribute-defined element style (e.g. resulting from \\"width=20 height=100%\\")."}\n                ],\n                "description": "Returns the styles defined inline (explicitly in the \\"style\\" attribute and implicitly, using DOM attributes) for a DOM node identified by <code>nodeId</code>."\n            },\n            {\n                "name": "getComputedStyleForNode",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "DOM.NodeId" }\n                ],\n                "returns": [\n                    { "name": "computedStyle", "type": "array", "items": { "$ref": "CSSComputedStyleProperty" }, "description": "Computed style for the specified DOM node." }\n                ],\n                "description": "Returns the computed style for a DOM node identified by <code>nodeId</code>."\n            },\n            {\n                "name": "getPlatformFontsForNode",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "DOM.NodeId" }\n                ],\n                "returns": [\n                    { "name": "cssFamilyName", "type": "string", "description": "Font family name which is determined by computed style." },\n                    { "name": "fonts", "type": "array", "items": { "$ref": "PlatformFontUsage"}, "description": "Usage statistics for every employed platform font." }\n                ],\n                "description": "Requests information about platform fonts which we used to render child TextNodes in the given node.",\n                "hidden": true\n            },\n            {\n                "name": "getAllStyleSheets",\n                "returns": [\n                    { "name": "headers", "type": "array", "items": { "$ref": "CSSStyleSheetHeader" }, "description": "Descriptor entries for all available stylesheets." }\n                ],\n                "description": "Returns metainfo entries for all known stylesheets."\n            },\n            {\n                "name": "getStyleSheet",\n                "parameters": [\n                    { "name": "styleSheetId", "$ref": "StyleSheetId" }\n                ],\n                "returns": [\n                    { "name": "styleSheet", "$ref": "CSSStyleSheetBody", "description": "Stylesheet contents for the specified <code>styleSheetId</code>." }\n                ],\n                "description": "Returns stylesheet data for the specified <code>styleSheetId</code>."\n            },\n            {\n                "name": "getStyleSheetText",\n                "parameters": [\n                    { "name": "styleSheetId", "$ref": "StyleSheetId" }\n                ],\n                "returns": [\n                    { "name": "text", "type": "string", "description": "The stylesheet text." }\n                ],\n                "description": "Returns the current textual content and the URL for a stylesheet."\n            },\n            {\n                "name": "setStyleSheetText",\n                "parameters": [\n                    { "name": "styleSheetId", "$ref": "StyleSheetId" },\n                    { "name": "text", "type": "string" }\n                ],\n                "description": "Sets the new stylesheet text, thereby invalidating all existing <code>CSSStyleId</code>\'s and <code>CSSRuleId</code>\'s contained by this stylesheet."\n            },\n            {\n                "name": "setStyleText",\n                "parameters": [\n                    { "name": "styleId", "$ref": "CSSStyleId" },\n                    { "name": "text", "type": "string" }\n                ],\n                "returns": [\n                    { "name": "style", "$ref": "CSSStyle", "description": "The resulting style after the text modification." }\n                ],\n                "description": "Updates the CSSStyleDeclaration text."\n            },\n            {\n                "name": "setPropertyText",\n                "parameters": [\n                    { "name": "styleId", "$ref": "CSSStyleId" },\n                    { "name": "propertyIndex", "type": "integer" },\n                    { "name": "text", "type": "string" },\n                    { "name": "overwrite", "type": "boolean" }\n                ],\n                "returns": [\n                    { "name": "style", "$ref": "CSSStyle", "description": "The resulting style after the property text modification." }\n                ],\n                "description": "Sets the new <code>text</code> for a property in the respective style, at offset <code>propertyIndex</code>. If <code>overwrite</code> is <code>true</code>, a property at the given offset is overwritten, otherwise inserted. <code>text</code> entirely replaces the property <code>name: value</code>."\n            },\n            {\n                "name": "toggleProperty",\n                "parameters": [\n                    { "name": "styleId", "$ref": "CSSStyleId" },\n                    { "name": "propertyIndex", "type": "integer" },\n                    { "name": "disable", "type": "boolean" }\n                ],\n                "returns": [\n                    { "name": "style", "$ref": "CSSStyle", "description": "The resulting style after the property toggling." }\n                ],\n                "description": "Toggles the property in the respective style, at offset <code>propertyIndex</code>. The <code>disable</code> parameter denotes whether the property should be disabled (i.e. removed from the style declaration). If <code>disable == false</code>, the property gets put back into its original place in the style declaration."\n            },\n            {\n                "name": "setRuleSelector",\n                "parameters": [\n                    { "name": "ruleId", "$ref": "CSSRuleId" },\n                    { "name": "selector", "type": "string" }\n                ],\n                "returns": [\n                    { "name": "rule", "$ref": "CSSRule", "description": "The resulting rule after the selector modification." }\n                ],\n                "description": "Modifies the rule selector."\n            },\n            {\n                "name": "addRule",\n                "parameters": [\n                    { "name": "contextNodeId", "$ref": "DOM.NodeId" },\n                    { "name": "selector", "type": "string" }\n                ],\n                "returns": [\n                    { "name": "rule", "$ref": "CSSRule", "description": "The newly created rule." }\n                ],\n                "description": "Creates a new empty rule with the given <code>selector</code> in a special \\"inspector\\" stylesheet in the owner document of the context node."\n            },\n            {\n                "name": "getSupportedCSSProperties",\n                "returns": [\n                    { "name": "cssProperties", "type": "array", "items": { "$ref": "CSSPropertyInfo" }, "description": "Supported property metainfo." }\n                ],\n                "description": "Returns all supported CSS property names."\n            },\n            {\n                "name": "forcePseudoState",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "DOM.NodeId", "description": "The element id for which to force the pseudo state." },\n                    { "name": "forcedPseudoClasses", "type": "array", "items": { "type": "string", "enum": ["active", "focus", "hover", "visited"] }, "description": "Element pseudo classes to force when computing the element\'s style." }\n                ],\n                "description": "Ensures that the given node will have specified pseudo-classes whenever its style is computed by the browser."\n            },\n            {\n                "name": "getNamedFlowCollection",\n                "parameters": [\n                    { "name": "documentNodeId", "$ref": "DOM.NodeId", "description": "The document node id for which to get the Named Flow Collection." }\n                ],\n                "returns": [\n                    { "name": "namedFlows", "type": "array", "items": { "$ref": "NamedFlow" }, "description": "An array containing the Named Flows in the document." }\n                ],\n                "description": "Returns the Named Flows from the document.",\n                "hidden": true\n            }\n        ],\n        "events": [\n            {\n                "name": "mediaQueryResultChanged",\n                "description": "Fires whenever a MediaQuery result changes (for example, after a browser window has been resized.) The current implementation considers only viewport-dependent media features."\n            },\n            {\n                "name": "styleSheetChanged",\n                "parameters": [\n                    { "name": "styleSheetId", "$ref": "StyleSheetId" }\n                ],\n                "description": "Fired whenever a stylesheet is changed as a result of the client operation."\n            },\n            {\n                "name": "styleSheetAdded",\n                "parameters": [\n                    { "name": "header", "$ref": "CSSStyleSheetHeader", "description": "Added stylesheet metainfo." }\n                ],\n                "description": "Fired whenever an active document stylesheet is added."\n            },\n            {\n                "name": "styleSheetRemoved",\n                "parameters": [\n                    { "name": "styleSheetId", "$ref": "StyleSheetId", "description": "Identifier of the removed stylesheet." }\n                ],\n                "description": "Fired whenever an active document stylesheet is removed."\n            },\n            {\n                "name": "namedFlowCreated",\n                "parameters": [\n                    { "name": "namedFlow", "$ref": "NamedFlow", "description": "The new Named Flow." }\n                ],\n                "description": "Fires when a Named Flow is created.",\n                "hidden": true\n            },\n            {\n                "name": "namedFlowRemoved",\n                "parameters": [\n                    { "name": "documentNodeId", "$ref": "DOM.NodeId", "description": "The document node id." },\n                    { "name": "flowName", "type": "string", "description": "Identifier of the removed Named Flow." }\n                ],\n                "description": "Fires when a Named Flow is removed: has no associated content nodes and regions.",\n                "hidden": true\n            },\n            {\n                "name": "regionLayoutUpdated",\n                "parameters": [\n                    { "name": "namedFlow", "$ref": "NamedFlow", "description": "The Named Flow whose layout may have changed." }\n                ],\n                "description": "Fires when a Named Flow\'s layout may have changed.",\n                "hidden": true\n            },\n            {\n                "name": "regionOversetChanged",\n                "parameters": [\n                    { "name": "namedFlow", "$ref": "NamedFlow", "description": "The Named Flow containing the regions whose regionOverset values changed." }\n                ],\n                "description": "Fires if any of the regionOverset values changed in a Named Flow\'s region chain.",\n                "hidden": true\n            }\n        ]\n    },\n    {\n        "domain": "Timeline",\n        "description": "Timeline provides its clients with instrumentation records that are generated during the page runtime. Timeline instrumentation can be started and stopped using corresponding commands. While timeline is started, it is generating timeline event records.",\n        "types": [\n            {\n                "id": "DOMCounters",\n                "type": "object",\n                "properties": [\n                    { "name": "documents", "type": "integer" },\n                    { "name": "nodes", "type": "integer" },\n                    { "name": "jsEventListeners", "type": "integer" }\n                ],\n                "description": "Current values of DOM counters.",\n                "hidden": true\n            },\n            {\n                "id": "TimelineEvent",\n                "type": "object",\n                "properties": [\n                    { "name": "type", "type": "string", "description": "Event type." },\n                    { "name": "thread", "type": "string", "optional": true, "description": "If present, identifies the thread that produced the event.", "hidden": true },\n                    { "name": "data", "type": "object", "description": "Event data." },\n                    { "name": "children", "type": "array", "optional": true, "items": { "$ref": "TimelineEvent" }, "description": "Nested records." },\n                    { "name": "counters", "$ref": "DOMCounters", "optional": true, "hidden": true, "description": "Current values of DOM counters." },\n                    { "name": "usedHeapSize", "type": "integer", "optional": true, "hidden": true, "description": "Current size of JS heap." },\n                    { "name": "nativeHeapStatistics", "type": "object", "optional": true, "hidden": true, "description": "Native heap statistics." }\n                ],\n                "description": "Timeline record contains information about the recorded activity."\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables timeline. After this call, timeline can be started from within the page (for example upon console.timeline)."\n            },\n            {\n                "name": "disable",\n                "description": "Disables timeline."\n            },\n            {\n                "name": "start",\n                "parameters": [\n                    { "name": "maxCallStackDepth", "optional": true, "type": "integer", "description": "Samples JavaScript stack traces up to <code>maxCallStackDepth</code>, defaults to 5." },\n                    { "name": "bufferEvents", "optional": true, "type": "boolean", "hidden": true, "description": "Whether instrumentation events should be buffered and returned upon <code>stop</code> call." },\n                    { "name": "includeDomCounters", "optional": true, "type": "boolean", "hidden": true, "description": "Whether DOM counters data should be included into timeline events." },\n                    { "name": "includeNativeMemoryStatistics", "optional": true, "type": "boolean", "hidden": true, "description": "Whether native memory usage statistics should be reported as part of timeline events." }\n                ],\n                "description": "Starts capturing instrumentation events."\n            },\n            {\n                "name": "stop",\n                "description": "Stops capturing instrumentation events.",\n                "returns": [\n                    { "name": "events", "type": "array", "items": { "$ref": "TimelineEvent" }, "optional": true, "hidden": true, "description": "Timeline event record data." }\n                ]\n            }\n        ],\n        "events": [\n            {\n                "name": "eventRecorded",\n                "parameters": [\n                    { "name": "record", "$ref": "TimelineEvent", "description": "Timeline event record data." }\n                ],\n                "description": "Fired for every instrumentation event while timeline is started."\n            },\n            {\n                "name": "started",\n                "parameters": [\n                    { "name": "consoleTimeline", "type": "boolean", "optional": true, "description": "If specified, identifies that timeline was started using console.timeline() call." }\n                ],\n                "description": "Fired when timeline is started.",\n                "hidden": true\n            },\n            {\n                "name": "stopped",\n                "parameters": [\n                    { "name": "consoleTimeline", "type": "boolean", "optional": true, "description": "If specified, identifies that timeline was started using console.timeline() call." }\n                ],\n                "description": "Fired when timeline is stopped.",\n                "hidden": true\n            }\n        ]\n    },\n    {\n        "domain": "Debugger",\n        "description": "Debugger domain exposes JavaScript debugging capabilities. It allows setting and removing breakpoints, stepping through execution, exploring stack traces, etc.",\n        "types": [\n            {\n                "id": "BreakpointId",\n                "type": "string",\n                "description": "Breakpoint identifier."\n            },\n            {\n                "id": "ScriptId",\n                "type": "string",\n                "description": "Unique script identifier."\n            },\n            {\n                "id": "CallFrameId",\n                "type": "string",\n                "description": "Call frame identifier."\n            },\n            {\n                "id": "Location",\n                "type": "object",\n                "properties": [\n                    { "name": "scriptId", "$ref": "ScriptId", "description": "Script identifier as reported in the <code>Debugger.scriptParsed</code>." },\n                    { "name": "lineNumber", "type": "integer", "description": "Line number in the script (0-based)." },\n                    { "name": "columnNumber", "type": "integer", "optional": true, "description": "Column number in the script (0-based)." }\n                ],\n                "description": "Location in the source code."\n            },\n            {\n                "id": "FunctionDetails",\n                "hidden": true,\n                "type": "object",\n                "properties": [\n                    { "name": "location", "$ref": "Location", "description": "Location of the function." },\n                    { "name": "name", "type": "string", "optional": true, "description": "Name of the function. Not present for anonymous functions." },\n                    { "name": "displayName", "type": "string", "optional": true, "description": "Display name of the function(specified in \'displayName\' property on the function object)." },\n                    { "name": "inferredName", "type": "string", "optional": true, "description": "Name of the function inferred from its initial assignment." },\n                    { "name": "scopeChain", "type": "array", "optional": true, "items": { "$ref": "Scope" }, "description": "Scope chain for this closure." }\n                ],\n                "description": "Information about the function."\n            },\n            {\n                "id": "CallFrame",\n                "type": "object",\n                "properties": [\n                    { "name": "callFrameId", "$ref": "CallFrameId", "description": "Call frame identifier. This identifier is only valid while the virtual machine is paused." },\n                    { "name": "functionName", "type": "string", "description": "Name of the JavaScript function called on this call frame." },\n                    { "name": "location", "$ref": "Location", "description": "Location in the source code." },\n                    { "name": "scopeChain", "type": "array", "items": { "$ref": "Scope" }, "description": "Scope chain for this call frame." },\n                    { "name": "this", "$ref": "Runtime.RemoteObject", "description": "<code>this</code> object for this call frame." }\n                ],\n                "description": "JavaScript call frame. Array of call frames form the call stack."\n            },\n            {\n                "id": "Scope",\n                "type": "object",\n                "properties": [\n                    { "name": "type", "type": "string", "enum": ["global", "local", "with", "closure", "catch"], "description": "Scope type." },\n                    { "name": "object", "$ref": "Runtime.RemoteObject", "description": "Object representing the scope. For <code>global</code> and <code>with</code> scopes it represents the actual object; for the rest of the scopes, it is artificial transient object enumerating scope variables as its properties." }\n                ],\n                "description": "Scope description."\n            },\n            {\n                "id": "SetScriptSourceError",\n                "type": "object",\n                "properties": [\n                    { "name": "compileError", "optional": true, "type": "object", "properties":\n                        [\n                            { "name": "message", "type": "string", "description": "Compiler error message" },\n                            { "name": "lineNumber", "type": "integer", "description": "Compile error line number (1-based)" },\n                            { "name": "columnNumber", "type": "integer", "description": "Compile error column number (1-based)" }\n                        ]\n                    }\n                ],\n                "description": "Error data for setScriptSource command. compileError is a case type for uncompilable script source error.",\n                "hidden": true\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables debugger for the given page. Clients should not assume that the debugging has been enabled until the result for this command is received."\n            },\n            {\n                "name": "disable",\n                "description": "Disables debugger for given page."\n            },\n            {\n                "name": "setBreakpointsActive",\n                "parameters": [\n                    { "name": "active", "type": "boolean", "description": "New value for breakpoints active state." }\n                ],\n                "description": "Activates / deactivates all breakpoints on the page."\n            },\n            {\n                "name": "setSkipAllPauses",\n                "hidden": true,\n                "parameters": [\n                    { "name": "skipped", "type": "boolean", "description": "New value for skip pauses state." },\n                    { "name": "untilReload", "type": "boolean", "optional": true, "description": "Whether page reload should set skipped to false." }\n                ],\n                "description": "Makes page not interrupt on any pauses (breakpoint, exception, dom exception etc)."\n            },\n            {\n                "name": "setBreakpointByUrl",\n                "parameters": [\n                    { "name": "lineNumber", "type": "integer", "description": "Line number to set breakpoint at." },\n                    { "name": "url", "type": "string", "optional": true, "description": "URL of the resources to set breakpoint on." },\n                    { "name": "urlRegex", "type": "string", "optional": true, "description": "Regex pattern for the URLs of the resources to set breakpoints on. Either <code>url</code> or <code>urlRegex</code> must be specified." },\n                    { "name": "columnNumber", "type": "integer", "optional": true, "description": "Offset in the line to set breakpoint at." },\n                    { "name": "condition", "type": "string", "optional": true, "description": "Expression to use as a breakpoint condition. When specified, debugger will only stop on the breakpoint if this expression evaluates to true." },\n                    { "name": "isAntibreakpoint", "type": "boolean", "optional": true, "hidden": true, "description": "Creates pseudo-breakpoint that prevents debugger from pausing on exception at this location." }\n                ],\n                "returns": [\n                    { "name": "breakpointId", "$ref": "BreakpointId", "description": "Id of the created breakpoint for further reference." },\n                    { "name": "locations", "type": "array", "items": { "$ref": "Location"}, "description": "List of the locations this breakpoint resolved into upon addition." }\n                ],\n                "description": "Sets JavaScript breakpoint at given location specified either by URL or URL regex. Once this command is issued, all existing parsed scripts will have breakpoints resolved and returned in <code>locations</code> property. Further matching script parsing will result in subsequent <code>breakpointResolved</code> events issued. This logical breakpoint will survive page reloads."\n            },\n            {\n                "name": "setBreakpoint",\n                "parameters": [\n                    { "name": "location", "$ref": "Location", "description": "Location to set breakpoint in." },\n                    { "name": "condition", "type": "string", "optional": true, "description": "Expression to use as a breakpoint condition. When specified, debugger will only stop on the breakpoint if this expression evaluates to true." }\n                ],\n                "returns": [\n                    { "name": "breakpointId", "$ref": "BreakpointId", "description": "Id of the created breakpoint for further reference." },\n                    { "name": "actualLocation", "$ref": "Location", "description": "Location this breakpoint resolved into." }\n                ],\n                "description": "Sets JavaScript breakpoint at a given location."\n            },\n            {\n                "name": "removeBreakpoint",\n                "parameters": [\n                    { "name": "breakpointId", "$ref": "BreakpointId" }\n                ],\n                "description": "Removes JavaScript breakpoint."\n            },\n            {\n                "name": "continueToLocation",\n                "parameters": [\n                    { "name": "location", "$ref": "Location", "description": "Location to continue to." },\n                    { "name": "interstatementLocation", "type": "boolean", "optional": true, "hidden": true, "description": "Allows breakpoints at the intemediate positions inside statements." }\n                ],\n                "description": "Continues execution until specific location is reached."\n            },\n            {\n                "name": "stepOver",\n                "description": "Steps over the statement."\n            },\n            {\n                "name": "stepInto",\n                "description": "Steps into the function call."\n            },\n            {\n                "name": "stepOut",\n                "description": "Steps out of the function call."\n            },\n            {\n                "name": "pause",\n                "description": "Stops on the next JavaScript statement."\n            },\n            {\n                "name": "resume",\n                "description": "Resumes JavaScript execution."\n            },\n            {\n                "name": "searchInContent",\n                "parameters": [\n                    { "name": "scriptId", "$ref": "ScriptId", "description": "Id of the script to search in." },\n                    { "name": "query", "type": "string", "description": "String to search for."  },\n                    { "name": "caseSensitive", "type": "boolean", "optional": true, "description": "If true, search is case sensitive." },\n                    { "name": "isRegex", "type": "boolean", "optional": true, "description": "If true, treats string parameter as regex." }\n                ],\n                "returns": [\n                    { "name": "result", "type": "array", "items": { "$ref": "Page.SearchMatch" }, "description": "List of search matches." }\n                ],\n                "description": "Searches for given string in script content."\n            },\n            {\n                "name": "canSetScriptSource",\n                "returns": [\n                    { "name": "result", "type": "boolean", "description": "True if <code>setScriptSource</code> is supported." }\n                ],\n                "description": "Always returns true."\n            },\n            {\n                "name": "setScriptSource",\n                "parameters": [\n                    { "name": "scriptId", "$ref": "ScriptId", "description": "Id of the script to edit." },\n                    { "name": "scriptSource", "type": "string", "description": "New content of the script." },\n                    { "name": "preview", "type": "boolean", "optional": true, "description": " If true the change will not actually be applied. Preview mode may be used to get result description without actually modifying the code.", "hidden": true }\n                ],\n                "returns": [\n                    { "name": "callFrames", "type": "array", "optional": true, "items": { "$ref": "CallFrame"}, "description": "New stack trace in case editing has happened while VM was stopped." },\n                    { "name": "result", "type": "object", "optional": true, "description": "VM-specific description of the changes applied.", "hidden": true }\n                ],\n                "error": {\n                    "$ref": "SetScriptSourceError"\n                },\n                "description": "Edits JavaScript source live."\n            },\n            {\n                "name": "restartFrame",\n                "parameters": [\n                    { "name": "callFrameId", "$ref": "CallFrameId", "description": "Call frame identifier to evaluate on." }\n                ],\n                "returns": [\n                    { "name": "callFrames", "type": "array", "items": { "$ref": "CallFrame"}, "description": "New stack trace." },\n                    { "name": "result", "type": "object", "description": "VM-specific description.", "hidden": true }\n                ],\n                "hidden": true,\n                "description": "Restarts particular call frame from the beginning."\n            },\n            {\n                "name": "getScriptSource",\n                "parameters": [\n                    { "name": "scriptId", "$ref": "ScriptId", "description": "Id of the script to get source for." }\n                ],\n                "returns": [\n                    { "name": "scriptSource", "type": "string", "description": "Script source." }\n                ],\n                "description": "Returns source for the script with given id."\n            },\n            {\n                "name": "getFunctionDetails",\n                "hidden": true,\n                "parameters": [\n                    { "name": "functionId", "$ref": "Runtime.RemoteObjectId", "description": "Id of the function to get location for." }\n                ],\n                "returns": [\n                    { "name": "details", "$ref": "FunctionDetails", "description": "Information about the function." }\n                ],\n                "description": "Returns detailed informtation on given function."\n            },\n            {\n                "name": "setPauseOnExceptions",\n                "parameters": [\n                    { "name": "state", "type": "string", "enum": ["none", "uncaught", "all"], "description": "Pause on exceptions mode." }\n                ],\n                "description": "Defines pause on exceptions state. Can be set to stop on all exceptions, uncaught exceptions or no exceptions. Initial pause on exceptions state is <code>none</code>."\n            },\n            {\n                "name": "evaluateOnCallFrame",\n                "parameters": [\n                    { "name": "callFrameId", "$ref": "CallFrameId", "description": "Call frame identifier to evaluate on." },\n                    { "name": "expression", "type": "string", "description": "Expression to evaluate." },\n                    { "name": "objectGroup", "type": "string", "optional": true, "description": "String object group name to put result into (allows rapid releasing resulting object handles using <code>releaseObjectGroup</code>)." },\n                    { "name": "includeCommandLineAPI", "type": "boolean", "optional": true, "description": "Specifies whether command line API should be available to the evaluated expression, defaults to false.", "hidden": true },\n                    { "name": "doNotPauseOnExceptionsAndMuteConsole", "type": "boolean", "optional": true, "description": "Specifies whether evaluation should stop on exceptions and mute console. Overrides setPauseOnException state.", "hidden": true },\n                    { "name": "returnByValue", "type": "boolean", "optional": true, "description": "Whether the result is expected to be a JSON object that should be sent by value." },\n                    { "name": "generatePreview", "type": "boolean", "optional": true, "hidden": true, "description": "Whether preview should be generated for the result." }\n                ],\n                "returns": [\n                    { "name": "result", "$ref": "Runtime.RemoteObject", "description": "Object wrapper for the evaluation result." },\n                    { "name": "wasThrown", "type": "boolean", "optional": true, "description": "True if the result was thrown during the evaluation." }\n                ],\n                "description": "Evaluates expression on a given call frame."\n            },\n            {\n                "name": "compileScript",\n                "hidden": true,\n                "parameters": [\n                    { "name": "expression", "type": "string", "description": "Expression to compile." },\n                    { "name": "sourceURL", "type": "string", "description": "Source url to be set for the script." }\n                ],\n                "returns": [\n                    { "name": "scriptId", "$ref": "ScriptId", "optional": true, "description": "Id of the script." },\n                    { "name": "syntaxErrorMessage", "type": "string", "optional": true, "description": "Syntax error message if compilation failed." }\n                ],\n                "description": "Compiles expression."\n            },\n            {\n                "name": "runScript",\n                "hidden": true,\n                "parameters": [\n                    { "name": "scriptId", "$ref": "ScriptId", "description": "Id of the script to run." },\n                    { "name": "contextId", "$ref": "Runtime.ExecutionContextId", "optional": true, "description": "Specifies in which isolated context to perform script run. Each content script lives in an isolated context and this parameter may be used to specify one of those contexts. If the parameter is omitted or 0 the evaluation will be performed in the context of the inspected page." },\n                    { "name": "objectGroup", "type": "string", "optional": true, "description": "Symbolic group name that can be used to release multiple objects." },\n                    { "name": "doNotPauseOnExceptionsAndMuteConsole", "type": "boolean", "optional": true, "description": "Specifies whether script run should stop on exceptions and mute console. Overrides setPauseOnException state." }\n                ],\n                "returns": [\n                    { "name": "result", "$ref": "Runtime.RemoteObject", "description": "Run result." },\n                    { "name": "wasThrown", "type": "boolean", "optional": true, "description": "True if the result was thrown during the script run." }\n                ],\n                "description": "Runs script with given id in a given context."\n            },\n            {\n                "name": "setOverlayMessage",\n                "parameters": [\n                    { "name": "message", "type": "string", "optional": true, "description": "Overlay message to display when paused in debugger." }\n                ],\n                "hidden": true,\n                "description": "Sets overlay message."\n            },\n            {\n                "name": "setVariableValue",\n                "parameters": [\n                    { "name": "scopeNumber", "type": "integer", "description": "0-based number of scope as was listed in scope chain. Only \'local\', \'closure\' and \'catch\' scope types are allowed. Other scopes could be manipulated manually." },\n                    { "name": "variableName", "type": "string", "description": "Variable name." },\n                    { "name": "newValue", "$ref": "Runtime.CallArgument", "description": "New variable value." },\n                    { "name": "callFrameId", "$ref": "CallFrameId", "optional": true, "description": "Id of callframe that holds variable." },\n                    { "name": "functionObjectId", "$ref": "Runtime.RemoteObjectId", "optional": true, "description": "Object id of closure (function) that holds variable." }\n                ],\n                "hidden": true,\n                "description": "Changes value of variable in a callframe or a closure. Either callframe or function must be specified. Object-based scopes are not supported and must be mutated manually."\n            },\n            {\n                "name": "getStepInPositions",\n                "parameters": [\n                    { "name": "callFrameId", "$ref": "CallFrameId", "description": "Id of a call frame where the current statement should be analized" }\n                ],\n                "returns": [\n                    { "name": "stepInPositions", "type": "array", "items": { "$ref": "Location" }, "optional": true, "description": "experimental" }\n                ],\n                "hidden": true,\n                "description": "Lists all positions where step-in is possible for a current statement in a specified call frame"\n            },\n            {\n                "name": "getBacktrace",\n                "returns": [\n                    { "name": "callFrames", "type": "array", "items": { "$ref": "CallFrame"}, "description": "Call stack the virtual machine stopped on." }\n                ],\n                "hidden": true,\n                "description": "Returns call stack including variables changed since VM was paused. VM must be paused."\n            },\n            {\n                "name": "skipStackFrames",\n                "parameters": [\n                    { "name": "script", "optional": true, "type": "string", "description": "Regular expression defining the scripts to ignore while stepping." }\n                ],\n                "hidden": true,\n                "description": "Makes backend skip steps in the sources with names matching given pattern. VM will try leave blacklisted scripts by performing \'step in\' several times, finally resorting to \'step out\' if unsuccessful."\n            }\n        ],\n        "events": [\n            {\n                "name": "globalObjectCleared",\n                "description": "Called when global has been cleared and debugger client should reset its state. Happens upon navigation or reload."\n            },\n            {\n                "name": "scriptParsed",\n                "parameters": [\n                    { "name": "scriptId", "$ref": "ScriptId", "description": "Identifier of the script parsed." },\n                    { "name": "url", "type": "string", "description": "URL or name of the script parsed (if any)." },\n                    { "name": "startLine", "type": "integer", "description": "Line offset of the script within the resource with given URL (for script tags)." },\n                    { "name": "startColumn", "type": "integer", "description": "Column offset of the script within the resource with given URL." },\n                    { "name": "endLine", "type": "integer", "description": "Last line of the script." },\n                    { "name": "endColumn", "type": "integer", "description": "Length of the last line of the script." },\n                    { "name": "isContentScript", "type": "boolean", "optional": true, "description": "Determines whether this script is a user extension script." },\n                    { "name": "sourceMapURL", "type": "string", "optional": true, "description": "URL of source map associated with script (if any)." },\n                    { "name": "hasSourceURL", "type": "boolean", "optional": true, "description": "True, if this script has sourceURL.", "hidden": true }\n                ],\n                "description": "Fired when virtual machine parses script. This event is also fired for all known and uncollected scripts upon enabling debugger."\n            },\n            {\n                "name": "scriptFailedToParse",\n                "parameters": [\n                    { "name": "url", "type": "string", "description": "URL of the script that failed to parse." },\n                    { "name": "scriptSource", "type": "string", "description": "Source text of the script that failed to parse." },\n                    { "name": "startLine", "type": "integer", "description": "Line offset of the script within the resource." },\n                    { "name": "errorLine", "type": "integer", "description": "Line with error." },\n                    { "name": "errorMessage", "type": "string", "description": "Parse error message." }\n                ],\n                "description": "Fired when virtual machine fails to parse the script."\n            },\n            {\n                "name": "breakpointResolved",\n                "parameters": [\n                    { "name": "breakpointId", "$ref": "BreakpointId", "description": "Breakpoint unique identifier." },\n                    { "name": "location", "$ref": "Location", "description": "Actual breakpoint location." }\n                ],\n                "description": "Fired when breakpoint is resolved to an actual script and location."\n            },\n            {\n                "name": "paused",\n                "parameters": [\n                    { "name": "callFrames", "type": "array", "items": { "$ref": "CallFrame" }, "description": "Call stack the virtual machine stopped on." },\n                    { "name": "reason", "type": "string", "enum": [ "XHR", "DOM", "EventListener", "exception", "assert", "CSPViolation", "debugCommand", "other" ], "description": "Pause reason." },\n                    { "name": "data", "type": "object", "optional": true, "description": "Object containing break-specific auxiliary properties." },\n                    { "name": "hitBreakpoints", "type": "array", "optional": true, "items": { "type": "string" }, "description": "Hit breakpoints IDs", "hidden": true }\n                ],\n                "description": "Fired when the virtual machine stopped on breakpoint or exception or any other stop criteria."\n            },\n            {\n                "name": "resumed",\n                "description": "Fired when the virtual machine resumed execution."\n            }\n        ]\n    },\n    {\n        "domain": "DOMDebugger",\n        "description": "DOM debugging allows setting breakpoints on particular DOM operations and events. JavaScript execution will stop on these operations as if there was a regular breakpoint set.",\n        "types": [\n            {\n                "id": "DOMBreakpointType",\n                "type": "string",\n                "enum": ["subtree-modified", "attribute-modified", "node-removed"],\n                "description": "DOM breakpoint type."\n            }\n        ],\n        "commands": [\n            {\n                "name": "setDOMBreakpoint",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "DOM.NodeId", "description": "Identifier of the node to set breakpoint on." },\n                    { "name": "type", "$ref": "DOMBreakpointType", "description": "Type of the operation to stop upon." }\n                ],\n                "description": "Sets breakpoint on particular operation with DOM."\n            },\n            {\n                "name": "removeDOMBreakpoint",\n                "parameters": [\n                    { "name": "nodeId", "$ref": "DOM.NodeId", "description": "Identifier of the node to remove breakpoint from." },\n                    { "name": "type", "$ref": "DOMBreakpointType", "description": "Type of the breakpoint to remove." }\n                ],\n                "description": "Removes DOM breakpoint that was set using <code>setDOMBreakpoint</code>."\n            },\n            {\n                "name": "setEventListenerBreakpoint",\n                "parameters": [\n                    { "name": "eventName", "type": "string", "description": "DOM Event name to stop on (any DOM event will do)." }\n                ],\n                "description": "Sets breakpoint on particular DOM event."\n            },\n            {\n                "name": "removeEventListenerBreakpoint",\n                "parameters": [\n                    { "name": "eventName", "type": "string", "description": "Event name." }\n                ],\n                "description": "Removes breakpoint on particular DOM event."\n            },\n            {\n                "name": "setInstrumentationBreakpoint",\n                "parameters": [\n                    { "name": "eventName", "type": "string", "description": "Instrumentation name to stop on." }\n                ],\n                "description": "Sets breakpoint on particular native event.",\n                "hidden": true\n            },\n            {\n                "name": "removeInstrumentationBreakpoint",\n                "parameters": [\n                    { "name": "eventName", "type": "string", "description": "Instrumentation name to stop on." }\n                ],\n                "description": "Removes breakpoint on particular native event.",\n                "hidden": true\n            },\n            {\n                "name": "setXHRBreakpoint",\n                "parameters": [\n                    { "name": "url", "type": "string", "description": "Resource URL substring. All XHRs having this substring in the URL will get stopped upon." }\n                ],\n                "description": "Sets breakpoint on XMLHttpRequest."\n            },\n            {\n                "name": "removeXHRBreakpoint",\n                "parameters": [\n                    { "name": "url", "type": "string", "description": "Resource URL substring." }\n                ],\n                "description": "Removes breakpoint from XMLHttpRequest."\n            }\n        ]\n    },\n    {\n        "domain": "Profiler",\n        "hidden": true,\n        "types": [\n            {\n                "id": "ProfileHeader",\n                "type": "object",\n                "description": "Profile header.",\n                "properties": [\n                    { "name": "title", "type": "string", "description": "Profile title." },\n                    { "name": "uid", "type": "integer", "description": "Unique identifier of the profile." }\n                ]\n            },\n            {\n                "id": "CPUProfileNode",\n                "type": "object",\n                "description": "CPU Profile node. Holds callsite information, execution statistics and child nodes.",\n                "properties": [\n                    { "name": "functionName", "type": "string", "description": "Function name." },\n                    { "name": "scriptId", "$ref": "Debugger.ScriptId", "description": "Script identifier." },\n                    { "name": "url", "type": "string", "description": "URL." },\n                    { "name": "lineNumber", "type": "integer", "description": "Line number." },\n                    { "name": "hitCount", "type": "integer", "description": "Number of samples where this node was on top of the call stack." },\n                    { "name": "callUID", "type": "number", "description": "Call UID." },\n                    { "name": "children", "type": "array", "items": { "$ref": "CPUProfileNode" }, "description": "Child nodes." },\n                    { "name": "deoptReason", "type": "string", "description": "The reason of being not optimized. The function may be deoptimized or marked as don\'t optimize."},\n                    { "name": "id", "optional": true, "type": "integer", "description": "Unique id of the node." }\n                ]\n            },\n            {\n                "id": "CPUProfile",\n                "type": "object",\n                "description": "Profile.",\n                "properties": [\n                    { "name": "head", "$ref": "CPUProfileNode" },\n                    { "name": "startTime", "type": "number", "description": "Profiling start time in seconds." },\n                    { "name": "endTime", "type": "number", "description": "Profiling end time in seconds." },\n                    { "name": "samples", "optional": true, "type": "array", "items": { "type": "integer" }, "description": "Ids of samples top nodes." }\n                ]\n            },\n            {\n                "id": "HeapSnapshotObjectId",\n                "type": "string",\n                "description": "Heap snashot object id."\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable"\n            },\n            {\n                "name": "disable"\n            },\n            {\n                "name": "setSamplingInterval",\n                "parameters": [\n                    { "name": "interval", "type": "integer", "description": "New sampling interval in microseconds." }\n                ],\n                "description": "Changes CPU profiler sampling interval. Must be called before CPU profiles recording started."\n            },\n            {\n                "name": "start"\n            },\n            {\n                "name": "stop",\n                "returns": [\n                    { "name": "header", "$ref": "ProfileHeader", "description": "The header of the recorded profile."}\n                ]\n            },\n            {\n                "name": "getProfileHeaders",\n                "returns": [\n                    { "name": "headers", "type": "array", "items": { "$ref": "ProfileHeader"} }\n                ]\n            },\n            {\n                "name": "getCPUProfile",\n                "parameters": [\n                    { "name": "uid", "type": "integer" }\n                ],\n                "returns": [\n                    { "name": "profile", "$ref": "CPUProfile" }\n                ]\n            },\n            {\n                "name": "removeProfile",\n                "parameters": [\n                    { "name": "type", "type": "string" },\n                    { "name": "uid", "type": "integer" }\n                ]\n            },\n            {\n                "name": "clearProfiles"\n            }\n        ],\n        "events": [\n            {\n                "name": "addProfileHeader",\n                "parameters": [\n                    { "name": "header", "$ref": "ProfileHeader" }\n                ]\n            },\n            {\n                "name": "setRecordingProfile",\n                "parameters": [\n                    { "name": "isProfiling", "type": "boolean" }\n                ]\n            },\n            {\n                "name": "resetProfiles"\n            }\n        ]\n    },\n    {\n        "domain": "HeapProfiler",\n        "hidden": true,\n        "types": [\n            {\n                "id": "ProfileHeader",\n                "type": "object",\n                "description": "Profile header.",\n                "properties": [\n                    { "name": "title", "type": "string", "description": "Profile title." },\n                    { "name": "uid", "type": "integer", "description": "Unique identifier of the profile." },\n                    { "name": "maxJSObjectId", "type": "integer", "optional": true, "description": "Last seen JS object Id." }\n                ]\n            },\n            {\n                "id": "HeapSnapshotObjectId",\n                "type": "string",\n                "description": "Heap snashot object id."\n            }\n        ],\n        "commands": [\n            {\n                "name": "getProfileHeaders",\n                "returns": [\n                    { "name": "headers", "type": "array", "items": { "$ref": "ProfileHeader"} }\n                ]\n            },\n            {\n                "name": "startTrackingHeapObjects"\n            },\n            {\n                "name": "stopTrackingHeapObjects"\n            },\n            {\n                "name": "getHeapSnapshot",\n                "parameters": [\n                    { "name": "uid", "type": "integer" }\n                ]\n            },\n            {\n                "name": "removeProfile",\n                "parameters": [\n                    { "name": "uid", "type": "integer" }\n                ]\n            },\n            {\n                "name": "clearProfiles"\n            },\n            {\n                "name": "takeHeapSnapshot",\n                "parameters": [\n                    { "name": "reportProgress", "type": "boolean", "optional": true, "description": "If true \'reportHeapSnapshotProgress\' events will be generated while snapshot is being taken." }\n                ]\n            },\n            {\n                "name": "collectGarbage"\n            },\n            {\n                "name": "getObjectByHeapObjectId",\n                "parameters": [\n                    { "name": "objectId", "$ref": "HeapSnapshotObjectId" },\n                    { "name": "objectGroup", "type": "string", "optional": true, "description": "Symbolic group name that can be used to release multiple objects." }\n                ],\n                "returns": [\n                    { "name": "result", "$ref": "Runtime.RemoteObject", "description": "Evaluation result." }\n                ]\n            },\n            {\n                "name": "getHeapObjectId",\n                "parameters": [\n                    { "name": "objectId", "$ref": "Runtime.RemoteObjectId", "description": "Identifier of the object to get heap object id for." }\n                ],\n                "returns": [\n                    { "name": "heapSnapshotObjectId", "$ref": "HeapSnapshotObjectId", "description": "Id of the heap snapshot object corresponding to the passed remote object id." }\n                ]\n            }\n        ],\n        "events": [\n            {\n                "name": "addProfileHeader",\n                "parameters": [\n                    { "name": "header", "$ref": "ProfileHeader" }\n                ]\n            },\n            {\n                "name": "addHeapSnapshotChunk",\n                "parameters": [\n                    { "name": "uid", "type": "integer" },\n                    { "name": "chunk", "type": "string" }\n                ]\n            },\n            {\n                "name": "finishHeapSnapshot",\n                "parameters": [\n                    { "name": "uid", "type": "integer" }\n                ]\n            },\n            {\n                "name": "resetProfiles"\n            },\n            {\n                "name": "reportHeapSnapshotProgress",\n                "parameters": [\n                    { "name": "done", "type": "integer" },\n                    { "name": "total", "type": "integer" }\n                ]\n            },\n            {\n                "name": "lastSeenObjectId",\n                "description": "If heap objects tracking has been started then backend regulary sends a current value for last seen object id and corresponding timestamp. If the were changes in the heap since last event then one or more heapStatsUpdate events will be sent before a new lastSeenObjectId event.",\n                "parameters": [\n                    { "name": "lastSeenObjectId", "type": "integer" },\n                    { "name": "timestamp", "type": "number" }\n                ]\n            },\n            {\n                "name": "heapStatsUpdate",\n                "description": "If heap objects tracking has been started then backend may send update for one or more fragments",\n                "parameters": [\n                    { "name": "statsUpdate", "type": "array", "items": { "type": "integer" }, "description": "An array of triplets. Each triplet describes a fragment. The first integer is the fragment index, the second integer is a total count of objects for the fragment, the third integer is a total size of the objects for the fragment."}\n                ]\n            }\n        ]\n    },\n    {\n        "domain": "Worker",\n        "hidden": true,\n        "types": [],\n        "commands": [\n            {\n                "name": "enable"\n            },\n            {\n                "name": "disable"\n            },\n            {\n                "name": "sendMessageToWorker",\n                "parameters": [\n                    { "name": "workerId", "type": "integer" },\n                    { "name": "message", "type": "object" }\n                ]\n            },\n            {\n                "name": "canInspectWorkers",\n                "description": "Tells whether browser supports workers inspection.",\n                "returns": [\n                    { "name": "result", "type": "boolean", "description": "True if browser has workers support." }\n                ]\n            },\n            {\n                "name": "connectToWorker",\n                "parameters": [\n                    { "name": "workerId", "type": "integer" }\n                ]\n            },\n            {\n                "name": "disconnectFromWorker",\n                "parameters": [\n                    { "name": "workerId", "type": "integer" }\n                ]\n            },\n            {\n                "name": "setAutoconnectToWorkers",\n                "parameters": [\n                    { "name": "value", "type": "boolean" }\n                ]\n            }\n        ],\n        "events": [\n            {\n                "name": "workerCreated",\n                "parameters": [\n                    { "name": "workerId", "type": "integer" },\n                    { "name": "url", "type": "string" },\n                    { "name": "inspectorConnected", "type": "boolean" }\n                ]\n            },\n            {\n                "name": "workerTerminated",\n                "parameters": [\n                    { "name": "workerId", "type": "integer" }\n                ]\n            },\n            {\n                "name": "dispatchMessageFromWorker",\n                "parameters": [\n                    { "name": "workerId", "type": "integer" },\n                    { "name": "message", "type": "object" }\n                ]\n            },\n            {\n                "name": "disconnectedFromWorker"\n            }\n        ]\n    },\n    {\n        "domain": "Canvas",\n        "hidden": true,\n        "types": [\n            {\n                "id": "ResourceId",\n                "type": "string",\n                "description": "Unique resource identifier."\n            },\n            {\n                "id": "ResourceStateDescriptor",\n                "type": "object",\n                "description": "Resource state descriptor.",\n                "properties": [\n                    { "name": "name", "type": "string", "description": "State name." },\n                    { "name": "enumValueForName", "type": "string", "optional": true, "description": "String representation of the enum value, if <code>name</code> stands for an enum." },\n                    { "name": "value", "$ref": "CallArgument", "optional": true, "description": "The value associated with the particular state." },\n                    { "name": "values", "type": "array", "items": { "$ref": "ResourceStateDescriptor" }, "optional": true, "description": "Array of values associated with the particular state. Either <code>value</code> or <code>values</code> will be specified." },\n                    { "name": "isArray", "type": "boolean", "optional": true, "description": "True iff the given <code>values</code> items stand for an array rather than a list of grouped states." }\n                ]\n            },\n            {\n                "id": "ResourceState",\n                "type": "object",\n                "description": "Resource state.",\n                "properties": [\n                    { "name": "id", "$ref": "ResourceId" },\n                    { "name": "traceLogId", "$ref": "TraceLogId" },\n                    { "name": "descriptors", "type": "array", "items": { "$ref": "ResourceStateDescriptor" }, "optional": true, "description": "Describes current <code>Resource</code> state." },\n                    { "name": "imageURL", "type": "string", "optional": true, "description": "Screenshot image data URL." }\n                ]\n            },\n            {\n                "id": "CallArgument",\n                "type": "object",\n                "properties": [\n                    { "name": "description", "type": "string", "description": "String representation of the object." },\n                    { "name": "enumName", "type": "string", "optional": true, "description": "Enum name, if any, that stands for the value (for example, a WebGL enum name)." },\n                    { "name": "resourceId", "$ref": "ResourceId", "optional": true, "description": "Resource identifier. Specified for <code>Resource</code> objects only." },\n                    { "name": "type", "type": "string", "optional": true, "enum": ["object", "function", "undefined", "string", "number", "boolean"], "description": "Object type. Specified for non <code>Resource</code> objects only." },\n                    { "name": "subtype", "type": "string", "optional": true, "enum": ["array", "null", "node", "regexp", "date"], "description": "Object subtype hint. Specified for <code>object</code> type values only." },\n                    { "name": "remoteObject", "$ref": "Runtime.RemoteObject", "optional": true, "description": "The <code>RemoteObject</code>, if requested." }\n                ]\n            },\n            {\n                "id": "Call",\n                "type": "object",\n                "properties": [\n                    { "name": "contextId", "$ref": "ResourceId" },\n                    { "name": "functionName", "type": "string", "optional": true },\n                    { "name": "arguments", "type": "array", "items": { "$ref": "CallArgument" }, "optional": true },\n                    { "name": "result", "$ref": "CallArgument", "optional": true },\n                    { "name": "isDrawingCall", "type": "boolean", "optional": true },\n                    { "name": "isFrameEndCall", "type": "boolean", "optional": true },\n                    { "name": "property", "type": "string", "optional": true },\n                    { "name": "value", "$ref": "CallArgument", "optional": true },\n                    { "name": "sourceURL", "type": "string", "optional": true },\n                    { "name": "lineNumber", "type": "integer", "optional": true },\n                    { "name": "columnNumber", "type": "integer", "optional": true }\n                ]\n            },\n            {\n                "id": "TraceLogId",\n                "type": "string",\n                "description": "Unique trace log identifier."\n            },\n            {\n                "id": "TraceLog",\n                "type": "object",\n                "properties": [\n                    { "name": "id", "$ref": "TraceLogId" },\n                    { "name": "calls", "type": "array", "items": { "$ref": "Call" } },\n                    { "name": "contexts", "type": "array", "items": { "$ref": "CallArgument" } },\n                    { "name": "startOffset", "type": "integer" },\n                    { "name": "alive", "type": "boolean" },\n                    { "name": "totalAvailableCalls", "type": "number" }\n                ]\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables Canvas inspection."\n            },\n            {\n                "name": "disable",\n                "description": "Disables Canvas inspection."\n            },\n            {\n                "name": "dropTraceLog",\n                "parameters": [\n                    { "name": "traceLogId", "$ref": "TraceLogId" }\n                ]\n            },\n            {\n                "name": "hasUninstrumentedCanvases",\n                "returns": [\n                    { "name": "result", "type": "boolean" }\n                ],\n                "description": "Checks if there is any uninstrumented canvas in the inspected page."\n            },\n            {\n                "name": "captureFrame",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Page.FrameId", "optional": true, "description": "Identifier of the frame containing document whose canvases are to be captured. If omitted, main frame is assumed." }\n                ],\n                "returns": [\n                    { "name": "traceLogId", "$ref": "TraceLogId", "description": "Identifier of the trace log containing captured canvas calls." }\n                ],\n                "description": "Starts (or continues) a canvas frame capturing which will be stopped automatically after the next frame is prepared."\n            },\n            {\n                "name": "startCapturing",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Page.FrameId", "optional": true, "description": "Identifier of the frame containing document whose canvases are to be captured. If omitted, main frame is assumed." }\n                ],\n                "returns": [\n                    { "name": "traceLogId", "$ref": "TraceLogId", "description": "Identifier of the trace log containing captured canvas calls." }\n                ],\n                "description": "Starts (or continues) consecutive canvas frames capturing. The capturing is stopped by the corresponding stopCapturing command."\n            },\n            {\n                "name": "stopCapturing",\n                "parameters": [\n                    { "name": "traceLogId", "$ref": "TraceLogId" }\n                ]\n            },\n            {\n                "name": "getTraceLog",\n                "parameters": [\n                    { "name": "traceLogId", "$ref": "TraceLogId" },\n                    { "name": "startOffset", "type": "integer", "optional": true },\n                    { "name": "maxLength", "type": "integer", "optional": true }\n                ],\n                "returns": [\n                    { "name": "traceLog", "$ref": "TraceLog" }\n                ]\n            },\n            {\n                "name": "replayTraceLog",\n                "parameters": [\n                    { "name": "traceLogId", "$ref": "TraceLogId" },\n                    { "name": "stepNo", "type": "integer", "description": "Last call index in the trace log to replay (zero based)." }\n                ],\n                "returns": [\n                    { "name": "resourceState", "$ref": "ResourceState" },\n                    { "name": "replayTime", "type": "number", "description": "Replay time (in milliseconds)." }\n                ]\n            },\n            {\n                "name": "getResourceState",\n                "parameters": [\n                    { "name": "traceLogId", "$ref": "TraceLogId" },\n                    { "name": "resourceId", "$ref": "ResourceId" }\n                ],\n                "returns": [\n                    { "name": "resourceState", "$ref": "ResourceState" }\n                ]\n            },\n            {\n                "name": "evaluateTraceLogCallArgument",\n                "parameters": [\n                    { "name": "traceLogId", "$ref": "TraceLogId" },\n                    { "name": "callIndex", "type": "integer", "description": "Index of the call to evaluate on (zero based)." },\n                    { "name": "argumentIndex", "type": "integer", "description": "Index of the argument to evaluate (zero based). Provide <code>-1</code> to evaluate call result." },\n                    { "name": "objectGroup", "type": "string", "optional": true, "description": "String object group name to put result into (allows rapid releasing resulting object handles using <code>Runtime.releaseObjectGroup</code>)." }\n                ],\n                "returns": [\n                    { "name": "result", "$ref": "Runtime.RemoteObject", "optional": true, "description": "Object wrapper for the evaluation result." },\n                    { "name": "resourceState", "$ref": "ResourceState", "optional": true, "description": "State of the <code>Resource</code> object." }\n                ],\n                "description": "Evaluates a given trace call argument or its result."\n            }\n        ],\n        "events": [\n            {\n                "name": "contextCreated",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Page.FrameId", "description": "Identifier of the frame containing a canvas with a context." }\n                ],\n                "description": "Fired when a canvas context has been created in the given frame. The context may not be instrumented (see hasUninstrumentedCanvases command)."\n            },\n            {\n                "name": "traceLogsRemoved",\n                "parameters": [\n                    { "name": "frameId", "$ref": "Page.FrameId", "optional": true, "description": "If given, trace logs from the given frame were removed." },\n                    { "name": "traceLogId", "$ref": "TraceLogId", "optional": true, "description": "If given, trace log with the given ID was removed." }\n                ],\n                "description": "Fired when a set of trace logs were removed from the backend. If no parameters are given, all trace logs were removed."\n            }\n        ]\n    },\n    {\n        "domain": "Input",\n        "types": [\n            {\n                "id": "TouchPoint",\n                "type": "object",\n                "hidden": true,\n                "properties": [\n                    { "name": "state", "type": "string", "enum": ["touchPressed", "touchReleased", "touchMoved", "touchStationary", "touchCancelled"], "description": "State of the touch point." },\n                    { "name": "x", "type": "integer", "description": "X coordinate of the event relative to the main frame\'s viewport."},\n                    { "name": "y", "type": "integer", "description": "Y coordinate of the event relative to the main frame\'s viewport. 0 refers to the top of the viewport and Y increases as it proceeds towards the bottom of the viewport."},\n                    { "name": "radiusX", "type": "integer", "optional": true, "description": "X radius of the touch area (default: 1)."},\n                    { "name": "radiusY", "type": "integer", "optional": true, "description": "Y radius of the touch area (default: 1)."},\n                    { "name": "rotationAngle", "type": "number", "optional": true, "description": "Rotation angle (default: 0.0)."},\n                    { "name": "force", "type": "number", "optional": true, "description": "Force (default: 1.0)."},\n                    { "name": "id", "type": "number", "optional": true, "description": "Identifier used to track touch sources between events, must be unique within an event."}\n                ]\n            }\n        ],\n        "commands": [\n            {\n                "name": "dispatchKeyEvent",\n                "parameters": [\n                    { "name": "type", "type": "string", "enum": ["keyDown", "keyUp", "rawKeyDown", "char"], "description": "Type of the key event." },\n                    { "name": "modifiers", "type": "integer", "optional": true, "description": "Bit field representing pressed modifier keys. Alt=1, Ctrl=2, Meta/Command=4, Shift=8 (default: 0)." },\n                    { "name": "timestamp", "type": "number", "optional": true, "description": "Time at which the event occurred. Measured in UTC time in seconds since January 1, 1970 (default: current time)." },\n                    { "name": "text", "type": "string", "optional": true, "description": "Text as generated by processing a virtual key code with a keyboard layout. Not needed for for <code>keyUp</code> and <code>rawKeyDown</code> events (default: \\"\\")" },\n                    { "name": "unmodifiedText", "type": "string", "optional": true, "description": "Text that would have been generated by the keyboard if no modifiers were pressed (except for shift). Useful for shortcut (accelerator) key handling (default: \\"\\")." },\n                    { "name": "keyIdentifier", "type": "string", "optional": true, "description": "Unique key identifier (e.g., \'U+0041\') (default: \\"\\")." },\n                    { "name": "windowsVirtualKeyCode", "type": "integer", "optional": true, "description": "Windows virtual key code (default: 0)." },\n                    { "name": "nativeVirtualKeyCode", "type": "integer", "optional": true, "description": "Native virtual key code (default: 0)." },\n                    { "name": "macCharCode", "type": "integer", "optional": true, "description": "Mac character code (default: 0)." },\n                    { "name": "autoRepeat", "type": "boolean", "optional": true, "description": "Whether the event was generated from auto repeat (default: false)." },\n                    { "name": "isKeypad", "type": "boolean", "optional": true, "description": "Whether the event was generated from the keypad (default: false)." },\n                    { "name": "isSystemKey", "type": "boolean", "optional": true, "description": "Whether the event was a system key event (default: false)." }\n                ],\n                "description": "Dispatches a key event to the page."\n            },\n            {\n                "name": "dispatchMouseEvent",\n                "parameters": [\n                    { "name": "type", "type": "string", "enum": ["mousePressed", "mouseReleased", "mouseMoved"], "description": "Type of the mouse event." },\n                    { "name": "x", "type": "integer", "description": "X coordinate of the event relative to the main frame\'s viewport."},\n                    { "name": "y", "type": "integer", "description": "Y coordinate of the event relative to the main frame\'s viewport. 0 refers to the top of the viewport and Y increases as it proceeds towards the bottom of the viewport."},\n                    { "name": "modifiers", "type": "integer", "optional": true, "description": "Bit field representing pressed modifier keys. Alt=1, Ctrl=2, Meta/Command=4, Shift=8 (default: 0)." },\n                    { "name": "timestamp", "type": "number", "optional": true, "description": "Time at which the event occurred. Measured in UTC time in seconds since January 1, 1970 (default: current time)." },\n                    { "name": "button", "type": "string", "enum": ["none", "left", "middle", "right"], "optional": true, "description": "Mouse button (default: \\"none\\")." },\n                    { "name": "clickCount", "type": "integer", "optional": true, "description": "Number of times the mouse button was clicked (default: 0)." },\n                    { "name": "deviceSpace", "type": "boolean", "optional": true, "hidden": true, "description": "If true, x and y are given in dip wrt current viewport." }\n                ],\n                "description": "Dispatches a mouse event to the page."\n            },\n            {\n                "name": "dispatchTouchEvent",\n                "hidden": true,\n                "parameters": [\n                    { "name": "type", "type": "string", "enum": ["touchStart", "touchEnd", "touchMove"], "description": "Type of the touch event." },\n                    { "name": "touchPoints", "type": "array", "items": { "$ref": "TouchPoint" }, "description": "Touch points." },\n                    { "name": "modifiers", "type": "integer", "optional": true, "description": "Bit field representing pressed modifier keys. Alt=1, Ctrl=2, Meta/Command=4, Shift=8 (default: 0)." },\n                    { "name": "timestamp", "type": "number", "optional": true, "description": "Time at which the event occurred. Measured in UTC time in seconds since January 1, 1970 (default: current time)." }\n                ],\n                "description": "Dispatches a touch event to the page."\n            },\n            {\n                "name": "dispatchGestureEvent",\n                "hidden": true,\n                "parameters": [\n                    { "name": "type", "type": "string", "enum": ["scrollBegin", "scrollEnd", "scrollUpdate", "tapDown", "tap", "pinchBegin", "pinchEnd", "pinchUpdate"], "description": "Type of the gesture event." },\n                    { "name": "x", "type": "integer", "description": "X coordinate relative to the screen\'s viewport."},\n                    { "name": "y", "type": "integer", "description": "Y coordinate relative to the screen\'s viewport."},\n                    { "name": "timestamp", "type": "number", "optional": true, "description": "Time at which the event occurred. Measured in UTC time in seconds since January 1, 1970 (default: current time)." },\n                    { "name": "deltaX", "type": "integer", "optional": true, "description": "Delta X where apllies."},\n                    { "name": "deltaY", "type": "integer", "optional": true, "description": "Delta Y where apllies."},\n                    { "name": "pinchScale", "type": "number", "optional": true, "description": "Pinch scale." }\n                ],\n                "description": "Dispatches a gesture event to the page."\n            }\n        ],\n        "events": []\n    },\n    {\n        "domain": "LayerTree",\n        "hidden": true,\n        "types": [\n            {\n                "id": "LayerId",\n                "type": "string",\n                "description": "Unique RenderLayer identifier."\n            },\n            {\n                "id": "Layer",\n                "type": "object",\n                "description": "Information about a compositing layer.",\n                "properties": [\n                    { "name": "layerId", "$ref": "LayerId", "description": "The unique id for this layer." },\n                    { "name": "parentLayerId", "$ref": "LayerId", "optional": true, "description": "The id of parent (not present for root)." },\n                    { "name": "nodeId", "$ref": "DOM.NodeId", "optional": true, "description": "The id for the node associated with this layer." },\n                    { "name": "offsetX", "type": "number", "description": "Offset from parent layer, X coordinate." },\n                    { "name": "offsetY", "type": "number", "description": "Offset from parent layer, X coordinate." },\n                    { "name": "width", "type": "number", "description": "Layer width." },\n                    { "name": "height", "type": "number", "description": "Layer height." },\n                    { "name": "transform", "type": "array", "items": { "type": "number" }, "minItems": 16, "maxItems": 16, "optional": true, "description": "Transformation matrix for layer, default is identity matrix" },\n                    { "name": "anchorX", "type": "number", "optional": true, "description": "Transform anchor point X, absent if no transform specified" },\n                    { "name": "anchorY", "type": "number", "optional": true, "description": "Transform anchor point Y, absent if no transform specified" },\n                    { "name": "anchorZ", "type": "number", "optional": true, "description": "Transform anchor point Z, absent if no transform specified" },\n                    { "name": "paintCount", "type": "integer", "description": "Indicates how many time this layer has painted." },\n                    { "name": "invisible", "type": "boolean", "optional": true, "description": "Set if layer is not visible." }\n                ]\n            }\n        ],\n        "commands": [\n            {\n                "name": "enable",\n                "description": "Enables compositing tree inspection."\n            },\n            {\n                "name": "disable",\n                "description": "Disables compositing tree inspection."\n            },\n            {\n                "name": "getLayers",\n                "parameters": [\n                    { "name": "nodeId", "optional": true, "$ref": "DOM.NodeId", "description": "Root of the subtree for which we want to gather layers (return entire tree if not specified)" }\n                ],\n                "description": "Returns the layer tree structure of the current page.",\n                "returns": [\n                    { "name": "layers", "type": "array", "items": { "$ref": "Layer" }, "description": "Child layers." }\n                ]\n            },\n            {\n                "name": "compositingReasons",\n                "parameters": [\n                    { "name": "layerId", "$ref": "LayerId", "description": "The id of the layer for which we want to get the reasons it was composited." }\n                ],\n                "description": "Provides the reasons why the given layer was composited.",\n                "returns": [\n                    { "name": "compositingReasons", "type": "array", "items": { "type": "string" }, "description": "A list of strings specifying reasons for the given layer to become composited." }\n                ]\n            }\n        ],\n        "events": [\n            {\n                "name": "layerTreeDidChange"\n            }\n        ]\n    },\n    {\n        "domain": "Tracing",\n        "hidden": true,\n        "commands": [\n            {\n                "name": "start",\n                "description": "Strart trace events collection.",\n                "parameters": [\n                    { "name": "categories", "type": "string", "description": "Category/tag filter" }\n                ]\n            },\n            {\n                "name": "end",\n                "description": "Stop trace events collection."\n            }\n        ],\n        "events": [\n            {\n                "name": "dataCollected",\n                "parameters": [\n                    { "name": "value", "type": "array", "items": { "type": "object" } }\n                ]\n            },\n            {\n                "name": "tracingComplete"\n            }\n        ]\n    }]\n}'
}),define("LiveDevelopment/Inspector/Inspector",["require","exports","module","utils/Async","utils/EventDispatcher","text!LiveDevelopment/Inspector/Inspector.json"],function(e,t){"use strict";function n(e,t){return void 0===t&&console.assert(e.optional===!0,"Missing argument: "+e.name),!0}function r(e,t){if(!v)return console.log("You must connect to the WebSocket before sending messages."),(new $.Deferred).reject().promise();var r,i,o,a,s,l,c={};if(o=Array.prototype.slice.call(arguments,2),"function"==typeof o[o.length-1])i=o.pop();else{var u=new $.Deferred;s=u.promise(),i=function(e,t){t?u.reject(t):u.resolve(e)}}if(r=S++,t)for(a in t)n(o[a],t[a])&&(c[t[a].name]=o[a]);return l={method:e,id:r,params:c},b[r]={callback:i,message:l},v.send(JSON.stringify(l)),s}function i(e,t,n){return r(e+"."+t,null,n)}function o(){v=void 0,t.trigger("disconnect")}function a(e){y&&(y.reject(),y=null),t.trigger("error",e)}function s(){y&&(y.resolve(),y=null),t.trigger("connect")}function l(e){var n=JSON.parse(e.data),r=b[n.id],i=r&&r.callback,o=r&&r.message||"No message";if(r)i(n.result,n.error),delete b[n.id];else if(n.method){var a=n.method.split("."),s=a[0],l=a[1];E.triggerWithArray(t[s],l,n.params)}t.trigger("message",n),n.error&&t.trigger("error",n.error,o)}function c(e,t){e||(e="127.0.0.1"),t||(t=9222);var n=new $.Deferred,r=new XMLHttpRequest;return r.open("GET","http://"+e+":"+t+"/json"),r.onload=function(){var e=JSON.parse(r.response);n.resolve(e)},r.onerror=function(){n.reject(r.response)},r.send(null),n.promise()}function u(){var e=new $.Deferred,t=e.promise();return v&&v.readyState===WebSocket.OPEN?(v.onclose=function(){o(),e.resolve()},t=_.withTimeout(t,5e3),v.close()):(v&&(delete v.onmessage,delete v.onopen,delete v.onclose,delete v.onerror,v=void 0),e.resolve()),t}function d(e){u().done(function(){v=new WebSocket(e),v.onmessage=l,v.onopen=s,v.onclose=o,v.onerror=a})}function p(e){y&&y.reject("CANCEL");var t=new $.Deferred;y=t;var n=c();return n.done(function(n){var r,i;for(r in n)if(i=n[r],i.webSocketDebuggerUrl&&0===i.url.indexOf(e))return void d(i.webSocketDebuggerUrl);t.reject(FileError.ERR_NOT_FOUND)}),n.fail(function(e){t.reject(e)}),t.promise()}function h(){return void 0!==v&&v.readyState===WebSocket.OPEN}function f(){return I}function m(e){I=e}function g(n){t.config=n;var i,o,a,s,l=e("text!LiveDevelopment/Inspector/Inspector.json"),c=JSON.parse(l);for(i in c.domains){a=c.domains[i];var u={};t[a.domain]=u,E.makeEventDispatcher(u);for(o in a.commands)s=a.commands[o],u[s.name]=r.bind(void 0,a.domain+"."+s.name,s.parameters)}}var v,y,_=e("utils/Async"),E=e("utils/EventDispatcher"),b={},S=1,I="";E.makeEventDispatcher(t),t.connect=d,t.connected=h,t.connectToURL=p,t.disconnect=u,t.getDebuggableWindows=c,t.getUserAgent=f,t.init=g,t.send=i,t.setUserAgent=m}),define("text!widgets/StatusBar.html",[],function(){return'<div id="status-bar" class="statusbar no-focus">\n    <div id="status-info" class="info" >\n        <div id="status-cursor"></div>\n        <div id="status-file"></div>\n    </div>\n    <div id="status-indicators" class="indicators">\n        <div id="status-indent">\n            <div id="indent-type"></div>\n            <div id="indent-width-label"></div>\n            <input id="indent-width-input" type="number" min="1" max="10" maxlength="2" size="2" class="hidden">\n        </div>\n        <div id="status-language"></div>\n        <div id="status-overwrite">{{STATUSBAR_INSERT}}</div>\n        <div class="spinner"></div>\n    </div>\n</div>\n'}),define("widgets/StatusBar",["require","exports","module","utils/AppInit","text!widgets/StatusBar.html","strings","view/WorkspaceManager"],function(e,t){"use strict";function n(e){return S?(e&&(I=!0,$("*").addClass("busyCursor")),void v.addClass("spin")):void console.error("StatusBar API invoked before status bar created")}function r(){return S?(I&&(I=!1,$("*").removeClass("busyCursor")),void v.removeClass("spin")):void console.error("StatusBar API invoked before status bar created")}function i(e,t,n,r,i,o){if(!S)return void console.error("StatusBar API invoked before status bar created");t=t||document.createElement("div"),i=i||"",r=r||"",e=e.replace(w,"-")||"";var a=$(t);if(a.attr("id",e),a.attr("title",i),a.addClass("indicator"),a.addClass(r),n||a.hide(),o&&$("#"+o).length>0)a.insertAfter("#"+o);else{var s=$("#status-bar .spinner");a.insertBefore(s)}}function o(e,t,n,r){if(!S)return void console.error("StatusBar API invoked before status bar created");var i=$("#"+e.replace(w,"-"));i&&(t?i.show():i.hide(),n?(i.removeClass(),i.addClass(n)):(i.removeClass(),i.addClass("indicator")),r&&i.attr("title",r))}function a(){f.css("display","none")}function s(){f.css("display","")}function l(){g.css("display","none")}function c(){g.css("display","")}function u(){a(),l()}function d(){s(),c()}function p(){return S?void(m.is(":visible")&&(m.hide(),b.recomputeLayout())):void console.error("StatusBar API invoked before status bar created")}function h(){return S?void(m.is(":visible")||(m.show(),b.recomputeLayout())):void console.error("StatusBar API invoked before status bar created")}var f,m,g,v,y=e("utils/AppInit"),_=e("text!widgets/StatusBar.html"),E=e("strings"),b=e("view/WorkspaceManager"),S=!1,I=!1,w=new RegExp("[^a-zA-Z 0-9]+","g");y.htmlReady(function(){var e=$(".main-view .content");e.append(Mustache.render(_,E)),m=$("#status-bar"),g=$("#status-indicators"),v=$("#status-bar .spinner"),f=$("#status-info"),S=!0,p()}),t.hideInformation=a,t.showInformation=s,t.showBusyIndicator=n,t.hideBusyIndicator=r,t.hideIndicators=l,t.showIndicators=c,t.hideAllPanes=u,t.showAllPanes=d,t.addIndicator=i,t.updateIndicator=o,t.hide=p,t.show=h}),define("document/DocumentCommandHandlers",["require","exports","module","utils/AppInit","command/CommandManager","command/Commands","utils/DeprecationWarning","project/ProjectManager","document/DocumentManager","view/MainViewManager","editor/EditorManager","filesystem/FileSystem","filesystem/FileSystemError","file/FileUtils","project/FileViewController","document/InMemoryFile","utils/StringUtils","utils/Async","widgets/Dialogs","widgets/DefaultDialogs","strings","widgets/PopUpManager","preferences/PreferencesManager","utils/PerfUtils","utils/KeyEvent","LiveDevelopment/Inspector/Inspector","command/Menus","utils/UrlParams","widgets/StatusBar","view/WorkspaceManager","thirdparty/lodash"],function(e,t){"use strict";function n(){var e=Z.getCurrentDocument(),t=brackets.config.app_title,n=et.getCurrentlyViewedPath(et.ACTIVE_PANE);if(!brackets.nativeMenus){n?(St.text(Ct),St.attr("title",n),e?It.css("visibility",e.isDirty?"visible":"hidden"):It.css("visibility","hidden")):(St.text(""),St.attr("title",""),It.css("visibility","hidden")),wt.css("width","");var r=St.width();wt.css("width",r);var i=Mt.height();Lt!==i&&(Lt=i,Et.recomputeLayout())}var o=J.getProjectRoot();if(o){var a=o.name;n?(t=st.format(Ot,Ct,a,brackets.config.app_title),e&&e.isDirty&&(t="• "+t)):t=st.format(Tt,a,brackets.config.app_title)}window.document.title=t}function r(e){var t=e.file.fullPath;return e.isUntitled()?t.substring(t.lastIndexOf("/")+1):J.makeProjectRelativeIfPossible(t)}function i(){var e=et.getCurrentlyViewedFile(et.ACTIVE_PANE);if(e){var t=Z.getOpenDocumentForPath(e.fullPath);Ct=t?r(t):J.makeProjectRelativeIfPossible(e.fullPath)}else Ct=null;n()}function o(e,t){var r=Z.getCurrentDocument();r&&t.file.fullPath===r.file.fullPath&&n()}function a(e,t){return ct.showModalDialog(ut.DIALOG_ID_ERROR,dt.ERROR_OPENING_FILE_TITLE,st.format(dt.ERROR_OPENING_FILE,st.breakableUrl(t),it.getFileErrorString(e)))}function s(e,t,n,r){function i(e,t){t&&(et._removeView(n,nt.getFileForPath(t)),et.focusActivePane()),s.reject(e)}function o(e,n){t?i(e,n):a(e,n).done(function(){i(e,n)})}var s=new $.Deferred;if(et.getCurrentlyViewedPath(et.ACTIVE_PANE)===e)return s.resolve(et.getCurrentlyViewedFile(et.ACTIVE_PANE)),s.promise();if(!e)throw new Error("_doOpen() called without fullPath");var l=ft.markStart("Open File:	"+e);s.always(function(){ft.addMeasurement(l)});var c=nt.getFileForPath(e);return et._open(n,c,r).done(function(){s.resolve(c)}).fail(function(t){o(t,e),s.reject()}),s.promise()}function l(e,t,n,r){var i;return n=n||et.ACTIVE_PANE,e?i=s(e,t,n,r):(i=new $.Deferred,Pt||(Pt=J.getProjectRoot().fullPath),nt.showOpenDialog(!0,!1,dt.OPEN_FILE,Pt,null,function(e,o){if(!e)if(o.length>0){var a=[];o.forEach(function(e){a.push(nt.getFileForPath(e))}),et.addListToWorkingSet(n,a),s(o[o.length-1],t,n,r).done(function(){Pt=it.getDirectoryPath(et.getCurrentlyViewedPath(n))}).then(i.resolve,i.reject)}else i.reject()})),i.promise()}function c(e){var t={path:e,line:null,column:null};if(e){var n=/(.+?):([0-9]+)(:([0-9]+))?$/.exec(e);n&&(t.path=n[1],n[2]&&(t.line=parseInt(n[2],10)),n[4]&&(t.column=parseInt(n[4],10)))}return t}function u(e){var t=c(e?e.fullPath:null),n=e&&e.silent||!1,r=e&&e.paneId||et.ACTIVE_PANE,i=new $.Deferred;return l(t.path,n,r,e&&e.options).done(function(n){e&&e.options&&e.options.noPaneActivate||et.setActivePaneId(r),null!==t.line&&((null===t.column||t.column<=0)&&(t.column=1),tt.getCurrentFullEditor().setCursorPos(t.line-1,t.column-1,!0)),i.resolve(n)}).fail(function(e){i.reject(e)}),i}function d(e){var t=new $.Deferred;return u(e).done(function(e){var n=Z.getOpenDocumentForPath(e.fullPath);t.resolve(n)}).fail(function(e){t.reject(e)}),t.promise()}function p(e){return u(e).done(function(t){var n=e&&e.paneId||et.ACTIVE_PANE;et.addToWorkingSet(n,t,e.index,e.forceRedraw)})}function h(e){Q.deprecationWarning("Commands.FILE_ADD_TO_WORKING_SET has been deprecated.  Use Commands.CMD_ADD_TO_WORKINGSET_AND_OPEN instead.");var t=new $.Deferred;return p(e).done(function(e){var n=Z.getOpenDocumentForPath(e.fullPath);t.resolve(n)}).fail(function(e){t.reject(e)}),t.promise()}function f(e,t,n){var r=t+"-"+Rt++,i=$.Deferred();if(Rt>9999)i.reject();else{var o=e.fullPath+r,a=n?nt.getDirectoryForPath(o):nt.getFileForPath(o);a.exists(function(o,a){o||a?f(e,t,n).then(i.resolve,i.reject):i.resolve(r)})}return i.promise()}function m(e){function t(t){return J.createNewItem(n,t,!1,e).always(function(){kt=!1})}if(kt)return void J.forceFinishRename();kt=!0;var n,r=J.getSelectedItem();return(!r||r instanceof at)&&(r=J.getProjectRoot()),r.isFile&&(n=nt.getDirectoryForPath(r.parentPath)),n=n||r,f(n,dt.UNTITLED,e).then(t,t.bind(void 0,dt.UNTITLED))}function g(){var e="",t=Z.createUntitledDocument(Rt++,e);return et._edit(et.ACTIVE_PANE,t),(new $.Deferred).resolve(t).promise()}function v(){m(!1)}function y(){m(!0)}function _(e,t){return ct.showModalDialog(ut.DIALOG_ID_ERROR,dt.ERROR_SAVING_FILE_TITLE,st.format(dt.ERROR_SAVING_FILE,st.breakableUrl(t),it.getFileErrorString(e)))}function E(e,t){function n(e){_(e,a.fullPath).done(function(){o.reject(e)})}function r(){ct.showModalDialog(ut.DIALOG_ID_ERROR,dt.EXT_MODIFIED_TITLE,st.format(dt.EXT_MODIFIED_WARNING,st.breakableUrl(e.file.fullPath)),[{className:ct.DIALOG_BTN_CLASS_LEFT,id:ct.DIALOG_BTN_SAVE_AS,text:dt.SAVE_AS},{className:ct.DIALOG_BTN_CLASS_NORMAL,id:ct.DIALOG_BTN_CANCEL,text:dt.CANCEL},{className:ct.DIALOG_BTN_CLASS_PRIMARY,id:ct.DIALOG_BTN_OK,text:dt.SAVE_AND_OVERWRITE}]).done(function(t){t===ct.DIALOG_BTN_CANCEL?o.reject():t===ct.DIALOG_BTN_OK?E(e,!0).then(o.resolve,o.reject):t===ct.DIALOG_BTN_SAVE_AS&&At({doc:e}).then(o.resolve,o.reject)})}function i(){it.writeText(a,e.getText(!0),t).done(function(){e.notifySaved(),o.resolve(a)}).fail(function(e){e===rt.CONTENTS_MODIFIED?r():n(e)})}var o=new $.Deferred,a=e.file;return e.isDirty?e.keepChangesTime?e.file.stat(function(n,r){n||e.keepChangesTime!==r.mtime.getTime()||(t=!0),i()}):i():o.resolve(a),o.always(function(){et.focusActivePane()}),o.promise()}function b(e,t){var n=new $.Deferred;return it.readAsText(e.file).done(function(t,r){e.refreshText(t,r),n.resolve()}).fail(function(r){t?n.resolve():a(r,e.file.fullPath).done(function(){n.reject(r)})}),n.promise()}function S(e,t){function n(n){function i(){var e=tt.getActiveEditor();e&&t&&(e.setSelections(t.selections),e.setScrollPos(t.scrollPos.x,t.scrollPos.y)),a.resolve(s)}function o(){var t;if(ot.getFileSelectionFocus()===ot.PROJECT_MANAGER)t=ot.openAndSelectDocument(n,ot.PROJECT_MANAGER);else{var r=et.findInAllWorkingSets(e.file.fullPath).shift();et._removeView(r.paneId,e.file,!0),t=p({fullPath:n,paneId:r.paneId,index:r.index,forceRedraw:!0})}t.always(function(){i()})}var s;return n===r?void E(e).then(a.resolve,a.reject):(e.isSaving=!0,s=nt.getFileForPath(n),void it.writeText(s,e.getText(!0),!0).done(function(){e.isDirty&&!e.isUntitled()?b(e).always(o):o()}).fail(function(e){_(e,n).done(function(){a.reject(e)})}).always(function(){e.isSaving=!1}))}var r,i,o,a=new $.Deferred;if(e){if(r=e.file.fullPath,e.isUntitled()){var s=et.findInAllWorkingSets(r).shift();s&&et._open(s.paneId,e.file),i=J.getProjectRoot().fullPath}else i=it.getDirectoryPath(r);o=it.getBaseName(r),nt.showSaveDialog(dt.SAVE_FILE_AS,i,o,function(e,t){e?a.reject(e):t?n(t):a.reject(xt)})}else a.reject();return a.promise()}function I(e){var t,n=tt.getActiveEditor(),r=n&&n.document,i=e&&e.doc||r;return i&&!i.isSaving?i.isUntitled()?(i===r&&(t={selections:n.getSelections(),scrollPos:n.getScrollPos()}),S(i,t)):E(i):$.Deferred().reject().promise()}function w(e){var t=!1,n=[];return lt.doSequentially(e,function(e){if(t)return(new $.Deferred).reject().promise();var r=Z.getOpenDocumentForPath(e.fullPath);if(r){var i=I({doc:r});return i.done(function(e){n.push(e)}).fail(function(e){e===xt&&(t=!0)}),i}return n.push(e),(new $.Deferred).resolve().promise()},!1).then(function(){return n})}function C(){return w(et.getWorkingSet(et.ALL_PANES))}function D(){return C()}function T(e){function t(e){r||et._close(o,e)}var n,r,i,o=et.ACTIVE_PANE;e&&(n=e.file,r=e.promptOnly,i=e._forceClose,o=e.paneId||o);var a=new $.Deferred,s=a.promise();if(n||(n=et.getCurrentlyViewedFile(et.ACTIVE_PANE)),!n)return a.resolve(),s;var l=Z.getOpenDocumentForPath(n.fullPath);if(l&&l.isDirty&&!i){var c=it.getBaseName(l.file.fullPath);ct.showModalDialog(ut.DIALOG_ID_SAVE_CLOSE,dt.SAVE_CLOSE_TITLE,st.format(dt.SAVE_CLOSE_MESSAGE,st.breakableUrl(c)),[{className:ct.DIALOG_BTN_CLASS_LEFT,id:ct.DIALOG_BTN_DONTSAVE,text:dt.DONT_SAVE},{className:ct.DIALOG_BTN_CLASS_NORMAL,id:ct.DIALOG_BTN_CANCEL,text:dt.CANCEL},{className:ct.DIALOG_BTN_CLASS_PRIMARY,id:ct.DIALOG_BTN_OK,text:dt.SAVE}]).done(function(e){if(e===ct.DIALOG_BTN_CANCEL)a.reject();else if(e===ct.DIALOG_BTN_OK)I({doc:l}).done(function(e){t(e),a.resolve()}).fail(function(){a.reject()});else if(t(n),r)a.resolve();else{var i=!Z.getOpenDocumentForPath(n.fullPath);b(l,i).then(a.resolve,a.reject)}}),a.always(function(){et.focusActivePane()})}else t(n),et.focusActivePane(),a.resolve();return s}function O(e,t,n){var i=new $.Deferred,o=[];if(e.forEach(function(e){var t=Z.getOpenDocumentForPath(e.fullPath);t&&t.isDirty&&o.push(t)}),0===o.length||n)i.resolve();else if(1===o.length){var a={file:o[0].file,promptOnly:t};T(a).done(function(){i.resolve()}).fail(function(){i.reject()})}else{var s=dt.SAVE_CLOSE_MULTI_MESSAGE+it.makeDialogFileList(bt.map(o,r));ct.showModalDialog(ut.DIALOG_ID_SAVE_CLOSE,dt.SAVE_CLOSE_TITLE,s,[{className:ct.DIALOG_BTN_CLASS_LEFT,id:ct.DIALOG_BTN_DONTSAVE,text:dt.DONT_SAVE},{className:ct.DIALOG_BTN_CLASS_NORMAL,id:ct.DIALOG_BTN_CANCEL,text:dt.CANCEL},{className:ct.DIALOG_BTN_CLASS_PRIMARY,id:ct.DIALOG_BTN_OK,text:dt.SAVE}]).done(function(t){t===ct.DIALOG_BTN_CANCEL?i.reject():t===ct.DIALOG_BTN_OK?w(e).done(function(e){i.resolve(e)}).fail(function(){i.reject()}):i.resolve()})}return i.done(function(n){n=n||e,t||et._closeList(et.ALL_PANES,n)}),i.promise()}function M(e){return O(et.getAllOpenFiles(),e&&e.promptOnly,e&&e._forceClose)}function L(e){return O(e.fileList)}function R(e,t,n){return Ft?(new $.Deferred).reject().promise():Y.execute(X.FILE_CLOSE_ALL,{promptOnly:!0}).done(function(){Ft=!0;try{J.trigger("beforeAppClose")}catch(e){console.error(e)}ht.savePreferences(),t()}).fail(function(){Ft=!1,n&&n()})}function N(){Ft=!1}function x(){pt.trigger("beforeMenuPopup")}function A(e){return R(e,function(){window.close()},function(){brackets.app.abortQuit()})}function P(){var e=J.getContext();e||(e=et.getCurrentlyViewedFile()),e&&J.renameItemInline(e)}function k(e){return R(e,function(){brackets.app.quit()},function(){brackets.app.abortQuit()})}function F(e){e.keyCode===mt.DOM_VK_CONTROL&&(et.endTraversal(),Ut=!1,$(window.document.body).off("keyup",F))}function U(e){var t=et.traverseToNextViewByMRU(e);if(t){var n=t.file,r=t.paneId;et.beginTraversal(),Y.execute(X.FILE_OPEN,{fullPath:n.fullPath,paneId:r}),Ut||(Ut=!0,$(window.document.body).keyup(F))}}function j(){U(1)}function V(){U(-1)}function B(){J.showInTree(et.getCurrentlyViewedFile(et.ACTIVE_PANE))}function H(){var e=J.getSelectedItem();e.isDirectory?ct.showModalDialog(ut.DIALOG_ID_EXT_DELETED,dt.CONFIRM_FOLDER_DELETE_TITLE,st.format(dt.CONFIRM_FOLDER_DELETE,st.breakableUrl(e.name)),[{className:ct.DIALOG_BTN_CLASS_NORMAL,id:ct.DIALOG_BTN_CANCEL,text:dt.CANCEL},{className:ct.DIALOG_BTN_CLASS_PRIMARY,id:ct.DIALOG_BTN_OK,text:dt.DELETE}]).done(function(t){t===ct.DIALOG_BTN_OK&&J.deleteItem(e)}):J.deleteItem(e)}function W(){var e=J.getSelectedItem();e&&brackets.app.showOSFolder(e.fullPath,function(t){t&&console.error("Error showing '"+e.fullPath+"' in OS folder:",t)})}function G(){var e=new $.Deferred;if(brackets.inBrowser)e.resolve();else{var t=brackets.app.getRemoteDebuggingPort?brackets.app.getRemoteDebuggingPort():9234;gt.getDebuggableWindows("127.0.0.1",t).fail(e.reject).done(function(t){var n=t[0];if(!n||!n.webSocketDebuggerUrl)return void e.reject();var r=new WebSocket(n.webSocketDebuggerUrl);r.onopen=function(){r.send(JSON.stringify({id:1,method:"Network.setCacheDisabled",params:{cacheDisabled:!0}}))},r.onmessage=function(){r.close(),e.resolve()},r.onerror=e.reject})}return e.promise()}function K(e){return Nt?void 0:(Nt=!0,Y.execute(X.FILE_CLOSE_ALL,{promptOnly:!0}).done(function(){try{J.trigger("beforeAppClose")}catch(t){console.error(t)}G().always(function(){bt.forEach(vt.getAllMenus(),function(e,t){vt.removeMenu(t)});var t=e.indexOf("#");-1!==t&&(e=e.substr(0,t)),window.location.href=e})}).fail(function(){Nt=!1}))}function q(e){var t=window.location.href,n=new yt;n.parse(),e?n.get("reloadWithoutUserExts")||n.put("reloadWithoutUserExts",!0):n.get("reloadWithoutUserExts")&&n.remove("reloadWithoutUserExts"),-1!==t.indexOf("?")&&(t=t.substring(0,t.indexOf("?"))),n.isEmpty()||(t+="?"+n.toString()),window.setTimeout(function(){K(t)},100)}var z=e("utils/AppInit"),Y=e("command/CommandManager"),X=e("command/Commands"),Q=e("utils/DeprecationWarning"),J=e("project/ProjectManager"),Z=e("document/DocumentManager"),et=e("view/MainViewManager"),tt=e("editor/EditorManager"),nt=e("filesystem/FileSystem"),rt=e("filesystem/FileSystemError"),it=e("file/FileUtils"),ot=e("project/FileViewController"),at=e("document/InMemoryFile"),st=e("utils/StringUtils"),lt=e("utils/Async"),ct=e("widgets/Dialogs"),ut=e("widgets/DefaultDialogs"),dt=e("strings"),pt=e("widgets/PopUpManager"),ht=e("preferences/PreferencesManager"),ft=e("utils/PerfUtils"),mt=e("utils/KeyEvent"),gt=e("LiveDevelopment/Inspector/Inspector"),vt=e("command/Menus"),yt=e("utils/UrlParams").UrlParams,_t=e("widgets/StatusBar"),Et=e("view/WorkspaceManager"),bt=e("thirdparty/lodash"),St=null,It=null,wt=null,Ct=null,Dt="mac"===brackets.platform?"—":"-",Tt="{0} "+Dt+" {1}",Ot="{0} ({1}) "+Dt+" {2}",Mt=null,Lt=null,Rt=1,Nt=!1,xt={userCanceled:!0};ht.definePreference("defaultExtension","string","");var At,Pt=null,kt=!1;At=function(e){var t,n=null;if(e)n=e.doc;else{var r=tt.getActiveEditor();r&&(n=r.document,t={},t.selections=r.getSelections(),t.scrollPos=r.getScrollPos())}return S(n,t)};var Ft=!1,Ut=!1,jt=bt.partial(q,!0);z.htmlReady(function(){var e=new yt,t=$("#toolbar-extension-manager"),n=$("<div>"+dt.STATUSBAR_USER_EXTENSIONS_DISABLED+"</div>");e.parse(),"true"===e.get("reloadWithoutUserExts")&&(Y.get(X.FILE_EXTENSION_MANAGER).setEnabled(!1),t.css({display:"none"}),_t.addIndicator("status-user-exts",n,!0),console.log("Brackets reloaded with extensions disabled")),Mt=$("#titlebar"),wt=$(".title-wrapper",Mt),St=$(".title",wt),It=$(".dirty-dot",wt)}),t._parseDecoratedPath=c;var $t=dt.CMD_QUIT,Vt=dt.CMD_SHOW_IN_OS;"win"===brackets.platform?($t=dt.CMD_EXIT,Vt=dt.CMD_SHOW_IN_EXPLORER):"mac"===brackets.platform&&(Vt=dt.CMD_SHOW_IN_FINDER),t.showFileOpenError=a,Y.register(dt.CMD_ADD_TO_WORKING_SET,X.FILE_ADD_TO_WORKING_SET,h),Y.register(dt.CMD_FILE_OPEN,X.FILE_OPEN,d),Y.register(dt.CMD_ADD_TO_WORKING_SET,X.CMD_ADD_TO_WORKINGSET_AND_OPEN,p),Y.register(dt.CMD_FILE_OPEN,X.CMD_OPEN,u),Y.register(dt.CMD_FILE_NEW_UNTITLED,X.FILE_NEW_UNTITLED,g),Y.register(dt.CMD_FILE_NEW,X.FILE_NEW,v),Y.register(dt.CMD_FILE_NEW_FOLDER,X.FILE_NEW_FOLDER,y),Y.register(dt.CMD_FILE_SAVE,X.FILE_SAVE,I),Y.register(dt.CMD_FILE_SAVE_ALL,X.FILE_SAVE_ALL,D),Y.register(dt.CMD_FILE_SAVE_AS,X.FILE_SAVE_AS,At),Y.register(dt.CMD_FILE_RENAME,X.FILE_RENAME,P),Y.register(dt.CMD_FILE_DELETE,X.FILE_DELETE,H),Y.register(dt.CMD_FILE_CLOSE,X.FILE_CLOSE,T),Y.register(dt.CMD_FILE_CLOSE_ALL,X.FILE_CLOSE_ALL,M),Y.register(dt.CMD_FILE_CLOSE_LIST,X.FILE_CLOSE_LIST,L),Y.register(dt.CMD_NEXT_DOC,X.NAVIGATE_NEXT_DOC,j),Y.register(dt.CMD_PREV_DOC,X.NAVIGATE_PREV_DOC,V),Y.register(Vt,X.NAVIGATE_SHOW_IN_OS,W),Y.register($t,X.FILE_QUIT,k),Y.register(dt.CMD_SHOW_IN_TREE,X.NAVIGATE_SHOW_IN_FILE_TREE,B),Y.registerInternal(X.APP_ABORT_QUIT,N),Y.registerInternal(X.APP_BEFORE_MENUPOPUP,x),Y.registerInternal(X.FILE_CLOSE_WINDOW,A),Y.registerInternal(X.APP_RELOAD,q),Y.registerInternal(X.APP_RELOAD_WITHOUT_EXTS,jt),J.on("projectOpen",n),Z.on("dirtyFlagChange",o),Z.on("fileNameChange",i),et.on("currentFileChange",i),J.on("beforeProjectClose",function(){Rt=1})}),define("text!htmlContent/code-hint-list.html",[],function(){return'{{#hints}}\n    <li>\n        <a href="#">\n            <span class="codehint-item">{{{formattedHint}}}</span>\n        </a>\n    </li>\n{{/hints}}'}),define("editor/CodeHintList",["require","exports","module","command/KeyBindingManager","command/Menus","utils/KeyEvent","utils/StringUtils","utils/ValidationUtils","utils/ViewUtils","widgets/PopUpManager","text!htmlContent/code-hint-list.html"],function(e,t){"use strict";function n(e,t,n){this.hints=[],this.selectedIndex=-1,this.maxResults=s.isIntegerInRange(n,1,1e3)?n:50,this.opened=!1,this.editor=e,this.insertHintOnTab=t,this.pendingText="",this.handleSelect=null,this.handleClose=null,this.$hintMenu=$("<li class='dropdown codehint-menu'></li>").append($("<a href='#' class='dropdown-toggle' data-toggle='dropdown'></a>").hide()).append("<ul class='dropdown-menu'></ul>"),this._keydownHook=this._keydownHook.bind(this)}var r=e("command/KeyBindingManager"),i=e("command/Menus"),o=e("utils/KeyEvent"),a=e("utils/StringUtils"),s=e("utils/ValidationUtils"),l=e("utils/ViewUtils"),c=e("widgets/PopUpManager"),u=e("text!htmlContent/code-hint-list.html");n.prototype._setSelectedIndex=function(e){var t=this.$hintMenu.find("li");if(e=Math.max(-1,Math.min(e,t.length-1)),-1!==this.selectedIndex&&$(t[this.selectedIndex]).find("a").removeClass("highlight"),this.selectedIndex=e,-1!==this.selectedIndex){var n=$(t[this.selectedIndex]),r=this.$hintMenu.find("ul.dropdown-menu");n.find("a").addClass("highlight"),l.scrollElementIntoView(r,n,!1)}},n.prototype.addPendingText=function(e){this.pendingText+=e},n.prototype.removePendingText=function(e){0===this.pendingText.indexOf(e)&&(this.pendingText=this.pendingText.slice(e.length))},n.prototype._buildListView=function(e){var t,n=this,r=e.match,i=e.selectInitial,o={hints:[]};if(this.hints=e.hints,this.hints.handleWideResults=e.handleWideResults,t=r?function(e){var t=e.replace(new RegExp(a.regexEscape(r),"i"),"<strong>$&</strong>");o.hints.push({formattedHint:"<span>"+t+"</span>"})}:function(e){o.hints.push({formattedHint:e.jquery?"":e})},this.$hintMenu.find("li").remove(),0===this.hints.length)this.handleClose&&this.handleClose();else{this.hints.some(function(e,r){return r>=n.maxResults?!0:void t(e)});var s=this.$hintMenu.find("ul.dropdown-menu"),l=s.parent();s.remove().append(Mustache.render(u,o)),s.children("li").each(function(e,t){var r=n.hints[e],i=$(t);i.data("hint",r),r.jquery&&i.find(".codehint-item").append(r)}),s.on("click","li",function(e){e.stopPropagation(),n.handleSelect&&n.handleSelect($(this).data("hint"))}),this.hints.handleWideResults&&s.find("li a").addClass("wide-result"),l.append(s),this._setSelectedIndex(i?0:-1)}},n.prototype._calcHintListLocation=function(){var e=this.editor._codeMirror.cursorCoords(),t=e.bottom,n=e.left,r=this.editor.getTextHeight(),i=$(window),o=this.$hintMenu.children("ul"),a=o.outerHeight(),s=t+a-i.height();s>0&&(t-=r+2+a),t-=30;var l=o.width(),c=l,u=n+l-i.width();return u>0?n=Math.max(0,n-u):this.hints.handleWideResults&&(c=l+Math.abs(u)),{left:n,top:t,width:c}},n.prototype.isHandlingKeyCode=function(e){return e===o.DOM_VK_UP||e===o.DOM_VK_DOWN||e===o.DOM_VK_PAGE_UP||e===o.DOM_VK_PAGE_DOWN||e===o.DOM_VK_RETURN||e===o.DOM_VK_TAB&&this.insertHintOnTab},n.prototype._keydownHook=function(e){function t(e){var t,n=Math.min(i.hints.length,i.maxResults);i.selectedIndex<0?t=e>0?e-1:n-1:(t=i.selectedIndex,t=e>0?t===n-1?0:Math.min(t+e,n-1):0===t?n-1:Math.max(t+e,0)),i._setSelectedIndex(t)}function n(){var e,t=1,n=i.$hintMenu.find("li"),r=i.$hintMenu.find("ul.dropdown-menu");return 0!==n.length&&(e=$(n[0]).height(),e&&(t=Math.floor(r.height()/e),t=Math.max(1,Math.min(t,n.length)))),t}var r,i=this;if(!this.isOpen())return this.handleClose(),!1;if("keydown"===e.type&&this.isHandlingKeyCode(e.keyCode)){if(r=e.keyCode,e.shiftKey&&(e.keyCode===o.DOM_VK_UP||e.keyCode===o.DOM_VK_DOWN||e.keyCode===o.DOM_VK_PAGE_UP||e.keyCode===o.DOM_VK_PAGE_DOWN))return this.handleClose(),!1;if(r===o.DOM_VK_UP)t.call(this,-1);else if(r===o.DOM_VK_DOWN)t.call(this,1);else if(r===o.DOM_VK_PAGE_UP)t.call(this,-n());else if(r===o.DOM_VK_PAGE_DOWN)t.call(this,n());else{if(-1===this.selectedIndex||!(r===o.DOM_VK_RETURN||r===o.DOM_VK_TAB&&this.insertHintOnTab))return!1;if(this.pendingText)return!1;$(this.$hintMenu.find("li")[this.selectedIndex]).trigger("click")}return e.stopImmediatePropagation(),e.preventDefault(),!0}return!1},n.prototype.isOpen=function(){return this.opened&&!this.$hintMenu.hasClass("open")&&(this.opened=!1),this.opened},n.prototype.open=function(e){if(i.closeAll(),this._buildListView(e),this.hints.length){$("#codehint-menu-bar > ul").append(this.$hintMenu);var t=this._calcHintListLocation();this.$hintMenu.addClass("open").css({left:t.left,top:t.top,width:t.width+"px"}),this.opened=!0,c.addPopUp(this.$hintMenu,this.handleClose,!0),r.addGlobalKeydownHook(this._keydownHook)}},n.prototype.update=function(e){if(this.$hintMenu.addClass("apply-transition"),this._buildListView(e),this.hints.length){var t=this._calcHintListLocation();this.$hintMenu.css({left:t.left,top:t.top,width:t.width+"px"})}},n.prototype.close=function(){this.opened=!1,this.$hintMenu&&(this.$hintMenu.removeClass("open"),c.removePopUp(this.$hintMenu),this.$hintMenu.remove()),r.removeGlobalKeydownHook(this._keydownHook)},n.prototype.onSelect=function(e){this.handleSelect=e},n.prototype.onClose=function(e){this.handleClose=e},t.CodeHintList=n}),define("editor/CodeHintManager",["require","exports","module","command/Commands","command/CommandManager","editor/EditorManager","strings","utils/KeyEvent","editor/CodeHintList","preferences/PreferencesManager"],function(e,t){"use strict";function n(e,t){return t.priority-e.priority}function r(e,t,r){var i={provider:e,priority:r||0};if(-1!==t.indexOf("all")){var o;for(o in D)D.hasOwnProperty(o)&&(D[o].push(i),D[o].sort(n))}else t.forEach(function(e){D[e]||(D[e]=Array.prototype.concat(D.all)),D[e].push(i),D[e].sort(n)})}function i(e,t){var n,r,i;i=Array.isArray(t)?t:t?[t]:Object.keys(D),i.forEach(function(t){for(r=D[t],n=0;n<r.length;n++)if(r[n].provider===e){r.splice(n,1);break}})}function o(e){var t=D[e]||D.all;return t.filter(function(e){var t="codehint."+e.provider.constructor.name;return C.get(t)!==!1})}function a(){L&&(L.close(),L=null,N=null,O=null,M=null,R&&(R.reject(),R=null))}function s(e){if(M){if(M===e&&(L.isOpen()||R&&"pending"===R.state()))return!0;a()}return!1}function l(){R&&(R.reject(),R=null);var e=O.getHints(T);if(T=null,e)if(e===!0){var t=M;a(),A(t)}else e.hasOwnProperty("hints")?L.isOpen()?L.update(e):L.open(e):(R=e,e.done(function(e){L&&(L.isOpen()?L.update(e):L.open(e))}));else a()}function c(e){e||(e=b.getFocusedEditor()),e&&(T=null,s(e)&&a(),A(e))}function u(e,t,n){N=t,n.ctrlKey||n.altKey||n.metaKey||n.keyCode!==I.DOM_VK_ENTER&&n.keyCode!==I.DOM_VK_RETURN&&n.keyCode!==I.DOM_VK_TAB||(T=String.fromCharCode(n.keyCode))}function d(e,t,n){N=t,T=String.fromCharCode(n.charCode),L&&L.addPendingText(T)}function p(e,t,n){N=t,s(t)&&(n.keyCode===I.DOM_VK_HOME||n.keyCode===I.DOM_VK_END?a():(n.keyCode===I.DOM_VK_LEFT||n.keyCode===I.DOM_VK_RIGHT||n.keyCode===I.DOM_VK_BACK_SPACE)&&l())}function h(e,t){s(t)&&t.getSelections().length>1&&a()}function f(e,t,n){if(T&&t===N){if(N=null,s(t)){var r=T;l(),s(t)||(T=r,A(t))}else A(t);if(L&&n[0]&&n[0].text.length&&n[0].text[0].length){var i=t.getCursorPos().ch-n[0].from.ch,o=n[0].text[0];o.length>i&&(o=o.substr(0,i)),L.removePendingText(o)}}}function m(e,t){return e&&e===t}function g(){return L&&L.isOpen()}function v(){return L}function y(e,t,n){t&&(t.on("editorChange",f),t.on("keydown",u),t.on("keypress",d),t.on("keyup",p),t.on("cursorActivity",h)),n&&(n.off("editorChange",f),n.off("keydown",u),n.off("keypress",d),n.off("keyup",p),n.off("cursorActivity",h))}var _=e("command/Commands"),E=e("command/CommandManager"),b=e("editor/EditorManager"),S=e("strings"),I=e("utils/KeyEvent"),w=e("editor/CodeHintList").CodeHintList,C=e("preferences/PreferencesManager"),D={all:[]},T=null,O=null,M=null,L=null,R=null,N=null,x=!0;C.definePreference("showCodeHints","boolean",!0),C.definePreference("insertHintOnTab","boolean",!1),C.definePreference("maxCodeHints","integer",50),C.on("change","showCodeHints",function(){x=C.get("showCodeHints")});var A;A=function(e){if(x&&!(e.getSelections().length>1)){var t=e.getLanguageForSelection(),n=o(t.getId());if(n.some(function(t){return t.provider.hasHints(e,T)?(O=t.provider,!0):void 0}),O){var r,i=C.get("maxCodeHints");r=void 0!==O.insertHintOnTab?O.insertHintOnTab:C.get("insertHintOnTab"),M=e,L=new w(M,r,i),L.onSelect(function(e){var t=O.insertHint(e),n=M;a(),t&&A(n)}),L.onClose(a),l()}else T=null}},y(null,b.getActiveEditor(),null),b.on("activeEditorChange",y),E.on("beforeExecuteCommand",a),E.register(S.CMD_SHOW_CODE_HINTS,_.SHOW_CODE_HINTS,c),t._getCodeHintList=v,t._removeHintProvider=i,t.isOpen=g,t.registerHintProvider=r,t.hasValidExclusion=m}),define("text!htmlContent/main-view.html",[],function(){return'<!-- \n  Copyright (c) 2012 Adobe Systems Incorporated. All rights reserved.\n   \n  Permission is hereby granted, free of charge, to any person obtaining a\n  copy of this software and associated documentation files (the "Software"), \n  to deal in the Software without restriction, including without limitation \n  the rights to use, copy, modify, merge, publish, distribute, sublicense, \n  and/or sell copies of the Software, and to permit persons to whom the \n  Software is furnished to do so, subject to the following conditions:\n   \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n   \n  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \n  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER \n  DEALINGS IN THE SOFTWARE.\n-->\n\n\n<!--\n    HTML template for the body tag of index.html. It is rendered dynamically in\n    brackets.js with Mustache and localized with the i18n RequireJS plugin.\n\n    LOCALIZATION NOTE:\n    All display text for this file must use templating so the text can be localized.\n    \n    English text goes in src/nls/root/strings.js. All other translations go in the strings.js file for\n    the specific local in the nls folder. If a translation is missing for a specific key English\n    is used as a fallback\n\n    Strings should be referenced using the double brackets syntax.\n    Example: {{keyname}}. Note, all strings are HTML escaped unless the form \n    {{&keyname}} is used.\n\n-->\n\n    <!-- Main UI: horizontal set of sidebar, main content vertical stack, and vertical toolbar -->\n    <div class="main-view">\n        <div id="sidebar" class="sidebar panel quiet-scrollbars horz-resizable right-resizer collapsible" data-minsize="0" data-forceleft=".content">\n            <div class="working-set-splitview-btn btn-alt-quiet"></div>\n            <div class="working-set-option-btn btn-alt-quiet"></div>\n            \n            <div id="working-set-list-container">\n                \n            </div>\n            <div id="project-files-header">\n                <span id="project-title" class="title"></span>\n            </div>\n            <div id="project-files-container">\n                <!-- This will contain a dynamically generated <ul> hierarchy at runtime -->\n            </div>\n        </div>\n        \n        <!--\n            Vertical stack of titlebar (in-browser), editor, bottom panels, status bar\n                (status bar is injected later - see StatusBar.init()).\n            Note: all children must be in a vertical stack with heights explicitly set in a fixed\n                unit such as px (not percent/em/auto). If you change the height later, you must\n                call WorkspaceManager.recomputeLayout() each time. Otherwise the layout will\n                not get set correctly. Use WorkspaceManager to have this managed for you automatically.\n         -->\n        <div class="content">\n            <!-- Horizontal titlebar containing menus & filename when inBrowser -->\n            <div id="titlebar" class="toolbar no-focus">\n                <!-- Menu bar -->\n                <ul class="nav" data-dropdown="dropdown">\n                </ul>\n                \n                <!-- Filename label -->\n                <div class="title-wrapper">\n                    <span class="title"></span>&nbsp;<span class=\'dirty-dot\' style="visibility:hidden;">•</span>\n                </div>\n            </div>\n            \n            <div id="editor-holder">\n                <!-- View Panes are programatically created here -->\n            </div>\n            \n            <!-- Bottom panels and status bar are programmatically created here -->\n            \n        </div>\n\n        <!-- Vertical toolbar docked to right -->\n        <div id="main-toolbar" class="toolbar no-focus">\n            <!-- Top-aligned buttons -->\n            <div class="buttons">\n                <a id="toolbar-go-live" href="#"></a> <!-- tooltip for this is set in JS -->\n                <a id="toolbar-extension-manager" title="{{EXTENSION_MANAGER_TITLE}}" href="#"></a>\n                <a id="update-notification" title="{{UPDATE_NOTIFICATION_TOOLTIP}}" href="#" style="display: none"></a>\n            </div>\n            <div class="bottom-buttons"></div>\n        </div>\n        \n        <!-- Hack to ensure that the code editor\'s web font is loaded early. -->\n        <!-- For more info, see note in brackets.less for class .dummy-text, or issue 76 -->\n        <div class="dummy-text">x</div>\n    </div>\n\n    <!-- Modal Windows -->\n    <div id="context-menu-bar">\n        <ul data-dropdown="dropdown"></ul>\n    </div>\n    <div id="codehint-menu-bar">\n        <ul data-dropdown="dropdown"></ul>\n    </div>\n    <div id="hidden-editors"></div>'
}),define("utils/NodeConnection",["require","exports","module","utils/EventDispatcher"],function(e,t,n){"use strict";function r(e,t){var n=setTimeout(function(){e.reject("timeout")},t);e.always(function(){clearTimeout(n)})}function i(){var e=$.Deferred(),t=null,n=null;return r(e,l),brackets.app.getNodeState(function(r,i){!r&&i&&"rejected"!==e.state()?(t=i,n=new WebSocket("ws://localhost:"+t),n.binaryType="arraybuffer",n.onclose=function(){e.reject("WebSocket closed")},n.onopen=function(){n.onclose=null,e.resolveWith(null,[n,t])}):e.reject("brackets.app.getNodeState error: "+r)}),e.promise()}function o(){this.domains={},this._registeredModules=[],this._pendingInterfaceRefreshDeferreds=[],this._pendingCommandDeferreds=[]}var a=e("utils/EventDispatcher"),s=10,l=1e4,c=500,u=4294967295;a.makeEventDispatcher(o.prototype),o.prototype.domains=null,o.prototype._registeredModules=null,o.prototype._ws=null,o.prototype._port=null,o.prototype._commandCount=1,o.prototype._autoReconnect=!1,o.prototype._pendingInterfaceRefreshDeferreds=null,o.prototype._pendingCommandDeferreds=null,o.prototype._getNextCommandID=function(){var e;return e=this._commandCount>u?this._commandCount=0:this._commandCount++},o.prototype._cleanup=function(){if(this.domains={},this._ws&&this._ws.readyState!==WebSocket.CLOSED)try{this._ws.close()}catch(e){}var t=this._pendingInterfaceRefreshDeferreds.concat(this._pendingCommandDeferreds);t.forEach(function(e){e.reject("cleanup")}),this._pendingInterfaceRefreshDeferreds=[],this._pendingCommandDeferreds=[],this._ws=null,this._port=null},o.prototype.connect=function(e){function t(e,t){function n(){r._ws.onclose=function(){if(r._autoReconnect){var e=r.connect(!0);r.trigger("close",e)}else r._cleanup(),r.trigger("close")},o.resolve()}function i(e){r._cleanup(),o.reject(e)}r._ws=e,r._port=t,r._ws.onmessage=r._receive.bind(r),r._refreshInterface().then(function(){r._registeredModules.length>0?r.loadDomains(r._registeredModules,!1).then(n,i):n()},i)}function n(){a++,l=new Date,i().then(t,function(){if(s>a){var e=new Date,t=Math.max(c-(e-l),1);setTimeout(n,t)}else o.reject("Max connection attempts reached")})}var r=this;r._autoReconnect=e;var o=$.Deferred(),a=0,l=null;return r._cleanup(),n(),o.promise()},o.prototype.connected=function(){return!(!this._ws||this._ws.readyState!==WebSocket.OPEN)},o.prototype.disconnect=function(){this._autoReconnect=!1,this._cleanup()},o.prototype.loadDomains=function(e,t){var n=$.Deferred();r(n,l);var i=e;return Array.isArray(e)||(i=[e]),t&&Array.prototype.push.apply(this._registeredModules,i),this.domains.base&&this.domains.base.loadDomainModulesFromPaths?(this.domains.base.loadDomainModulesFromPaths(i).then(function(e){e||n.reject("loadDomainModulesFromPaths failed")},function(e){n.reject("Unable to load one of the modules: "+i+(e?", reason: "+e:""))}),this._pendingInterfaceRefreshDeferreds.push(n)):n.reject("this.domains.base is undefined"),n.promise()},o.prototype._send=function(e){if(this.connected()){var t=null;if("string"==typeof e)t=e;else try{t=JSON.stringify(e)}catch(n){console.error("[NodeConnection] Unable to stringify message in order to send: "+n.message)}if(t)try{this._ws.send(t)}catch(r){console.error("[NodeConnection] Error sending message: "+r.message)}}else console.error("[NodeConnection] Not connected to node, unable to send.")},o.prototype._receive=function(e){var t,n=null,r=e.data;if(e.data instanceof ArrayBuffer){if(r.byteLength<4)return void console.error("[NodeConnection] received malformed binary message");var i=r.slice(0,4),o=r.slice(4),s=new Uint32Array(i),l=s[0];t={type:"commandResponse",message:{id:l,response:o}}}else try{t=JSON.parse(r)}catch(c){return void console.error("[NodeConnection] received malformed message",e,c.message)}switch(t.type){case"event":"base"===t.message.domain&&"newDomains"===t.message.event&&this._refreshInterface(),a.triggerWithArray(this,t.message.domain+":"+t.message.event,t.message.parameters);break;case"commandResponse":n=this._pendingCommandDeferreds[t.message.id],n&&(n.resolveWith(this,[t.message.response]),delete this._pendingCommandDeferreds[t.message.id]);break;case"commandError":n=this._pendingCommandDeferreds[t.message.id],n&&(n.rejectWith(this,[t.message.message,t.message.stack]),delete this._pendingCommandDeferreds[t.message.id]);break;case"error":console.error("[NodeConnection] received error: "+t.message.message);break;default:console.error("[NodeConnection] unknown event type: "+t.type)}},o.prototype._refreshInterface=function(){function e(e){function r(e,t){return function(){var r=$.Deferred(),i=Array.prototype.slice.call(arguments,0),o=n._getNextCommandID();return n._pendingCommandDeferreds[o]=r,n._send({id:o,domain:e,command:t.name,parameters:i}),r}}n.domains={},n.domainEvents={},e.forEach(function(e){n.domains[e.domain]={},e.commands.forEach(function(t){n.domains[e.domain][t.name]=r(e.domain,t)}),n.domainEvents[e.domain]={},e.events.forEach(function(t){var r=t.parameters;n.domainEvents[e.domain][t.name]=r})}),t.resolve()}var t=$.Deferred(),n=this,r=this._pendingInterfaceRefreshDeferreds;return this._pendingInterfaceRefreshDeferreds=[],t.then(function(){r.forEach(function(e){e.resolve()})},function(e){r.forEach(function(t){t.reject(e)})}),this.connected()?$.getJSON("http://localhost:"+this._port+"/api").done(e).fail(function(e){t.reject(e)}):t.reject("Attempted to call _refreshInterface when not connected."),t.promise()},o._getConnectionTimeout=function(){return l},n.exports=o}),define("extensibility/Package",["require","exports","module","utils/AppInit","filesystem/FileSystem","file/FileUtils","utils/StringUtils","strings","utils/ExtensionLoader","utils/NodeConnection","preferences/PreferencesManager"],function(e,t,n){"use strict";function r(e){return I.domains.extensionManager?e(I.domains.extensionManager):(new $.Deferred).reject("extensionManager domain is undefined").promise()}function i(e,t){return r(function(n){var r=new $.Deferred;return n.validate(e,t).done(function(e){r.resolve({errors:e.errors,metadata:e.metadata})}).fail(function(e){r.reject(e)}),r.promise()})}function o(e,t,n){return r(function(r){var i=new $.Deferred,o=E.getUserExtensionPath(),a=o.replace(/\/user$/,"/disabled"),s=v.getNativeBracketsDirectoryPath()+"/extensions/default/",l=n?"update":"install";return r[l](e,o,{disabledDirectory:a,systemExtensionDirectory:s,apiVersion:brackets.metadata.apiVersion,nameHint:t}).done(function(e){e.keepFile=!1,e.installationStatus!==C.INSTALLED||n?i.resolve(e):E.loadExtension(e.name,{baseUrl:v.convertWindowsPathToUnixPath(e.installedTo)},"main").then(function(){i.resolve(e)},function(){i.reject(w.ERROR_LOADING)})}).fail(function(e){i.reject(e)}),i.promise()})}function a(e){if("github.com"===e.parsed.hostname||"www.github.com"===e.parsed.hostname){var t=/^\/[^\/?]+\/([^\/?]+)(\/?)$/.exec(e.parsed.pathname);t?(t[2]||(e.url+="/"),e.url+="archive/master.zip",e.filenameHint=t[1]+".zip"):(t=/^\/[^\/?]+\/([^\/?]+)\/archive\/master.zip$/.exec(e.parsed.pathname),t&&(e.filenameHint=t[1]+".zip"))}}function s(e,t){return r(function(n){var r=new $.Deferred,i=PathUtils.parseUrl(e);if(!i.hostname)return r.reject(w.MALFORMED_URL),r.promise();if("http:"!==i.protocol&&"https:"!==i.protocol)return r.reject(w.UNSUPPORTED_PROTOCOL),r.promise();var o={url:e,parsed:i,filenameHint:i.filename};a(o);var s=o.filenameHint;s=s.replace(/[^a-zA-Z0-9_\- \(\)\.]/g,"_"),s||(s="extension.zip");var l=n.downloadFile(t,o.url,S.get("proxy"));return l.done(function(e){r.resolve({localPath:v.convertWindowsPathToUnixPath(e),filenameHint:o.filenameHint})}).fail(function(e){r.reject(e)}),r.promise()})}function l(e){return r(function(t){return t.abortDownload(e)})}function c(e,t){var n=new $.Deferred;return o(e,t).done(function(e){e.keepFile=!0;var t=e.installationStatus;t===C.ALREADY_INSTALLED||t===C.NEEDS_UPDATE||t===C.SAME_VERSION||t===C.OLDER_VERSION?n.resolve(e):e.errors&&e.errors.length>0?n.reject(e.errors[0]):e.disabledReason?n.reject(e.disabledReason):n.resolve(e)}).fail(function(e){n.reject(e)}),n.promise()}function u(e){var t=1,n=2,r=3,i=4,o=new $.Deferred,a=t,u=T++;return s(e,u).done(function(e){a=n,c(e.localPath,e.filenameHint).done(function(t){var n=t.installationStatus;a=r,t.localPath=e.localPath,t.keepFile=!1,n===C.INSTALLED&&g.getFileForPath(e.localPath).unlink(),o.resolve(t)}).fail(function(t){a=i,g.getFileForPath(e.localPath).unlink(),o.reject(t)})}).fail(function(e){a=i,o.reject(e)}),{promise:o.promise(),cancel:function(){a===t&&l(u)}}}function d(e){function t(e){return _[e]?_[e]:(console.log("Unknown installation error",e),_.UNKNOWN_ERROR)}return Array.isArray(e)?(e[0]=t(e[0]),y.format.apply(window,e)):t(e)}function p(e){return r(function(t){return t.remove(e)})}function h(e,t){var n=new $.Deferred;return o(e,t,!0).done(function(e){e.installationStatus!==C.INSTALLED?n.reject(e.errors):n.resolve(e)}).fail(function(e){n.reject(e)}),n.promise()}function f(){return D}var m=e("utils/AppInit"),g=e("filesystem/FileSystem"),v=e("file/FileUtils"),y=e("utils/StringUtils"),_=e("strings"),E=e("utils/ExtensionLoader"),b=e("utils/NodeConnection"),S=e("preferences/PreferencesManager");S.definePreference("proxy","string",void 0);var I,w={ERROR_LOADING:"ERROR_LOADING",MALFORMED_URL:"MALFORMED_URL",UNSUPPORTED_PROTOCOL:"UNSUPPORTED_PROTOCOL"},C={FAILED:"FAILED",INSTALLED:"INSTALLED",ALREADY_INSTALLED:"ALREADY_INSTALLED",SAME_VERSION:"SAME_VERSION",OLDER_VERSION:"OLDER_VERSION",NEEDS_UPDATE:"NEEDS_UPDATE",DISABLED:"DISABLED"},D=$.Deferred(),T=0;m.appReady(function(){I=new b,I.connect(!0).then(function(){var e=v.getNativeBracketsDirectoryPath()+"/"+v.getNativeModuleDirectoryPath(n)+"/node/ExtensionManagerDomain";I.loadDomains(e,!0).then(function(){D.resolve()},function(){console.error("[Extensions] Failed to connect to node",arguments),D.reject()})})}),t._getNodeConnectionDeferred=f,t.installFromURL=u,t.installFromPath=c,t.validate=i,t.install=o,t.remove=p,t.installUpdate=h,t.formatError=d,t.InstallationStatuses=C}),define("view/ViewCommandHandlers",["require","exports","module","command/Commands","utils/EventDispatcher","command/CommandManager","strings","utils/StringUtils","editor/EditorManager","preferences/PreferencesManager","document/DocumentManager","view/ThemeSettings","view/MainViewManager","utils/AppInit","thirdparty/lodash"],function(e,t,n){"use strict";function r(e){$("#"+e).remove()}function i(e,t,n,i,o){o=o||".CodeMirror";var a=$("<style type='text/css'></style>").attr("id",e),s=N.format("{0}: {1}{2}",t,n,i?" !important":"");a.html(o+"{ "+s+" }"),r(e),$("head").append(a)}function o(){r(B)}function a(e){i(B,"font-size",e,!0)}function s(){r(H)}function l(e){i(H,"font-family",e)}function c(e,t){var n=e._codeMirror.defaultCharWidth(),r=V.get("fontSize"),i=t,o=0,a=0,s=e.getScrollPos(),l=e._codeMirror.lineAtHeight(s.y,"local");o=/em$/.test(r)?10:1,a=parseInt((parseFloat(i)-parseFloat(r))*o,10),a&&e.refreshAll();var c=e._codeMirror.defaultCharWidth(),u=s.x/n,d=s.x+Math.round(u*(c-n)),p=e._codeMirror.heightAtLine(l,"local");e.setScrollPos(d,p)}function u(e){var n=V.get("fontSize");n!==e&&(o(),e&&a(e),j.forEach(F.getPaneIdList(),function(t){var n=F.getCurrentlyViewedPath(t),r=n&&P.getOpenDocumentForPath(n);r&&r._masterEditor&&c(r._masterEditor,e)}),t.trigger("fontSizeChange",e,n),V.set("fontSize",e))}function d(){return V.get("fontSize")}function p(e){var n=x.getCurrentFullEditor(),r=V.get("fontFamily");r!==e&&(s(),e&&l(e),t.trigger("fontFamilyChange",e,r),V.set("fontFamily",e),n&&n.refreshAll())}function h(){return V.get("fontFamily")}function f(e){var t=V.get("fontSize"),n=/^[\d\.]+(px|em)$/;if(-1===t.search(n))return!1;var r=t.substring(t.length-2,t.length),i="px"===r?1:.1,o=parseFloat(t.substring(0,t.length-2)),a=o+i*e,s=a+r;return W*i>a||a>G*i?!1:(u(s),!0)}function m(){f(1)}function g(){f(-1)}function v(){u(K+"px")}function y(){null!==P.getCurrentDocument()?L.get(O.VIEW_INCREASE_FONT_SIZE).getEnabled()||(L.get(O.VIEW_INCREASE_FONT_SIZE).setEnabled(!0),L.get(O.VIEW_DECREASE_FONT_SIZE).setEnabled(!0),L.get(O.VIEW_RESTORE_FONT_SIZE).setEnabled(!0)):(L.get(O.VIEW_INCREASE_FONT_SIZE).setEnabled(!1),L.get(O.VIEW_DECREASE_FONT_SIZE).setEnabled(!1),L.get(O.VIEW_RESTORE_FONT_SIZE).setEnabled(!1))}function _(){l(V.get("fontFamily")),a(V.get("fontSize")),y()}function E(){var e=V.get("fontSize"),t=A.getViewState("fontSizeAdjustment");t&&(A.setViewState("fontSizeAdjustment"),e||(e=K+t+"px",V.set("fontSize",e))),e&&(o(),a(e))}function b(){p(q),u(K+"px")}function S(e,t,n){var r=t/e,i=(t+n)/e,o=Math.ceil(r),a=Math.floor(i)-1;return{first:o,last:a}}function I(e){var t,n,r=x.getCurrentFullEditor(),i=r.getTextHeight(),o=r.getCursorPos(),a=r.hasSelection(),s=r.getInlineWidgets(),l=r._codeMirror.getScrollInfo(),c=r._getLineSpaceElement().offsetTop,u=l.clientHeight,d=l.top-c,p=c;s.forEach(function(e){t=r._getInlineWidgetLineNumber(e),n=r._codeMirror.charCoords({line:t,ch:0},"local"),n.top<l.top?(d-=e.info.height,p+=e.info.height):n.top+e.info.height<l.top+u&&(u-=e.info.height)});var h=S(i,d,u);a||(o.line<h.first?r.setCursorPos({line:h.first+e,ch:o.ch}):o.line>h.last?r.setCursorPos({line:h.last+e,ch:o.ch}):(e>0&&o.line===h.first||0>e&&o.line===h.last)&&r._codeMirror.moveV(e,"line"));var f=h.first+e;r.setScrollPos(l.left,i*f+p)}function w(){I(-1)}function C(){I(1)}function D(){k.showDialog()}function T(e,t){return{fontSizeStyle:K+t+"px"}}var O=e("command/Commands"),M=e("utils/EventDispatcher"),L=e("command/CommandManager"),R=e("strings"),N=e("utils/StringUtils"),x=e("editor/EditorManager"),A=e("preferences/PreferencesManager"),P=e("document/DocumentManager"),k=e("view/ThemeSettings"),F=e("view/MainViewManager"),U=e("utils/AppInit"),j=e("thirdparty/lodash"),V=A.getExtensionPrefs("fonts"),B="codemirror-dynamic-fonts",H="codemirror-dynamic-font-family",W=1,G=72,K=12,q="'SourceCodePro-Medium', ＭＳ ゴシック, 'MS Gothic', monospace";L.register(R.CMD_INCREASE_FONT_SIZE,O.VIEW_INCREASE_FONT_SIZE,m),L.register(R.CMD_DECREASE_FONT_SIZE,O.VIEW_DECREASE_FONT_SIZE,g),L.register(R.CMD_RESTORE_FONT_SIZE,O.VIEW_RESTORE_FONT_SIZE,v),L.register(R.CMD_SCROLL_LINE_UP,O.VIEW_SCROLL_LINE_UP,w),L.register(R.CMD_SCROLL_LINE_DOWN,O.VIEW_SCROLL_LINE_DOWN,C),L.register(R.CMD_THEMES,O.CMD_THEMES_OPEN_SETTINGS,D),A.convertPreferences(n,{fontSizeAdjustment:"user"},!0,T),V.definePreference("fontSize","string",K+"px"),V.definePreference("fontFamily","string",q),F.on("currentFileChange",y),U.appReady(_),M.makeEventDispatcher(t),t.restoreFontSize=E,t.restoreFonts=b,t.getFontSize=d,t.setFontSize=u,t.getFontFamily=h,t.setFontFamily=p}),define("text!htmlContent/themes-settings.html",[],function(){return'<div class="theme-settings modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">{{Strings.THEMES_SETTINGS}}</h1>\n    </div>\n    <div class="modal-body">\n        <form class="form-horizontal">\n            <div class="control-group">\n                <label class="control-label">{{Strings.CURRENT_THEME}}:</label>\n                <div class="controls">\n                    <select>\n                        {{#themes}}\n                        <option style="text-align:left;" value="{{name}}" data-target="theme">{{displayName}}</option>\n                        {{/themes}}\n                    </select>\n                </div>\n            </div>\n\n            <div class="control-group">\n                <label class="control-label">{{Strings.USE_THEME_SCROLLBARS}}:</label>\n                <div class="controls">\n                    {{#settings.themeScrollbars}}\n                        <input type="checkbox" data-target="themeScrollbars" checked>\n                    {{/settings.themeScrollbars}}\n                    {{^settings.themeScrollbars}}\n                        <input type="checkbox" data-target="themeScrollbars">\n                    {{/settings.themeScrollbars}}\n                </div>\n            </div>\n\n            <div class="control-group">\n                <label class="control-label">{{Strings.FONT_SIZE}}:</label>\n                <div class="controls">\n                    <input type="text" data-target="fontSize" value="{{settings.fontSize}}">\n                </div>\n            </div>\n\n            <div class="control-group">\n                <label class="control-label">{{Strings.FONT_FAMILY}}:</label>\n                <div class="controls">\n                    <input type="text" data-target="fontFamily" value="{{settings.fontFamily}}">\n                </div>\n            </div>\n        </form>\n    </div>\n    <div class="modal-footer">\n        <button class="dialog-button btn" data-button-id="cancel">{{Strings.CANCEL}}</button>\n        <button class="dialog-button btn primary" data-button-id="save">{{Strings.DONE}}</button>\n    </div>\n</div>\n'}),define("view/ThemeSettings",["require","exports","module","thirdparty/lodash","widgets/Dialogs","strings","view/ViewCommandHandlers","text!htmlContent/themes-settings.html","preferences/PreferencesManager"],function(e,t){"use strict";function n(){var e={};return Object.keys(f).forEach(function(t){e[t]=p.get(t)}),e.fontFamily=c.getFontFamily(),e.fontSize=c.getFontSize(),e}function r(){var e=n(),t={},r=a.map(h,function(e){return e}),i=$("<div>").append(m).html(),o=$(Mustache.render(i,{settings:e,themes:r,Strings:l})),u=o.find("[value='"+e.theme+"']");0===u.length&&(u=o.find("[value='"+f.theme+"']")),u.attr("selected","selected"),o.find("[data-toggle=tab].default").tab("show"),o.on("change","[data-target]:checkbox",function(){var e=$(this),n=e.attr("data-target");t[n]=e.is(":checked")}).on("input","[data-target]:text",function(){var e=$(this),n=e.attr("data-target");t[n]=e.val()}).on("change","select",function(){var e=$(":selected",this),t=e.attr("data-target");t&&p.set(t,e.val())}),s.showModalDialogUsingTemplate(o).done(function(n){var r;"save"===n?Object.keys(t).forEach(function(e){f.hasOwnProperty(e)?p.set(e,t[e]):(r="set"+e[0].toLocaleUpperCase()+e.substr(1),"function"==typeof c[r]&&c[r](t[e]))}):"cancel"===n&&p.set("theme",e.theme)})}function i(e){h=e}function o(){p.set("theme",f.theme),p.set("themeScrollbars",f.themeScrollbars)}var a=e("thirdparty/lodash"),s=e("widgets/Dialogs"),l=e("strings"),c=e("view/ViewCommandHandlers"),u=e("text!htmlContent/themes-settings.html"),d=e("preferences/PreferencesManager"),p=d.getExtensionPrefs("themes"),h={},f={themeScrollbars:!0,theme:"light-theme"},m=$(u).addClass("themeSettings");p.definePreference("theme","string",f.theme),p.definePreference("themeScrollbars","boolean",f.themeScrollbars),t._setThemes=i,t.restore=o,t.showDialog=r}),define("view/ThemeView",["require","exports","module","thirdparty/CodeMirror2/lib/codemirror","preferences/PreferencesManager"],function(e,t){"use strict";function n(e){if(e=e||{},a.get("themeScrollbars")){var t=(e.scrollbar||[]).join(" ");s.text(t||"")}else s.text("")}function r(e){var t=a.get("theme"),n=(e.getOption("theme")||"").replace(/[\s]*/,"");n!==t&&(i.defaults.theme=t,e.setOption("theme",t))}var i=e("thirdparty/CodeMirror2/lib/codemirror"),o=e("preferences/PreferencesManager"),a=o.getExtensionPrefs("themes"),s=$("<style id='scrollbars'>").appendTo("head");t.updateScrollbars=n,t.updateThemes=r}),define("view/ThemeManager",["require","exports","module","thirdparty/lodash","utils/EventDispatcher","filesystem/FileSystem","file/FileUtils","editor/EditorManager","utils/ExtensionUtils","view/ThemeSettings","view/ThemeView","preferences/PreferencesManager"],function(e,t){"use strict";function n(e){var t=e.lastIndexOf(".");return e=e.substring(0,-1!==t?t:void 0).replace(/-/g," "),e.split(" ").map(function(e){return e[0].toUpperCase()+e.substring(1)}).join(" ")}function r(e,t){t=t||{};var r=e.name;t.name||(t.name=t.title?t.title:v.getFilenameWithoutExtension(r).replace(/\.min$/,""),t.name=t.name.toLocaleLowerCase().replace(/[\W]/g,"-")),this.file=e,this.name=t.name,this.displayName=t.title||n(r),this.dark=void 0!==t.theme&&t.theme.dark===!0,this.addModeClass=void 0!==t.theme&&t.theme.addModeClass===!0}function i(e){var t=[];return e=e.replace(M,function(e){return t.push(e),""}),{content:e,scrollbar:t}}function o(e){return e.replace(/^([A-Z]+:)?\//,function(e){return e.toLocaleLowerCase()})}function a(e,t){var n=new $.Deferred,r=new less.Parser({rootpath:o(L),filename:o(t.file._path)});return r.parse("#editor-holder {"+e+"\n}",function(e,t){e?n.reject(e):n.resolve(t.toCSS())}),n.promise()}function s(e){var t=e._path;return f.find(w,function(e){return e.file._path===t})}function l(){return C||(C=w[I.get("theme")]||w[T]),C}function c(){return f.map(w,function(e){return e})}function u(){var e=l(),t=e&&v.readAsText(e.file).then(function(t){return a(t.replace(O,""),e)}).then(function(t){var n=i(t);return e.scrollbar=n.scrollbar,n.content}).then(function(t){return $("body").toggleClass("dark",e.dark),D.text(t),e});return $.when(t)}function d(e){e&&(C=null),$.when(e&&u()).done(function(){var e=y.getActiveEditor();if(e&&e._codeMirror){var t=e._codeMirror;b.updateThemes(t),t.setOption("addModeClass",!(!C||!C.addModeClass))}})}function p(e,t){var n=new $.Deferred,i=g.getFileForPath(e),o=I.get("theme");return i.exists(function(e,a){var s;a?(s=new r(i,t),w[s.name]=s,E._setThemes(w),o===s.name&&d(!0),n.resolve(s)):(e||!a)&&n.reject(e)}),n.promise()}function h(e){var t=e.path+"/"+e.metadata.theme.file;return p(t,e.metadata)}var f=e("thirdparty/lodash"),m=e("utils/EventDispatcher"),g=e("filesystem/FileSystem"),v=e("file/FileUtils"),y=e("editor/EditorManager"),_=e("utils/ExtensionUtils"),E=e("view/ThemeSettings"),b=e("view/ThemeView"),S=e("preferences/PreferencesManager"),I=S.getExtensionPrefs("themes"),w={},C=null,D=$(_.addEmbeddedStyleSheet("")),T="thor-light-theme",O=/\/\*([\s\S]*?)\*\//gm,M=/((?:[^}|,]*)::-webkit-scrollbar(?:[^{]*)[{](?:[^}]*?)[}])/gim,L=v.getNativeBracketsDirectoryPath()+"/styles/";I.on("change","theme",function(){C&&C.name===I.get("theme")||(d(!0),b.updateScrollbars(l()),t.trigger("themeChange",l()))}),I.on("change","themeScrollbars",function(){d(),b.updateScrollbars(l())}),g.on("change",function(e,t){t&&!t.isDirectory&&s(t)&&d(!0)}),y.on("activeEditorChange",function(){d()}),m.makeEventDispatcher(t),t.refresh=d,t.loadFile=p,t.loadPackage=h,t.getCurrentTheme=l,t.getAllThemes=c,t._toDisplayName=n,t._extractScrollbars=i}),function(e){function t(e,t){var n=t?F[et]:F[Q];return n.test(e)?new i(e,t):null}function n(e,n){var r=t(e,n);return r?r.version:null}function r(e,n){var r=t(e,n);return r?r.version:null}function i(e,t){if(e instanceof i){if(e.loose===t)return e;e=e.version}if(!(this instanceof i))return new i(e,t);this.loose=t;var n=e.trim().match(t?F[et]:F[Q]);if(!n)throw new TypeError("Invalid Version: "+e);this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.prerelease=n[4]?n[4].split(".").map(function(e){return/^[0-9]+$/.test(e)?+e:e}):[],this.build=n[5]?n[5].split("."):[],this.format()}function o(e,t,n){try{return new i(e,n).inc(t).version}catch(r){return null}}function a(e,t){var n=Dt.test(e),r=Dt.test(t);return n&&r&&(e=+e,t=+t),n&&!r?-1:r&&!n?1:t>e?-1:e>t?1:0}function s(e,t){return a(t,e)}function l(e,t,n){return new i(e,n).compare(t)}function c(e,t){return l(e,t,!0)}function u(e,t,n){return l(t,e,n)}function d(t,n){return t.sort(function(t,r){return e.compare(t,r,n)})}function p(t,n){return t.sort(function(t,r){return e.rcompare(t,r,n)})}function h(e,t,n){return l(e,t,n)>0}function f(e,t,n){return l(e,t,n)<0}function m(e,t,n){return 0===l(e,t,n)}function g(e,t,n){return 0!==l(e,t,n)}function v(e,t,n){return l(e,t,n)>=0}function y(e,t,n){return l(e,t,n)<=0}function _(e,t,n,r){var i;switch(t){case"===":i=e===n;break;case"!==":i=e!==n;break;case"":case"=":case"==":i=m(e,n,r);break;case"!=":i=g(e,n,r);break;case">":i=h(e,n,r);break;case">=":i=v(e,n,r);break;case"<":i=f(e,n,r);break;case"<=":i=y(e,n,r);break;default:throw new TypeError("Invalid operator: "+t)}return i}function E(e,t){if(e instanceof E){if(e.loose===t)return e;e=e.value}return this instanceof E?(this.loose=t,this.parse(e),void(this.value=this.semver===Tt?"":this.operator+this.semver.version)):new E(e,t)}function b(e,t){if(e instanceof b&&e.loose===t)return e;if(!(this instanceof b))return new b(e,t);if(this.loose=t,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(function(e){return this.parseRange(e.trim())},this).filter(function(e){return e.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function S(e,t){return new b(e,t).set.map(function(e){return e.map(function(e){return e.value}).join(" ").trim().split(" ")})}function I(e,t){return e=T(e,t),e=C(e,t),e=M(e,t),e=R(e,t)}function w(e){return!e||"x"===e.toLowerCase()||"*"===e}function C(e,t){return e.trim().split(/\s+/).map(function(e){return D(e,t)}).join(" ")}function D(e,t){var n=t?F[pt]:F[dt];return e.replace(n,function(e,t,n,r,i){var o;return w(t)?o="":w(n)?o=">="+t+".0.0-0 <"+(+t+1)+".0.0-0":w(r)?o=">="+t+"."+n+".0-0 <"+t+"."+(+n+1)+".0-0":i?("-"!==i.charAt(0)&&(i="-"+i),o=">="+t+"."+n+"."+r+i+" <"+t+"."+(+n+1)+".0-0"):o=">="+t+"."+n+"."+r+"-0 <"+t+"."+(+n+1)+".0-0",o})}function T(e,t){return e.trim().split(/\s+/).map(function(e){return O(e,t)}).join(" ")}function O(e,t){var n=t?F[vt]:F[gt];return e.replace(n,function(e,t,n,r,i){var o;return w(t)?o="":w(n)?o=">="+t+".0.0-0 <"+(+t+1)+".0.0-0":w(r)?o="0"===t?">="+t+"."+n+".0-0 <"+t+"."+(+n+1)+".0-0":">="+t+"."+n+".0-0 <"+(+t+1)+".0.0-0":i?("-"!==i.charAt(0)&&(i="-"+i),o="0"===t?"0"===n?"="+t+"."+n+"."+r+i:">="+t+"."+n+"."+r+i+" <"+t+"."+(+n+1)+".0-0":">="+t+"."+n+"."+r+i+" <"+(+t+1)+".0.0-0"):o="0"===t?"0"===n?"="+t+"."+n+"."+r:">="+t+"."+n+"."+r+"-0 <"+t+"."+(+n+1)+".0-0":">="+t+"."+n+"."+r+"-0 <"+(+t+1)+".0.0-0",o})}function M(e,t){return e.split(/\s+/).map(function(e){return L(e,t)}).join(" ")}function L(e,t){e=e.trim();var n=t?F[st]:F[at];return e.replace(n,function(e,t,n,r,i){var o=w(n),a=o||w(r),s=a||w(i),l=s;return"="===t&&l&&(t=""),t&&l?(o&&(n=0),a&&(r=0),s&&(i=0),">"===t&&(t=">=",o||(a?(n=+n+1,r=0,i=0):s&&(r=+r+1,i=0))),e=t+n+"."+r+"."+i+"-0"):o?e="*":a?e=">="+n+".0.0-0 <"+(+n+1)+".0.0-0":s&&(e=">="+n+"."+r+".0-0 <"+n+"."+(+r+1)+".0-0"),e})}function R(e){return e.trim().replace(F[wt],"")}function N(e,t,n,r,i,o,a,s,l,c,u,d){return t=w(n)?"":w(r)?">="+n+".0.0-0":w(i)?">="+n+"."+r+".0-0":">="+t,s=w(l)?"":w(c)?"<"+(+l+1)+".0.0-0":w(u)?"<"+l+"."+(+c+1)+".0-0":d?"<="+l+"."+c+"."+u+"-"+d:"<="+s,(t+" "+s).trim()}function x(e,t){for(var n=0;n<e.length;n++)if(!e[n].test(t))return!1;return!0}function A(e,t,n){try{t=new b(t,n)}catch(r){return!1}return t.test(e)}function P(e,t,n){return e.filter(function(e){return A(e,t,n)}).sort(function(e,t){return u(e,t,n)})[0]||null}function k(e,t){try{return new b(e,t).range||"*"}catch(n){return null}}"object"==typeof module&&module.exports===e&&(e=module.exports=i),e.SEMVER_SPEC_VERSION="2.0.0";var F=e.re=[],U=e.src=[],j=0,$=j++;U[$]="0|[1-9]\\d*";var V=j++;U[V]="[0-9]+";var B=j++;U[B]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var H=j++;U[H]="("+U[$]+")\\.("+U[$]+")\\.("+U[$]+")";var W=j++;U[W]="("+U[V]+")\\.("+U[V]+")\\.("+U[V]+")";var G=j++;U[G]="(?:"+U[$]+"|"+U[B]+")";var K=j++;U[K]="(?:"+U[V]+"|"+U[B]+")";var q=j++;U[q]="(?:-("+U[G]+"(?:\\."+U[G]+")*))";var z=j++;U[z]="(?:-?("+U[K]+"(?:\\."+U[K]+")*))";var Y=j++;U[Y]="[0-9A-Za-z-]+";var X=j++;U[X]="(?:\\+("+U[Y]+"(?:\\."+U[Y]+")*))";var Q=j++,J="v?"+U[H]+U[q]+"?"+U[X]+"?";U[Q]="^"+J+"$";var Z="[v=\\s]*"+U[W]+U[z]+"?"+U[X]+"?",et=j++;U[et]="^"+Z+"$";var tt=j++;U[tt]="((?:<|>)?=?)";var nt=j++;U[nt]=U[V]+"|x|X|\\*";var rt=j++;U[rt]=U[$]+"|x|X|\\*";var it=j++;U[it]="[v=\\s]*("+U[rt]+")(?:\\.("+U[rt]+")(?:\\.("+U[rt]+")(?:("+U[q]+"))?)?)?";var ot=j++;U[ot]="[v=\\s]*("+U[nt]+")(?:\\.("+U[nt]+")(?:\\.("+U[nt]+")(?:("+U[z]+"))?)?)?";var at=j++;U[at]="^"+U[tt]+"\\s*"+U[it]+"$";var st=j++;U[st]="^"+U[tt]+"\\s*"+U[ot]+"$";var lt=j++;U[lt]="(?:~>?)";var ct=j++;U[ct]="(\\s*)"+U[lt]+"\\s+",F[ct]=new RegExp(U[ct],"g");var ut="$1~",dt=j++;U[dt]="^"+U[lt]+U[it]+"$";var pt=j++;U[pt]="^"+U[lt]+U[ot]+"$";var ht=j++;U[ht]="(?:\\^)";var ft=j++;U[ft]="(\\s*)"+U[ht]+"\\s+",F[ft]=new RegExp(U[ft],"g");var mt="$1^",gt=j++;U[gt]="^"+U[ht]+U[it]+"$";var vt=j++;U[vt]="^"+U[ht]+U[ot]+"$";var yt=j++;U[yt]="^"+U[tt]+"\\s*("+Z+")$|^$";var _t=j++;U[_t]="^"+U[tt]+"\\s*("+J+")$|^$";var Et=j++;U[Et]="(\\s*)"+U[tt]+"\\s*("+Z+"|"+U[it]+")",F[Et]=new RegExp(U[Et],"g");var bt="$1$2$3",St=j++;U[St]="^\\s*("+U[it]+")\\s+-\\s+("+U[it]+")\\s*$";var It=j++;U[It]="^\\s*("+U[ot]+")\\s+-\\s+("+U[ot]+")\\s*$";var wt=j++;U[wt]="(<|>)?=?\\s*\\*";for(var Ct=0;j>Ct;Ct++)F[Ct]||(F[Ct]=new RegExp(U[Ct]));e.parse=t,e.valid=n,e.clean=r,e.SemVer=i,i.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},i.prototype.inspect=function(){return'<SemVer "'+this+'">'},i.prototype.toString=function(){return this.version},i.prototype.compare=function(e){return e instanceof i||(e=new i(e,this.loose)),this.compareMain(e)||this.comparePre(e)},i.prototype.compareMain=function(e){return e instanceof i||(e=new i(e,this.loose)),a(this.major,e.major)||a(this.minor,e.minor)||a(this.patch,e.patch)},i.prototype.comparePre=function(e){if(e instanceof i||(e=new i(e,this.loose)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.lenth&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],r=e.prerelease[t];if(void 0===n&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===n)return-1;if(n!==r)return a(n,r)}while(++t)},i.prototype.inc=function(e){switch(e){case"major":this.major++,this.minor=-1;case"minor":this.minor++,this.patch=-1;case"patch":this.patch++,this.prerelease=[];break;case"prerelease":if(0===this.prerelease.length)this.prerelease=[0];else{for(var t=this.prerelease.length;--t>=0;)"number"==typeof this.prerelease[t]&&(this.prerelease[t]++,t=-2);-1===t&&this.prerelease.push(0)}break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this},e.inc=o,e.compareIdentifiers=a;var Dt=/^[0-9]+$/;e.rcompareIdentifiers=s,e.compare=l,e.compareLoose=c,e.rcompare=u,e.sort=d,e.rsort=p,e.gt=h,e.lt=f,e.eq=m,e.neq=g,e.gte=v,e.lte=y,e.cmp=_,e.Comparator=E;var Tt={};E.prototype.parse=function(e){var t=this.loose?F[yt]:F[_t],n=e.match(t);if(!n)throw new TypeError("Invalid comparator: "+e);this.operator=n[1],n[2]?(this.semver=new i(n[2],this.loose),"<"!==this.operator||this.semver.prerelease.length||(this.semver.prerelease=["0"],this.semver.format())):this.semver=Tt},E.prototype.inspect=function(){return'<SemVer Comparator "'+this+'">'},E.prototype.toString=function(){return this.value},E.prototype.test=function(e){return this.semver===Tt?!0:_(e,this.operator,this.semver,this.loose)},e.Range=b,b.prototype.inspect=function(){return'<SemVer Range "'+this.range+'">'},b.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(" ").trim()}).join("||").trim(),this.range},b.prototype.toString=function(){return this.range},b.prototype.parseRange=function(e){var t=this.loose;e=e.trim();var n=t?F[It]:F[St];e=e.replace(n,N),e=e.replace(F[Et],bt),e=e.replace(F[ct],ut),e=e.replace(F[ft],mt),e=e.split(/\s+/).join(" ");var r=t?F[yt]:F[_t],i=e.split(" ").map(function(e){return I(e,t)}).join(" ").split(/\s+/);return this.loose&&(i=i.filter(function(e){return!!e.match(r)})),i=i.map(function(e){return new E(e,t)})},e.toComparators=S,b.prototype.test=function(e){if(!e)return!1;for(var t=0;t<this.set.length;t++)if(x(this.set[t],e))return!0;return!1},e.satisfies=A,e.maxSatisfying=P,e.validRange=k,"function"==typeof define&&define.amd&&define("extensibility/node/node_modules/semver/semver.browser",e)}("object"==typeof exports?exports:"function"==typeof define&&define.amd?{}:semver={}),define("extensibility/ExtensionManager",["require","exports","module","thirdparty/lodash","utils/EventDispatcher","extensibility/Package","utils/AppInit","utils/Async","utils/ExtensionLoader","utils/ExtensionUtils","filesystem/FileSystem","file/FileUtils","preferences/PreferencesManager","strings","utils/StringUtils","view/ThemeManager","extensibility/node/node_modules/semver/semver.browser"],function(e,t){"use strict";
function n(e){var n=Q[e];if(n&&n.installInfo&&n.registryInfo){n.installInfo.owner=n.registryInfo.owner,n.installInfo.updateAvailable=!1,n.registryInfo.updateAvailable=!1,n.installInfo.updateCompatible=!1,n.registryInfo.updateCompatible=!1;var r=n.installInfo.metadata?n.installInfo.metadata.version:null;if(r&&B.lt(r,n.registryInfo.metadata.version)){n.registryInfo.updateAvailable=!0,n.installInfo.updateAvailable=!0;var i=O.findLast(n.registryInfo.versions,function(e){return B.satisfies(brackets.metadata.apiVersion,e.brackets)});i&&i.version&&B.lt(r,i.version)&&(n.installInfo.updateCompatible=!0,n.registryInfo.updateCompatible=!0,n.installInfo.lastCompatibleVersion=i.version,n.registryInfo.lastCompatibleVersion=i.version)}t.trigger("registryUpdate",e)}}function r(e){var t=Q[e];t.installInfo&&t.installInfo.metadata&&t.installInfo.metadata.theme&&V.loadPackage(t.installInfo)}function i(e){t.extensions=Q=e,Object.keys(Q).forEach(function(e){n(e)})}function o(){t.extensions=Q={},J=[],Z=[]}function a(){return H?H.promise():(H=new $.Deferred,$.ajax({url:brackets.config.extension_registry,dataType:"json",cache:!1}).done(function(e){Object.keys(e).forEach(function(t){Q[t]||(Q[t]={}),Q[t].registryInfo=e[t],n(t)}),t.trigger("registryDownload"),H.resolve()}).fail(function(){H.reject()}).always(function(){H=null}),H.promise())}function s(e,i){function o(o,a){var s,l=x.getUserExtensionPath();if(0===i.indexOf(l))s=z;else{var c,u=i.split("/");u.length>2&&(c=u[u.length-2]),s="dev"===c?q:"default"===c?K:Y}Q[o]||(Q[o]={}),Q[o].installInfo={metadata:a,path:i,locationType:s,status:"loadFailed"===e.type?G:W},n(o),r(o),t.trigger("statusChange",o)}A.loadPackageJson(i).done(function(e){o(e.name,e)}).fail(function(){var e=i.match(/\/([^\/]+)$/),t=e&&e[1]||i,n={name:t,title:t};o(t,n)})}function l(e,t){var n=e.brackets||e.engines&&e.engines.brackets,r={};if(r.isCompatible=!n||B.satisfies(t,n),r.isCompatible)r.compatibleVersion=e.version;else if("<"===n.charAt(0))r.requiresNewer=!1;else if(">"===n.charAt(0))r.requiresNewer=!0;else if("~"===n.charAt(0)){var i=n.slice(1);i.match(/^[0-9]+$/)?i+=".0.0":i.match(/^[0-9]+\.[0-9]+$/)&&(i+=".0"),r.requiresNewer=B.lt(t,i)}return r}function c(e,t){if(!e.versions){var n=l(e.metadata,t);return n.isCompatible&&(n.isLatestVersion=!0),n}var r=e.versions.length-1,i=l(e.versions[r],t);if(i.isCompatible)return i.isLatestVersion=!0,i;for(r--;r>=0;r--){var o=l(e.versions[r],t);if(o.isCompatible)return o.isLatestVersion=!1,o.requiresNewer=i.requiresNewer,o}return i}function u(e,t){return j.format(brackets.config.extension_url,e,t)}function d(e){var n=new $.Deferred;return Q[e]&&Q[e].installInfo?L.remove(Q[e].installInfo.path).done(function(){Q[e].installInfo=null,n.resolve(),t.trigger("statusChange",e)}).fail(function(e){n.reject(e)}):n.reject(j.format(U.EXTENSION_NOT_INSTALLED,e)),n.promise()}function p(e,t,n){return L.installUpdate(t,e).done(function(){n||P.getFileForPath(t).unlink()})}function h(){Object.keys(Z).forEach(function(e){var t=Z[e],n=t.keepFile,r=t.localPath;r&&!n&&P.getFileForPath(r).unlink()}),Z={}}function f(){J={}}function m(e,n){n?J[e]=!0:delete J[e],t.trigger("statusChange",e)}function g(e){return!!J[e]}function v(){return Object.keys(J).length>0}function y(e){void 0===e.keepFile&&(e.keepFile=!1);var n=e.installationStatus;if(n===L.InstallationStatuses.ALREADY_INSTALLED||n===L.InstallationStatuses.NEEDS_UPDATE||n===L.InstallationStatuses.SAME_VERSION||n===L.InstallationStatuses.OLDER_VERSION){var r=e.name;delete J[r],Z[r]=e,t.trigger("statusChange",r)}}function _(e){var n=Z[e];n&&(n.localPath&&!n.keepFile&&P.getFileForPath(n.localPath).unlink(),delete Z[e],t.trigger("statusChange",e))}function E(e){return!!Z[e]}function b(){return Object.keys(Z).length>0}function S(){return N.doInParallel_aggregateErrors(Object.keys(J),function(e){return d(e)})}function I(){return N.doInParallel_aggregateErrors(Object.keys(Z),function(e){var t=Z[e];return p(t.name,t.localPath,t.keepFile)})}function w(){var e=[];return Object.keys(Q).forEach(function(t){var n=Q[t];n.installInfo&&n.registryInfo&&n.registryInfo.updateCompatible&&e.push({id:t,installVersion:n.installInfo.metadata.version,registryVersion:n.registryInfo.lastCompatibleVersion})}),e}function C(e){return e.reduce(function(e,t){var n=Q[t.id];if(!n||!n.installInfo)return e;var r=n.installInfo.metadata.version;return B.lt(r,t.registryVersion)&&e.push(t),e},[])}function D(e,t){var n=[],r=[],i=[],o=new $.Deferred;return P.getDirectoryForPath(e).getContents(function(e,a){e||(n=a.filter(function(e){return e.isFile&&"zip"===k.getFileExtension(e.fullPath)})),N.doInParallel_aggregateErrors(n,function(e){var n=new $.Deferred;return L.validate(e.fullPath,{requirePackageJSON:!0}).done(function(o){if(o.errors.length)return void n.reject(L.formatError(o.errors));var a,s,l,c,u=o.metadata.name,d=t[u];return d&&B.lte(o.metadata.version,d)?void n.reject():(a=Q[u],s=a&&a.installInfo&&a.installInfo.metadata.version,s&&B.lte(o.metadata.version,s)?void n.reject():(l=s?i:r,l.some(function(e){return e.info.metadata.name===u?(c=e,!0):!1}),c?B.lt(c.info.metadata.version,o.metadata.version)&&(c.file=e,c.info=o):l.push({file:e,info:o}),void n.resolve()))}).fail(function(e){n.reject(L.formatError(e))}),n.promise()}).fail(function(e){e.forEach(function(e){e.error&&(e.error.forEach?(console.error("Errors for",e.item),e.error.forEach(function(e){console.error(L.formatError(e))})):console.error("Error for",e.item,e))})}).always(function(){o.resolve({installZips:r,updateZips:i})})}),o.promise()}function T(){var e=k.getDirectoryPath(k.getNativeBracketsDirectoryPath())+X+"/",t=F.getViewState(X)||{},n=new $.Deferred;return D(e,t).done(function(e){var r=N.doSequentially(e.installZips,function(e){return t[e.info.metadata.name]=e.info.metadata.version,L.installFromPath(e.file.fullPath)}),i=r.always(function(){return N.doSequentially(e.updateZips,function(e){return t[e.info.metadata.name]=e.info.metadata.version,L.installUpdate(e.file.fullPath)})});i.always(function(){F.setViewState(X,t),n.resolve()})}),n.promise()}var O=e("thirdparty/lodash"),M=e("utils/EventDispatcher"),L=e("extensibility/Package"),R=e("utils/AppInit"),N=e("utils/Async"),x=e("utils/ExtensionLoader"),A=e("utils/ExtensionUtils"),P=e("filesystem/FileSystem"),k=e("file/FileUtils"),F=e("preferences/PreferencesManager"),U=e("strings"),j=e("utils/StringUtils"),V=e("view/ThemeManager"),B=e("extensibility/node/node_modules/semver/semver.browser"),H=null,W="enabled",G="startFailed",K="default",q="dev",z="user",Y="unknown",X="auto-install-extensions",Q={},J=[],Z=[];F.stateManager.definePreference(X,"object",void 0),R.appReady(function(){L._getNodeConnectionDeferred().done(function(){T()})}),x.on("load",s).on("loadFailed",s),M.makeEventDispatcher(t),t.downloadRegistry=a,t.getCompatibilityInfo=c,t.getExtensionURL=u,t.remove=d,t.update=p,t.extensions=Q,t.cleanupUpdates=h,t.markForRemoval=m,t.isMarkedForRemoval=g,t.unmarkAllForRemoval=f,t.hasExtensionsToRemove=v,t.updateFromDownload=y,t.removeUpdate=_,t.isMarkedForUpdate=E,t.hasExtensionsToUpdate=b,t.removeMarkedExtensions=S,t.updateExtensions=I,t.getAvailableUpdates=w,t.cleanAvailableUpdates=C,t.ENABLED=W,t.START_FAILED=G,t.LOCATION_DEFAULT=K,t.LOCATION_DEV=q,t.LOCATION_USER=z,t.LOCATION_UNKNOWN=Y,t._getAutoInstallFiles=D,t._reset=o,t._setExtensions=i}),define("utils/NativeApp",["require","exports","module","utils/Async","filesystem/FileSystemError"],function(e,t){"use strict";function n(e){return e===brackets.fs.ERR_NOT_FOUND?l.NOT_FOUND:l.UNKNOWN}function r(e,t){var r=new $.Deferred;return brackets.app.openLiveBrowser(e,!!t,function(e,t){e?r.reject(n(e)):(void 0!==t&&c.push(t),r.resolve(t))}),r.promise()}function i(e){var t=new $.Deferred;return isNaN(e)&&(e=0),brackets.app.closeLiveBrowser(function(r){if(r)t.reject(n(r));else{var i=c.indexOf(e);-1!==i&&c.splice(i,1),t.resolve()}},e),t.promise()}function o(){var e=c.concat();return s.doSequentially(e,i,!1)}function a(e){brackets.app.openURLInDefaultBrowser(e)}var s=e("utils/Async"),l=e("filesystem/FileSystemError"),c=[];t.openLiveBrowser=r,t.closeLiveBrowser=i,t.closeAllLiveBrowsers=o,t.openURLInDefaultBrowser=a}),define("text!htmlContent/update-dialog.html",[],function(){return'<div class="update-dialog modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">{{UPDATE_AVAILABLE_TITLE}}</h1>\n    </div>\n    <div class="modal-body no-padding">\n        <img class="update-icon" src="styles/images/update_large_icon.svg">\n        <div class="update-text">\n            <p class="dialog-message">{{UPDATE_MESSAGE}}</p>\n            <div class="update-info">\n            </div>\n        </div>\n    </div>\n    <div class="modal-footer">\n        <button class="dialog-button btn left" data-button-id="cancel">{{CANCEL}}</button>\n        <button class="dialog-button btn primary" data-button-id="download">{{GET_IT_NOW}}</button>\n    </div>\n</div>\n'}),define("text!htmlContent/update-list.html",[],function(){return'{{#.}}\n<div>\n    <h3>{{versionString}} - {{dateString}} (<a href="{{releaseNotesURL}}" title="{{releaseNotesURL}}">{{Strings.RELEASE_NOTES}}</a>)</h3>\n    <ul>\n        {{#newFeatures}}\n        <li><b>{{name}}</b> - {{description}}</li>\n        {{/newFeatures}}\n    </ul>\n</div>\n{{/.}}'}),define("utils/UpdateNotification",["require","exports","module","widgets/Dialogs","widgets/DefaultDialogs","extensibility/ExtensionManager","preferences/PreferencesManager","utils/NativeApp","strings","text!htmlContent/update-dialog.html","text!htmlContent/update-list.html","utils/Global"],function(e,t,n){"use strict";function r(e,t){return e=e||brackets.getLocale(),t&&(e=e.substring(0,2)),brackets.config.update_info_url+e+".json"}function i(e,t,n){var i,o=f.getViewState("lastInfoURLFetchTime"),a=new $.Deferred,s=!1;if(e&&(s=!0),i=f.getViewState("updateInfo"),i||(s=!0),(new Date).getTime()>o+_&&(s=!0),s){var l,c=new $.Deferred,u=brackets.getLocale().toLowerCase();"en"!==u&&"en-us"!==u?(l=n||r(),$.ajax({url:l,cache:!1,type:"HEAD"}).fail(function(){var e=r(brackets.getLocale(),!0);e!==l?$.ajax({url:e,cache:!1,type:"HEAD"}).fail(function(){l=r("en")}).done(function(){l=e}).always(function(){c.resolve()}):(l=r("en"),c.resolve())}).done(function(){c.resolve()})):(l=n||r("en"),c.resolve()),c.done(function(){$.ajax({url:l,dataType:"json",cache:!1}).done(function(e){t||(o=(new Date).getTime(),f.setViewState("lastInfoURLFetchTime",o),f.setViewState("updateInfo",e)),a.resolve(e)}).fail(function(e){if(!e.responseText)return void a.reject();try{i=JSON.parse(e.responseText),a.resolve(i)}catch(t){a.reject()}})})}else a.resolve(i);return a.promise()}function o(e,t){for(var n=0,r=e.length;r>n&&!(e[n].buildNumber<=t);)n++;return n>0?e.slice(0,n):null}function a(e){d.showModalDialogUsingTemplate(Mustache.render(v,g)).done(function(t){t===d.DIALOG_BTN_DOWNLOAD&&m.openURLInDefaultBrowser(e[0].downloadURL)});var t=$(".update-dialog.instance"),n=t.find(".update-info");e.Strings=g,n.html(Mustache.render(y,e))}function s(){var e=h.getAvailableUpdates();f.setViewState("extensionUpdateInfo",e),f.setViewState("lastExtensionRegistryCheckTime",(new Date).getTime()),$("#toolbar-extension-manager").toggleClass("updatesAvailable",e.length>0)}function l(){var e=f.getViewState("lastExtensionRegistryCheckTime"),t=e+_,n=(new Date).getTime(),r=f.getViewState("extensionUpdateInfo");r=h.cleanAvailableUpdates(r),$("#toolbar-extension-manager").toggleClass("updatesAvailable",r.length>0),0===r.length&&(n>t?h.downloadRegistry().done(function(){setTimeout(l,_+E)}):setTimeout(l,t-n+E))}function c(e,t){var n,r,s=f.getViewState("lastNotifiedBuildNumber"),l=!1,u=new $.Deferred;return t&&(n={},t.hasOwnProperty("_buildNumber")&&(n._buildNumber=b,b=t._buildNumber,l=!0),t.hasOwnProperty("lastNotifiedBuildNumber")&&(n.lastNotifiedBuildNumber=s,s=t.lastNotifiedBuildNumber,l=!0),t.hasOwnProperty("_versionInfoURL")&&(r=t._versionInfoURL,l=!0)),i(e||l,l,r).done(function(t){var r=o(t,b);if(0===b&&!e)return void u.resolve();if(r){var i=$("#update-notification");i.css("display","block"),S||(S=!0,i.on("click",function(){c(!0)})),(e||r[0].buildNumber>s)&&(a(r),s=r[0].buildNumber,l||f.setViewState("lastNotifiedBuildNumber",s))}else e&&d.showModalDialog(p.DIALOG_ID_ERROR,g.NO_UPDATE_TITLE,g.NO_UPDATE_MESSAGE);n&&(n.hasOwnProperty("_buildNumber")&&(b=n._buildNumber),n.hasOwnProperty("lastNotifiedBuildNumber")&&(s=n.lastNotifiedBuildNumber)),u.resolve()}).fail(function(){e&&d.showModalDialog(p.DIALOG_ID_ERROR,g.ERROR_FETCHING_UPDATE_INFO_TITLE,g.ERROR_FETCHING_UPDATE_INFO_MSG),u.reject()}),u.promise()}function u(){c(),l(),window.setInterval(c,_+E)}var d=e("widgets/Dialogs"),p=e("widgets/DefaultDialogs"),h=e("extensibility/ExtensionManager"),f=e("preferences/PreferencesManager"),m=e("utils/NativeApp"),g=e("strings"),v=e("text!htmlContent/update-dialog.html"),y=e("text!htmlContent/update-list.html");e("utils/Global");var _=864e5,E=12e4,b=Number(/-([0-9]+)/.exec(brackets.metadata.version)[1]);f.stateManager.definePreference("lastNotifiedBuildNumber","number",0),f.stateManager.definePreference("lastInfoURLFetchTime","number",0),f.stateManager.definePreference("lastExtensionRegistryCheckTime","number",0),f.stateManager.definePreference("extensionUpdateInfo","Array",[]),f.convertPreferences(n,{lastNotifiedBuildNumber:"user",lastInfoURLFetchTime:"user",updateInfo:"user"},!0);var S=!1;h.on("registryDownload",s),t.launchAutomaticUpdate=u,t.checkForUpdate=c}),define("utils/DragAndDrop",["require","exports","module","utils/Async","command/CommandManager","command/Commands","widgets/Dialogs","widgets/DefaultDialogs","view/MainViewManager","filesystem/FileSystem","file/FileUtils","project/ProjectManager","strings","utils/StringUtils"],function(e,t){"use strict";function n(e){var t,n=e.length;for(t=0;n>t;t++)if("file"===e[t].kind){var r=e[t].webkitGetAsEntry();if(r.isFile)return!0;if(1===n)return!0}return!1}function r(e){var t=[],n={};return o.doInParallel(e,function(r,i){var o=new $.Deferred;return d.resolve(r,function(l,c){if(!l&&c.isFile){if(i<e.length-1&&-1!==u.findInWorkingSet(u.ALL_PANES,r))return void o.resolve();a.execute(s.CMD_ADD_TO_WORKINGSET_AND_OPEN,{fullPath:r,silent:!0}).done(function(){o.resolve()}).fail(function(e){t.push({path:r,error:e}),o.reject()})}else!l&&c.isDirectory&&1===e.length?h.openProject(r).done(function(){o.resolve()}).fail(function(){o.reject()}):(t.push({path:r,error:l||n}),o.reject())}),o.promise()},!1).fail(function(){function e(e){return e===n?f.ERROR_MIXED_DRAGDROP:p.getFileErrorString(e)}if(t.length>0){var r=f.ERROR_OPENING_FILES;r+="<ul class='dialog-list'>",t.forEach(function(t){r+="<li><span class='dialog-filename'>"+m.breakableUrl(h.makeProjectRelativeIfPossible(t.path))+"</span> - "+e(t.error)+"</li>"}),r+="</ul>",l.showModalDialog(c.DIALOG_ID_ERROR,f.ERROR_OPENING_FILE_TITLE,r)}})}function i(){function e(e){e=e.originalEvent||e;var t=e.dataTransfer.files;if(t&&t.length){e.stopPropagation(),e.preventDefault();var r="none";0===$(".modal.instance").length&&n(e.dataTransfer.items)&&(r="copy"),e.dataTransfer.dropEffect=r}}function t(e){e=e.originalEvent||e;var t=e.dataTransfer.files;t&&t.length&&(e.stopPropagation(),e.preventDefault(),brackets.app.getDroppedFiles(function(e,t){e||r(t)}))}$(window.document.body).on("dragover",e).on("drop",t),window.document.body.addEventListener("dragover",function(t){$(t.target).closest(".CodeMirror").length&&e(t)},!0),window.document.body.addEventListener("drop",function(e){$(e.target).closest(".CodeMirror").length&&t(e)},!0)}var o=e("utils/Async"),a=e("command/CommandManager"),s=e("command/Commands"),l=e("widgets/Dialogs"),c=e("widgets/DefaultDialogs"),u=e("view/MainViewManager"),d=e("filesystem/FileSystem"),p=e("file/FileUtils"),h=e("project/ProjectManager"),f=e("strings"),m=e("utils/StringUtils");a.register(f.CMD_OPEN_DROPPED_FILES,s.FILE_OPEN_DROPPED_FILES,r),t.attachHandlers=i,t.isValidDrop=n,t.openDroppedFiles=r}),define("text!htmlContent/problems-panel.html",[],function(){return'<div id="problems-panel" class="bottom-panel vert-resizable top-resizer">\n    <div class="toolbar simple-toolbar-layout">\n        <div class="title"><!-- filled in programmatically --></div>\n        <a href="#" class="close">&times;</a>\n    </div>\n    <div class="table-container resizable-content"></div>\n</div>'}),define("text!htmlContent/problems-panel-table.html",[],function(){return'<table class="bottom-panel-table table table-striped table-condensed row-highlight">\n    <tbody>\n        {{#reportList}}\n        <tr class="inspector-section">\n            <td colspan="3"><span class="disclosure-triangle expanded"></span>{{providerName}} ({{results.length}})</td>\n        </tr>\n        {{#results}}\n        <tr>\n            <td class="line-number" data-character="{{pos.ch}}">{{friendlyLine}}</td>\n            <td class="line-text">{{message}}</td>\n            <td class="line-snippet">{{codeSnippet}}</td>\n        </tr>\n        {{/results}}\n        {{/reportList}}\n    </tbody>\n</table>\n'}),define("language/CodeInspection",["require","exports","module","thirdparty/lodash","command/Commands","view/WorkspaceManager","command/CommandManager","document/DocumentManager","editor/EditorManager","view/MainViewManager","language/LanguageManager","preferences/PreferencesManager","utils/PerfUtils","strings","utils/StringUtils","utils/AppInit","utils/Resizer","widgets/StatusBar","utils/Async","text!htmlContent/problems-panel.html","text!htmlContent/problems-panel-table.html"],function(e,t,n){"use strict";function r(e){v.get(m.NAVIGATE_GOTO_FIRST_PROBLEM).setEnabled(e),K=e}function i(){q={}}function o(e){var t,n,r=b.getLanguageForPath(e).getId(),i=S._buildContext(e,r),o=q[r],a=j.get(F,i),s=j.get(U,i);return o=o&&o.slice(0)||[],a&&a.length?("string"==typeof a&&(a=[a]),t=a.reduce(function(e,t){var n=f.find(o,{name:t});return n&&e.push(n),e},[]),n=s?t:f.union(t,o)):n=o,n}function a(e,t){var n=new $.Deferred,r=[];return t=t||o(e.fullPath),t.length?(y.getDocumentText(e).done(function(i){var o,a=I.markStart("CodeInspection:	"+e.fullPath);o=M.doInParallel(t,function(t){var n=I.markStart("CodeInspection '"+t.name+"':	"+e.fullPath),o=new $.Deferred;if(o.done(function(e){r.push({provider:t,result:e})}),t.scanFileAsync)window.setTimeout(function(){var e={pos:{line:-1,col:0},message:C.format(w.LINTER_TIMED_OUT,t.name,j.get(k)),type:x.ERROR};o.resolve({errors:[e]})},j.get(k)),t.scanFileAsync(i,e.fullPath).done(function(e){I.addMeasurement(n),o.resolve(e)}).fail(function(e){I.finalizeMeasurement(n);var r={pos:{line:-1,col:0},message:C.format(w.LINTER_FAILED,t.name,e),type:x.ERROR};console.error("[CodeInspection] Provider "+t.name+" (async) failed: "+e),o.resolve({errors:[r]})});else try{var a=t.scanFile(i,e.fullPath);I.addMeasurement(n),o.resolve(a)}catch(s){I.finalizeMeasurement(n);var l={pos:{line:-1,col:0},message:C.format(w.LINTER_FAILED,t.name,s),type:x.ERROR};console.error("[CodeInspection] Provider "+t.name+" (sync) threw an error: "+s),o.resolve({errors:[l]})}return o.promise()},!1),o.then(function(){r.sort(function(e,n){return t.indexOf(e.provider)-t.indexOf(n.provider)}),I.addMeasurement(a),n.resolve(r)})}).fail(function(t){console.error("[CodeInspection] Could not read file for inspection: "+e.fullPath),n.reject(t)}),n.promise()):(n.resolve(null),n.promise())}function s(e,t,n){var r,i;if(1===t.length)B.find(".inspector-section").hide(),1!==e||n?(n&&(e+="+"),r=C.format(w.MULTIPLE_ERRORS,t[0].name,e)):r=C.format(w.SINGLE_ERROR,t[0].name);else{if(!(t.length>1))return;B.find(".inspector-section").show(),n&&(e+="+"),r=C.format(w.ERRORS_PANEL_TITLE_MULTIPLE,e)}V.find(".title").text(r),i=C.format(w.STATUSBAR_CODE_INSPECTION_TOOLTIP,r),O.updateIndicator(N,!0,"inspection-errors",i)}function l(){if(!W)return H=!1,z=null,T.hide(V),O.updateIndicator(N,!0,"inspection-disabled",w.LINT_DISABLED),void r(!1);var e=y.getCurrentDocument(),t=e&&o(e.file.fullPath);if(t&&t.length){var n,i=0,l=!1,c=[],u=[];(z=a(e.file,t)).then(function(o){if(this===z){var a=o.reduce(function(e,t){return e+(t.result?t.result.errors.length:0)},0);if(H=Boolean(a),!a){T.hide(V);var d=w.NO_ERRORS_MULTIPLE_PROVIDER;return 1===t.length&&(d=C.format(w.NO_ERRORS,t[0].name)),O.updateIndicator(N,!0,"inspection-valid",d),void r(!1)}var p=I.markStart("ProblemsPanel render:	"+e.file.fullPath);o.forEach(function(t){var n=t.provider;t.result&&(t.result.errors.forEach(function(t){!isNaN(t.pos.line)&&t.pos.line+1>0&&void 0!==(t.codeSnippet=e.getLine(t.pos.line))&&(t.friendlyLine=t.pos.line+1,t.codeSnippet=t.codeSnippet.substr(0,Math.min(175,t.codeSnippet.length))),t.type!==x.META&&i++}),t.result.aborted&&(l=!0),t.result.errors.length&&(c.push({providerName:n.name,results:t.result.errors}),u.push(n)))}),n=Mustache.render(R,{reportList:c}),B.empty().append(n).scrollTop(0),G||T.show(V),s(i,u,l),r(!0),I.addMeasurement(p)}})}else{H=!1,z=null,T.hide(V);var d=e&&b.getLanguageForPath(e.file.fullPath);d?O.updateIndicator(N,!0,"inspection-disabled",C.format(w.NO_LINT_AVAILABLE,d.getName())):O.updateIndicator(N,!0,"inspection-disabled",w.NOTHING_TO_LINT),r(!1)}}function c(e,t){q[e]||(q[e]=[]),q[e].push(t),l()}function u(){W?(E.on("currentFileChange.codeInspection",function(){l()}),y.on("currentDocumentLanguageChanged.codeInspection",function(){l()}).on("documentSaved.codeInspection documentRefreshed.codeInspection",function(e,t){t===y.getCurrentDocument()&&l()})):(y.off(".codeInspection"),E.off(".codeInspection"))}function d(e,t){void 0===e&&(e=!W),e!==W&&(W=e,v.get(m.VIEW_TOGGLE_INSPECTION).setChecked(W),u(),t||(j.set(A,W),j.save()),l())}function p(e,t){void 0===e&&(e=!G),e!==G&&(G=e,t||(j.set(P,G),j.save()),G?T.hide(V):H&&T.show(V))}function h(){l(),K&&V.find("tr:not(.inspector-section)").first().trigger("click")}var f=e("thirdparty/lodash"),m=e("command/Commands"),g=e("view/WorkspaceManager"),v=e("command/CommandManager"),y=e("document/DocumentManager"),_=e("editor/EditorManager"),E=e("view/MainViewManager"),b=e("language/LanguageManager"),S=e("preferences/PreferencesManager"),I=e("utils/PerfUtils"),w=e("strings"),C=e("utils/StringUtils"),D=e("utils/AppInit"),T=e("utils/Resizer"),O=e("widgets/StatusBar"),M=e("utils/Async"),L=e("text!htmlContent/problems-panel.html"),R=e("text!htmlContent/problems-panel-table.html"),N="status-inspection",x={ERROR:"problem_type_error",WARNING:"problem_type_warning",META:"problem_type_meta"},A="enabled",P="collapsed",k="asyncTimeout",F="prefer",U="usePreferredOnly",j=S.getExtensionPrefs("linting");S.convertPreferences(n,{enabled:"user linting.enabled",collapsed:"user linting.collapsed"});var V,B,H,W=!1,G=!1,K=!1,q={},z=null;v.register(w.CMD_VIEW_TOGGLE_INSPECTION,m.VIEW_TOGGLE_INSPECTION,d),v.register(w.CMD_GOTO_FIRST_PROBLEM,m.NAVIGATE_GOTO_FIRST_PROBLEM,h),j.definePreference(A,"boolean",brackets.config["linting.enabled_by_default"]).on("change",function(){d(j.get(A),!0)}),j.definePreference(P,"boolean",!1).on("change",function(){p(j.get(P),!0)}),j.definePreference(k,"number",1e4),D.htmlReady(function(){var e=Mustache.render(L,w);g.createBottomPanel("errors",$(e),100),V=$("#problems-panel");var t;B=V.find(".table-container").on("click","tr",function(e){if(t&&t.removeClass("selected"),t=$(e.currentTarget),t.addClass("selected"),t.hasClass("inspector-section")){t.nextUntil(".inspector-section").toggle();var n=$(".disclosure-triangle",t);n.toggleClass("expanded")}else{var r=t.find(".line-number"),i=parseInt(r.text(),10)-1;if(!isNaN(i)){var o=r.data("character"),a=_.getCurrentFullEditor();a.setCursorPos(i,o,!0),E.focusActivePane()}}}),$("#problems-panel .close").click(function(){p(!0)});var n=Mustache.render('<div id="status-inspection">&nbsp;</div>',w);O.addIndicator(N,$(n),!0,"","","status-indent"),$("#status-inspection").click(function(){H&&p()}),d(j.get(A),!0),p(j.get(P),!0)}),t._unregisterAll=i,t._PREF_ASYNC_TIMEOUT=k,t._PREF_PREFER_PROVIDERS=F,t._PREF_PREFERRED_ONLY=U,t.register=c,t.Type=x,t.toggleEnabled=d,t.inspectFile=a,t.requestRun=l,t.getProvidersForPath=o}),define("language/HTMLUtils",["require","exports","module","thirdparty/CodeMirror2/lib/codemirror","utils/TokenUtils"],function(e,t){"use strict";function n(e){var t=e.token.string,n=t.charAt(0),r=t.charAt(t.length-1),i=p.offsetInToken(e),o=!1;if(t.length>1&&("'"===n||'"'===n)&&r===n&&(o=null!==t.match(/\=\s*['"]$/),!o))return t=t.substring(1,t.length-1),i=i-1>t.length?t.length:i-1,{val:t,offset:i,quoteChar:n,hasEndQuote:!0};if(o){var a=t.indexOf(" "),s=t.indexOf(">"),l=-1!==a&&s>a?a:s;t=t.substring(0,l>i?l:i)}else i>0&&("'"===n||'"'===n)&&(t=t.substring(0,i));return n=t.charAt(0),"'"===n||'"'===n?(t=t.substring(1),i--):(n="",">"===r&&(t="",i=0)),{val:t,offset:i,quoteChar:n,hasEndQuote:!1}}function r(e){var t=e.editor.getMode(),n=d.innerMode(t,e.token.state);return"tag bracket"===e.token.type?n.state.tagName:n.state.tagName||e.token.string}function i(e,t){var n=[],r=p.getInitialContext(e._codeMirror,t),i=$.extend({},r);if("html"===e.getModeForSelection()&&r.token&&!v.test(r.token.type)){for(;p.movePrevToken(r)&&!v.test(r.token.type)&&("error"!==r.token.type||0!==r.token.string.indexOf("<"));)"attribute"===r.token.type&&n.push(r.token.string);for(;p.moveNextToken(i)&&!v.test(i.token.type);)if("attribute"===i.token.type){if(0===i.token.string.indexOf("<"))break;n.push(i.token.string)}else if("error"===i.token.type){if(0===i.token.string.indexOf("<")||0===i.token.string.indexOf(">"))break;/\S/.test(i.token.string)&&-1===i.token.string.indexOf('"')&&-1===i.token.string.indexOf("'")&&-1===i.token.string.indexOf("=")&&n.push(i.token.string)}}return n}function o(e,t,n,r,i,o,a,s){return{tagName:n||"",attr:{name:r||"",value:i||"",valueAssigned:o||!1,quoteChar:a||"",hasEndQuote:s||!1},position:{tokenType:e||"",offset:t||0}}}function a(e){var t=n(e),i=t.val,a=t.offset,s=t.quoteChar,l=t.hasEndQuote,c=e.token.string.length;if(("string"===e.token.type||"error"===e.token.type)&&e.pos.ch===e.token.end&&c>1){var u=e.token.string[0],d=e.token.string[c-1];if(u===d&&("'"===u||'"'===u))return o()}if(!p.moveSkippingWhitespace(p.movePrevToken,e)||"="!==e.token.string)return o();if(!p.moveSkippingWhitespace(p.movePrevToken,e)||"attribute"!==e.token.type)return o();var h=e.token.string,f=r(e);return o(g,a,f,h,i,!0,s,l)}function s(e,t){if(t===!1&&"attribute"!==e.token.type)return o();var i=r(e),a=e.token.string,s=p.offsetInToken(e);if(!p.moveSkippingWhitespace(p.moveNextToken,e)||"="!==e.token.string)return t&&(!e.token.type||e.token.type&&"attribute"!==e.token.type&&-1===e.token.type.indexOf("error")&&-1!==e.token.string.indexOf("<"))?o():o(m,s,i,a);if(!p.moveSkippingWhitespace(p.moveNextToken,e))return o(m,s,i,a);var l=n(e),c=l.val,u=l.quoteChar,d=l.hasEndQuote;return o(m,s,i,a,c,!0,u,d)}function l(e,t){var n,i,l=$.extend({},t),c=p.getInitialContext(e._codeMirror,l),u=p.offsetInToken(c);if("html"!==e.getModeForSelection())return o();if(c.token.string.length>0&&!/\S/.test(c.token.string)){var d={ch:c.pos.ch+1,line:c.pos.line},y=e._codeMirror.getTokenAt(d,!0);if(y.string.length>0&&/\S/.test(y.string)&&">"!==y.string.charAt(0))if(c.token=y,v.test(c.token.type)){if("<"===c.token.string.charAt(0))return o()}else{if("attribute"===c.token.type)return s(c,!1);if("="===c.token.string)return o()}else{if(!p.movePrevToken(c))return o();if("comment"===c.token.type)return o();if(!v.test(c.token.type)&&"="!==c.token.string)return n=a(c),"comment"===c.token.type||v.test(c.token.type)&&(">"===c.token.string||"/>"===c.token.string||"</"===c.token.string)?o():(n.tagName||(n=s(c,!0)),n.tagName?o(m,0,n.tagName):o());i=m,u=0}}if(v.test(c.token.type)){if("tag bracket"!==c.token.type){if(p.movePrevToken(c)&&!/\S/.test(c.token.string))return o();"tag bracket"===c.token.type&&"</"===c.token.string&&(i=f),p.moveNextToken(c)}if(">"===c.token.string||"/>"===c.token.string)return o();if("="!==c.token.string&&null===c.token.string.match(/^["']/))return i||(i=h,"tag bracket"===c.token.type&&("</"===c.token.string?(i=f,u-=2):u=0,0===u&&p.moveNextToken(c))),o(i,u,r(c))}if("="===c.token.string){if(!p.moveSkippingWhitespace(p.movePrevToken,c)||"attribute"!==c.token.type)return o();i=g,u=0}return"attribute"===c.token.type?(n=s(c,!1),n.attr.quoteChar?u=t.ch-c.pos.ch:i===g&&t.ch+1<c.pos.ch&&(n.attr.value="")):n=a(c),i&&n.tagName&&(n.position.tokenType=i,n.position.offset=u),n}function c(e,t){for(var n,r,i=p.getInitialContext(e._codeMirror,{line:0,ch:0}),o=[],a=null,s=!1,l=e._codeMirror.getMode();p.moveNextToken(i,!1);)n=d.innerMode(l,i.token.state).mode.name,s?(a.end||(a.end=a.start),n===r?(a.text=e.document.getRange(a.start,a.end),s=!1):a.end={line:i.pos.line,ch:i.pos.ch}):n===t?(a={start:{line:i.pos.line,ch:i.pos.ch}},o.push(a),s=!0):r=n;return o}function u(e){return c(e,"css")}var d=e("thirdparty/CodeMirror2/lib/codemirror"),p=e("utils/TokenUtils"),h="tagName",f="closingTag",m="attr.name",g="attr.value",v=/^tag/;t.TAG_NAME=h,t.CLOSING_TAG=f,t.ATTR_NAME=m,t.ATTR_VALUE=g,t.getTagInfo=l,t.getTagAttributes=i,t.createTagInfo=o,t.findStyleBlocks=u,t.findBlocks=c}),define("language/CSSUtils",["require","exports","module","thirdparty/CodeMirror2/lib/codemirror","utils/Async","document/DocumentManager","editor/EditorManager","language/HTMLUtils","language/LanguageManager","project/ProjectManager","utils/TokenUtils","thirdparty/lodash"],function(e,t){"use strict";function n(e){var t=U.getLanguageForPath(e).getId();return"less"===t||"scss"===t}function r(e){return/\S/.test(e)}function i(e){var t,n;return e&&e.token&&e.token.state&&"comment"!==e.token.type?(t=e.token.state.localState||e.token.state,t.context?(n=t.context.type,"{"===n||"rule"===n||"block"===n):!1):!1}function o(e){function t(e){return"parens"===e.type&&e.prev?"prop"===e.prev.type?!0:t(e.prev):!1}var n;return e&&e.token&&e.token.state&&"comment"!==e.token.type?(n=e.token.state.localState||e.token.state,n.context&&n.context.prev?"prop"===n.context.type&&("rule"===n.context.prev.type||"block"===n.context.prev.type)||t(n.context):!1):!1}function a(e){var t;return e&&e.token&&e.token.state?(t=e.token.state.localState||e.token.state,t.context?"at"===t.context.type:!1):!1}function s(e,t,n,r,i,o,a){var s={context:e||"",offset:t||0,name:n||"",index:-1,values:[],isNewItem:o===!0,range:a};return(e===G||e===H||e===K)&&(s.index=r,s.values=i),s}function l(e){var t="",n=V.offsetInToken(e),i=e.token.string,o=[";","{","}"];if("property"===e.token.type||"property error"===e.token.type||"tag"===e.token.type)t=i,V.movePrevToken(e)&&r(e.token.string)&&-1===o.indexOf(e.token.string)&&(t=e.token.string+i,n+=e.token.string.length);else if("meta"===e.token.type||"-"===i)t=i,!V.moveNextToken(e)||"property"!==e.token.type&&"property error"!==e.token.type&&"tag"!==e.token.type||(t+=e.token.string);else{if(r(i)&&-1===o.indexOf(i))return s();var a={ch:e.pos.ch+1,line:e.pos.line},c=e.editor.getTokenAt(a,!0);if("property"===c.type||"property error"===c.type||"tag"===c.type)t=c.string,n=0;else if("meta"===c.type||"-"===c.string)return e.pos=a,e.token=c,l(e)}return""===t&&(n=0),s(W,n,t)}function c(e){var t=$.extend({},e),n="";do if(":"!==t.token.string&&!o(t))return"";while(":"!==t.token.string&&V.moveSkippingWhitespace(V.movePrevToken,t));return":"!==t.token.string||!V.moveSkippingWhitespace(V.movePrevToken,t)||"property"!==t.token.type&&"property error"!==t.token.type||(n=t.token.string,V.movePrevToken(t)&&"meta"===t.token.type&&(n=t.token.string+n)),n}function u(e){for(var t,n="",r=[];":"!==e.token.string&&V.movePrevToken(e)&&":"!==e.token.string&&o(e);)t=e.token.string,""!==n&&(t+=n),e.token.string.length>0&&!e.token.string.match(/\S/)||","===e.token.string?n=t:(n="",0===r.length||t.match(/,\s*$/)?r.push(t):r[r.length-1]=t+r[r.length-1]);return r.length>0&&r.reverse(),r}function d(e,t){for(var n=t,r=[];";"!==e.token.string&&"}"!==e.token.string&&V.moveNextToken(e)&&";"!==e.token.string&&"}"!==e.token.string;){if(!o(e)){n="";break}""===n?n=e.token.string.trim():n.length>0&&(e.token.string.length>0&&!e.token.string.match(/\S/)?(n+=e.token.string,r.push(n),n=""):","===e.token.string?n+=e.token.string:n&&n.match(/,$/)?(r.push(n),n=e.token.string.length>0?e.token.string:""):n+=e.token.string)
}return n.length>0&&r.push(n),r}function p(e,t){for(var n={start:{},end:{}};V.moveNextToken(e)&&!r(e.token.string););for(;";"===t.token.string||"}"===t.token.string||!r(t.token.string);)V.movePrevToken(t);return n.start=B.clone(e.pos),n.start.ch=e.token.start,n.end=B.clone(t.pos),n.end.ch=t.token.end,n}function h(e,t){var n,r,i,o,a=$.extend({},e.pos),l=$.extend({},e.pos),h=$.extend({},e.pos),f=V.getInitialContext(t._codeMirror,a),m="",g=[],v=-1,y=V.offsetInToken(e),_=!1,E={ch:e.pos.ch+1,line:e.pos.line},b=t._codeMirror.getTokenAt(E,!0);return(i=c(f))?(n=V.getInitialContext(t._codeMirror,l),g=u(n),m="",":"===e.token.string?(v=0,_=!0):(v=g.length-1,","===e.token.string?(g[v]+=e.token.string,v++,_=!0):(v=0>v?0:v+1,e.token.string.match(/\S/)?m=e.token.string:(_=!0,v>0&&(g[v-1]+=e.token.string.substr(0,y))))),_&&(y=0,t.document.getLine(e.pos.line).length>e.pos.ch&&(0===b.string.length||b.string.match(/\S/))&&(_=!1)),r=V.getInitialContext(t._codeMirror,h),g=g.concat(d(r,m)),o=g.length?p(n,r):{start:B.clone(e.pos),end:B.clone(e.pos)},v===g.length&&(_=!0),s(G,y,i,v,g,_,o)):s()}function f(e,t){var n,r,i=$.extend({},e.pos),o=$.extend({},e.pos),a=0,l=[],c=V.offsetInToken(e);if(e.token.type&&"string"!==e.token.type)return s();for(n=V.getInitialContext(t._codeMirror,i),l[0]=n.token.string;!(!V.movePrevToken(n)||"def"===n.token.type&&"@import"===n.token.string||n.token.type&&"tag"!==n.token.type&&"url"!==n.token.string);)l[0]=n.token.string+l[0],c+=n.token.string.length;if("def"!==n.token.type||"@import"!==n.token.string)return s();r=V.getInitialContext(t._codeMirror,o);do{if(!V.moveNextToken(r)){if("("===r.token.string)break;return s()}l[0]+=r.token.string}while(")"!==r.token.string&&""!==r.token.string);return s(K,c,"",a,l,!1)}function m(e,t){var n=$.extend({},t),r=V.getInitialContext(e._codeMirror,n),c=e.getModeForSelection();return"css"!==c&&"text/x-scss"!==c&&"text/x-less"!==c?s():i(r)?l(r,e):o(r)?h(r,e):a(r)?f(r,e):s()}function g(e,t){if(e.parentSelectors){var n=e.parentSelectors+" / ";return n+=t&&e.selectorGroup?e.selectorGroup:e.selector}return t&&e.selectorGroup?e.selectorGroup:e.selector}function v(e,t){function n(){for(;L.eol();){if(R++,R>=T)return!1;r(k)&&(k+=" "),L=new x.StringStream(D[R])}return!0}function i(){return C=x.startState(P),D=x.splitLines(e),T=D.length,0===T?!1:(R=0,L=new x.StringStream(D[R]),n()?(M=P.token(L,C),O=L.current(),!0):!1)}function o(){return L.start=L.pos,n()?(M=P.token(L,C),O=L.current(),!0):!1}function a(){if(!i())return!1;for(;!r(O);)if(!o())return!1;return!0}function s(){if(!o())return!1;for(;!r(O);)if(!o())return!1;return!0}function l(){return/^\/[\/\*]/.test(O)}function c(){if(!/^\/\//.test(O))for(;!/\*\/$/.test(O)&&o(););}function u(){if(!o())return!1;for(;l();)if(c(),!o())return!1;return!0}function d(e){var t="",n=0;for(e||(e="{");;){if(-1!==O.indexOf(e)&&-1===O.indexOf(X[e]))n++;else if(O===X[e]&&(n--,0>=n))return t+=O;if(t+=O,!u())return t}}function p(){return/^-(moz|ms|o|webkit)-$/.test(O)||"top"!==C.state&&"block"!==C.state&&"pseudo"!==C.state&&-1!==L.string.indexOf(";")&&!/\([^)]+;/.test(L.string)}function h(){for(var e="";";"!==O&&(!(/#\{$/.test(O)||"{"===O&&/[#@]$/.test(e))||(d("{"),"}"===O&&o(),";"!==O));){if("{"===O||"}"===O)return!1;if(e=O,!u())break}return!0}function f(){var e;for(e=A.length-1;e>=0;e--)if(-1===A[e].declListEndLine&&A[e].level<F)return g(A[e],!0);return""}function m(e,t){for(k="",$=e,V=R;","!==O&&"{"!==O||"{"===O&&/[#@]$/.test(k)||","===O&&!r(k);){if("{"===O)k+=d("{"),o();else if("}"===O&&(!k||/:\s*\S/.test(k)||!/#\{.+/.test(k)))return!1;if(";"===O&&"parens"!==C.state||"prop"===C.state&&!/\{/.test(L.string)?k="":"("===O?r(k)?k+=d("("):d("("):(r(O)||r(k))&&(k+=O),!u())return!1}if(!k)return!1;/\\/.test(k)&&(k=k.replace(K,function(e){return e.replace(q,function(e){return e=e.substr(1),1===e.length?e:String.fromCharCode(parseInt(e,16)<1114111?parseInt(e,16):65533)})})),k=k.trim();var n=-1===B?$:$+1,i=-1!==L.string.indexOf(k,$)?L.string.indexOf(k,$-k.length):n;if(""!==k){t>F&&F++,-1===j&&(j=R,U=L.start-k.length);var a=f();A.push({selector:k,ruleStartLine:j,ruleStartChar:U,selectorStartLine:V,selectorStartChar:i,declListEndLine:-1,selectorEndLine:R,selectorEndChar:i+k.length,selectorGroupStartLine:B,selectorGroupStartChar:H,level:F,parentSelectors:a}),k=""}return $=-1,!0}function v(e){if(B=-1!==L.string.indexOf(",")?R:-1,H=L.start,!m(L.start,e))return!1;for(;","===O;){if(!u())return!1;if(!m(L.start,e))return!1}return!0}function y(e){var t;W=Math.min(R,T-1),G=L.start;var n,r;if(-1!==B){for(n="",r=B;W>=r;r++){var i=0,o=D[r].length;r===B?i=H:n+=" ",r===W&&(o=G),n+=D[r].substring(i,o).trim()}n=n.trim()}for(t=A.length-1;t>=0;t--)if(A[t].level===e){if(-1!==A[t].declListEndLine)break;A[t].declListStartLine=W,A[t].declListStartChar=G,n&&(A[t].selectorGroup=n)}var a=!0;do for(B=-1,H=-1,j=-1,U=-1,a||F>0&&F===e&&(F--,"}"===O&&s()),"{"===O&&s(),a=N(void 0,F+1),t=A.length-1;t>=0&&!(A[t].level<F);t--)-1===A[t].declListEndLine&&(A[t].declListEndLine=R,A[t].declListEndChar=L.pos-1);while(F>0&&F===e)}function _(){return-1!==U?!1:L.start>0&&-1!==D[R].substr(0,L.start).indexOf("}")?!1:!0}function E(){return/^@/.test(O)&&!/^@mixin/i.test(O)&&"@"!==O}function b(){return/\}:(enabled|disabled|checked|indeterminate|link|visited|hover|active|focus|target|lang|root|nth-|first-|last-|only-|empty|not)/.test(L.string)}function S(){return/[@#]\{\S+\}(\s*:|.*;)/.test(L.string)&&!b()}function I(e){if(j=-1,U=-1,V=-1,$=-1,B=-1,H=-1,/@media/i.test(O)){for(;"{"!==O;)if(!u())return;if(!s())return;e>=F&&F++,N("}",F+1),F>0&&F--}else for(;";"!==O;){if("{"===O)return void d("{");if(!u())return}}function w(e){return v(e)?(y(e),!0):!1}var C,D,T,O,M,L,R,N,A=[],P=x.getMode({indentUnit:2},t||"css"),k="",F=0,U=-1,j=-1,$=-1,V=-1,B=-1,H=-1,W=-1,G=-1,K=new RegExp("\\\\[^\\\\]+","g"),q=new RegExp("\\\\([a-f0-9]{6}|[a-f0-9]{4}(\\s|\\\\|$)|[a-f0-9]{2}(\\s|\\\\|$)|.)","i");return N=function(e,t){for(;!e||O!==e;){if(S()){if(!h())return!1}else if(E())I(t);else if(l())_()&&(U=L.start,j=R),c();else if(p()){if(!h())return!1}else{if(!w(void 0===t?0:t)&&t>0)return!1;if(t>0)return!0;U=-1,j=-1}if(!s())break}return!0},a()&&N(),A}function y(e){return e=e.trim(),0===e.indexOf("@")?"":e}function _(e){var t=[""],n=[],r=[];return B.forEach(e,function(e){e=y(e),r=e.split(","),n=[],B.forEach(r,function(e){var r=e.indexOf("&");B.forEach(t,function(t){-1===r?(e=y(e),t.length&&e.length&&(t+=" "),t+=e):t=y(e.replace(/&/g,t)),n.push(t)})}),t=n}),t.join(", ")}function E(e,t,n){var r=v(e,n),i=[],o="."===t[0]||"#"===t[0];"."===t[0]&&(t="\\"+t),o||(t="(^|[\\s>+~])"+t);var a=new RegExp(t+"(\\[[^\\]]*\\]|:{1,2}[\\w-()]+|\\.[\\w-]+|#[\\w-]+)*\\s*$",o?"":"i");return r.forEach(function(e){var t=e.selector;if(-1!==e.selector.indexOf("&")&&e.parentSelectors){var n=e.parentSelectors.split(" / ");n.push(e.selector),t=_(n)}-1!==t.search(a)?i.push(e):o||/\*\s*$/.test(t)&&i.push(e)}),i}function b(e,t,n,r){t.forEach(function(t){e.push({name:g(t),document:n,lineStart:t.ruleStartLine+r,lineEnd:t.declListEndLine+r,selectorGroup:t.selectorGroup})})}function S(e,t){function n(e,n){var r=new $.Deferred;return P.getDocumentForPath(e).done(function(e){var i=E(e.getText(),n,e.getLanguage().getMode());b(t,i,e,0),r.resolve()}).fail(function(t){console.warn("Unable to read "+e+" during CSS rule search:",t),r.resolve()}),r.promise()}var r=new $.Deferred;return j.getAllFiles(j.getLanguageFilter(["css","less","scss"])).done(function(t){A.doInParallel(t,function(t){return n(t.fullPath,e)}).then(r.resolve,r.reject)}),r.promise()}function I(e,t,n){var r=k.getCurrentFullEditor();if(r.document!==e)return void console.error("Cannot search for <style> blocks in HTML file other than current editor");var i=F.findStyleBlocks(r);i.forEach(function(r){var i=E(r.text,t);b(n,i,e,r.start.line)})}function w(e,t){var n=new $.Deferred,r=[];return t&&I(t,e,r),S(e,r).done(function(){n.resolve(r)}).fail(function(e){n.reject(e)}),n.promise()}function C(e,t){function i(e,t){var n=0;for(t||(t="}");;){if(t===e.token.string)n++;else if(e.token.string.match(Q[t])&&(n--,0>=n))return;if(!V.movePrevToken(e))return}}function o(e){var t="";for(V.movePrevToken(e);;){if("comment"!==e.token.type){if(/[\{\}\;]/.test(e.token.string))break;if("style"===e.token.string&&"tag"===e.token.type){var n=t.indexOf(">");-1!==n&&(t=t.substring(n+1));break}t=e.token.string+t}if(!V.movePrevToken(e))break}return t}var a=e._codeMirror,s=V.getInitialContext(a,$.extend({},t)),l="",c=!1,u=n(e.document.file.fullPath),d=[],p=!1;u&&r(s.token.string)&&"{"!==s.token.string&&("block"===s.token.state.state||"top"===s.token.state.state)&&(c=!0);do if("comment"!==s.token.type)if("}"===s.token.string){if(!u)break;if("top"===s.token.state.state)break;p=!0,i(s,"}")}else if("{"===s.token.string){if(l=o(s),!u)break;p||/^\s*@/.test(l)||d.unshift(l),p&&(p=!1)}else!u&&r(s.token.string)&&(c=!0),V.movePrevToken(s);else V.movePrevToken(s);while(!V.isAtStart(s));if(l=y(l),s=V.getInitialContext(a,$.extend({},t)),(!l&&!c&&!u||u&&(""===s.token.string||/\s+/.test(s.token.string)))&&V.moveNextToken(s)&&"comment"!==s.token.type&&r(s.token.string)&&(c=!0,s=V.getInitialContext(a,$.extend({},t))),(!l||u)&&c)for(;;){if("comment"!==s.token.type){if("{"===s.token.string){l=o(s),u&&!/^\s*@/.test(l)&&d.push(l);break}if("}"===s.token.string||";"===s.token.string)break}if(!V.moveNextToken(s))break}return u?_(d):y(l)}function D(e){return e.replace(/\/\*(?:(?!\*\/)[\s\S])*\*\//g,"")}function T(e){var t=e.replace(/\\\"|\\\'/g,"");return t.replace(/\"(.*?)\"|\'(.*?)\'/g,"")}function O(e){return T(D(e))}function M(e){var t,n=/(?:flow\-(into|from)\:\s*)([\w\-]+)(?:\s*;)/gi,r=[],i={};for(e=O(e),t=n.exec(e);t;){var o=t[2];-1!==Y.indexOf(o)||i.hasOwnProperty(o)||(i[o]=r.push(o)),t=n.exec(e)}return r}function L(e,t,n,r){var i,o="\n"+t+" {\n";if(n)o+="	",i=1;else{var a;for(a=0;r>a;a++)o+=" ";i=r}o+="\n}\n";var s=e.getText().split("\n"),l=s.length-1,c=s[s.length-1].length;return e.replaceRange(o,{line:l,ch:c}),{range:{from:{line:l+1,ch:0},to:{line:l+3,ch:1}},pos:{line:l+2,ch:i}}}function R(e){var t,n=[];return e.forEach(function(e){e.selectorGroup&&(e.name=e.selectorGroup),t&&e.document===t.document&&e.lineStart===t.lineStart&&e.lineEnd===t.lineEnd&&e.selectorGroup===t.selectorGroup||n.push(e),t=e}),n}function N(e){var t,n,r=0,i=e.document.getText();for(t=0;t<e.startLine;t++)r=i.indexOf("\n",r)+1;for(n=r,t=e.startLine+1;t<=e.endLine+1;t++)n=i.indexOf("\n",n)+1;var o=v(i.substring(r,n));return o.length?o[0].selectorGroup||o[0].selector:""}var x=e("thirdparty/CodeMirror2/lib/codemirror"),A=e("utils/Async"),P=e("document/DocumentManager"),k=e("editor/EditorManager"),F=e("language/HTMLUtils"),U=e("language/LanguageManager"),j=e("project/ProjectManager"),V=e("utils/TokenUtils"),B=e("thirdparty/lodash"),H="selector",W="prop.name",G="prop.value",K="import.url",q=["content","element"],z=["none","inherit","default","auto","initial"],Y=q.concat(z),X={"{":"}","[":"]","(":")"},Q=B.invert(X);t._findAllMatchingSelectorsInText=E,t.findMatchingRules=w,t.extractAllSelectors=v,t.extractAllNamedFlows=M,t.findSelectorAtDocumentPos=C,t.reduceStyleSheetForRegExParsing=O,t.addRuleToDocument=L,t.consolidateRules=R,t.getRangeSelectors=N,t.getCompleteSelectors=g,t.isCSSPreprocessorFile=n,t.SELECTOR=H,t.PROP_NAME=W,t.PROP_VALUE=G,t.IMPORT_URL=K,t.getInfoAtPos=m,t.createInfo=s}),define("utils/DropdownEventHandler",["require","exports","module","command/KeyBindingManager","utils/KeyEvent","widgets/PopUpManager","utils/ViewUtils"],function(e,t){"use strict";function n(e,t,n){this.$list=e,this.$items=e.find("li"),this.selectionCallback=t,this.closeCallback=n,this.scrolling=!1,this._selectedIndex=-1}var r=e("command/KeyBindingManager"),i=e("utils/KeyEvent"),o=e("widgets/PopUpManager"),a=e("utils/ViewUtils");n.prototype.open=function(){function e(e){var t;if("keydown"===e.type){if(t=e.keyCode,t===i.DOM_VK_TAB)n.close();else if(t===i.DOM_VK_UP)n._tryToSelect(-1===n._selectedIndex?-1:n._selectedIndex-1,-1);else if(t===i.DOM_VK_DOWN)n._tryToSelect(-1===n._selectedIndex?0:n._selectedIndex+1,1);else if(t===i.DOM_VK_PAGE_UP)n._tryToSelect((n._selectedIndex||0)-n._itemsPerPage(),-1,!0);else if(t===i.DOM_VK_PAGE_DOWN)n._tryToSelect((n._selectedIndex||0)+n._itemsPerPage(),1,!0);else if(t===i.DOM_VK_HOME)n._tryToSelect(0,1);else if(t===i.DOM_VK_END)n._tryToSelect(n.$items.length-1,-1);else{if(-1===n._selectedIndex||t!==i.DOM_VK_RETURN)return!1;n._selectionHandler()}return e.stopImmediatePropagation(),e.preventDefault(),!0}return!1}function t(){r.removeGlobalKeydownHook(e),n._cleanup()}var n=this;r.addGlobalKeydownHook(e),this.$list&&(this._registerMouseEvents(),o.addPopUp(this.$list,t,!0))},n.prototype.close=function(){this.$list&&o.removePopUp(this.$list)},n.prototype._cleanup=function(){this.$list&&this.$list.off(".dropdownEventHandler"),this.closeCallback&&this.closeCallback()},n.prototype._tryToSelect=function(e,t,n){var r=this.$items.length;n?0>e?(e=0,t=1):e>=r&&(e=r-1,t=-1):(e%=r,0>e&&(e+=r));var i=this.$items.eq(e);i.hasClass("divider")||i.find("a.disabled").length?this._tryToSelect(e+t,t,n):this._setSelectedIndex(e,!0)},n.prototype._itemsPerPage=function(){var e,t=1;return 0!==this.$items.length&&(e=$(this.$items[0]).height(),e&&(t=Math.floor(this.$list.height()/e),t=Math.max(1,Math.min(t,this.$items.length)))),t},n.prototype._selectionHandler=function(){if(-1!==this._selectedIndex){var e=this.$items.eq(this._selectedIndex).find("a");this._clickHandler(e)}},n.prototype._clickHandler=function(e){this.selectionCallback&&this.$list&&e&&(e.hasClass("disabled")||(this.selectionCallback(e),o.removePopUp(this.$list)))},n.prototype._setSelectedIndex=function(e,t){if(e=Math.max(-1,Math.min(e,this.$items.length-1)),-1!==this._selectedIndex&&this.$items.eq(this._selectedIndex).find("a").removeClass("selected"),this._selectedIndex=e,-1!==this._selectedIndex){var n=this.$items.eq(this._selectedIndex);n.find("a").addClass("selected"),t&&(this.scrolling=!0,a.scrollElementIntoView(this.$list,n,!1))}},n.prototype._registerMouseEvents=function(){var e=this;this.$list.on("click.dropdownEventHandler","a",function(){e._clickHandler($(this))}).on("mouseover.dropdownEventHandler","a",function(t){if(e.scrolling)return void(e.scrolling=!1);var n=$(t.currentTarget),r=n.closest("li"),i=e.$list.offset(),o=r.offset();n.hasClass("disabled")||o.top<i.top+e.$list.height()&&i.top<=o.top&&e._setSelectedIndex(e.$items.index(r),!1)})},n.prototype.reRegisterMouseHandlers=function(e){this.$list&&(this.$list.off(".dropdownEventHandler"),this.$list=e,this.$items=e.find("li"),this._registerMouseEvents())},t.DropdownEventHandler=n}),define("widgets/DropdownButton",["require","exports","module","utils/DropdownEventHandler","utils/EventDispatcher","view/WorkspaceManager","command/Menus","utils/ViewUtils","thirdparty/lodash"],function(e,t){"use strict";function n(e,t,n){this.items=t,this.itemRenderer=n||this.itemRenderer,this._onClick=this._onClick.bind(this),this.closeDropdown=this.closeDropdown.bind(this),this._onClickOutside=this._onClickOutside.bind(this),this.$button=$("<button class='btn btn-dropdown'/>").text(e).on("click",this._onClick)}var r=e("utils/DropdownEventHandler").DropdownEventHandler,i=e("utils/EventDispatcher"),o=e("view/WorkspaceManager"),a=e("command/Menus"),s=e("utils/ViewUtils"),l=e("thirdparty/lodash");i.makeEventDispatcher(n.prototype),n.prototype.items=null,n.prototype.$button=null,n.prototype.$dropdown=null,n.prototype.dropdownExtraClasses=null,n.prototype._lastFocus=null,n.prototype._dropdownEventHandler=null,n.prototype._onClick=function(e){this.$button.hasClass("disabled")||this.toggleDropdown(),e.stopPropagation()},n.prototype.setButtonLabel=function(e){this.$button&&$(this.$button).text(e)},n.prototype.itemRenderer=function(e){return l.escape(String(e))},n.prototype._renderList=function(e){if(!e)return null;var t="";return this.items.forEach(function(e,n){if("---"===e)t+="<li class='divider'></li>";else{var r=this.itemRenderer(e,n),i=r.html||r,o=r.html&&!r.enabled?"disabled":"";t+="<li><a class='stylesheet-link "+o+"' data-index='"+n+"'>",t+=i,t+="</a></li>"}}.bind(this)),e.append(t),this.trigger("listRendered",e),this._dropdownEventHandler&&this._dropdownEventHandler.reRegisterMouseHandlers(e),e},n.prototype.refresh=function(){this.$dropdown&&($("li",this.$dropdown).remove(),this._renderList(this.$dropdown))},n.prototype.setChecked=function(e,t){if(this.$dropdown){var n=$("li",this.$dropdown),r=n.length;e>-1&&r>e&&$("a",n[e]).toggleClass("checked",t)}},n.prototype.showDropdown=function(){if(this.items.length&&!this.$dropdown){a.closeAll();var e=$("<ul class='dropdown-menu dropdownbutton-popup' tabindex='-1'>").addClass(this.dropdownExtraClasses).css("min-width",this.$button.outerWidth());this.$dropdown=e,this._renderList(this.$dropdown).appendTo($("body")).data("attached-to",this.$button[0]);var t=this.$button.offset(),n=t.left,i=t.top+this.$button.outerHeight(),l={top:i,left:n,height:e.height(),width:e.width()},c=s.getElementClipSize($(window),l);c.bottom>0&&(i=Math.max(0,t.top-e.height()-4)),c.right>0&&(n=Math.max(0,n-c.right)),e.css({left:n,top:i}),this._dropdownEventHandler=new r(e,this._onSelect.bind(this),this._onDropdownClose.bind(this)),this._dropdownEventHandler.open(),window.document.body.addEventListener("mousedown",this._onClickOutside,!0),o.on("workspaceUpdateLayout",this.closeDropdown),this._lastFocus=window.document.activeElement,e.focus()}},n.prototype._onDropdownClose=function(){window.document.body.removeEventListener("mousedown",this._onClickOutside,!0),o.off("workspaceUpdateLayout",this.closeDropdown),window.document.activeElement===this.$dropdown[0]&&this._lastFocus.focus(),this._dropdownEventHandler=null,this.$dropdown=null},n.prototype.closeDropdown=function(){this._dropdownEventHandler&&this._dropdownEventHandler.close()},n.prototype._onClickOutside=function(e){var t=$(e.target).closest(".dropdownbutton-popup");$(e.target).is(this.$button)||0!==t.length&&t[0]===this.$dropdown[0]||(this.closeDropdown(),e.stopPropagation(),e.preventDefault())},n.prototype.toggleDropdown=function(){this.$dropdown?this.closeDropdown():this.showDropdown()},n.prototype._onSelect=function(e){var t=Number(e.data("index"));this.trigger("select",this.items[t],t)},t.DropdownButton=n}),define("editor/MultiRangeInlineEditor",["require","exports","module","thirdparty/lodash","document/TextRange","editor/InlineTextEditor","editor/EditorManager","file/FileUtils","preferences/PreferencesManager","project/ProjectManager","command/Commands","strings","command/CommandManager"],function(e,t){"use strict";function n(e,t){return parseInt(e.css(t),10)}function r(){var e=y.getProjectRoot();return{location:{scope:"user",layer:"project",layerID:e&&e.fullPath}}}function i(e){this.name=e.name,this.textRange=new h(e.document,e.lineStart,e.lineEnd)}function o(e,t,n){n&&(t.name=n(t.textRange));var r=p.escape(t.name)+" <span class='related-file'>:"+(t.textRange.startLine+1)+"</span>";e.html(r),e.attr("title",e.text())}function a(e,t,n,r){f.call(this),this._ranges=e.map(function(e){return new i(e)}),this._messageCB=t,this._labelCB=n,this._selectedRangeIndex=-1,this._collapsedFiles={},this._fileComparator=r||function(e,t){return g.comparePaths(e.fullPath,t.fullPath)},this._ranges.sort(function(e,t){return this._fileComparator(e.textRange.document.file,t.textRange.document.file)}.bind(this))}function s(){var e=m.getFocusedInlineWidget();return e instanceof a?e:null}function l(){var e=s();e&&e._selectPreviousRange()}function c(){var e=s();e&&e._selectNextRange()}var u,d,p=e("thirdparty/lodash"),h=e("document/TextRange").TextRange,f=e("editor/InlineTextEditor").InlineTextEditor,m=e("editor/EditorManager"),g=e("file/FileUtils"),v=e("preferences/PreferencesManager"),y=e("project/ProjectManager"),_=e("command/Commands"),E=e("strings"),b=e("command/CommandManager");i.prototype.name=null,i.prototype.textRange=null,i.prototype.$listItem=null,a.prototype=Object.create(f.prototype),a.prototype.constructor=a,a.prototype.parentClass=f.prototype,a.prototype.$messageDiv=null,a.prototype.$relatedContainer=null,a.prototype.$related=null,a.prototype.$selectedMarker=null,a.prototype.$rangeList=null,a.prototype._ranges=null,a.prototype._selectedRangeIndex=null,a.prototype._collapsedFiles=null,a.prototype._messageCB=null,a.prototype._labelCB=null,a.prototype._fileComparator=null,a.prototype._$headers=null,a.prototype._createListItem=function(e){var t=this,n=$("<li/>");n.data("filename",e.textRange.document.file.name),n.appendTo(this.$rangeList),o(n,e),n.mousedown(function(){t.setSelectedIndex(t._ranges.indexOf(e))}),e.$listItem=n},a.prototype._toggleSection=function(e,t){var n=this._$headers[e],i=n.find(".disclosure-triangle"),o=i.hasClass("expanded");if(i.toggleClass("expanded"),n.nextUntil(".section-header").toggle(!o),this._collapsedFiles[e]=o,!t){var a=v.getViewState("inlineEditor.collapsedFiles",r())||{};o?a[e]=!0:delete a[e],v.setViewState("inlineEditor.collapsedFiles",a,r())}if(this._updateSelectedMarker(!1),this._ruleListHeightChanged(),-1===this._selectedRangeIndex&&!o&&!t){var s=p.findIndex(this._ranges,function(t){return t.textRange.document.file.fullPath===e});this.setSelectedIndex(s)}},a.prototype._createHeaderItem=function(e){var t=$("<li class='section-header'><span class='disclosure-triangle expanded'/><span class='filename'>"+p.escape(e.file.name)+"</span></li>").attr("title",y.makeProjectRelativeIfPossible(e.file.fullPath)).appendTo(this.$rangeList);t.click(function(){this._toggleSection(e.file.fullPath)}.bind(this)),this._$headers[e.file.fullPath]=t},a.prototype._renderList=function(){function e(){t&&(n._$headers[t.file.fullPath].append(" ("+r+")"),n._collapsedFiles[t.file.fullPath]&&n._toggleSection(t.file.fullPath,!0))}this.$rangeList.empty(),this._$headers={};var t,n=this,r=0;this._ranges.forEach(function(n){t!==n.textRange.document&&(e(),t=n.textRange.document,r=0,this._createHeaderItem(t)),r++,this._createListItem(n)},this),e()},a.prototype.load=function(){a.prototype.parentClass.load.apply(this,arguments),this.$messageDiv=$("<div/>").addClass("inline-editor-message"),this.$editorHolder.on("mousewheel.MultiRangeInlineEditor",function(e){e.stopPropagation()}),this.$relatedContainer=$("<div/>").addClass("related-container"),this.$selectedMarker=$("<div/>").appendTo(this.$relatedContainer).addClass("selection"),this.$related=$("<div/>").appendTo(this.$relatedContainer).addClass("related"),this.$rangeList=$("<ul/>").appendTo(this.$related);var e=v.getViewState("inlineEditor.collapsedFiles",r())||{};Object.keys(e).forEach(function(e){this._collapsedFiles[e]=!0}.bind(this)),this._renderList(),this._ranges.length>1&&this.$wrapper.before(this.$relatedContainer);var t=this;this._ranges.forEach(function(e){e.textRange.on("change",function(){o(e.$listItem,e)}).on("contentChange",function(){o(e.$listItem,e,t._labelCB)}),e.textRange.on("lostSync",function(){t._removeRange(e)})});var n=p.findIndex(this._ranges,function(e){return!this._collapsedFiles[e.textRange.document.file.fullPath]}.bind(this));1===this._ranges.length&&-1===n&&(n=0),this.setSelectedIndex(-1!==n?n:-1);var i=this._onClick.bind(this);this.$htmlContent.on("click.MultiRangeInlineEditor",i),this.$htmlContent.on("mouseup.MultiRangeInlineEditor",i),this.$htmlContent.on("focusin.MultiRangeInlineEditor",this._updateCommands.bind(this)).on("focusout.MultiRangeInlineEditor",this._updateCommands.bind(this))},a.prototype._updateCommands=function(){var e=this.hasFocus()&&this._ranges.length>1;u.setEnabled(e&&this._selectedRangeIndex>0),d.setEnabled(e&&-1!==this._selectedRangeIndex&&this._selectedRangeIndex<this._ranges.length-1)},a.prototype.onAdded=function(){this._updateSelectedMarker(!1),a.prototype.parentClass.onAdded.apply(this,arguments),this._ruleListHeightChanged(),this._updateCommands()},a.prototype.setSelectedIndex=function(e,t){var n=Math.min(Math.max(-1,e),this._ranges.length-1),r=this;if(t||-1===n||n!==this._selectedRangeIndex){var i=this._selectedRangeIndex>=0?this._ranges[this._selectedRangeIndex].$listItem:null;if(i&&i.removeClass("selected"),this.editor&&this.editor.off(".MultiRangeInlineEditor"),this._selectedRangeIndex=n,-1===n){this.setInlineContent(null);var o=this._ranges.length>0;o?this.$messageDiv.text(E.INLINE_EDITOR_HIDDEN_MATCHES):this._messageCB?this._messageCB(o).done(function(e){r.$messageDiv.html(e)}):this.$messageDiv.text(E.INLINE_EDITOR_NO_MATCHES),this.$htmlContent.append(this.$messageDiv),this.sizeInlineWidgetToContents()}else{this.$messageDiv.remove();var a=this._getSelectedRange();a.$listItem.addClass("selected"),this.setInlineContent(a.textRange.document,a.textRange.startLine,a.textRange.endLine),this.editor.focus(),this._updateEditorMinHeight(),this.editor.refresh(),this.editor.on("cursorActivity.MultiRangeInlineEditor",this._ensureCursorVisible.bind(this)),this.sizeInlineWidgetToContents(),this._updateSelectedMarker(!0)}this._updateCommands()}},a.prototype._updateEditorMinHeight=function(){if(this.editor){var e=this.$related.outerHeight(),t=$(".inline-editor-header",this.$htmlContent).outerHeight();e&&t&&$(this.editor.getScrollerElement()).css("min-height",e-t+"px")}},a.prototype._ruleListHeightChanged=function(){this._updateEditorMinHeight(),this.sizeInlineWidgetToContents()},a.prototype._removeRange=function(e){if(this._ranges.length<=1)return void this.close();var t=this._ranges.indexOf(e);t===this._selectedRangeIndex&&this.setSelectedIndex(t+1<this._ranges.length?t+1:t-1),e.textRange.dispose(),this._ranges.splice(t,1),this._renderList(),t<this._selectedRangeIndex&&(this._selectedRangeIndex--,this._updateSelectedMarker(!0)),1===this._ranges.length&&(this.$relatedContainer.remove(),this.editor&&this.editor.refresh()),this._updateCommands()},a.prototype.addAndSelectRange=function(e,t,n,r){var o,a=new i({name:e,document:t,lineStart:n,lineEnd:r});for(o=0;o<this._ranges.length&&!(this._fileComparator(this._ranges[o].textRange.document.file,t.file)>0);o++);this._ranges.splice(o,0,a),this._renderList(),this._ranges.length>1&&!this.$relatedContainer.parent().length&&this.$wrapper.before(this.$relatedContainer),this._collapsedFiles[t.file.fullPath]&&this._toggleSection(t.file.fullPath),this.setSelectedIndex(o,!0),this._updateCommands()},a.prototype._updateSelectedMarker=function(e){if(this._selectedRangeIndex<0||this._collapsedFiles[this._getSelectedRange().textRange.document.file.fullPath])return void this.$selectedMarker.hide();var t=this._ranges[this._selectedRangeIndex].$listItem,r=this.$relatedContainer.height(),i=t.position().top,o=this.$relatedContainer.scrollTop();if(this.$selectedMarker.show().toggleClass("animate",e).css("top",i).height(t.outerHeight()),!(0>=r)){var a=n(t.parent(),"paddingTop");if(o>i-a)this.$relatedContainer.scrollTop(i-a);else{var s=i+t.height()+n(t.parent(),"paddingBottom");s>o+r&&this.$relatedContainer.scrollTop(s-r)}}},a.prototype.onClosed=function(){a.prototype.parentClass.onClosed.apply(this,arguments),this._ranges.forEach(function(e){e.textRange.dispose()}),this.$htmlContent.off(".MultiRangeInlineEditor"),this.$editorHolder.off(".MultiRangeInlineEditor")},a.prototype._onClick=function(e){function t(t){return t.find(e.target).length>0||t[0]===e.target}if(this.editor){var n=this.editor,r=n.getRootElement(),i=$(r).offset();if(!t($(r))&&!t($(".filename",this.$htmlContent))&&(n.focus(),!t(this.$relatedContainer)))if(e.pageY<i.top)n.setCursorPos(0,0);else if(e.pageY>i.top+$(r).height()){var o=n.getLastVisibleLine();n.setCursorPos(o,n.document.getLine(o).length)}}},a.prototype._ensureCursorVisible=function(){if(this.editor&&$.contains(this.editor.getRootElement(),window.document.activeElement)){var e=this.hostEditor.getScrollPos(),t=this.editor._codeMirror.cursorCoords(),n=this.hostEditor.getVirtualScrollAreaTop();this.hostEditor._codeMirror.scrollIntoView({left:e.x,top:t.top-n,right:e.x,bottom:t.bottom-n})}},a.prototype._onLostContent=function(e,t){return t&&"deleted"===t.type?void 0:a.prototype.parentClass._onLostContent.apply(this,arguments)},a.prototype._getRanges=function(){return this._ranges},a.prototype._getSelectedRange=function(){return this._selectedRangeIndex>=0?this._ranges[this._selectedRangeIndex]:null},a.prototype._selectNextPrev=function(e){if(-1!==this._selectedRangeIndex){var t,n=this._ranges[this._selectedRangeIndex].textRange.document;for(t=this._selectedRangeIndex+e;t>=0&&t<this._ranges.length;t+=e){var r=this._ranges[t].textRange.document;if(r===n&&this._collapsedFiles[r.file.fullPath]&&this._toggleSection(r.file.fullPath),!this._collapsedFiles[r.file.fullPath])return void this.setSelectedIndex(t)}}},a.prototype._selectNextRange=function(){this._selectNextPrev(1)},a.prototype._selectPreviousRange=function(){this._selectNextPrev(-1)},a.prototype.sizeInlineWidgetToContents=function(){a.prototype.parentClass.sizeInlineWidgetToContents.call(this);var e=Math.max(this.$related.height(),this.$header.outerHeight()+(-1===this._selectedRangeIndex?this.$messageDiv.outerHeight():this.$editorHolder.height()));e&&this.hostEditor.setInlineWidgetHeight(this,e,!1)},a.prototype.onParentShown=function(){a.prototype.parentClass.onParentShown.apply(this,arguments),this._updateSelectedMarker(!1)},a.prototype.refresh=function(){a.prototype.parentClass.refresh.apply(this,arguments),this.sizeInlineWidgetToContents(),this.editor&&this.editor.refresh()},u=b.register(E.CMD_QUICK_EDIT_PREV_MATCH,_.QUICK_EDIT_PREV_MATCH,l),u.setEnabled(!1),d=b.register(E.CMD_QUICK_EDIT_NEXT_MATCH,_.QUICK_EDIT_NEXT_MATCH,c),d.setEnabled(!1),t.MultiRangeInlineEditor=a,t.getFocusedMultiRangeInlineEditor=s}),define("editor/CSSInlineEditor",["require","exports","module","language/CSSUtils","widgets/DropdownButton","command/CommandManager","command/Commands","document/DocumentManager","editor/EditorManager","editor/Editor","language/LanguageManager","project/ProjectManager","file/FileUtils","language/HTMLUtils","editor/MultiRangeInlineEditor","strings","utils/ViewUtils","thirdparty/lodash"],function(e){"use strict";function t(){return g.getAllFiles(g.getLanguageFilter(["css","less","scss"]))}function n(e,t){var n,r=y.getTagInfo(e,t),i="";if(r.position.tokenType===y.TAG_NAME||r.position.tokenType===y.CLOSING_TAG)i=r.tagName;else if(r.position.tokenType===y.ATTR_NAME||r.position.tokenType===y.ATTR_VALUE)if("class"===r.attr.name){var o=r.attr.value;if(/\S/.test(o)){var a=o.substr(0,r.position.offset).lastIndexOf(" "),s=o.indexOf(" ",r.position.offset);i="."+o.substring(-1===a?0:a+1,-1===s?o.length:s),"."===i&&(i="",n=E.ERROR_CSSQUICKEDIT_BETWEENCLASSES)}else n=E.ERROR_CSSQUICKEDIT_CLASSNOTFOUND}else if("id"===r.attr.name){var l=r.attr.value.trim();l?i="#"+l:n=E.ERROR_CSSQUICKEDIT_IDNOTFOUND}else n=E.ERROR_CSSQUICKEDIT_UNSUPPORTEDATTR;return{selectorName:i,reason:n}}function r(e,t,n){p.getDocumentForPath(n).done(function(r){var i=l.addRuleToDocument(r,e,f.getUseTabChar(n),f.getSpaceUnits(n));t.addAndSelectRange(e,r,i.range.from.line,i.range.to.line),t.editor.setCursorPos(i.pos.line,i.pos.ch)})}function i(){var e=_.getFocusedMultiRangeInlineEditor();if(e){var t=S.find(I,function(t){return t.inlineEditor===e});t&&t.handler()}}function o(e){var t="<span class='stylesheet-name'>"+S.escape(e.name);return e.subDirStr&&(t+="<span class='stylesheet-dir'> — "+S.escape(e.subDirStr)+"</span>"),t+="</span>"}function a(e){function i(e,t){r(D,w,t.fullPath)}function a(){var e=new $.Deferred;return t().done(function(t){e.resolve(t.length?E.CSS_QUICK_EDIT_NO_MATCHES:E.CSS_QUICK_EDIT_NO_STYLESHEETS)}),e}function u(){s.setEnabled(w.hasFocus()&&!C.$button.hasClass("disabled"))}function d(){C.$button.hasClass("disabled")||(1===O.length?r(D,w,O[0].fullPath):C.toggleDropdown())}function p(e,t){var n="css"===m.getLanguageForPath(e.fullPath).getId(),r="css"===m.getLanguageForPath(t.fullPath).getId();return n&&!r?1:!n&&r?-1:v.comparePaths(e.fullPath,t.fullPath)}function h(e){e.sort(p);var t={};return e.forEach(function(e){t[e.name]||(t[e.name]=[]),t[e.name].push(e)}),S.forEach(t,function(e){if(e.length>1){var t=b.getDirNamesForDuplicateFiles(e);e.forEach(function(e,n){e.subDirStr=t[n]
})}}),e}function f(){C.closeDropdown()}if("html"!==e.getLanguageForSelection().getId())return null;var g=e.getSelection();if(g.start.line!==g.end.line)return null;var y=n(e,g.start);if(""===y.selectorName)return y.reason||null;var w,C,D=y.selectorName,T=new $.Deferred,O=[];return l.findMatchingRules(D,e.document).done(function(n){var r=new $.Deferred;w=new _.MultiRangeInlineEditor(l.consolidateRules(n),a,l.getRangeSelectors,p),w.load(e),w.$htmlContent.on("focusin",u).on("focusout",u),w.on("add",function(){r.resolve()}),w.on("close",function(){C.closeDropdown(),e.off("scroll",f)});var s=$(".inline-editor-header",w.$htmlContent);C=new c(E.BUTTON_NEW_RULE,[],o),C.$button.addClass("disabled"),C.$button.addClass("btn-mini stylesheet-button"),s.append(C.$button),I.push({inlineEditor:w,handler:d}),e.on("scroll",f),T.resolve(w);var m=t();$.when(m,r.promise()).done(function(e){O=h(e),O.length>0&&(C.$button.removeClass("disabled"),n.length||C.$button.focus(),1===O.length?(C.$button.removeClass("btn-dropdown"),C.$button.on("click",d)):(C.items=O,C.on("select",i))),u()})}).fail(function(e){console.warn("Error in findMatchingRules()",e),T.reject()}),T.promise()}var s,l=e("language/CSSUtils"),c=e("widgets/DropdownButton").DropdownButton,u=e("command/CommandManager"),d=e("command/Commands"),p=e("document/DocumentManager"),h=e("editor/EditorManager"),f=e("editor/Editor").Editor,m=e("language/LanguageManager"),g=e("project/ProjectManager"),v=e("file/FileUtils"),y=e("language/HTMLUtils"),_=e("editor/MultiRangeInlineEditor"),E=e("strings"),b=e("utils/ViewUtils"),S=e("thirdparty/lodash"),I=[];h.registerInlineEditProvider(a),s=u.register(E.CMD_CSS_QUICK_EDIT_NEW_RULE,d.CSS_QUICK_EDIT_NEW_RULE,i),s.setEnabled(!1)}),define("project/WorkingSetSort",["require","exports","module","command/Commands","command/CommandManager","view/MainViewManager","preferences/PreferencesManager","file/FileUtils","utils/AppInit","strings","thirdparty/lodash"],function(e,t,n){"use strict";function r(e){var t;return e?(t="string"==typeof e?e:e.getID(),I[t]):void console.error("Attempting to get a Sort method with a missing required parameter: command")}function i(e){return e?(D.hasOwnProperty(e)?(e=D[e],y.setViewState(O,e)):e=null,e):null}function o(){return C}function a(){v.off(".sort")}function s(e){C=e,y.setViewState("automaticSort",C),g.get(m.CMD_WORKING_SORT_TOGGLE_AUTO).setChecked(C),w.setChecked(C),C?w.sort():a()}function l(){C&&w&&w.getEvents()&&v.on(w.getEvents(),function(){w.sort()}).on("_workingSetDisableAutoSort.sort",function(){s(!1)})}function c(e){w!==e&&(null!==w&&w.setChecked(!1),C&&e.setChecked(!0),g.get(m.CMD_WORKING_SORT_TOGGLE_AUTO).setEnabled(!!e.getEvents()),y.setViewState(O,e.getCommandID()),w=e)}function u(e,t,n){this._commandID=e,this._compareFn=t,this._events=n}function d(e,t,n){var r="";if(!e||!t)return void console.log("Attempting to register a Sort method with a missing required parameter: command or compare function");if(r="string"==typeof e?e:e.getID(),I[r])return void console.log("Attempting to register an already-registered Sort method: "+e);n&&(n=n.split(" "),n.forEach(function(e,t){n[t]=n[t].trim()+".sort"}),n=n.join(" "));var i=new u(r,t,n);return I[r]=i,i}function p(){s(!o())}function h(e){r(e).execute()}function f(){var e=y.getViewState(O);return e||(e=i(y.getViewState(M))),e||(e=m.CMD_WORKINGSET_SORT_BY_ADDED),e}var m=e("command/Commands"),g=e("command/CommandManager"),v=e("view/MainViewManager"),y=e("preferences/PreferencesManager"),_=e("file/FileUtils"),E=e("utils/AppInit"),b=e("strings"),S=e("thirdparty/lodash"),I=[],w=null,C=!1,D={"view.sortWorkingSetByAdded":"cmd.sortWorkingSetByAdded","view.sortWorkingSetByName":"cmd.sortWorkingSetByName","view.sortWorkingSetByType":"cmd.sortWorkingSetByType"},T="workingSetAdd workingSetAddList",O="workingSetSortMethod",M="currentSort";u.prototype.getCommandID=function(){return this._commandID},u.prototype.getCompareFn=function(){return this._compareFn},u.prototype.getEvents=function(){return this._events},u.prototype.setChecked=function(e){var t=g.get(this._commandID);t&&t.setChecked(e)},u.prototype.execute=function(){c(this),this.sort()},u.prototype.sort=function(){w===this&&(a(),v._sortWorkingSet(v.ALL_PANES,this._compareFn),l())},d(m.CMD_WORKINGSET_SORT_BY_ADDED,function(e,t,n){var r=v.findInWorkingSetByAddedOrder(e,t.fullPath),i=v.findInWorkingSetByAddedOrder(e,n.fullPath);return r-i},T),d(m.CMD_WORKINGSET_SORT_BY_NAME,function(e,t,n){return _.compareFilenames(t.name,n.name,!1)},T),d(m.CMD_WORKINGSET_SORT_BY_TYPE,function(e,t,n){return _.compareFilenames(t.name,n.name,!0)},T),g.register(b.CMD_WORKINGSET_SORT_BY_ADDED,m.CMD_WORKINGSET_SORT_BY_ADDED,S.partial(h,m.CMD_WORKINGSET_SORT_BY_ADDED)),g.register(b.CMD_WORKINGSET_SORT_BY_NAME,m.CMD_WORKINGSET_SORT_BY_NAME,S.partial(h,m.CMD_WORKINGSET_SORT_BY_NAME)),g.register(b.CMD_WORKINGSET_SORT_BY_TYPE,m.CMD_WORKINGSET_SORT_BY_TYPE,S.partial(h,m.CMD_WORKINGSET_SORT_BY_TYPE)),g.register(b.CMD_WORKING_SORT_TOGGLE_AUTO,m.CMD_WORKING_SORT_TOGGLE_AUTO,p),y.stateManager.definePreference("automaticSort","boolean",!1),y.convertPreferences(n,{_LEGACY_SORT_PREF:"user",automaticSort:"user"},!0),y.stateManager.definePreference(O,"string",""),E.appReady(function(){var e=f(),t=r(e),n=y.getViewState("automaticSort");t&&c(t),n&&s(n),t&&n&&t.sort()}),t.register=d,t.get=r,t.getAutomatic=o,t.setAutomatic=s}),define("widgets/ModalBar",["require","exports","module","view/MainViewManager","utils/EventDispatcher","utils/KeyEvent","utils/AnimationUtils","view/WorkspaceManager"],function(e,t){"use strict";function n(e,t,n){if(void 0===n&&(n=!0),this._handleKeydown=this._handleKeydown.bind(this),this._handleFocusChange=this._handleFocusChange.bind(this),this._$root=$("<div class='modal-bar'/>").html(e).insertBefore("#editor-holder"),n&&(this._$root.addClass("popout offscreen"),window.getComputedStyle(this._$root.get(0)).getPropertyValue("top"),this._$root.removeClass("popout offscreen")),r.focusActivePane(),t){this._autoClose=!0,this._$root.on("keydown",this._handleKeydown),window.document.body.addEventListener("focusin",this._handleFocusChange,!0);var i=$("input[type='text']",this._$root).first();i.length>0?i.focus():$("button",this._$root).first().focus()}r.cacheScrollState(r.ALL_PANES),s.recomputeLayout(),r.restoreAdjustedScrollState(r.ALL_PANES,this.height())}var r=e("view/MainViewManager"),i=e("utils/EventDispatcher"),o=e("utils/KeyEvent"),a=e("utils/AnimationUtils"),s=e("view/WorkspaceManager");i.makeEventDispatcher(n.prototype),n.prototype._$root=null,n.prototype._autoClose=!1,n.prototype.isLockedOpen=null,n.prototype.height=function(){return this._$root.outerHeight()},n.prototype.prepareClose=function(e){if(void 0===e&&(e=!0),this._$root.addClass("popout"),!brackets.nativeMenus){var t=$("#titlebar").outerHeight();this._$root.css("top",t+"px")}var n=this.height();e&&r.cacheScrollState(r.ALL_PANES),s.recomputeLayout(),e&&r.restoreAdjustedScrollState(r.ALL_PANES,-n)},n.prototype.close=function(e,t){function n(){o._$root.remove(),i.resolve()}var i=new $.Deferred,o=this;return void 0===e&&(e=!0),void 0===t&&(t=!0),this._$root.hasClass("popout")||this.prepareClose(e),this._autoClose&&window.document.body.removeEventListener("focusin",this._handleFocusChange,!0),this.trigger("close"),t?a.animateUsingClass(this._$root.get(0),"offscreen").done(n):n(),r.focusActivePane(),i.promise()},n.prototype._handleKeydown=function(e){e.keyCode===o.DOM_VK_ESCAPE&&(e.stopPropagation(),e.preventDefault(),this.close())},n.prototype._handleFocusChange=function(e){if(!this.isLockedOpen||!this.isLockedOpen()){var t=$(e.target).data("attached-to")||e.target;$.contains(this._$root.get(0),t)||this.close()}},n.prototype.getRoot=function(){return this._$root},t.ModalBar=n}),define("utils/StringMatch",["require","exports","module","thirdparty/lodash"],function(e,t){"use strict";function n(e){this.label=e}function r(e){var t,n,r=[0],i=0,o=!1;for(t=0;t<e.length;t++)n=e[t],"/"===n?(r.push(t++),r.push(t),i=r.length-1,o=!1):"."===n||"-"===n||"_"===n?(r.push(t++),r.push(t),o=!1):n.toUpperCase()===n?(o&&r.push(t),o=!1):o=!0;return{specials:r,lastSegmentSpecialsIndex:i}}function i(e){_=e}function o(e,t){this.index=e,t&&(this.upper=t)}function a(e,t){this.index=e,t&&(this.upper=t)}function s(e,t,n,r,i,s){function l(){var a;for(a=p;a<i.length&&!(i[a]>=f[u]);a++)if(i[a]<h)p=a;else if(e[u]===t[i[a]]){h=i[a];var s=n[u]===r[h]&&r[h]!==t[h];return d.push(new o(h,s)),p=a,u++,h++,!0}return!1}function c(){for(;d.length>0;){var e=d.pop();if(!e)return!1;if(u--,e instanceof o&&(p--,e.index<f[u]))return f[u]=e.index-1,m=y,(e=d[d.length-1])?(h=e.index+1,!0):(h=i[s]+1,!0)}return!1}var u,d=[],p=s,h=i[s],f=[];for(u=0;u<e.length;u++)f[u]=1/0;u=0;for(var m=v;;){for(;u<e.length&&h<t.length&&h<=f[u];)if(m===v&&(l()||(m=y)),m===y)if(e[u]===t[h]){var g=n[u]===r[h]&&r[h]!==t[h];d.push(new a(h++,g)),u++,m=v}else h++;if(u>=e.length||u<e.length&&!c())break}return u<e.length||0===d.length?null:d}function l(e,t,n,r,i,o){var a,l,c="",u="",d=i[o]+e.length-t.length;for(d>0&&(c=e.substring(0,d),u=n.substring(0,d),e=e.substring(d),n=n.substring(d)),a=0;a<e.length&&(l=s(e.substring(a),t,n.substring(a),r,i,o),!l&&0!==o);a++);return a!==e.length&&l?{remainder:c+e.substring(0,a),originalRemainder:u+n.substring(0,a),matchList:l}:null}function c(e,t,n,r,i,o){var a,c,u=i[o];if(a=l(e,t,n,r,i,o,u)){if(c=a.matchList,a.remainder){var d=s(a.remainder,t.substring(0,u),a.originalRemainder,r.substring(0,u),i.slice(0,o),0);if(!d)return null;c.unshift.apply(c,d)}}else c=s(e,t,n,r,i,0);return c}function u(e,t,n){function r(e){h&&(h.includesLastSegment=c>=n,h.matched&&h.includesLastSegment&&(_&&(s.lastSegment+=u*C),p+=u*C),h.matched&&!d&&(_&&(s.notStartingOnSpecial-=T),p-=T),l.push(h)),e>c+1&&l.push({text:t.substring(c+1,e),matched:!1,includesLastSegment:e>n}),h=null,u=0}function i(e){var i=e.index,a=0;if(_&&(s.match+=b),a+=b,e.upper&&(_&&(s.upper+=S),a+=S),i===n&&(_&&(s.beginning+=w),a+=w),p>0&&c+1===i){i-f===n&&(_&&(s.beginning+=w),a+=w),f++;var l=I*f;d&&(l=2*l),_&&(s.consecutive+=l),a+=l}else f=1;e instanceof o&&(_&&(s.special+=E),a+=E),p+=a,i>=n&&(u+=a),(h&&!h.matched||i>c+1)&&r(i),c=i,h?h.text+=t[i]:(h={text:t[i],matched:!0},d=e instanceof o)}var a,s,l=[],c=-1,u=0,d=!1,p=0;_&&(s={special:0,match:0,upper:0,lastSegment:0,beginning:0,lengthDeduction:0,consecutive:0,notStartingOnSpecial:0});var h=null,f=0;for(a=0;a<e.length;a++){var m=e[a];i(m)}r(t.length);var g=-1*Math.round(t.length*D);_&&(s.lengthDeduction=g),p+=g;var v={ranges:l,matchGoodness:p};return _&&(v.scoreDebug=s),v}function d(e,t){var r=new n(e);return r.matchGoodness=-Number.MAX_VALUE,e.substr(0,t.length)!==t&&(r.matchGoodness*=.5),_&&(r.scoreDebug={beginning:-r.matchGoodness}),r.stringRanges=[{text:e.substr(0,t.length),matched:!0,includesLastSegment:!0}],e.length>t.length&&r.stringRanges.push({text:e.substring(t.length),matched:!1,includesLastSegment:!0}),r}function p(e,t,i,o){var a;if(i=i||{},!t)return a=new n(e),a.matchGoodness=0,_&&(a.scoreDebug={}),a.stringRanges=[{text:e,matched:!1,includesLastSegment:!0}],a;var l=t.toLowerCase(),p=e.toLowerCase();if(i.preferPrefixMatches&&(i.segmentedSearch=!1),i.preferPrefixMatches&&p.substr(0,l.length)===l)return d(e,t);o||(o=r(e));var h,f;if(i.segmentedSearch?(h=o.specials[o.lastSegmentSpecialsIndex],f=c(l,p,t,e,o.specials,o.lastSegmentSpecialsIndex)):(h=0,f=s(l,p,t,e,o.specials,0)),f){var m=u(f,e,h);a=new n(e),a.stringRanges=m.ranges,a.matchGoodness=-1*m.matchGoodness,_&&(a.scoreDebug=m.scoreDebug)}return a}function h(e,t){var n;Array.isArray(t)?n=t:(n=[],g.forEach(t,function(e,t){n[e]=t})),e.sort(function(e,t){var r;for(r=0;r<n.length;r++){var i=n[r];if("function"==typeof i){var o=i(e,t);if(o)return o}else{var a=e[i],s=t[i];if("string"==typeof a&&(a=a.toLowerCase(),s=s.toLowerCase()),s>a)return-1;if(a>s)return 1}}return 0})}function f(e){h(e,{matchGoodness:0,label:1})}function m(e){this.options=e,this.reset()}var g=e("thirdparty/lodash"),v=0,y=1,_=!1,E=40,b=10,S=100,I=8,w=13,C=1,D=.2,T=25;m.prototype._specialsCache=null,m.prototype._noMatchCache=null,m.prototype.reset=function(){this._lastQuery=null,this._specialsCache={},this._noMatchCache={}},m.prototype.match=function(e,t){if(null!==this._lastQuery&&this._lastQuery!==t.substring(0,this._lastQuery.length)&&(this._noMatchCache={}),this._lastQuery=t,g.has(this._noMatchCache,e))return void 0;var n=g.has(this._specialsCache,e)?this._specialsCache[e]:void 0;void 0===n&&(n=r(e),this._specialsCache[e]=n);var i=p(e,t,this.options,n);return i||(this._noMatchCache[e]=!0),i},t._findSpecialCharacters=r,t._wholeStringSearch=c,t._lastSegmentSearch=l,t._setDebugScores=i,t._generateMatchList=s,t._SpecialMatch=o,t._NormalMatch=a,t._computeRangesAndScore=u,t.SearchResult=n,t.stringMatch=p,t.basicMatchSort=f,t.multiFieldSort=h,t.StringMatcher=m}),define("search/QuickOpen",["require","exports","module","document/DocumentManager","editor/EditorManager","view/MainViewManager","view/MainViewFactory","command/CommandManager","strings","utils/StringUtils","command/Commands","project/ProjectManager","language/LanguageManager","utils/KeyEvent","widgets/ModalBar","utils/StringMatch","utils/ViewUtils"],function(e,t){"use strict";function n(e,t,n,r,i,o,a,s,l,c){this.name=e,this.languageIds=t,this.done=n,this.search=r,this.match=i,this.itemFocus=o,this.itemSelect=a,this.resultsFormatter=s,this.matcherOptions=l,this.label=c}function r(e){F.push(new n(e.name,e.languageIds,e.done,e.search,e.match,e.itemFocus,e.itemSelect,e.resultsFormatter,e.matcherOptions,e.label))}function i(){this.$searchField=void 0,this._handleItemSelect=this._handleItemSelect.bind(this),this._handleItemFocus=this._handleItemFocus.bind(this),this._handleKeyUp=this._handleKeyUp.bind(this),this._handleResultsReady=this._handleResultsReady.bind(this),this._handleShowResults=this._handleShowResults.bind(this),this._handleBlur=this._handleBlur.bind(this),this._handleDocumentMouseDown=this._handleDocumentMouseDown.bind(this),this._filterCallback=this._filterCallback.bind(this),this._resultsFormatterCallback=this._resultsFormatterCallback.bind(this),this._filenameMatcher=new A.StringMatcher({segmentedSearch:!0}),this._matchers={}}function o(e,t){var n;return t?n=e.length:(n=e.lastIndexOf("."),-1===n&&(n=e.length)),e.slice(e.lastIndexOf("/")+1,n)}function a(e){var t=e.match(k);return e.length<=1||!t||t[1]&&isNaN(t[1])||t[3]&&isNaN(t[3])?null:{query:t[0],local:0===e.indexOf(":"),line:t[1]-1||0,ch:t[3]-1||0}}function s(){var e=$("input#quickOpenSearch").data("smart-autocomplete").rawResults;return e||[]}function l(e){if(!e)return null;var t=$(e).index(),n=s();return n[t]}function c(e){var t=$("input#quickOpenSearch").val();return t!==e}function u(e,t){if(!_){var n=new $.Deferred;return E.done(function(){c(e)?n.reject():n.resolve(u(e,t))}),n.promise()}var r=a(e);r&&!r.local&&""!==r.query&&(e=e.replace(r.query,""));var i=$.map(_,function(n){var r;return r=t.match(L.makeProjectRelativeIfPossible(n.fullPath),e),r&&(r.label=n.name,r.fullPath=n.fullPath,r.filenameWithoutExtension=o(n.name,!1)),r});return A.multiFieldSort(i,{matchGoodness:0,filenameWithoutExtension:1,label:2,fullPath:3}),i}function d(e,t,n){var r=e.label||e;t=t||"quicksearch-namematch";var i=e.stringRanges;i||(i=[{text:r,matched:!1,includesLastSegment:!0}]);var o="";if(e.scoreDebug){var a=e.scoreDebug;o+='<span title="sp:'+a.special+", m:"+a.match+", ls:"+a.lastSegment+", b:"+a.beginning+", ld:"+a.lengthDeduction+", c:"+a.consecutive+", nsos: "+a.notStartingOnSpecial+", upper: "+a.upper+'">('+e.matchGoodness+") </span>"}return i.forEach(function(e){e.matched&&(o+="<span class='"+t+"'>");var r=n?n(e.includesLastSegment,e.text):e.text;o+=O.breakableUrl(r),e.matched&&(o+="</span>")}),o}function p(e,t){t=t.slice(t.indexOf("@")+1,t.length);var n=d(e);return"<li>"+n+"</li>"}function h(e){function t(e,t){if(e){var n=t.lastIndexOf("/");return t.substring(n+1)}return""}var n=d(e,null,t),r=d(e,"quicksearch-pathmatch");return"<li>"+n+"<br /><span class='quick-open-path'>"+r+"</span></li>"}function f(){var e=I.getActiveEditor();return e&&e.getSelectedText()||""}function m(e,t){function n(){b=new i,b.showDialog(e,t)}b?b.isOpen?b.setSearchFieldValue(e,t):b.close().done(n):n()}function g(){m("",f())}function v(){S.getCurrentDocument()&&m(":","")}function y(){S.getCurrentDocument()&&m("@",f())}var _,E,b,S=e("document/DocumentManager"),I=e("editor/EditorManager"),w=e("view/MainViewManager"),C=e("view/MainViewFactory"),D=e("command/CommandManager"),T=e("strings"),O=e("utils/StringUtils"),M=e("command/Commands"),L=e("project/ProjectManager"),R=e("language/LanguageManager"),N=e("utils/KeyEvent"),x=e("widgets/ModalBar").ModalBar,A=e("utils/StringMatch"),P=e("utils/ViewUtils"),k=new RegExp(":([^,]+)?(,(.+)?)?"),F=[],U=null;i.prototype.isOpen=!1,i.prototype._filenameMatcher=null,i.prototype._matchers=null,i.prototype._closeDeferred=null,i.prototype._origDocPath=null,i.prototype._origSelections=null,i.prototype._origScrollPos=null,i.prototype._handleItemSelect=function(e,t){t||(t=$(".smart_autocomplete_container > li:first-child").get(0));var n=l(t),r=!0,i=this,o=this.$searchField.val(),s=a(o);if(U)U.itemSelect(n);else{var c=n&&n.fullPath;c?(r=!1,this.modalBar.prepareClose(),D.execute(M.CMD_ADD_TO_WORKINGSET_AND_OPEN,{fullPath:c}).done(function(){if(s){var e=I.getCurrentFullEditor();e.setCursorPos(s.line,s.ch,!0)}}).always(function(){i.close()})):s&&I.getCurrentFullEditor().setCursorPos(s.line,s.ch,!0)}r&&(this.close(null,null,!0),w.focusActivePane())},i.prototype._handleItemFocus=function(e,t){var n=l(t);U&&U.itemFocus&&U.itemFocus(n)},i.prototype._handleKeyUp=function(e){if(e.keyCode===N.DOM_VK_RETURN||e.keyCode===N.DOM_VK_ESCAPE){e.stopImmediatePropagation(),e.preventDefault();var t=this;setTimeout(function(){e.keyCode===N.DOM_VK_ESCAPE?t.close(t._origScrollPos,t._origSelections,!0):e.keyCode===N.DOM_VK_RETURN&&t._handleItemSelect(null,$(".smart_autocomplete_highlight").get(0))},0)}},i.prototype._isValidLineNumberQuery=function(e){if(":"===e)return!0;var t=a(e),n=I.getCurrentFullEditor();return t&&n&&t.line>=n.getFirstVisibleLine()&&t.line<=n.getLastVisibleLine()},i.prototype._handleResultsReady=function(e,t){var n=0===t.length&&(_||U)&&!this._isValidLineNumberQuery(this.$searchField.val());P.toggleClass(this.$searchField,"no-results",n)},i.prototype._handleShowResults=function(){0===$(".smart_autocomplete_highlight").length&&this._handleItemFocus(null,$(".smart_autocomplete_container > li:first-child").get(0))},i.prototype.close=function(e,t,n){if(!this.isOpen)return this._closeDeferred.promise();this.isOpen=!1,this._closeDeferred=new $.Deferred;var r;for(r=0;r<F.length;r++){var i=F[r];i.done&&i.done()}this.$searchField.trigger("lostFocus");var o=this;return setTimeout(function(){o.modalBar.close(!!n).done(function(){o._closeDeferred.resolve()});var r=I.getCurrentFullEditor();t&&r.setSelections(t),e&&r.setScrollPos(e.x,e.y)},0),$(".smart_autocomplete_container").remove(),$(window.document).off("mousedown",this._handleDocumentMouseDown),this._closeDeferred.promise()},i.prototype._filterCallback=function(e){if(c(e))return s();var t=a(e);if(t&&t.local){var n={line:t.line,ch:t.ch},r={line:t.line};I.getCurrentFullEditor().setSelection(n,r,!0)}var i,o=S.getCurrentDocument();o&&(i=o.getLanguage().getId());var l;for(l=0;l<F.length;l++){var d=F[l],p=0===d.languageIds.length||-1!==d.languageIds.indexOf(i);if(p&&d.match&&d.match(e)){U=d;var h=this._matchers[U.name];return h||(h=new A.StringMatcher(d.matcherOptions),this._matchers[U.name]=h),this._updateDialogLabel(d,e),d.search(e,h)}}return this._updateDialogLabel(null,e),U=null,u(e,this._filenameMatcher)},i.prototype._resultsFormatterCallback=function(e){var t,n=this.$searchField.val();return(t=U?U.resultsFormatter||p:h)(e,n)},i.prototype.setSearchFieldValue=function(e,t){e=e||"",t=t||"",t=e+t;var n=this.$searchField;n.val(t).focus(),n.get(0).setSelectionRange(e.length,t.length),n.trigger("keyIn",[t])},i.prototype._updateDialogLabel=function(e,t){var n="";if(e&&e.label)n=e.label;else{var r=t.length>0?t.charAt(0):"";switch(r){case":":n=T.CMD_GOTO_LINE+"…";break;case"@":n=T.CMD_GOTO_DEFINITION+"…";break;default:n=""}}$(".find-dialog-label",this.dialog).text(n)},i.prototype._handleDocumentMouseDown=function(e){0===this.modalBar.getRoot().find(e.target).length&&0===$(".smart_autocomplete_container").find(e.target).length?this.close(null,null,!0):$("input#quickOpenSearch").get(0)!==e.target&&(e.preventDefault(),e.stopPropagation())},i.prototype._handleBlur=function(){var e,t,n=S.getCurrentDocument();n&&this._origDocPath===n.file.fullPath&&(e=this._origScrollPos,t=this._origSelections),this.close(e,t,!0)},i.prototype.showDialog=function(e,t){function n(e){return!R.getLanguageForPath(e.fullPath).isBinary()||C.findSuitableFactoryForPath(e.fullPath)}if(!this.isOpen){this.isOpen=!0,$(window.document).on("mousedown",this._handleDocumentMouseDown);var r=S.getCurrentDocument();this._origDocPath=r?r.file.fullPath:null,r?(this._origSelections=I.getCurrentFullEditor().getSelections(),this._origScrollPos=I.getCurrentFullEditor().getScrollPos()):(this._origSelections=null,this._origScrollPos=null);var i="<div align='right'><input type='text' autocomplete='off' id='quickOpenSearch' placeholder='"+T.CMD_QUICK_OPEN+"…' style='width: 30em'><span class='find-dialog-label'></span></div>";this.modalBar=new x(i,!1),this.$searchField=$("input#quickOpenSearch"),this.$searchField.bind({resultsReady:this._handleResultsReady,showResults:this._handleShowResults,itemSelect:this._handleItemSelect,itemFocus:this._handleItemFocus,keyup:this._handleKeyUp,blur:this._handleBlur}),this.$searchField.smartAutoComplete({source:[],maxResults:20,minCharLimit:0,autocompleteFocused:!0,forceSelect:!1,typeAhead:!1,filter:this._filterCallback,resultFormatter:this._resultsFormatterCallback}),this.setSearchFieldValue(e,t),E=L.getAllFiles(n,!0).done(function(e){_=e,E=null,this._filenameMatcher.reset()}.bind(this))}},L.on("projectOpen",function(){_=null}),D.register(T.CMD_QUICK_OPEN,M.NAVIGATE_QUICK_OPEN,g),D.register(T.CMD_GOTO_DEFINITION,M.NAVIGATE_GOTO_DEFINITION,y),D.register(T.CMD_GOTO_LINE,M.NAVIGATE_GOTO_LINE,v),t.beginSearch=m,t.addQuickOpenPlugin=r,t.highlightMatch=d,t.stringMatch=A.stringMatch,t.SearchResult=A.SearchResult,t.basicMatchSort=A.basicMatchSort,t.multiFieldSort=A.multiFieldSort}),define("project/SidebarView",["require","exports","module","utils/AppInit","project/ProjectManager","project/WorkingSetView","view/MainViewManager","command/CommandManager","command/Commands","strings","utils/Resizer","thirdparty/lodash"],function(e,t){"use strict";function n(){var e=S.getProjectRoot().name,t=S.getProjectRoot().fullPath;""===e&&"/"===t&&(e="/"),m.html(M.escape(e)),m.attr("title",t),g.trigger("scroll")}function r(){O.toggle(p)}function i(){O.show(p)}function o(){O.hide(p)}function a(){return O.isVisible(p)}function s(){1===w.getPaneCount()&&0===w.getWorkingSetSize(w.ACTIVE_PANE)?(v.hide(),h.hide()):(v.show(),h.show())}function l(){var e,t=["splitview-icon-none","splitview-icon-vertical","splitview-icon-horizontal"],n=w.getLayoutScheme();e=n.columns>1?1:n.rows>1?2:0,f.removeClass(t.join(" ")).addClass(t[e]),y.setChecked(0===e),_.setChecked(1===e),E.setChecked(2===e),s()}function c(){w.setLayoutScheme(1,1)}function u(){w.setLayoutScheme(1,2)}function d(){w.setLayoutScheme(2,1)}var p,h,f,m,g,v,y,_,E,b=e("utils/AppInit"),S=e("project/ProjectManager"),I=e("project/WorkingSetView"),w=e("view/MainViewManager"),C=e("command/CommandManager"),D=e("command/Commands"),T=e("strings"),O=e("utils/Resizer"),M=e("thirdparty/lodash");b.htmlReady(function(){function e(){var e;p.find(".sidebar-selection").each(function(t,n){e=$(n),e.width(e.parent()[0].scrollWidth)})}p=$("#sidebar"),h=p.find(".working-set-option-btn"),f=p.find(".working-set-splitview-btn"),m=p.find("#project-title"),g=p.find("#project-files-container"),v=p.find("#working-set-list-container"),p.on("panelResizeStart",function(){p.find(".sidebar-selection-extension").css("display","none"),p.find(".scroller-shadow").css("display","none")}),p.on("panelResizeUpdate",function(e,t){p.find(".sidebar-selection").width(t),S._setFileTreeSelectionWidth(t)}),p.on("panelResizeEnd",function(t,n){e(),p.find(".sidebar-selection-extension").css("display","block").css("left",n),p.find(".scroller-shadow").css("display","block"),g.triggerHandler("scroll"),I.syncSelectionIndicator()}),p.on("panelCollapsed",function(){C.get(D.VIEW_HIDE_SIDEBAR).setName(T.CMD_SHOW_SIDEBAR)}),p.on("panelExpanded",function(t,n){I.refresh(),e(),p.find(".scroller-shadow").css("display","block"),p.find(".sidebar-selection-extension").css("left",n),g.triggerHandler("scroll"),I.syncSelectionIndicator(),C.get(D.VIEW_HIDE_SIDEBAR).setName(T.CMD_HIDE_SIDEBAR)}),p.is(":visible")||p.trigger("panelCollapsed"),w.on("paneCreate",function(e,t){I.createWorkingSetViewForPane(v,t)}),w.on("paneLayoutChange",function(){l()}),w.on("workingSetAdd workingSetAddList workingSetRemove workingSetRemoveList workingSetUpdate",function(){s()}),M.forEach(w.getPaneIdList(),function(e){I.createWorkingSetViewForPane(v,e)}),l(),h.attr("title",T.GEAR_MENU_TOOLTIP),f.attr("title",T.SPLITVIEW_MENU_TOOLTIP)}),S.on("projectOpen",n),y=C.register(T.CMD_SPLITVIEW_NONE,D.CMD_SPLITVIEW_NONE,c),_=C.register(T.CMD_SPLITVIEW_VERTICAL,D.CMD_SPLITVIEW_VERTICAL,u),E=C.register(T.CMD_SPLITVIEW_HORIZONTAL,D.CMD_SPLITVIEW_HORIZONTAL,d),C.register(T.CMD_HIDE_SIDEBAR,D.VIEW_HIDE_SIDEBAR,r),t.toggle=r,t.show=i,t.hide=o,t.isVisible=a}),define("LiveDevelopment/Servers/BaseServer",["require","exports","module"],function(e,t){"use strict";function n(e){this._baseUrl=e.baseUrl,this._root=e.root,this._pathResolver=e.pathResolver,this._liveDocuments={}}n.prototype.getBaseUrl=function(){return this._baseUrl},n.prototype._setDocInfo=function(e){var t,n,r=e.doc;n=/^(.*\/)(.+\.([^.]+))$/.exec(r.file.fullPath),n&&(r.extension=n[3],t=this.pathToUrl(n[1]),r.url=t+encodeURI(n[2]),r.root={url:r.url},r.isDirty&&e._updateBrowser&&e._updateBrowser())},n.prototype.pathToUrl=function(e){var t=this.getBaseUrl(),n=this._pathResolver(e);if(n!==e){var r=encodeURI(e),i=encodeURI(this._root);return r.replace(i,t)}return null},n.prototype.urlToPath=function(e){var t,n="";return n=this.getBaseUrl(),""!==n&&0===e.indexOf(n)?(t=e.replace(n,encodeURI(this._root)),decodeURI(t)):null},n.prototype.readyToServe=function(){return $.Deferred().resolve().promise()},n.prototype.canServe=function(){return!0},n.prototype._documentKey=function(e){return"/"+encodeURI(this._pathResolver(e))},n.prototype.add=function(e){if(e){var t=this._documentKey(e.doc.file.fullPath);this._setDocInfo(e),this._liveDocuments[t]=e}},n.prototype.remove=function(e){if(e){var t=this._liveDocuments[this._documentKey(e.doc.file.fullPath)];t&&delete this._liveDocuments[t]}},n.prototype.get=function(e){return this._liveDocuments[this._documentKey(e)]},n.prototype.clear=function(){this._liveDocuments={}},n.prototype.start=function(){},n.prototype.stop=function(){},t.BaseServer=n}),define("LiveDevelopment/Servers/FileServer",["require","exports","module","LiveDevelopment/Servers/BaseServer","file/FileUtils"],function(e,t){"use strict";function n(e){r.call(this,e)}var r=e("LiveDevelopment/Servers/BaseServer").BaseServer,i=e("file/FileUtils"),o="win"===brackets.platform?"file:///":"file://";n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.prototype.canServe=function(e){return!this._baseUrl&&i.isStaticHtmlFileExt(e)},n.prototype.urlToPath=function(e){return 0===e.indexOf(o)?decodeURI(e.slice(o.length)):null},n.prototype.pathToUrl=function(e){return encodeURI(o+e)},t.FileServer=n}),define("LiveDevelopment/LiveDevelopmentUtils",["require","exports","module","language/LanguageManager","project/ProjectManager"],function(e,t){"use strict";function n(e){return e?-1!==s.indexOf(o.getLanguageForPath(e).getId()):!1}function r(e){return e?-1!==l.indexOf(o.getLanguageForPath(e).getId()):!1}function i(e){return n(e)||a.getBaseUrl()&&r(e)}var o=e("language/LanguageManager"),a=e("project/ProjectManager"),s=["htm","html","xhtml"],l=["php","php3","php4","php5","phtm","phtml","cfm","cfml","asp","aspx","jsp","jspx","shtm","shtml"];t.isHtmlFileExt=i,t.isStaticHtmlFileExt=n,t.isServerHtmlFileExt=r}),define("LiveDevelopment/LiveDevServerManager",["require","exports","module"],function(e,t){"use strict";function n(e,t){return t.priority-e.priority}function r(e){var t,n,r;for(r=0;r<o.length;r++)if(t=o[r],n=t.create(),n.canServe(e))return n;return null}function i(e,t){if(!e.create)return void console.error("Incompatible live development server provider");var r={};r.create=e.create,r.priority=t||0,o.push(r),o.sort(n)}var o=[];t.getProvider=r,t.registerProvider=i,t.getServer=r,t.registerServer=i}),define("LiveDevelopment/Servers/UserServer",["require","exports","module","LiveDevelopment/Servers/BaseServer","LiveDevelopment/LiveDevelopmentUtils"],function(e,t){"use strict";function n(e){r.call(this,e)}var r=e("LiveDevelopment/Servers/BaseServer").BaseServer,i=e("LiveDevelopment/LiveDevelopmentUtils");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.prototype.canServe=function(e){return this._baseUrl?e===this._pathResolver(e)?!1:i.isStaticHtmlFileExt(e)||i.isServerHtmlFileExt(e):!1},t.UserServer=n}),define("LiveDevelopment/Agents/CSSAgent",["require","exports","module","thirdparty/path-utils/path-utils.min","thirdparty/lodash","LiveDevelopment/Inspector/Inspector","utils/EventDispatcher"],function(e,t){"use strict";function n(e){return PathUtils.parseUrl(e).hrefNoSearch}function r(e,t){t.frame.parentId||(v={})}function i(e){var t,r={};e=n(e);for(t in v)v[t].canonicalizedURL===e&&(r[t]=v[t]);return r}function o(e,t){var n,r=i(e.url),o=[];void 0===t&&(t=e.getText());for(n in r)o.push(m.CSS.setStyleSheetText(r[n].styleSheetId,t));return o.length?$.when.apply($,o):(console.error("Style Sheet for document not loaded: "+e.url),(new $.Deferred).reject().promise())}function a(e){return o(e,"")}function s(e,r){var o,a=n(r.header.sourceURL),s=i(r.header.sourceURL),l=r.header.styleSheetId;o=f.some(s,function(e){return e&&e.styleSheetId===l}),o||(v[l]=r.header,v[l].canonicalizedURL=a,t.trigger("styleSheetAdded",a,r.header))}function l(e,n){var r=v[n.styleSheetId];delete v[n.styleSheetId],t.trigger("styleSheetRemoved",r.canonicalizedURL,r)}function c(){var e,t,n;return void 0===h&&(e=/Chrome\/(\d+)\./,t=m.getUserAgent(),n=t.match(e),n&&parseInt(n[1],10)>=34)?(h=!0,void m.Page.off("frameStoppedLoading.CSSAgent",c)):void m.send("CSS","getAllStyleSheets").done(function(e){e.headers.forEach(function(e){h=!1,s(null,{header:e})})}).fail(function(e){h=-32601===e.code,m.Page.off("frameStoppedLoading.CSSAgent",c)})}function u(){return m.CSS.enable()}function d(){m.Page.on("frameNavigated.CSSAgent",r),m.CSS.on("styleSheetAdded.CSSAgent",s),m.CSS.on("styleSheetRemoved.CSSAgent",l),h||m.Page.on("frameStoppedLoading.CSSAgent",c)}function p(){m.Page.off(".CSSAgent"),m.CSS.off(".CSSAgent")}e("thirdparty/path-utils/path-utils.min");var h,f=e("thirdparty/lodash"),m=e("LiveDevelopment/Inspector/Inspector"),g=e("utils/EventDispatcher"),v={};g.makeEventDispatcher(t),t.enable=u,t.styleForURL=i,t.reloadCSSForDocument=o,t.clearCSSForDocument=a,t.load=d,t.unload=p}),define("text!LiveDevelopment/Agents/RemoteFunctions.js",[],function(){return'/*\n * Copyright (c) 2012 Adobe Systems Incorporated. All rights reserved.\n *  \n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the "Software"), \n * to deal in the Software without restriction, including without limitation \n * the rights to use, copy, modify, merge, publish, distribute, sublicense, \n * and/or sell copies of the Software, and to permit persons to whom the \n * Software is furnished to do so, subject to the following conditions:\n *  \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *  \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER \n * DEALINGS IN THE SOFTWARE.\n * \n */\n\n\n/*jslint vars: true, plusplus: true, browser: true, nomen: true, indent: 4, forin: true, maxerr: 50, regexp: true */\n/*jshint unused: false */\n/*global window, navigator, Node, console */\n/*theseus instrument: false */\n\n/**\n * RemoteFunctions define the functions to be executed in the browser. This\n * modules should define a single function that returns an object of all\n * exported functions.\n */\nfunction RemoteFunctions(experimental) {\n    "use strict";\n\n    var lastKeepAliveTime = Date.now();\n    \n    /**\n     * @type {DOMEditHandler}\n     */\n    var _editHandler;\n    \n    var HIGHLIGHT_CLASSNAME = "__brackets-ld-highlight",\n        KEEP_ALIVE_TIMEOUT  = 3000;   // Keep alive timeout value, in milliseconds\n    \n    // determine whether an event should be processed for Live Development\n    function _validEvent(event) {\n        if (navigator.platform.substr(0, 3) === "Mac") {\n            // Mac\n            return event.metaKey;\n        } else {\n            // Windows\n            return event.ctrlKey;\n        }\n    }\n\n    // determine the color for a type\n    function _typeColor(type, highlight) {\n        switch (type) {\n        case "html":\n            return highlight ? "#eec" : "#ffe";\n        case "css":\n            return highlight ? "#cee" : "#eff";\n        case "js":\n            return highlight ? "#ccf" : "#eef";\n        default:\n            return highlight ? "#ddd" : "#eee";\n        }\n    }\n\n    // compute the screen offset of an element\n    function _screenOffset(element) {\n        var elemBounds = element.getBoundingClientRect(),\n            body = window.document.body,\n            offsetTop,\n            offsetLeft;\n\n        if (window.getComputedStyle(body).position === "static") {\n            offsetLeft = elemBounds.left + window.pageXOffset;\n            offsetTop = elemBounds.top + window.pageYOffset;\n        } else {\n            var bodyBounds = body.getBoundingClientRect();\n            offsetLeft = elemBounds.left - bodyBounds.left;\n            offsetTop = elemBounds.top - bodyBounds.top;\n        }\n        return { left: offsetLeft, top: offsetTop };\n    }\n\n    // set an event on a element\n    function _trigger(element, name, value, autoRemove) {\n        var key = "data-ld-" + name;\n        if (value !== undefined && value !== null) {\n            element.setAttribute(key, value);\n            if (autoRemove) {\n                window.setTimeout(element.removeAttribute.bind(element, key));\n            }\n        } else {\n            element.removeAttribute(key);\n        }\n    }\n\n    // construct the info menu\n    function Menu(element) {\n        this.element = element;\n        _trigger(this.element, "showgoto", 1, true);\n        window.setTimeout(window.remoteShowGoto);\n        this.remove = this.remove.bind(this);\n    }\n\n    Menu.prototype = {\n        onClick: function (url, event) {\n            event.preventDefault();\n            _trigger(this.element, "goto", url, true);\n            this.remove();\n        },\n\n        createBody: function () {\n            if (this.body) {\n                return;\n            }\n\n            // compute the position on screen\n            var offset = _screenOffset(this.element),\n                x = offset.left,\n                y = offset.top + this.element.offsetHeight;\n\n            // create the container\n            this.body = document.createElement("div");\n            this.body.style.setProperty("z-index", 2147483647);\n            this.body.style.setProperty("position", "absolute");\n            this.body.style.setProperty("left", x + "px");\n            this.body.style.setProperty("top", y + "px");\n            this.body.style.setProperty("font-size", "11pt");\n\n            // draw the background\n            this.body.style.setProperty("background", "#fff");\n            this.body.style.setProperty("border", "1px solid #888");\n            this.body.style.setProperty("-webkit-box-shadow", "2px 2px 6px 0px #ccc");\n            this.body.style.setProperty("border-radius", "6px");\n            this.body.style.setProperty("padding", "6px");\n        },\n\n        addItem: function (target) {\n            var item = document.createElement("div");\n            item.style.setProperty("padding", "2px 6px");\n            if (this.body.childNodes.length > 0) {\n                item.style.setProperty("border-top", "1px solid #ccc");\n            }\n            item.style.setProperty("cursor", "pointer");\n            item.style.setProperty("background", _typeColor(target.type));\n            item.innerHTML = target.name;\n            item.addEventListener("click", this.onClick.bind(this, target.url));\n\n            if (target.file) {\n                var file = document.createElement("i");\n                file.style.setProperty("float", "right");\n                file.style.setProperty("margin-left", "12px");\n                file.innerHTML = " " + target.file;\n                item.appendChild(file);\n            }\n            this.body.appendChild(item);\n        },\n\n        show: function () {\n            if (!this.body) {\n                this.body = this.createBody();\n            }\n            if (!this.body.parentNode) {\n                document.body.appendChild(this.body);\n            }\n            document.addEventListener("click", this.remove);\n        },\n\n        remove: function () {\n            if (this.body && this.body.parentNode) {\n                document.body.removeChild(this.body);\n            }\n            document.removeEventListener("click", this.remove);\n        }\n\n    };\n\n    function Editor(element) {\n        this.onBlur = this.onBlur.bind(this);\n        this.onKeyPress = this.onKeyPress.bind(this);\n\n        this.element = element;\n        this.element.setAttribute("contenteditable", "true");\n        this.element.focus();\n        this.element.addEventListener("blur", this.onBlur);\n        this.element.addEventListener("keypress", this.onKeyPress);\n\n        this.revertText = this.element.innerHTML;\n\n        _trigger(this.element, "edit", 1);\n    }\n\n    Editor.prototype = {\n        onBlur: function (event) {\n            this.element.removeAttribute("contenteditable");\n            this.element.removeEventListener("blur", this.onBlur);\n            this.element.removeEventListener("keypress", this.onKeyPress);\n            _trigger(this.element, "edit", 0, true);\n        },\n\n        onKeyPress: function (event) {\n            switch (event.which) {\n            case 13: // return\n                this.element.blur();\n                break;\n            case 27: // esc\n                this.element.innerHTML = this.revertText;\n                this.element.blur();\n                break;\n            }\n        }\n    };\n\n    function Highlight(color, trigger) {\n        this.color = color;\n        this.trigger = !!trigger;\n        this.elements = [];\n        this.selector = "";\n    }\n\n    Highlight.prototype = {\n        _elementExists: function (element) {\n            var i;\n            for (i in this.elements) {\n                if (this.elements[i] === element) {\n                    return true;\n                }\n            }\n            return false;\n        },\n\n        _makeHighlightDiv: function (element, doAnimation) {\n            var elementBounds = element.getBoundingClientRect(),\n                highlight = window.document.createElement("div"),\n                styles = window.getComputedStyle(element);\n            \n            // Don\'t highlight elements with 0 width & height\n            if (elementBounds.width === 0 && elementBounds.height === 0) {\n                return;\n            }\n            \n            highlight.className = HIGHLIGHT_CLASSNAME;\n            \n            var offset = _screenOffset(element);\n\n            var stylesToSet = {\n                "left": offset.left + "px",\n                "top": offset.top + "px",\n                "width": elementBounds.width + "px",\n                "height": elementBounds.height + "px",\n                "z-index": 2000000,\n                "margin": 0,\n                "padding": 0,\n                "position": "absolute",\n                "pointer-events": "none",\n                "border-top-left-radius": styles.borderTopLeftRadius,\n                "border-top-right-radius": styles.borderTopRightRadius,\n                "border-bottom-left-radius": styles.borderBottomLeftRadius,\n                "border-bottom-right-radius": styles.borderBottomRightRadius,\n                "border-style": "solid",\n                "border-width": "1px",\n                "border-color": "#00a2ff",\n                "box-shadow": "0 0 1px #fff",\n                "box-sizing": "border-box"\n            };\n            \n            var animateStartValues = {\n                "background-color": "rgba(0, 162, 255, 0.5)",\n                "opacity": 0\n            };\n            \n            var animateEndValues = {\n                "background-color": "rgba(0, 162, 255, 0)",\n                "opacity": 1\n            };\n            \n            var transitionValues = {\n                "-webkit-transition-property": "opacity, background-color",\n                "-webkit-transition-duration": "300ms, 2.3s",\n                "transition-property": "opacity, background-color",\n                "transition-duration": "300ms, 2.3s"\n            };\n            \n            function _setStyleValues(styleValues, obj) {\n                var prop;\n                \n                for (prop in styleValues) {\n                    obj.setProperty(prop, styleValues[prop]);\n                }\n            }\n\n            _setStyleValues(stylesToSet, highlight.style);\n            _setStyleValues(\n                doAnimation ? animateStartValues : animateEndValues,\n                highlight.style\n            );\n            \n            \n            if (doAnimation) {\n                _setStyleValues(transitionValues, highlight.style);\n                \n                window.setTimeout(function () {\n                    _setStyleValues(animateEndValues, highlight.style);\n                }, 20);\n            }\n        \n            window.document.body.appendChild(highlight);\n        },\n        \n        add: function (element, doAnimation) {\n            if (this._elementExists(element) || element === document) {\n                return;\n            }\n            if (this.trigger) {\n                _trigger(element, "highlight", 1);\n            }\n            this.elements.push(element);\n            \n            this._makeHighlightDiv(element, doAnimation);\n        },\n\n        clear: function () {\n            var i, highlights = window.document.querySelectorAll("." + HIGHLIGHT_CLASSNAME),\n                body = window.document.body;\n        \n            for (i = 0; i < highlights.length; i++) {\n                body.removeChild(highlights[i]);\n            }\n\n            if (this.trigger) {\n                for (i = 0; i < this.elements.length; i++) {\n                    _trigger(this.elements[i], "highlight", 0);\n                }\n            }\n            \n            this.elements = [];\n        },\n        \n        redraw: function () {\n            var i, highlighted;\n            \n            // When redrawing a selector-based highlight, run a new selector\n            // query to ensure we have the latest set of elements to highlight.\n            if (this.selector) {\n                highlighted = window.document.querySelectorAll(this.selector);\n            } else {\n                highlighted = this.elements.slice(0);\n            }\n            \n            this.clear();\n            for (i = 0; i < highlighted.length; i++) {\n                this.add(highlighted[i], false);\n            }\n        }\n    };\n\n    var _currentEditor;\n    function _toggleEditor(element) {\n        _currentEditor = new Editor(element);\n    }\n\n    var _currentMenu;\n    function _toggleMenu(element) {\n        if (_currentMenu) {\n            _currentMenu.remove();\n        }\n        _currentMenu = new Menu(element);\n    }\n\n    var _localHighlight;\n    var _remoteHighlight;\n    var _setup = false;\n\n\n    /** Event Handlers ***********************************************************/\n\n    function onMouseOver(event) {\n        if (_validEvent(event)) {\n            _localHighlight.add(event.target, true);\n        }\n    }\n\n    function onMouseOut(event) {\n        if (_validEvent(event)) {\n            _localHighlight.clear();\n        }\n    }\n\n    function onMouseMove(event) {\n        onMouseOver(event);\n        document.removeEventListener("mousemove", onMouseMove);\n    }\n\n    function onClick(event) {\n        if (_validEvent(event)) {\n            event.preventDefault();\n            event.stopPropagation();\n            if (event.altKey) {\n                _toggleEditor(event.target);\n            } else {\n                _toggleMenu(event.target);\n            }\n        }\n    }\n\n    function onKeyUp(event) {\n        if (_setup && !_validEvent(event)) {\n            document.removeEventListener("keyup", onKeyUp);\n            document.removeEventListener("mouseover", onMouseOver);\n            document.removeEventListener("mouseout", onMouseOut);\n            document.removeEventListener("mousemove", onMouseMove);\n            document.removeEventListener("click", onClick);\n            _localHighlight.clear();\n            _localHighlight = undefined;\n            _setup = false;\n        }\n    }\n\n    function onKeyDown(event) {\n        if (!_setup && _validEvent(event)) {\n            document.addEventListener("keyup", onKeyUp);\n            document.addEventListener("mouseover", onMouseOver);\n            document.addEventListener("mouseout", onMouseOut);\n            document.addEventListener("mousemove", onMouseMove);\n            document.addEventListener("click", onClick);\n            _localHighlight = new Highlight("#ecc", true);\n            _setup = true;\n        }\n    }\n\n    /** Public Commands **********************************************************/\n\n    // keep alive. Called once a second when a Live Development connection is active.\n    // If several seconds have passed without this method being called, we can assume\n    // that the connection has been severed and we should remove all our code/hooks.\n    function keepAlive() {\n        lastKeepAliveTime = Date.now();\n    }\n    \n    // show goto\n    function showGoto(targets) {\n        if (!_currentMenu) {\n            return;\n        }\n        _currentMenu.createBody();\n        var i;\n        for (i in targets) {\n            _currentMenu.addItem(targets[i]);\n        }\n        _currentMenu.show();\n    }\n\n    // remove active highlights\n    function hideHighlight() {\n        if (_remoteHighlight) {\n            _remoteHighlight.clear();\n            _remoteHighlight = null;\n        }\n    }\n\n    // highlight a node\n    function highlight(node, clear) {\n        if (!_remoteHighlight) {\n            _remoteHighlight = new Highlight("#cfc");\n        }\n        if (clear) {\n            _remoteHighlight.clear();\n        }\n        _remoteHighlight.add(node, true);\n    }\n\n    // highlight a rule\n    function highlightRule(rule) {\n        hideHighlight();\n        var i, nodes = document.querySelectorAll(rule);\n        for (i = 0; i < nodes.length; i++) {\n            highlight(nodes[i]);\n        }\n        _remoteHighlight.selector = rule;\n    }\n    \n    // redraw active highlights\n    function redrawHighlights() {\n        if (_remoteHighlight) {\n            _remoteHighlight.redraw();\n        }\n    }\n    \n    window.addEventListener("resize", redrawHighlights);\n    // Add a capture-phase scroll listener to update highlights when\n    // any element scrolls.\n    \n    function _scrollHandler(e) {\n        // Document scrolls can be updated immediately. Any other scrolls\n        // need to be updated on a timer to ensure the layout is correct.\n        if (e.target === document) {\n            redrawHighlights();\n        } else {\n            if (_remoteHighlight || _localHighlight) {\n                window.setTimeout(redrawHighlights, 0);\n            }\n        }\n    }\n    \n    window.addEventListener("scroll", _scrollHandler, true);\n    \n    var aliveTest = window.setInterval(function () {\n        if (Date.now() > lastKeepAliveTime + KEEP_ALIVE_TIMEOUT) {\n            // Remove highlights\n            hideHighlight();\n            \n            // Remove listeners\n            window.removeEventListener("resize", redrawHighlights);\n            window.removeEventListener("scroll", _scrollHandler, true);\n            \n            // Clear this interval\n            window.clearInterval(aliveTest);\n        }\n    }, 1000);\n    \n    /**\n     * Constructor\n     * @param {Document} htmlDocument\n     */\n    function DOMEditHandler(htmlDocument) {\n        this.htmlDocument = htmlDocument;\n        this.rememberedNodes = null;\n        this.entityParseParent = htmlDocument.createElement("div");\n    }\n\n    /**\n     * @private\n     * Find the first matching element with the specified data-brackets-id\n     * @param {string} id\n     * @return {Element}\n     */\n    DOMEditHandler.prototype._queryBracketsID = function (id) {\n        if (!id) {\n            return null;\n        }\n        \n        if (this.rememberedNodes && this.rememberedNodes[id]) {\n            return this.rememberedNodes[id];\n        }\n        \n        var results = this.htmlDocument.querySelectorAll("[data-brackets-id=\'" + id + "\']");\n        return results && results[0];\n    };\n    \n    /**\n     * @private\n     * Insert a new child element\n     * @param {Element} targetElement Parent element already in the document\n     * @param {Element} childElement New child element\n     * @param {Object} edit\n     */\n    DOMEditHandler.prototype._insertChildNode = function (targetElement, childElement, edit) {\n        var before = this._queryBracketsID(edit.beforeID),\n            after  = this._queryBracketsID(edit.afterID);\n        \n        if (edit.firstChild) {\n            before = targetElement.firstChild;\n        } else if (edit.lastChild) {\n            after = targetElement.lastChild;\n        }\n        \n        if (before) {\n            targetElement.insertBefore(childElement, before);\n        } else if (after && (after !== targetElement.lastChild)) {\n            targetElement.insertBefore(childElement, after.nextSibling);\n        } else {\n            targetElement.appendChild(childElement);\n        }\n    };\n    \n    /**\n     * @private\n     * Given a string containing encoded entity references, returns the string with the entities decoded.\n     * @param {string} text The text to parse.\n     * @return {string} The decoded text.\n     */\n    DOMEditHandler.prototype._parseEntities = function (text) {\n        // Kind of a hack: just set the innerHTML of a div to the text, which will parse the entities, then\n        // read the content out.\n        var result;\n        this.entityParseParent.innerHTML = text;\n        result = this.entityParseParent.textContent;\n        this.entityParseParent.textContent = "";\n        return result;\n    };\n    \n    /**\n     * @private\n     * @param {Node} node\n     * @return {boolean} true if node expects its content to be raw text (not parsed for entities) according to the HTML5 spec.\n     */\n    function _isRawTextNode(node) {\n        return (node.nodeType === Node.ELEMENT_NODE && /script|style|noscript|noframes|noembed|iframe|xmp/i.test(node.tagName));\n    }\n    \n    /**\n     * @private\n     * Replace a range of text and comment nodes with an optional new text node\n     * @param {Element} targetElement\n     * @param {Object} edit\n     */\n    DOMEditHandler.prototype._textReplace = function (targetElement, edit) {\n        function prevIgnoringHighlights(node) {\n            do {\n                node = node.previousSibling;\n            } while (node && node.className === HIGHLIGHT_CLASSNAME);\n            return node;\n        }\n        function nextIgnoringHighlights(node) {\n            do {\n                node = node.nextSibling;\n            } while (node && node.className === HIGHLIGHT_CLASSNAME);\n            return node;\n        }\n        function lastChildIgnoringHighlights(node) {\n            node = (node.childNodes.length ? node.childNodes.item(node.childNodes.length - 1) : null);\n            if (node && node.className === HIGHLIGHT_CLASSNAME) {\n                node = prevIgnoringHighlights(node);\n            }\n            return node;\n        }\n        \n        var start           = (edit.afterID)  ? this._queryBracketsID(edit.afterID)  : null,\n            startMissing    = edit.afterID && !start,\n            end             = (edit.beforeID) ? this._queryBracketsID(edit.beforeID) : null,\n            endMissing      = edit.beforeID && !end,\n            moveNext        = start && nextIgnoringHighlights(start),\n            current         = moveNext || (end && prevIgnoringHighlights(end)) || lastChildIgnoringHighlights(targetElement),\n            next,\n            textNode        = (edit.content !== undefined) ? this.htmlDocument.createTextNode(_isRawTextNode(targetElement) ? edit.content : this._parseEntities(edit.content)) : null,\n            lastRemovedWasText,\n            isText;\n        \n        // remove all nodes inside the range\n        while (current && (current !== end)) {\n            isText = current.nodeType === Node.TEXT_NODE;\n\n            // if start is defined, delete following text nodes\n            // if start is not defined, delete preceding text nodes\n            next = (moveNext) ? nextIgnoringHighlights(current) : prevIgnoringHighlights(current);\n\n            // only delete up to the nearest element.\n            // if the start/end tag was deleted in a prior edit, stop removing\n            // nodes when we hit adjacent text nodes\n            if ((current.nodeType === Node.ELEMENT_NODE) ||\n                    ((startMissing || endMissing) && (isText && lastRemovedWasText))) {\n                break;\n            } else {\n                lastRemovedWasText = isText;\n\n                if (current.remove) {\n                    current.remove();\n                } else if (current.parentNode && current.parentNode.removeChild) {\n                    current.parentNode.removeChild(current);\n                }\n                current = next;\n            }\n        }\n        \n        if (textNode) {\n            // OK to use nextSibling here (not nextIgnoringHighlights) because we do literally\n            // want to insert immediately after the start tag.\n            if (start && start.nextSibling) {\n                targetElement.insertBefore(textNode, start.nextSibling);\n            } else if (end) {\n                targetElement.insertBefore(textNode, end);\n            } else {\n                targetElement.appendChild(textNode);\n            }\n        }\n    };\n    \n    /**\n     * @private\n     * Apply an array of DOM edits to the document\n     * @param {Array.<Object>} edits\n     */\n    DOMEditHandler.prototype.apply = function (edits) {\n        var targetID,\n            targetElement,\n            childElement,\n            self = this;\n        \n        this.rememberedNodes = {};\n        \n        edits.forEach(function (edit) {\n            var editIsSpecialTag = edit.type === "elementInsert" && (edit.tag === "html" || edit.tag === "head" || edit.tag === "body");\n            \n            if (edit.type === "rememberNodes") {\n                edit.tagIDs.forEach(function (tagID) {\n                    var node = self._queryBracketsID(tagID);\n                    self.rememberedNodes[tagID] = node;\n                    if (node.remove) {\n                        node.remove();\n                    } else if (node.parentNode && node.parentNode.removeChild) {\n                        node.parentNode.removeChild(node);\n                    }\n                });\n                return;\n            }\n            \n            targetID = edit.type.match(/textReplace|textDelete|textInsert|elementInsert|elementMove/) ? edit.parentID : edit.tagID;\n            targetElement = self._queryBracketsID(targetID);\n            \n            if (!targetElement && !editIsSpecialTag) {\n                console.error("data-brackets-id=" + targetID + " not found");\n                return;\n            }\n            \n            switch (edit.type) {\n            case "attrChange":\n            case "attrAdd":\n                targetElement.setAttribute(edit.attribute, self._parseEntities(edit.value));\n                break;\n            case "attrDelete":\n                targetElement.removeAttribute(edit.attribute);\n                break;\n            case "elementDelete":\n                if (targetElement.remove) {\n                    targetElement.remove();\n                } else if (targetElement.parentNode && targetElement.parentNode.removeChild) {\n                    targetElement.parentNode.removeChild(targetElement);\n                }\n                break;\n            case "elementInsert":\n                childElement = null;\n                if (editIsSpecialTag) {\n                    // If we already have one of these elements (which we should), then\n                    // just copy the attributes and set the ID.\n                    childElement = self.htmlDocument[edit.tag === "html" ? "documentElement" : edit.tag];\n                    if (!childElement) {\n                        // Treat this as a normal insertion.\n                        editIsSpecialTag = false;\n                    }\n                }\n                if (!editIsSpecialTag) {\n                    childElement = self.htmlDocument.createElement(edit.tag);\n                }\n                \n                Object.keys(edit.attributes).forEach(function (attr) {\n                    childElement.setAttribute(attr, self._parseEntities(edit.attributes[attr]));\n                });\n                childElement.setAttribute("data-brackets-id", edit.tagID);\n                \n                if (!editIsSpecialTag) {\n                    self._insertChildNode(targetElement, childElement, edit);\n                }\n                break;\n            case "elementMove":\n                childElement = self._queryBracketsID(edit.tagID);\n                self._insertChildNode(targetElement, childElement, edit);\n                break;\n            case "textInsert":\n                var textElement = self.htmlDocument.createTextNode(_isRawTextNode(targetElement) ? edit.content : self._parseEntities(edit.content));\n                self._insertChildNode(targetElement, textElement, edit);\n                break;\n            case "textReplace":\n            case "textDelete":\n                self._textReplace(targetElement, edit);\n                break;\n            }\n        });\n        \n        this.rememberedNodes = {};\n        \n        // update highlight after applying diffs\n        redrawHighlights();\n    };\n    \n    function applyDOMEdits(edits) {\n        _editHandler.apply(edits);\n    }\n    \n    /**\n     *\n     * @param {Element} elem\n     */\n    function _domElementToJSON(elem) {\n        var json = { tag: elem.tagName.toLowerCase(), attributes: {}, children: [] },\n            i,\n            len,\n            node,\n            value;\n        \n        len = elem.attributes.length;\n        for (i = 0; i < len; i++) {\n            node = elem.attributes.item(i);\n            value = (node.name === "data-brackets-id") ? parseInt(node.value, 10) : node.value;\n            json.attributes[node.name] = value;\n        }\n        \n        len = elem.childNodes.length;\n        for (i = 0; i < len; i++) {\n            node = elem.childNodes.item(i);\n            \n            // ignores comment nodes and visuals generated by live preview\n            if (node.nodeType === Node.ELEMENT_NODE && node.className !== HIGHLIGHT_CLASSNAME) {\n                json.children.push(_domElementToJSON(node));\n            } else if (node.nodeType === Node.TEXT_NODE) {\n                json.children.push({ content: node.nodeValue });\n            }\n        }\n        \n        return json;\n    }\n    \n    function getSimpleDOM() {\n        return JSON.stringify(_domElementToJSON(document.documentElement));\n    }\n\n    // init\n    _editHandler = new DOMEditHandler(window.document);\n    \n    if (experimental) {\n        window.document.addEventListener("keydown", onKeyDown);\n    }\n\n    return {\n        "DOMEditHandler"        : DOMEditHandler,\n        "keepAlive"             : keepAlive,\n        "showGoto"              : showGoto,\n        "hideHighlight"         : hideHighlight,\n        "highlight"             : highlight,\n        "highlightRule"         : highlightRule,\n        "redrawHighlights"      : redrawHighlights,\n        "applyDOMEdits"         : applyDOMEdits,\n        "getSimpleDOM"          : getSimpleDOM\n    };\n}\n'
}),define("LiveDevelopment/Agents/RemoteAgent",["require","exports","module","LiveDevelopment/LiveDevelopment","utils/EventDispatcher","LiveDevelopment/Inspector/Inspector","text!LiveDevelopment/Agents/RemoteFunctions.js"],function(e,t){"use strict";function n(e,n){var r=/^data-ld-(.*)/.exec(n.name);r&&t.trigger(r[1],n)}function r(e,t){console.assert(e,"Attempted to call remote method without objectId set.");var n,r=Array.prototype.slice.call(arguments,2),i=new $.Deferred;return"function"==typeof r[r.length-1]&&(n=r.pop()),r=r.map(function(e){return e&&e.nodeId?e.resolve():e}),$.when.apply(void 0,r).done(function(){var o=[];r.forEach(function(e){o.push(e.objectId?{objectId:e.objectId}:{value:e})}),m.Runtime.callFunctionOn(e,t,o,void 0,n).then(i.resolve,i.reject)}),i.promise()}function i(e){var t=[d,"_LD."+e];return arguments.length>1&&(t=t.concat(Array.prototype.slice.call(arguments,1))),r.apply(null,t)}function o(){p&&(window.clearInterval(p),p=null)}function a(){o(),p=window.setInterval(function(){i("keepAlive")},1e3)}function s(e,t){if(!t.frame.parentId){o();var n="window._LD="+g+"("+h.config.experimental+");";m.Runtime.evaluate(n,function(e){e.error||e.wasThrown?u.reject(e.error):(d=e.result.objectId,u.resolve(),a())})}}function l(){return u=new $.Deferred,m.Page.on("frameNavigated.RemoteAgent",s),m.Page.on("frameStartedLoading.RemoteAgent",o),m.DOM.on("attributeModified.RemoteAgent",n),u.promise()}function c(){m.Page.off(".RemoteAgent"),m.DOM.off(".RemoteAgent"),o()}var u,d,p,h=e("LiveDevelopment/LiveDevelopment"),f=e("utils/EventDispatcher"),m=e("LiveDevelopment/Inspector/Inspector"),g=e("text!LiveDevelopment/Agents/RemoteFunctions.js");f.makeEventDispatcher(t),t.call=i,t.load=l,t.unload=c}),define("LiveDevelopment/Agents/ScriptAgent",["require","exports","module","LiveDevelopment/Inspector/Inspector","LiveDevelopment/Agents/DOMAgent"],function(e,t){"use strict";function n(e){return m[e]}function r(e){return f[e]}function i(e,t){v.DOMDebugger.setDOMBreakpoint(t.root.nodeId,"subtree-modified"),h.resolve()}function o(e,t){if(g){var n=y.nodeWithId(t.node.nodeId);n.trace=g,g=void 0}}function a(e,t){m[t.scriptId]=t,f[t.url]=t}function s(){}function l(e,t){switch(t.reason){case"exception":v.Debugger.resume();break;case"DOM":v.Debugger.resume(),"subtree-modified"===t.data.type&&t.data.insertion===!0&&(g=t.callFrames)}}function c(){f={},m={}}function u(e,t){t.frame.parentId||c()}function d(){c(),h=new $.Deferred;var e=new $.Deferred;return v.Debugger.enable().done(function(){v.Debugger.setPauseOnExceptions("uncaught").done(function(){e.resolve()})}),v.Page.on("frameNavigated.ScriptAgent",u),y.on("getDocument.ScriptAgent",i),v.Debugger.on("scriptParsed.ScriptAgent",a).on("scriptFailedToParse.ScriptAgent",s).on("paused.ScriptAgent",l),v.DOM.on("childNodeInserted.ScriptAgent",o),$.when(h.promise(),e.promise())}function p(){c(),v.Page.off(".ScriptAgent"),y.off(".ScriptAgent"),v.Debugger.off(".ScriptAgent"),v.DOM.off(".ScriptAgent")}var h,f,m,g,v=e("LiveDevelopment/Inspector/Inspector"),y=e("LiveDevelopment/Agents/DOMAgent");t.scriptWithId=n,t.scriptForURL=r,t.load=d,t.unload=p}),define("LiveDevelopment/Agents/GotoAgent",["require","exports","module","utils/Global","LiveDevelopment/Inspector/Inspector","LiveDevelopment/Agents/DOMAgent","LiveDevelopment/Agents/ScriptAgent","LiveDevelopment/Agents/RemoteAgent","editor/EditorManager","command/CommandManager","command/Commands"],function(e,t){"use strict";function n(e){var t=e.search(/[#\?]/);return t>=0&&(e=e.substr(0,t)),e}function r(e){var t=e.split("/");return t[t.length-1]}function i(e,t){if(t.location){var n=f.url,i=t.location;t.canHaveChildren()&&(i+=t.length),n+=":"+i;var o="&lt;"+t.name+"&gt;",a=r(n);e.push({type:"html",url:n,name:o,file:a})}}function o(e,t){if(t.sourceURL){var n=t.sourceURL;n+=":"+t.style.range.start;var i=t.selectorList.text,o=r(n);e.push({type:"css",url:n,name:i,file:o})}}function a(e,t){var n=m.scriptWithId(t.location.scriptId);if(n&&n.url){var i=n.url;i+=":"+t.location.lineNumber+","+t.location.columnNumber;var o=t.functionName;""===o&&(o="anonymous function");var a=r(i);e.push({type:"js",url:i,name:o,file:a})}}function s(e,t){var n=f.nodeWithId(t.nodeId);h.CSS.getMatchedStylesForNode(n.nodeId,function(e){var t,r=[];i(r,n);for(t in n.trace)a(r,n.trace[t]);for(t in n.events){var s=n.events[t];a(r,s.callFrames[0])}for(t in e.matchedCSSRules.reverse())o(r,e.matchedCSSRules[t].rule);g.call("showGoto",r)})}function l(e,t){var n=v.getCurrentFullEditor(),r=n._codeMirror;"number"==typeof e&&(e=r.posFromIndex(e)),r.setCursor(e),n.focus(),t||(r.addLineClass(e.line,"wrap","flash"),window.setTimeout(function(){r.removeLineClass(e.line,"wrap","flash")},1e3))}function c(e,t,r){console.assert("file://"===e.substr(0,7),"Cannot open non-file URLs");var i=new $.Deferred;e=n(e);var o=e.slice("win"===brackets.platform?8:7);o=decodeURI(o);var a=y.execute(_.FILE_OPEN,{fullPath:o});return a.done(function(){t&&l(t,r),i.resolve()}),a.fail(function(e){console.error(e),i.reject(e)}),i.promise()}function u(e,t){var n,r=t.value,i=/^(.*):([^:]+)$/.exec(r);i&&(r=i[1],n=i[2].split(","),n=1===n.length?parseInt(n[0],10):{line:parseInt(n[0],10),ch:parseInt(n[1],10)}),c(r,n)}function d(){g.on("showgoto.GotoAgent",s).on("goto.GotoAgent",u)}function p(){g.off(".GotoAgent")}e("utils/Global");var h=e("LiveDevelopment/Inspector/Inspector"),f=e("LiveDevelopment/Agents/DOMAgent"),m=e("LiveDevelopment/Agents/ScriptAgent"),g=e("LiveDevelopment/Agents/RemoteAgent"),v=e("editor/EditorManager"),y=e("command/CommandManager"),_=e("command/Commands");t.openLocation=l,t.open=c,t.load=d,t.unload=p}),define("LiveDevelopment/Agents/EditAgent",["require","exports","module","LiveDevelopment/Inspector/Inspector","LiveDevelopment/Agents/DOMAgent","LiveDevelopment/Agents/RemoteAgent","LiveDevelopment/Agents/GotoAgent","editor/EditorManager"],function(e,t){"use strict";function n(e,t){if(e===t)return void 0;var n,r=e.length,i=0;for(n=0;r>n&&t[n]===e[n];n++);for(i+=n,t=t.substr(n),r-=n,n=0;r>n&&t[t.length-1-n]===e[e.length-1-n];n++);return r-=n,t=t.substr(0,t.length-n),{from:i,to:i+r,text:t}}function r(e,r){if(s.nodeId===r.nodeId){d.open(c.url);var i=p.getCurrentFullEditor(),o=i._codeMirror,a=n(s.value,r.characterData);if(a){var l=o.posFromIndex(s.location+a.from),u=o.posFromIndex(s.location+a.to);t.isEditing=!0,i.document.replaceRange(a.text,l,u),t.isEditing=!1;var h=o.posFromIndex(s.location+a.from+a.text.length);i.setCursorPos(h.line,h.ch)}}}function i(e,t){if("0"===t.value)return void l.DOM.off(".EditAgent");var n=c.nodeWithId(t.nodeId);n=n.children[0],n.location&&(s=n,l.DOM.on("characterDataModified.EditAgent",r))}function o(){u.on("edit.EditAgent",i)}function a(){u.off(".EditAgent")}var s,l=e("LiveDevelopment/Inspector/Inspector"),c=e("LiveDevelopment/Agents/DOMAgent"),u=e("LiveDevelopment/Agents/RemoteAgent"),d=e("LiveDevelopment/Agents/GotoAgent"),p=e("editor/EditorManager");t.load=o,t.unload=a}),define("LiveDevelopment/Agents/DOMHelpers",["require","exports","module"],function(e,t){"use strict";function n(e,t,n){return"\\"===t?!1:void 0!==n?e===n:'"'===e||"'"===e}function r(e){if(n(e[0])&&e[e.length-1]===e[0]){var t=e[0];e=e.substr(1,e.length-2),e=e.replace("\\"+t,t)}return e}function i(e,t,r,i,o){"string"==typeof t&&(t=[t,t.length]),void 0===r&&(r=0);var a,s,l=!1;for(a=r;a<e.length;a++)if(i&&n(e[a],e[a-1],s))s=s?void 0:e[a];else if(!s)if(o&&!l&&e.substr(a,o[0].length)===o[0])l=!0,a+=o[0].length-1;else if(l)e.substr(a,o[1].length)===o[1]&&(l=!1,a+=o[1].length-1);else if(0===e.substr(a,t[1]).search(t[0]))return a;return-1}function o(e,t,n,r,o){for(var a,s=0;s<e.length;)a=i(e,t,s,n,r),0>a&&(a=e.length),o(e.substr(s,a-s)),s=a+1}function a(e,t){var n,r,o;return n=i(e,[/<[a-z!\/]/i,2],t),0>n?null:("<!--"===e.substr(n,4)?(r=i(e,"-->",n+4),o=3):"<script"===e.substr(n,7).toLowerCase()?(r=i(e.toLowerCase(),"</script>",n+7),o=9):"<style"===e.substr(n,6).toLowerCase()?(r=i(e.toLowerCase(),"</style>",n+6),o=8):(r=i(e,">",n+1,!0),o=1),0>r?null:{from:n,length:r+o-n})}function s(e){if(e=e.replace(/^<\S+\s*/,""),e=e.replace(/\s*\/?>$/,""),0!==e.length){var t,n,i,a={};return o(e,[/\s/,1],!0,void 0,function(e){t=e.search("="),0>t||(n=e.substr(0,t).trim(),0!==n.length&&(i=e.substr(t+1).trim(),i=r(i),a[n]=i))}),a}}function l(e){var t={};return"<"!==e[0]?(t.nodeType=3,t.nodeValue=e):"<!--"===e.substr(0,4)?(t.nodeType=8,t.nodeValue=e.substr(4,e.length-7)):"!"===e[1]?t.nodeType=10:(t.nodeType=1,t.nodeName=/^<([^>\s]+)/.exec(e)[1].toUpperCase(),t.attributes=s(e),"/"===t.nodeName[0]&&(t.nodeName=t.nodeName.substr(1),t.closing=!0),"/"===e[e.length-2]&&(t.closed=!0),("SCRIPT"===t.nodeName||"STYLE"===t.nodeName)&&(t.closed=!0)),t}function c(e,t){for(var n,r,i,o,s=0;s<e.length;)r=a(e,s),r||(r={from:e.length,length:0}),i=r.from-s,i>0&&(n=e.substr(s,i),/\S/.test(n)&&(o=l(n),o.sourceOffset=s,o.sourceLength=i,t(o))),r.length>0&&(o=l(e.substr(r.from,r.length)),o.sourceOffset=r.from,o.sourceLength=r.length,t(o)),s=r.from+r.length}t.extractPayload=l,t.eachNode=c}),define("LiveDevelopment/Agents/DOMNode",["require","exports","module","LiveDevelopment/Agents/DOMHelpers"],function(e){"use strict";function t(e,t,n){for(void 0===n&&(n=" ");e.length<t;)e+=n;return e}function n(e){switch(typeof e){case"function":return e;case"string":return function(e,t){return t.name===e}.bind(void 0,e.toUpperCase());case"number":return function(e,t){return t.type===e}.bind(void 0,e);default:console.error("Invalid find condition: "+e)}}var r=e("LiveDevelopment/Agents/DOMHelpers"),i=function(e,t){this.agent=e,this.children=[],this.attributes={},"string"==typeof t&&(t=r.extractPayload(t)),t&&this.setPayload(t),this.agent.addNode(this)},o=i.TYPE_ELEMENT=1,a=i.TYPE_ATTRIBUTE=2,s=i.TYPE_TEXT=3,l=i.TYPE_COMMENT=8,c=i.TYPE_DOCUMENT=9;return i.prototype.remove=function(){this.agent.removeNode(this),this.parent&&this.parent.removeChild(this)},i.prototype.setPayload=function(e){if(this.nodeId=e.nodeId,this.type=e.nodeType,e.nodeName&&(this.name=e.nodeName),e.nodeValue&&(this.value=e.nodeValue),this.attributes={},e.attributes){var t,n,r;for(t=0;t<e.attributes.length;t+=2)n=e.attributes[t],r=e.attributes[t+1],this.attributes[n]=r}e.sourceOffset&&(this.location=e.sourceOffset),e.sourceLength?this.length=e.sourceLength:this.value?this.length=this.value.length:this.name&&(this.length=this.name.length+2),e.children?this.setChildrenPayload(e.children):e.childNodeCount&&this.agent.requestChildNodes(this)},i.prototype.setChildrenPayload=function(e){var t,n,r;for(t in e)n=e[t],r=new i(this.agent,n),this.appendChild(r)},i.prototype.payload=function(){var e={type:this.type};return this.nodeType===o?e.nodeName=this.name:e.value=this.value,e},i.prototype.findParentForNextNodeMatchingPayload=function(e){for(var t=this.canHaveChildren()?this:this.parent;t&&!t.matchesPayload(e);)t=t.parent;return t},i.prototype.findNextNodeMatchingPayload=function(e){for(var t=this.nextNode();t&&!t.matchesPayload(e);)t=t.nextNode();return t},i.prototype.matchesPayload=function(e){var t=!1;if(this.type===e.nodeType)switch(this.type){case 1:t=this.name===e.nodeName;break;case 3:t=!0;break;default:t=!0}return t},i.prototype.resolve=function(){var e=new $.Deferred;return this.objectId?e.resolve(this):this.nodeId?this.agent.resolveNode(this,function(t){this.objectId=t.object.objectId,e.resolve(this)}.bind(this)):e.reject(),e.promise()},i.prototype.canHaveChildren=function(){return 1===this.type&&!this.closed&&!this.closing&&"LINK"!==this.nodeName},i.prototype.removeChild=function(e){this.children.splice(this.indexOfChild(e),1),delete e.parent},i.prototype.insertChildAt=function(e,t){return e.parent&&e.parent.removeChild(e),(!t||0>t||t>this.children.length)&&(t=this.children.length),this.children.splice(t,0,e),e.parent=this,e},i.prototype.appendChild=function(e){return this.insertChildAt(e)},i.prototype.insertChildAfter=function(e,t){var n=this.indexOfChild(t);return n>=0&&n++,this.insertChildAt(e,n)},i.prototype.insertChildBefore=function(e,t){var n=this.indexOfChild(t);return this.insertChildAt(e,n)},i.prototype.indexOfChild=function(e){if(!e)return-1;var t;for(t in this.children)if(this.children[t]===e)return parseInt(t,0);return-1},i.prototype.previousSibling=function(){return this.parent?this.parent.children[this.parent.indexOfChild(this)-1]:null},i.prototype.nextSibling=function(){return this.parent?this.parent.children[this.parent.indexOfChild(this)+1]:null},i.prototype.previousNode=function(){var e=this.previousSibling();return e?e.children.length>0&&(e=e.children[e.children.length-1]):e=this.parent,e},i.prototype.nextNode=function(){if(this.children.length>0)return this.children[0];for(var e,t=this;t;){if(e=t.nextSibling())return e;t=t.parent}return null},i.prototype.each=function(e){if(e(this)===!1)return!1;var t;for(t in this.children)if(this.children[t].each(e)===!1)return!1;return!0},i.prototype.find=function(e){var t=n(e),r=null;return this.each(function(e){return t(e)?(r=e,!1):void 0}),r},i.prototype.findAll=function(e){var t=[],r=n(e);return this.each(function(e){r(e)&&t.push(e)}),t},i.prototype.eachParent=function(e){for(var t=this.parent;t;){if(e(t)===!1)return;t=t.parent}return null},i.prototype.findParent=function(e){var t=null;return this.eachParent(function(n){return e(n)?(t=n,!1):void 0}),t},i.prototype.root=function(){for(var e=this;e.parent;)e=e.parent;return e},i.prototype.isAtLocation=function(e,t){if(void 0===t&&(t=!0),!this.location||e<this.location)return!1;var n;return n=t&&this.closeLocation?this.closeLocation+this.closeLength:this.location+this.length,this.type===s&&(n+=1),n>e},i.prototype.isEmpty=function(){return this.type===s&&/^\s*$/.test(this.value)},i.prototype.toString=function(){var e;switch(this.type){case o:e="<"+this.name+">";break;case a:e="[ATTRIBUTE]";break;case s:e=this.value.replace(/\s+/," ").substr(0,40);break;case l:e="<!--"+this.value.replace(/\s+/," ").substr(0,33)+"-->";break;case c:e="<!DOCTYPE>"}return e},i.prototype.dump=function(e){void 0===e&&(e="");var n=e+this.toString();this.location&&(n=t(n,60),n+=" ("+this.location+","+(this.location+this.length)+")",this.closeLocation&&(n+=" ("+this.closeLocation+","+(this.closeLocation+this.closeLength)+")")),this.nodeId&&(n=t(n,80),n+=" {"+this.nodeId+"}"),console.info(n),e+=". ";var r;for(r in this.children)this.children[r].dump(e)},i}),define("LiveDevelopment/Agents/DOMAgent",["require","exports","module","LiveDevelopment/Inspector/Inspector","utils/EventDispatcher","LiveDevelopment/Agents/EditAgent","LiveDevelopment/Agents/DOMNode","LiveDevelopment/Agents/DOMHelpers"],function(e,t){"use strict";function n(e){var n;return t.root.each(function(t){return!t.location||e<t.location?!0:void((!n||n.location<t.location)&&(n=t))}),n}function r(e){var n=[];return t.root.each(function(t){t.type===L.TYPE_ELEMENT&&t.isAtLocation(e)&&n.push(t)}),n}function i(e){return t.root.find(function(t){return t.isAtLocation(e,!1)})}function o(e){return C[e]}function a(e){e.nodeId&&delete C[e.nodeId]}function s(e){e.nodeId&&(C[e.nodeId]=e)}function l(e){D>=0&&D++,T.DOM.requestChildNodes(e.nodeId)}function c(e){var t=e.search(/[#\?]/);return t>=0&&(e=e.substr(0,t)),e}function u(e){var n=t.root;R.eachNode(e,function(e){if(!n)return!0;if(e.closing){var t=n.findParentForNextNodeMatchingPayload(e);if(!t)return console.warn("Matching Parent not at "+e.sourceOffset+" ("+e.nodeName+")");t.closeLocation=e.sourceOffset,t.closeLength=e.sourceLength}else{var r=n.findNextNodeMatchingPayload(e);if(!r)return console.warn("Skipping Source Node at "+e.sourceOffset);n=r,n.location=e.sourceOffset,n.length=e.sourceLength,e.closed&&(n.closed=e.closed)}})}function d(){var e=new XMLHttpRequest;e.open("GET",t.url),e.onload=function(){if(e.status>=200&&e.status<300||304===e.status||0===e.status)u(e.response),w.resolve();else{var n="Received status "+e.status+" from XMLHttpRequest while attempting to load source file at "+t.url;w.reject(n,{message:n})}},e.onerror=function(){var e="Could not load source file at "+t.url;w.reject(e,{message:e})},e.send(null)}function p(){T.DOM.getDocument(function(e){t.trigger("getDocument",e),C={},D=0,t.root=new L(t,e.root)})}function h(e,n){n.frame.parentId||(t.url=c(n.frame.url))}function f(){}function m(e,t){var n=o(t.parentId);n.setChildrenPayload(t.nodes),D>0&&0===--D&&d()}function g(e,t){t.nodeId>0&&T.DOM.requestChildNodes(t.nodeId)}function v(e,n){if(n.node.nodeId>0){var r=o(n.parentNodeId),i=o(n.previousNodeId),a=new L(t,n.node);r.insertChildAfter(a,i)}}function y(e,t){if(t.nodeId>0){var n=o(t.nodeId);n.remove()}}function _(e,r,o){var a=e-r+o.length,s=i(e);if(s)if(3===s.type){var l=s.value.substr(0,e-s.location);l+=o,l+=s.value.substr(r-s.location),s.value=l,M.isEditing||T.DOM.setNodeValue(s.nodeId,s.value)}else console.warn("Changing non-text nodes not supported.");else/^\s*$/.test(o)||(console.warn("Inserting nodes not supported."),s=n(e));s&&(s.length+=a,t.root.each(function(e){e.location>s.location&&(e.location+=a),void 0!==e.closeLocation&&e.closeLocation>s.location&&(e.closeLocation+=a)}))}function E(){return T.DOM.enable()}function b(){return T.DOM.disable()}function S(){return w=new $.Deferred,T.Page.on("frameNavigated.DOMAgent",h).on("loadEventFired.DOMAgent",p),T.DOM.on("documentUpdated.DOMAgent",f).on("setChildNodes.DOMAgent",m).on("childNodeCountUpdated.DOMAgent",g).on("childNodeInserted.DOMAgent",v).on("childNodeRemoved.DOMAgent",y),w.promise()}function I(){T.Page.off(".DOMAgent"),T.DOM.off(".DOMAgent")}var w,C,D,T=e("LiveDevelopment/Inspector/Inspector"),O=e("utils/EventDispatcher"),M=e("LiveDevelopment/Agents/EditAgent"),L=e("LiveDevelopment/Agents/DOMNode"),R=e("LiveDevelopment/Agents/DOMHelpers");O.makeEventDispatcher(t),t.enable=E,t.disable=b,t.nodeBeforeLocation=n,t.allNodesAtLocation=r,t.nodeAtLocation=i,t.nodeWithId=o,t.removeNode=a,t.addNode=s,t.requestChildNodes=l,t.applyChange=_,t.load=S,t.unload=I}),define("LiveDevelopment/Agents/HighlightAgent",["require","exports","module","LiveDevelopment/Agents/DOMAgent","utils/EventDispatcher","LiveDevelopment/Inspector/Inspector","LiveDevelopment/LiveDevelopment","LiveDevelopment/Agents/RemoteAgent","thirdparty/lodash"],function(e,t){"use strict";function n(e,n){var r;"1"===n.value&&(r=u.nodeWithId(n.nodeId)),t.trigger("highlight",r)}function r(){switch(g.type){case"node":p.DOM.hideHighlight();break;case"css":f.call("hideHighlight")}g={}}function i(e){return h.config.experimental&&p.config.highlight?(e&&3===e.type&&(e=e.parent),e&&e.nodeId&&1===e.type?void(("node"!==g.type||g.ref!==e.nodeId)&&(g={type:"node",ref:e.nodeId},p.DOM.highlightNode(e.nodeId,p.config.highlightConfig))):r()):void 0}function o(e){g.ref!==e&&(r(),g={type:"css",ref:e},f.call("highlightRule",e))}function a(e){var t="";Array.isArray(e)||(e=[e]),m.each(e,function(e){""!==t&&(t+=","),t+="[data-brackets-id='"+e+"']"}),o(t)}function s(){f.call("redrawHighlights")}function l(){h.config.experimental&&f.on("highlight.HighlightAgent",n)}function c(){h.config.experimental&&f.off(".HighlightAgent")}var u=e("LiveDevelopment/Agents/DOMAgent"),d=e("utils/EventDispatcher"),p=e("LiveDevelopment/Inspector/Inspector"),h=e("LiveDevelopment/LiveDevelopment"),f=e("LiveDevelopment/Agents/RemoteAgent"),m=e("thirdparty/lodash"),g={};d.makeEventDispatcher(t),t.hide=r,t.node=i,t.rule=o,t.domElement=a,t.redraw=s,t.load=l,t.unload=c}),define("LiveDevelopment/Documents/CSSDocument",["require","exports","module","thirdparty/lodash","utils/EventDispatcher","LiveDevelopment/Agents/CSSAgent","language/CSSUtils","editor/EditorManager","LiveDevelopment/Agents/HighlightAgent","LiveDevelopment/Inspector/Inspector"],function(e,t,n){"use strict";var r=e("thirdparty/lodash"),i=e("utils/EventDispatcher"),o=e("LiveDevelopment/Agents/CSSAgent"),a=e("language/CSSUtils"),s=e("editor/EditorManager"),l=e("LiveDevelopment/Agents/HighlightAgent"),c=e("LiveDevelopment/Inspector/Inspector"),u=function(e,t){this.doc=e,this._highlight=[],this.onHighlight=this.onHighlight.bind(this),this.onCursorActivity=this.onCursorActivity.bind(this),this.doc.addRef(),this.onChange=this.onChange.bind(this),this.onDeleted=this.onDeleted.bind(this),this.doc.on("change.CSSDocument",this.onChange),this.doc.on("deleted.CSSDocument",this.onDeleted),this.onActiveEditorChange=this.onActiveEditorChange.bind(this),s.on("activeEditorChange",this.onActiveEditorChange),t&&this.attachToEditor(t)};i.makeEventDispatcher(u.prototype),u.prototype._getStyleSheetHeader=function(){return o.styleForURL(this.doc.url)},u.prototype.getSourceFromBrowser=function(){function e(e){var t;for(t in e)if(r.has(e,t))return e[t];return null}var t=new $.Deferred,n=this._getStyleSheetHeader(),i=e(n);return i?c.CSS.getStyleSheetText(i.styleSheetId).then(function(e){t.resolve(e.text)},t.reject):t.reject(),t.promise()},u.prototype.close=function(){this.doc.off(".CSSDocument"),s.off("activeEditorChange",this.onActiveEditorChange),this.doc.releaseRef(),this.detachFromEditor()},u.prototype._updateBrowser=function(){var e=o.reloadCSSForDocument(this.doc);c.config.highlight&&e.done(l.redraw)},u.prototype.attachToEditor=function(e){this.editor=e,this.editor&&(l.on("highlight",this.onHighlight),this.editor.on("cursorActivity.CSSDocument",this.onCursorActivity),this.updateHighlight())},u.prototype.detachFromEditor=function(){this.editor&&(l.hide(),l.off("highlight",this.onHighlight),this.editor.off(".CSSDocument"),this.onHighlight(),this.editor=null)},u.prototype.updateHighlight=function(){if(c.config.highlight&&this.editor){var e=this.editor,t=[];r.each(this.editor.getSelections(),function(n){var r=a.findSelectorAtDocumentPos(e,n.reversed?n.end:n.start);r&&t.push(r)}),t.length?l.rule(t.join(",")):l.hide()}},u.prototype.setInstrumentationEnabled=function(){},u.prototype.isLiveEditingEnabled=function(){return!0},u.prototype.getResponseData=function(){return{body:this.doc.getText()}},u.prototype.onCursorActivity=function(){this.updateHighlight()},u.prototype.onChange=function(){this._updateBrowser()},u.prototype.onDeleted=function(){o.clearCSSForDocument(this.doc),this.close(),this.trigger("deleted",this)},u.prototype.onActiveEditorChange=function(e,t){this.detachFromEditor(),t&&t.document===this.doc&&this.attachToEditor(t)},u.prototype.onHighlight=function(e,t){var n;for(n in this._highlight)this._highlight[n].clear();this._highlight=[],t&&t.location&&c.CSS.getMatchedStylesForNode(t.nodeId,function(e){var t,n,r,i,o=this.editor._codeMirror,a=this._getStyleSheetHeader();for(t in e.matchedCSSRules)n=e.matchedCSSRules[t],n.ruleId&&a[n.ruleId.styleSheetId]&&(r=o.posFromIndex(n.selectorRange.start),i=o.posFromIndex(n.style.range.end),this._highlight.push(o.markText(r,i,{className:"highlight"})))}.bind(this))},n.exports=u}),define("LiveDevelopment/Documents/CSSPreprocessorDocument",["require","exports","module","thirdparty/lodash","utils/EventDispatcher","language/CSSUtils","editor/EditorManager","LiveDevelopment/Agents/HighlightAgent","LiveDevelopment/Inspector/Inspector"],function(e,t,n){"use strict";var r=e("thirdparty/lodash"),i=e("utils/EventDispatcher"),o=e("language/CSSUtils"),a=e("editor/EditorManager"),s=e("LiveDevelopment/Agents/HighlightAgent"),l=e("LiveDevelopment/Inspector/Inspector"),c=function(e){this.doc=e,this.onCursorActivity=this.onCursorActivity.bind(this),this.doc.addRef(),this.onActiveEditorChange=this.onActiveEditorChange.bind(this),a.on("activeEditorChange",this.onActiveEditorChange),this.onActiveEditorChange(null,a.getActiveEditor(),null)};i.makeEventDispatcher(c.prototype),c.prototype.close=function(){this.doc.off(".CSSPreprocessorDocument"),a.off("activeEditorChange",this.onActiveEditorChange),this.doc.releaseRef(),this.detachFromEditor()},c.prototype.isLiveEditingEnabled=function(){return!1},c.prototype.attachToEditor=function(e){this.editor=e,this.editor&&(this.editor.on("cursorActivity.CSSPreprocessorDocument",this.onCursorActivity),this.updateHighlight())},c.prototype.detachFromEditor=function(){this.editor&&(s.hide(),this.editor.off(".CSSPreprocessorDocument"),this.editor=null)},c.prototype.updateHighlight=function(){if(l.config.highlight&&this.editor){var e=this.editor,t=[];r.each(this.editor.getSelections(),function(n){var r=o.findSelectorAtDocumentPos(e,n.reversed?n.end:n.start);r&&t.push(r)}),t.length?s.rule(t.join(",")):s.hide()}},c.prototype.onCursorActivity=function(){this.updateHighlight()},c.prototype.onActiveEditorChange=function(e,t){this.detachFromEditor(),t&&t.document===this.doc&&this.attachToEditor(t)},n.exports=c}),define("language/HTMLTokenizer",["require","exports","module"],function(e,t){"use strict";function n(e){return" "===e||"	"===e||"\r"===e||"\n"===e}function r(e){return/[A-Za-z0-9\-]/.test(e)}function i(e){return'"'!==e&&"'"!==e&&"<"!==e&&"="!==e}function o(e){return"<"!==e&&"="!==e}function a(e,t){return e?{line:e.line,ch:e.ch+(t||0)}:null}function s(e){this._state=c,this._buffer=e,this._sectionStart=0,this._sectionStartPos={line:0,ch:0},this._index=0,this._indexPos={line:0,ch:0},this._special=0,this._token=null,this._nextToken=null}var l=0,c=l++,u=l++,d=l++,p=l++,h=l++,f=l++,m=l++,g=l++,v=l++,y=l++,_=l++,E=l++,b=l++,S=l++,I=l++,w=l++,C=l++,D=l++,T=l++,O=l++,M=l++,L=l++,R=l++,N=l++,x=l++,A=l++,P=l++,k=l++,F=l++,U=l++,j=l++,$=l++,V=l++,B=l++,H=l++,W=l++,G=l++,K=l++,q=l++,z=l++,Y=l++,X=l++,Q=l++,J=l++,Z=l++,et=l++,tt=l++,nt=l++,rt=l++,it=l++,ot=l++;s.prototype.nextToken=function(){if(this._token=null,this._nextToken){var e=this._nextToken;return this._nextToken=null,e}for(;this._index<this._buffer.length&&!this._token;){var t=this._buffer.charAt(this._index);if(this._state===c)"<"===t&&(this._emitTokenIfNonempty("text"),this._state=u,this._startSection());else if(this._state===u)if("/"===t)this._state=p;else if(">"===t||this._special>0)this._state=c;else if("!"===t)this._state=w,this._startSection(1);else if("?"===t)this._state=D,this._startSection(1);else if("s"===t||"S"===t)this._state=$,this._startSection();else{if(!r(t)){this._emitSpecialToken("error");break}n(t)||(this._state=d,this._startSection())}else if(this._state===d){if("/"===t)this._emitToken("opentagname"),this._emitSpecialToken("selfclosingtag",this._index+2,a(this._indexPos,2)),this._state=m;else if(">"===t)this._emitToken("opentagname"),this._emitSpecialToken("opentagend",this._index+1,a(this._indexPos,1)),this._state=c,this._startSection(1);else if(n(t))this._emitToken("opentagname"),this._state=g;else if(!r(t)){this._emitSpecialToken("error");break}}else if(this._state===p)if(">"===t)this._state=c;else if(this._special>0){if("s"!==t&&"S"!==t){this._state=c;continue}this._state=V}else{if(!r(t)){this._emitSpecialToken("error");break}n(t)||(this._state=h,this._startSection())}else if(this._state===h){if(">"===t)this._emitToken("closetag"),this._state=c,this._startSection(1),this._special=0;else if(n(t))this._emitToken("closetag"),this._state=f,this._special=0;else if(!r(t)){this._emitSpecialToken("error");break}}else if(this._state===f){if(">"===t)this._state=c,this._startSection(1);else if(!n(t)){this._emitSpecialToken("error");break}}else if(this._state===m){if(">"!==t){this._emitSpecialToken("error");break}this._state=c,this._startSection(1)}else if(this._state===g)if(">"===t)this._state=c,this._emitSpecialToken("opentagend",this._index+1,a(this._indexPos,1)),this._startSection(1);else if("/"===t)this._emitSpecialToken("selfclosingtag",this._index+2,a(this._indexPos,2)),this._state=m;else{if(!i(t)){this._emitSpecialToken("error");break}n(t)||(this._state=y,this._startSection())}else if(this._state===y)if("="===t)this._emitTokenIfNonempty("attribname"),this._state=E;else if(n(t))this._emitTokenIfNonempty("attribname"),this._state=_;else{if("/"===t||">"===t){this._emitTokenIfNonempty("attribname"),this._state=g;continue}if(!i(t)){this._emitSpecialToken("error");break}}else if(this._state===_)if("="===t)this._state=E;else{if("/"===t||">"===t){this._state=g;continue}if(!i(t)){this._emitSpecialToken("error");break}n(t)||(this._state=y,this._startSection())}else if(this._state===E)if('"'===t)this._state=b,this._startSection(1);else if("'"===t)this._state=S,this._startSection(1);else{if(!o(t)){this._emitSpecialToken("error");break}n(t)||(this._state=I,this._startSection())}else if(this._state===b)'"'===t&&(this._emitToken("attribvalue"),this._state=v);else if(this._state===S)"'"===t&&(this._state=v,this._emitToken("attribvalue"));else if(this._state===I){if(">"===t)this._emitToken("attribvalue"),this._emitSpecialToken("opentagend",this._index+1,a(this._indexPos,1)),this._state=c,this._startSection(1);else if(n(t))this._emitToken("attribvalue"),this._state=g;else if(!o(t)){this._emitSpecialToken("error");break}}else if(this._state===v)if(">"===t)this._state=c,this._emitSpecialToken("opentagend",this._index+1,a(this._indexPos,1)),this._startSection(1);else if("/"===t)this._emitSpecialToken("selfclosingtag",this._index+2,a(this._indexPos,2)),this._state=m;else{if(!n(t)){this._emitSpecialToken("error");break}this._state=g}else if(this._state===w)this._state="["===t?R:"-"===t?T:C;else if(this._state===C)">"===t&&(this._emitToken("declaration"),this._state=c,this._startSection(1));else if(this._state===D)">"===t&&(this._emitToken("processinginstruction"),this._state=c,this._startSection(1));else if(this._state===T)"-"===t?(this._state=O,this._startSection(1)):this._state=C;else if(this._state===O)"-"===t&&(this._state=M);else if(this._state===M)this._state="-"===t?L:O;else if(this._state===L)">"===t?(this._emitToken("comment",this._index-2,a(this._indexPos,-2)),this._state=c,this._startSection(1)):"-"!==t&&(this._state=O);else if(this._state===R)this._state="C"===t?N:C;else if(this._state===N)this._state="D"===t?x:C;else if(this._state===x)this._state="A"===t?A:C;else if(this._state===A)this._state="T"===t?P:C;else if(this._state===P)this._state="A"===t?k:C;else if(this._state===k)"["===t?(this._state=F,this._startSection(1)):this._state=C;else if(this._state===F)"]"===t&&(this._state=U);else if(this._state===U)this._state="]"===t?j:F;else if(this._state===j)">"===t?(this._emitToken("cdata",this._index-2,a(this._indexPos,-2)),this._state=c,this._startSection(1)):"]"!==t&&(this._state=F);else if(this._state===$)if("c"===t||"C"===t)this._state=B;else{if("t"!==t&&"T"!==t){this._state=d;continue}this._state=J}else if(this._state===V)this._state=1!==this._special||"c"!==t&&"C"!==t?2!==this._special||"t"!==t&&"T"!==t?c:nt:q;else if(this._state===B){if("r"!==t&&"R"!==t){this._state=d;continue}this._state=H}else if(this._state===H){if("i"!==t&&"I"!==t){this._state=d;continue}this._state=W}else if(this._state===W){if("p"!==t&&"P"!==t){this._state=d;continue}this._state=G}else if(this._state===G){if("t"!==t&&"T"!==t){this._state=d;continue}this._state=K}else{if(this._state===K){("/"===t||">"===t||n(t))&&(this._special=1),this._state=d;continue}if(this._state===q)this._state="r"===t||"R"===t?z:c;else if(this._state===z)this._state="i"===t||"I"===t?Y:c;else if(this._state===Y)this._state="p"===t||"P"===t?X:c;else if(this._state===X)this._state="t"===t||"T"===t?Q:c;else if(this._state===Q){if(">"===t||n(t)){this._state=h,this._startSection(-6);continue}this._state=c}else if(this._state===J){if("y"!==t&&"Y"!==t){this._state=d;continue}this._state=Z}else if(this._state===Z){if("l"!==t&&"L"!==t){this._state=d;continue}this._state=et}else if(this._state===et){if("e"!==t&&"E"!==t){this._state=d;continue}this._state=tt}else{if(this._state===tt){("/"===t||">"===t||n(t))&&(this._special=2),this._state=d;continue}if(this._state===nt)this._state="y"===t||"Y"===t?rt:c;else if(this._state===rt)this._state="l"===t||"L"===t?it:c;else if(this._state===it)this._state="e"===t||"E"===t?ot:c;else{if(this._state!==ot){console.error("HTMLTokenizer: Encountered unknown state"),this._emitSpecialToken("error");break}if(">"===t||n(t)){this._state=h,this._startSection(-5);continue}this._state=c}}}"\n"===t?(this._indexPos.line++,this._indexPos.ch=0):this._indexPos.ch++,this._index++}return this._index===this._buffer.length&&this._state!==c&&this._emitSpecialToken("error"),this._token},s.prototype._startSection=function(e){e=e||0,this._sectionStart=this._index+e,this._sectionStartPos=a(this._indexPos,e)
},s.prototype._setToken=function(e,t,n){void 0===t&&(t=this._index),void 0===n&&(n=this._indexPos);var r={type:e,contents:-1===this._sectionStart?"":this._buffer.substring(this._sectionStart,t),start:this._sectionStart,end:t,startPos:a(this._sectionStartPos),endPos:a(n)};this._token?(this._nextToken&&console.error("HTMLTokenizer: Tried to emit more than two tokens in a single call"),this._nextToken=r):this._token=r},s.prototype._emitToken=function(e,t,n){this._setToken(e,t,n),this._sectionStart=-1,this._sectionStartPos=null},s.prototype._emitSpecialToken=function(e,t,n){this._sectionStart=-1,this._sectionStartPos=null,this._emitToken(e,t,n)},s.prototype._emitTokenIfNonempty=function(e){this._index>this._sectionStart&&this._setToken(e),this._sectionStart=-1,this._sectionStartPos=null},t.Tokenizer=s}),define("thirdparty/murmurhash3_gc",["require","exports","module"],function(e,t,n){var r={mul32:function(e,t){var n=65535&t,r=t-n;return(r*e|0)+(n*e|0)|0},hashBytes:function(e,t,n){for(var r=3432918353,i=461845907,o=n,a=-4&t,s=0;a>s;s+=4){var l=255&e.charCodeAt(s)|(255&e.charCodeAt(s+1))<<8|(255&e.charCodeAt(s+2))<<16|(255&e.charCodeAt(s+3))<<24;l=this.mul32(l,r),l=(131071&l)<<15|l>>>17,l=this.mul32(l,i),o^=l,o=(524287&o)<<13|o>>>19,o=5*o+3864292196|0}switch(l=0,t%4){case 3:l=(255&e.charCodeAt(a+2))<<16;case 2:l|=(255&e.charCodeAt(a+1))<<8;case 1:l|=255&e.charCodeAt(a),l=this.mul32(l,r),l=(131071&l)<<15|l>>>17,l=this.mul32(l,i),o^=l}return o^=t,o^=o>>>16,o=this.mul32(o,2246822507),o^=o>>>13,o=this.mul32(o,3266489909),o^=o>>>16},hashString:function(e,t,n){for(var r=3432918353,i=461845907,o=n,a=-2&t,s=0;a>s;s+=2){var l=e.charCodeAt(s)|e.charCodeAt(s+1)<<16;l=this.mul32(l,r),l=(131071&l)<<15|l>>>17,l=this.mul32(l,i),o^=l,o=(524287&o)<<13|o>>>19,o=5*o+3864292196|0}return t%2==1&&(l=e.charCodeAt(a),l=this.mul32(l,r),l=(131071&l)<<15|l>>>17,l=this.mul32(l,i),o^=l),o^=t<<1,o^=o>>>16,o=this.mul32(o,2246822507),o^=o>>>13,o=this.mul32(o,3266489909),o^=o>>>16}};"undefined"!=typeof n&&"undefined"!=typeof n.exports&&(n.exports=r)}),define("language/HTMLSimpleDOM",["require","exports","module","language/HTMLTokenizer","thirdparty/murmurhash3_gc","utils/PerfUtils"],function(e,t){"use strict";function n(e){$.extend(this,e)}function r(e){var t=e.parent.children.indexOf(e);return 0===t?e.parent.tagID+".0":e.parent.children[t-1].tagID+"t"}function i(e,t){return{line:e.line+t.line,ch:0===t.line?e.ch+t.ch:t.ch}}function o(e,t){return{line:e.line,ch:e.ch+t}}function a(e,t,n){this.stack=[],this.text=e,this.t=new c(e),this.currentTag=null,this.startOffset=t||0,this.startOffsetPos=n||{line:0,ch:0}}function s(e,t){var n=new a(e);return n.build(t)}function l(e){function t(e){n+=e.tag?r+"TAG "+e.tagID+" "+e.tag+" "+JSON.stringify(e.attributes)+"\n":r+"TEXT "+(e.tagID||"- ")+e.content+"\n",e.isElement()&&(r+="  ",e.children.forEach(t),r=r.slice(2))}var n="",r="";return t(e),n}var c=e("language/HTMLTokenizer").Tokenizer,u=e("thirdparty/murmurhash3_gc"),d=e("utils/PerfUtils"),p=Math.floor(65535*Math.random()),h=1,f={li:{li:!0},dt:{dd:!0,dt:!0},dd:{dd:!0,dt:!0},address:{p:!0},article:{p:!0},aside:{p:!0},blockquote:{p:!0},dir:{p:!0},div:{p:!0},dl:{p:!0},fieldset:{p:!0},footer:{p:!0},form:{p:!0},h1:{p:!0},h2:{p:!0},h3:{p:!0},h4:{p:!0},h5:{p:!0},h6:{p:!0},header:{p:!0},hgroup:{p:!0},hr:{p:!0},main:{p:!0},menu:{p:!0},nav:{p:!0},ol:{p:!0},p:{p:!0},pre:{p:!0},section:{p:!0},table:{p:!0},ul:{p:!0},rt:{rp:!0,rt:!0},rp:{rp:!0,rt:!0},optgroup:{optgroup:!0,option:!0},option:{option:!0},tbody:{thead:!0,tbody:!0,tfoot:!0},tfoot:{tbody:!0},tr:{tr:!0,th:!0,td:!0},th:{th:!0,td:!0},td:{thead:!0,th:!0,td:!0},body:{head:!0,link:!0,script:!0}},m={area:!0,base:!0,basefont:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,isindex:!0,keygen:!0,link:!0,menuitem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};n.prototype={update:function(){if(this.isElement()){var e,t,n="",r="";for(e=0;e<this.children.length;e++)t=this.children[e],t.isElement()?(r+=String(t.tagID),n+=String(t.tagID)+t.attributeSignature+t.subtreeSignature):(r+=t.textSignature,n+=t.textSignature);this.childSignature=u.hashString(r,r.length,p),this.subtreeSignature=u.hashString(n,n.length,p)}else this.textSignature=u.hashString(this.content,this.content.length,p)},updateAttributeSignature:function(){var e=JSON.stringify(this.attributes);this.attributeSignature=u.hashString(e,e.length,p)},isElement:function(){return!!this.children},isText:function(){return!this.children}},a.prototype._logError=function(e){var t={token:e},n=e?e.startPos||e.endPos:this.startOffsetPos,r=e?e.endPos:this.startOffsetPos;t.startPos=i(this.startOffsetPos,n),t.endPos=i(this.startOffsetPos,r),this.errors||(this.errors=[]),this.errors.push(t)},a.prototype.build=function(e,t){function a(e,t){l=h[h.length-1],h.pop(),l.update(),l.end=u.startOffset+e,l.endPos=i(u.startOffsetPos,t)}var s,l,c,u=this,p=0,h=this.stack,g=null,v={};t=t||{};var y,_="HTMLInstr. Build DOM Full",E="HTMLInstr. Build DOM Partial";for(y=d.markStart([_,E]),_=y[0],E=y[1];null!==(s=this.t.nextToken());){if("text"!==s.type&&"comment"!==s.type&&c&&(c=null),"error"===s.type)return d.finalizeMeasurement(_),d.addMeasurement(E),this._logError(s),null;if("opentagname"===s.type){var b,S=s.contents.toLowerCase();if(f.hasOwnProperty(S))for(var I=f[S];h.length>0&&I.hasOwnProperty(h[h.length-1].tag);)a(s.start-1,o(s.startPos,-1));b=new n({tag:s.contents.toLowerCase(),children:[],attributes:{},parent:h.length?h[h.length-1]:null,start:this.startOffset+s.start-1,startPos:i(this.startOffsetPos,o(s.startPos,-1))}),b.tagID=this.getID(b,t),v[b.tagID]&&(b.tagID=this.getNewID()),v[b.tagID]=b,b.parent&&b.parent.children.push(b),this.currentTag=b,m.hasOwnProperty(b.tag)?b.update():h.push(b)}else if("opentagend"===s.type||"selfclosingtag"===s.type)this.currentTag&&("selfclosingtag"===s.type&&h.length&&h[h.length-1]===this.currentTag?a(s.end,s.endPos):(this.currentTag.end=this.startOffset+s.end,this.currentTag.endPos=i(this.startOffsetPos,s.endPos),l=this.currentTag,this.currentTag.updateAttributeSignature(),this.currentTag=null));else if("closetag"===s.type){var w=s.contents.toLowerCase();if(!m.hasOwnProperty(w)){var C;for(C=h.length-1;C>=0&&h[C].tag!==w;C--);if(e&&C!==h.length-1)return d.finalizeMeasurement(_),d.addMeasurement(E),this._logError(s),null;if(C>=0){do h.length===C+1?a(s.end+1,o(s.endPos,1)):a(s.start-2,o(s.startPos,-2));while(h.length>C)}else if(e)return d.finalizeMeasurement(_),d.addMeasurement(E),this._logError(s),null}}else if("attribname"===s.type)g=s.contents.toLowerCase(),this.currentTag.attributes[g]="";else if("attribvalue"===s.type&&null!==g)this.currentTag.attributes[g]=s.contents,g=null;else if("text"===s.type&&h.length){var D,T=h[h.length-1];c?(D=c,D.content+=s.contents):(D=new n({parent:h[h.length-1],content:s.contents}),T.children.push(D),D.tagID=r(D),v[D.tagID]=D,c=D),D.update()}p=s.end}if(h.length){if(e)return d.finalizeMeasurement(_),d.addMeasurement(E),this._logError(s),null;for(var O=this.text.split("\n"),M={line:O.length-1,ch:O[O.length-1].length};h.length;)a(this.text.length,M)}var L=l;return L?(L.nodeMap=v,d.addMeasurement(_),d.finalizeMeasurement(E),L):(this._logError(s),null)},a.prototype.getNewID=function(){return h++},a.prototype.getID=a.prototype.getNewID,t.build=s,t.Builder=a,t.SimpleNode=n,t._dumpDOM=l,t._offsetPos=o,t._getTextNodeID=r,t._seed=p}),define("language/HTMLDOMDiff",["require","exports","module"],function(e,t){"use strict";function n(e,t){var n=$.extend({},e.attributes),r=t.attributes,i=[];return Object.keys(r).forEach(function(t){if(n[t]!==r[t]){var o=n.hasOwnProperty(t)?"attrChange":"attrAdd";i.push({type:o,tagID:e.tagID,attribute:t,value:r[t]})}delete n[t]}),Object.keys(n).forEach(function(t){i.push({type:"attrDelete",tagID:e.tagID,attribute:t})}),i}function r(e){return e.parent&&e.parent.tagID}function i(e,t){var r,i,a=[],s=[],l=[],c=e?e.nodeMap:{},u=t.nodeMap,d=function(e){e.children&&c[e.tagID]&&a.push(e)},p=function(e){s.push.apply(s,e.edits),l.push.apply(l,e.moves),a.push.apply(a,e.newElements)};a.push(t);do r=a.pop(),i=c[r.tagID],i?(r.attributeSignature!==i.attributeSignature&&s.push.apply(s,n(i,r)),r.childSignature!==i.childSignature&&p(o(i,c,r,u)),r.subtreeSignature!==i.subtreeSignature&&r.children.forEach(d)):r.parent?p(o(null,c,r,u)):(s.push({type:"elementInsert",tag:r.tag,tagID:r.tagID,parentID:null,attributes:r.attributes}),p(Object.keys(c).length>0?o(c[Object.keys(c)[0]],c,r,u):o(null,c,r,u)));while(a.length);return l.length>0&&s.unshift({type:"rememberNodes",tagIDs:l}),s}var o=function(e,t,n,i){for(var o,a,s,l,c=0,u=0,d=n.children,p=e?e.children:[],h=[],f=[],m=[],g=[],v=function(e,t){h.forEach(function(t){"elementDelete"!==t.type&&(t.beforeID=e)}),f.push.apply(f,h),h=[],t||(l=e)},y=function(){return t[o.tagID]?!1:(s={type:"elementInsert",tag:o.tag,tagID:o.tagID,parentID:o.parent.tagID,attributes:o.attributes},h.push(s),g.push(o),l=o.tagID,c++,!0)},_=function(){return i[a.tagID]?!1:(v(a.tagID,!0),s={type:"elementDelete",tagID:a.tagID},h.push(s),u++,!0)},E=function(){s={type:"textInsert",content:o.content,parentID:o.parent.tagID},l?s.afterID=l:s.firstChild=!0,h.push(s),c++},b=function(){return c>0?n.children[c-1]:null},S=function(){var e=b();s=e&&!e.children?{type:"textReplace",content:e.content}:{type:"textDelete"};var t=h.length>0&&h[h.length-1];return t&&"textReplace"===t.type&&t.afterID===l?void u++:(s.parentID=a.parent.tagID,1===a.parent.children.length?h.push(s):(l&&(s.afterID=l),h.push(s)),void u++)},I=function(){var e=t[o.tagID];return e&&n.tagID!==r(e)?(s={type:"elementMove",tagID:o.tagID,parentID:o.parent.tagID},m.push(s.tagID),h.push(s),c++,!0):!1},w=function(e){var t=i[e.tagID];return e.children&&t&&r(e)!==r(t)};c<d.length&&u<p.length;)o=d[c],o.children&&I()||(a=p[u],w(a)?u++:o.isElement()||a.isElement()?o.isElement()&&a.isText()?(S(),y()):a.isElement()&&o.isText()?_()||E():o.tagID!==a.tagID?_()||y()||(console.error("HTML Instrumentation: This should not happen. Two elements have different tag IDs and there was no insert/delete. This generally means there was a reordering of elements."),c++,u++):(v(a.tagID,!1),c++,u++):(o.textSignature!==a.textSignature&&(s={type:"textReplace",content:o.content,parentID:o.parent.tagID},l&&(s.afterID=l),h.push(s)),c++,u++));for(;u<p.length;)a=p[u],w(a)?u++:a.isElement()?_()||(console.error("HTML Instrumentation: failed to add elementDelete for remaining element in the original DOM. This should not happen.",a),u++):S();for(;c<d.length;)o=d[c],o.isElement()?I()||y()||(console.error("HTML Instrumentation: failed to add elementInsert for remaining element in the updated DOM. This should not happen."),c++):E();return h.forEach(function(e){("textInsert"===e.type||"elementInsert"===e.type||"elementMove"===e.type)&&(e.lastChild=!0,delete e.firstChild,delete e.afterID)}),f.push.apply(f,h),{edits:f,moves:m,newElements:g}};t.domdiff=i}),define("language/HTMLInstrumentation",["require","exports","module","document/DocumentManager","./HTMLSimpleDOM","./HTMLDOMDiff"],function(e,t){"use strict";function n(e,t){I.hasOwnProperty(t.file.fullPath)&&(delete I[t.file.fullPath],t.off(".htmlInstrumentation"))}function r(e,t){return e&&t&&e.line===t.line&&e.ch===t.ch}function i(e,t){return e=e.filter(function(e){return!!e.tagID}).map(function(e){return t[e.tagID]||(t[e.tagID]={mark:e,range:e.find()}),t[e.tagID]}),e.sort(function(e,t){return e.range.from.line===t.range.from.line?e.range.from.ch-t.range.from.ch:e.range.from.line-t.range.from.line}),e}function o(e,t,n,o){var a,s;return o=o||{},a=i(e._codeMirror.findMarksAt(t),o),a.length?(s=a[a.length-1],n&&(r(s.range.from,t)||r(s.range.to,t))&&(s=a.length>1?a[a.length-2]:null),s.mark):null}function a(e,t,n){var r=o(e,t,!1,n);return r?r.tagID:-1}function s(e,t){t.children.forEach(function(t){t.isElement()&&s(e,t)});var n=e.markText(t.startPos,t.endPos);n.tagID=t.tagID}function l(e,t){var n=e._codeMirror,r=n.getAllMarks();n.operation(function(){r.forEach(function(e){e.hasOwnProperty("tagID")&&e.clear()})}),s(n,t)}function c(e,t,n){function r(e){return/[<>\/=\"\']/.test(e)}var i,a,s=0;if(this.isIncremental=!1,n&&1===n.length){var l=n[0];if(!r(l.text)&&!r(l.removed)){var c=o(t,l.from,!0);if(c){var u=c.find();u&&(i=t._codeMirror.getRange(u.from,u.to),this.changedTagID=c.tagID,a=u.from,s=t._codeMirror.indexFromPos(a),this.isIncremental=!0)}}}this.changedTagID||(i=t.document.getText()),E.Builder.call(this,i,s,a),this.editor=t,this.cm=t._codeMirror,this.previousDOM=e}function u(e,t){for(var n=e.parent;n&&n.tagID!==t;)n=n.parent;return!!n}function d(e,t,n){S||(n=void 0);var r=new c(e,t,n),i=r.update();if(!i)return{errors:r.errors};var o=b.domdiff(i.oldSubtree,i.newSubtree);return i.newSubtree!==i.newDOM&&delete i.newSubtree.nodeMap,{dom:i.newDOM,edits:o,_wasIncremental:r.isIncremental}}function p(e,t){var n=I[e.document.file.fullPath];n&&n.dom&&!I[e.document.file.fullPath].invalid||(t=null);var r=d(n&&n.dom,e,t);return r.errors?(n&&(n.invalid=!0),{errors:r.errors}):(I[e.document.file.fullPath]={timestamp:e.document.diskTimestamp,dom:r.dom,dirty:!1},{edits:r.edits})}function h(e,t){function n(e){e.tagID=e.attributes["data-brackets-id"],delete e.attributes["data-brackets-id"],e.children.forEach(function(t){t.parent=e,t.isElement()?n(t):t.isText()&&(t.update(),t.tagID=E.getTextNodeID(t),i[t.tagID]=t)}),e.update(),i[e.tagID]=e,e.tagID===t&&(r=e)}var r,i={};return n(e),r=r||e,r.nodeMap=i,r}function f(e,t){var n,r=I[e.document.file.fullPath],i=r.dom;return n=h(t,i.tagID),{diff:b.domdiff(i,n),browser:n,editor:i}}function m(e){I.hasOwnProperty(e.file.fullPath)||(e.on("change.htmlInstrumentation",function(){I[e.file.fullPath]&&(I[e.file.fullPath].dirty=!0)}),I[e.file.fullPath]=null);var t=I[e.file.fullPath];if(!e.isDirty&&t&&!t.dirty&&t.timestamp===e.diskTimestamp)return t.dom;var n=e.getText(),r=E.build(n);return r&&(I[e.file.fullPath]={timestamp:e.diskTimestamp,dom:r,dirty:!1}),r}function g(e){function t(e){if(e.tag){var n=" data-brackets-id='"+e.tagID+"'",r=e.start+e.tag.length+1;o+=i.substr(a,r-a)+n,a=r}e.isElement()&&e.children.forEach(t)}var n=e.document,r=m(n),i=n.getText(),o="",a=0;return r?(l(e,r),t(r),o+=i.substr(a)):null}function v(e){var t=I[e.document.file.fullPath],n=t&&t.dom;return n?void l(e,n):void console.error("Couldn't find the dom for "+e.document.file.fullPath)}function y(){I={}}var _=e("document/DocumentManager"),E=e("./HTMLSimpleDOM"),b=e("./HTMLDOMDiff"),S=!0,I={};c.prototype=Object.create(E.Builder.prototype),c.prototype.getID=function(e,t){var n=a(this.editor,E._offsetPos(e.startPos,1),t);if(-1===n||u(e,n))n=this.getNewID();else{var r=this.previousDOM.nodeMap[n];r&&r.tag===e.tag||(n=this.getNewID())}return n},c.prototype._updateMarkedRanges=function(e,t){var n=Object.keys(e),i=this.cm,o=i.getAllMarks();i.operation(function(){o.forEach(function(o){if(o.hasOwnProperty("tagID")&&e[o.tagID]){var a=e[o.tagID],s=t[o.tagID];s&&r(s.range.from,a.startPos)&&r(s.range.to,a.endPos)||(o.clear(),o=i.markText(a.startPos,a.endPos),o.tagID=a.tagID),n.splice(n.indexOf(String(a.tagID)),1)}}),n.forEach(function(t){var n,r=e[t];r.isElement()&&(n=i.markText(r.startPos,r.endPos),n.tagID=Number(t))})})},c.prototype._buildNodeMap=function(e){function t(e){e.tagID&&(n[e.tagID]=e),e.isElement()&&e.children.forEach(t)}var n={};t(e),e.nodeMap=n},c.prototype._handleDeletions=function(e,t,n){var r=[];if(Object.keys(t).forEach(function(t){n.hasOwnProperty(t)||(r.push(t),delete e[t])}),r.length){var i=this.cm.getAllMarks();i.forEach(function(e){e.hasOwnProperty("tagID")&&-1!==r.indexOf(e.tagID)&&e.clear()})}},c.prototype.update=function(){var e={},t=this.build(!0,e),n={newDOM:t,oldSubtree:this.previousDOM,newSubtree:t};if(!t)return null;if(this.changedTagID){var r=this.previousDOM.nodeMap[this.changedTagID],i=r.parent;if(i){var o=i.children.indexOf(r);if(-1===o)console.error("DOMUpdater.update(): couldn't locate old subtree in tree");else{r.parent=null,t.parent=i,i.children[o]=t,$.extend(this.previousDOM.nodeMap,t.nodeMap),this._updateMarkedRanges(t.nodeMap,e),this._buildNodeMap(r),this._handleDeletions(this.previousDOM.nodeMap,r.nodeMap,t.nodeMap);for(var a=i;a;)a.update(),a=a.parent;n.newDOM=this.previousDOM,n.oldSubtree=r}}}else l(this.editor,n.newDOM);return n},_.on("beforeDocumentDelete",n),t._markText=v,t._getMarkerAtDocumentPos=o,t._getTagIDAtDocumentPos=a,t._markTextFromDOM=l,t._updateDOM=d,t._allowIncremental=S,t._getBrowserDiff=f,t._resetCache=y,t.scanDocument=m,t.generateInstrumentedHTML=g,t.getUnappliedEditList=p}),define("LiveDevelopment/Documents/HTMLDocument",["require","exports","module","editor/EditorManager","utils/EventDispatcher","LiveDevelopment/Agents/HighlightAgent","language/HTMLInstrumentation","LiveDevelopment/Inspector/Inspector","LiveDevelopment/LiveDevelopment","utils/PerfUtils","LiveDevelopment/Agents/RemoteAgent","thirdparty/lodash"],function(e,t,n){"use strict";var r=e("editor/EditorManager"),i=e("utils/EventDispatcher"),o=e("LiveDevelopment/Agents/HighlightAgent"),a=e("language/HTMLInstrumentation"),s=e("LiveDevelopment/Inspector/Inspector"),l=e("LiveDevelopment/LiveDevelopment"),c=e("utils/PerfUtils"),u=e("LiveDevelopment/Agents/RemoteAgent"),d=e("thirdparty/lodash"),p=function(e,t){this.doc=e,this.doc&&this.doc.addRef(),this.editor=t,this._instrumentationEnabled=!1,this._onActiveEditorChange=this._onActiveEditorChange.bind(this),r.on("activeEditorChange",this._onActiveEditorChange),this.attachToEditor(t)};i.makeEventDispatcher(p.prototype),p.prototype.setInstrumentationEnabled=function(e){e&&!this._instrumentationEnabled&&this.editor&&(a.scanDocument(this.doc),a._markText(this.editor)),this._instrumentationEnabled=e},p.prototype.isLiveEditingEnabled=function(){return this._instrumentationEnabled},p.prototype.getResponseData=function(){var e;return this._instrumentationEnabled&&this.editor&&(e=a.generateInstrumentedHTML(this.editor)),{body:e||this.doc.getText()}},p.prototype.close=function(){this.editor&&this.editor.off(".HTMLDocument"),this.doc&&this.doc.releaseRef(),r.off("activeEditorChange",this._onActiveEditorChange),l.config.experimental&&this._onHighlight()},p.prototype.attachToEditor=function(e){var t=this;this.editor=e,this.editor.on("cursorActivity.HTMLDocument",function(e,n){t._onCursorActivity(e,n)}),this.editor.on("change.HTMLDocument",function(e,n,r){t._onChange(e,n,r)}),this.editor.on("beforeDestroy.HTMLDocument",function(e,n){t._onDestroy(e,n)}),l.config.experimental&&o.on("highlight.HTMLDocument",function(e,n){t._onHighlight(e,n)}),this._instrumentationEnabled&&a._markText(this.editor)},p.prototype.detachFromEditor=function(){this.editor&&(o.hide(),this.editor.off(".HTMLDocument"),this._removeHighlight(),this.editor=null)},p.prototype.updateHighlight=function(){var e=this.editor,t=[];s.config.highlight&&(e&&d.each(e.getSelections(),function(n){var r=a._getTagIDAtDocumentPos(e,n.reversed?n.end:n.start);-1!==r&&t.push(r)}),t.length?o.domElement(t):o.hide())},p.prototype._onCursorActivity=function(e,t){this.editor===t&&this.updateHighlight()},p.prototype._compareWithBrowser=function(e){var t=this;u.call("getSimpleDOM").done(function(n){var r,i,o,s=JSON.parse(n.result.value);try{o=a._getBrowserDiff(t.editor,s)}catch(l){return console.error("Error comparing in-browser DOM to in-editor DOM"),void console.error(l.stack)}r=o.diff.filter(function(e){return i=o.browser.nodeMap[e.parentID],i&&"html"===i.tag&&"textDelete"===e.type?!1:!0}),r.length>0&&(console.warn("Browser DOM does not match after change: "+JSON.stringify(e)),r.forEach(function(e){console.log(e)}))})},p.prototype._onDestroy=function(e,t){this.editor===t&&this.detachFromEditor()},p.prototype._onChange=function(e,t,n){if(this._instrumentationEnabled){var r="HTMLDocument applyDOMEdits",i=c.isActive(r);i||c.markStart(r);var o,s=this,l=a.getUnappliedEditList(t,n);l.edits&&(o=u.call("applyDOMEdits",l.edits),o.always(function(){i||c.addMeasurement(r)})),this.errors=l.errors||[],this.trigger("statusChanged",this),this._debug&&(console.log("Edits applied to browser were:"),console.log(JSON.stringify(l.edits,null,2)),o.done(function(){s._compareWithBrowser(n)}))}},p.prototype._onActiveEditorChange=function(e,t){this.detachFromEditor(),t&&t.document===this.doc&&this.attachToEditor(t)},p.prototype._onHighlight=function(e,t){if(this._removeHighlight(),t&&t.location&&this.editor){var n,r=this.editor._codeMirror,i=r.posFromIndex(t.location);n=t.closeLocation?t.closeLocation+t.closeLength:t.location+t.length,n=r.posFromIndex(n),this._highlight=r.markText(i,n,{className:"highlight"})}},p.prototype._removeHighlight=function(){this._highlight&&(this._highlight.clear(),this._highlight=null)},n.exports=p}),define("LiveDevelopment/Documents/JSDocument",["require","exports","module","utils/EventDispatcher","LiveDevelopment/Inspector/Inspector","LiveDevelopment/Agents/ScriptAgent","LiveDevelopment/Agents/HighlightAgent"],function(e,t,n){"use strict";var r=e("utils/EventDispatcher"),i=e("LiveDevelopment/Inspector/Inspector"),o=e("LiveDevelopment/Agents/ScriptAgent"),a=e("LiveDevelopment/Agents/HighlightAgent"),s=function(e,t){t&&(this.doc=e,this.editor=t,this.onHighlight=this.onHighlight.bind(this),this.onChange=this.onChange.bind(this),this.onCursorActivity=this.onCursorActivity.bind(this),a.on("highlight",this.onHighlight),this.editor.on("change",this.onChange),this.editor.on("cursorActivity",this.onCursorActivity),this.onCursorActivity())};r.makeEventDispatcher(s.prototype),s.prototype.close=function(){this.editor&&(a.off("highlight",this.onHighlight),this.editor.off("change",this.onChange),this.editor.off("cursorActivity",this.onCursorActivity),this.onHighlight())},s.prototype.script=function(){return o.scriptForURL(this.doc.url)},s.prototype.onCursorActivity=function(){},s.prototype.onChange=function(){var e=this.doc.getText();i.Debugger.setScriptSource(this.script().scriptId,e,function(){i.Runtime.evaluate('if($)$("canvas").each(function(i,e){if(e.rerender)e.rerender()})')}.bind(this))},s.prototype.onHighlight=function(e,t){var n,r=this.editor._codeMirror;for(n in this._highlight)r.removeLineClass(this._highlight[n],"wrap","highlight");if(this._highlight=[],t&&t.trace){var i,o,a=this.script().scriptId;for(n in t.trace)i=t.trace[n],i.location&&i.location.scriptId===a&&(o=i.location.lineNumber,r.addLineClass(o,"wrap","highlight"),this._highlight.push(o))}},n.exports=s}),define("LiveDevelopment/Agents/ConsoleAgent",["require","exports","module","LiveDevelopment/Inspector/Inspector"],function(e,t){"use strict";function n(e){var t=e.level;"warning"===t&&(t="warn");var n="ConsoleAgent: "+e.text;if(e.url&&(n+=" (url: "+e.url+")"),e.stackTrace){var r=e.stackTrace[0];n+=" in "+r.functionName+":"+r.columnNumber}console[t](n)}function r(e,t){c=t.message,n(c)}function i(){c&&n(c)}function o(){}function a(){return u.Console.enable()}function s(){u.Console.on("messageAdded.ConsoleAgent",r).on("messageRepeatCountUpdated.ConsoleAgent",i).on("messagesCleared.ConsoleAgent",o)}function l(){u.Console.off(".ConsoleAgent")}var c,u=e("LiveDevelopment/Inspector/Inspector");t.enable=a,t.load=s,t.unload=l}),define("LiveDevelopment/Agents/NetworkAgent",["require","exports","module","LiveDevelopment/Inspector/Inspector"],function(e,t){"use strict";function n(e){var t=e.search(/[#\?]/);return t>=0&&(e=e.substr(0,t)),e}function r(e){return p&&p[e]}function i(e){p[n(e)]=!0}function o(e,t){i(t.request.url)}function a(){p={}}function s(e,t){t.frame.parentId||a(),i(t.frame.url)}function l(){return d.Network.enable()}function c(){d.Page.on("frameNavigated.NetworkAgent",s),d.Network.on("requestWillBeSent.NetworkAgent",o)}function u(){a(),d.Page.off(".NetworkAgent"),d.Network.off(".NetworkAgent")}var d=e("LiveDevelopment/Inspector/Inspector"),p={};t.wasURLRequested=r,t.enable=l,t.load=c,t.unload=u}),define("LiveDevelopment/LiveDevelopment",["require","exports","module","utils/Global","thirdparty/lodash","utils/Async","language/CSSUtils","widgets/Dialogs","widgets/DefaultDialogs","document/DocumentManager","editor/EditorManager","utils/EventDispatcher","LiveDevelopment/Servers/FileServer","filesystem/FileSystemError","file/FileUtils","LiveDevelopment/LiveDevelopmentUtils","LiveDevelopment/LiveDevServerManager","view/MainViewManager","utils/NativeApp","preferences/PreferencesDialogs","project/ProjectManager","strings","utils/StringUtils","LiveDevelopment/Servers/UserServer","LiveDevelopment/Inspector/Inspector","LiveDevelopment/Documents/CSSDocument","LiveDevelopment/Documents/CSSPreprocessorDocument","LiveDevelopment/Documents/HTMLDocument","LiveDevelopment/Documents/JSDocument","LiveDevelopment/Agents/CSSAgent","LiveDevelopment/Agents/ConsoleAgent","LiveDevelopment/Agents/RemoteAgent","LiveDevelopment/Agents/NetworkAgent","LiveDevelopment/Agents/DOMAgent","LiveDevelopment/Agents/ScriptAgent","LiveDevelopment/Agents/HighlightAgent","LiveDevelopment/Agents/GotoAgent","LiveDevelopment/Agents/EditAgent"],function(e,t){"use strict";function n(e){return e&&"pending"===e.state()}function r(){return gt.getCurrentDocument()}function i(e){switch(e.getLanguage().getId()){case"less":case"scss":return xt;case"css":return Nt;case"javascript":return t.config.experimental?Pt:null}return St.isHtmlFileExt(e.file.fullPath)?At:null}function o(e){return Wt?Wt.get(e):void 0}function a(e){return e?o(e.document.file.fullPath):null}function s(e){var t;e.editor&&e._errorLineHandles&&e._errorLineHandles.length&&e.editor._codeMirror.operation(function(){for(;;){if(t=e._errorLineHandles.pop(),!t)break;e.editor._codeMirror.removeLineClass(t,"wrap",kt)}})}function l(e){return e+" "+Mt.format(Ot.LIVE_DEVELOPMENT_TROUBLESHOOTING,brackets.config.troubleshoot_url)}function c(e){s(e),e.close(),e.editor&&e.editor.off(".livedev"),e.off(".livedev")}function u(e){qt[e.doc.url]&&delete qt[e.doc.url],Wt&&Wt.remove(e),c(e)}function d(e,n){if(e!==t.status){t.status=e;var r=e===at?n:null;t.trigger("statusChange",e,r)}}function p(e){var t,n,r,i,o=e.errors.length?dt:ct;d(o),e.editor&&e.editor._codeMirror.operation(function(){s(e),e._errorLineHandles=e._errorLineHandles||[],e.errors.forEach(function(o){for(t=o.startPos.line,n=o.endPos.line,r=t;n+1>r;r++)i=e.editor._codeMirror.addLineClass(r,"wrap",kt),e._errorLineHandles.push(i)})})}function h(){$t&&(c($t),$t=void 0),Object.keys(qt).forEach(function(e){c(qt[e]),delete qt[e]}),Wt&&Wt.clear()}function f(e,t){var n=i(e),r=new n(e,t);return n?(r.on("statusChanged.livedev",function(){p(r)}),r):null}function m(e){e._ensureMasterEditor(),$t=f(e,e._masterEditor),Wt.add($t)}function g(e){Ut.hasOwnProperty(e)&&!Gt.hasOwnProperty(e)&&(Gt[e]=!0)}function v(e){Gt.hasOwnProperty(e)&&delete Gt[e]}function y(e){var t=Wt&&Wt.get(e.file.fullPath),n=t&&t.isLiveEditingEnabled();return e.isDirty&&!n}function _(e,t,n){var r;t.message?r=t.message:(console.warn("Expected a non-empty string in error.message, got this instead:",t.message),r=JSON.stringify(t)),r&&"Uncaught"===r.substr(0,8)&&(r=r.substr(9));var i=t.data;Array.isArray(i)&&(r+="\n"+i.join("\n")),console.error(r,t,n)}function E(e,t){var n=Wt&&Wt.urlToPath(t),r=!!qt[t];if(n&&!r){var o=gt.getDocumentForPath(n);o.done(function(e){if(!(i(e)!==Nt&&i(e)!==xt||$t&&e===$t.doc)){var t=f(e,e._masterEditor);t&&(Wt.add(t),qt[e.url]=t,t.on("deleted.livedev",function(e,t){u(t)}))}})}}function b(){Kt.forEach(function(e){Ut[e].unload()}),Kt=[]}function S(e,t){var n;return Ut[e]&&Ut[e][t]&&(n=Ut[e][t].call()),n?n.fail(function(){console.error(t+" failed on agent",e)}):n=(new $.Deferred).resolve().promise(),n}function I(){var e;return e=t.config.experimental?Ut:Gt,Object.keys(e)}function w(){return pt.doInParallel(I(),function(e){return S(e,"enable")},!0)}function C(){if(Ht)return Ht;var e,t=new $.Deferred;return Ht=t.promise(),d(lt),e=pt.doInParallel(I(),function(e){return S(e,"load").done(function(){Kt.push(e)})},!0),e=pt.withTimeout(e,1e4),e.done(function(){var e=$t?$t.doc:null;if(e){var n=ct;y(e)&&(n=ut),d(n),t.resolve()}else t.reject()}),e.fail(t.reject),Ht.fail(function(){d(ot),ft.showModalDialog(ft.DIALOG_ID_ERROR,Ot.LIVE_DEVELOPMENT_ERROR_TITLE,l(Ot.LIVE_DEV_LOADING_ERROR_MESSAGE))}).always(function(){Ht=null}),Ht}function D(){var e,t,n=r();if(n&&(e=n.file.fullPath,St.isStaticHtmlFileExt(e)||St.isServerHtmlFileExt(e)))return(new $.Deferred).resolve(n);var i=new $.Deferred,o=Tt.getBaseUrl(),a=o&&o.length;return Tt.getAllFiles().done(function(n){var r,o=Tt.getProjectRoot().fullPath,s=!1,l=!0;r=e?bt.getDirectoryPath(e):o;for(var c=n.filter(function(e){var t=bt.getParentPath(e.fullPath);return 0===r.indexOf(t)}),u=function(e){if(0===e.fullPath.indexOf(r)){if("index"!==bt.getFilenameWithoutExtension(e.name))return!1;if(a){if(St.isServerHtmlFileExt(e.name)||St.isStaticHtmlFileExt(e.name))return!0}else if(St.isStaticHtmlFileExt(e.name))return!0}};!s&&l;)t=it.findIndex(c,u),-1===t?(r=bt.getParentPath(r),-1===r.indexOf(o)&&(l=!1)):s=!0;return-1!==t?void gt.getDocumentForPath(c[t].fullPath).then(i.resolve,i.resolve):void i.resolve(null)}),i.promise()}function T(e,t,n){if(n&&n.document&&ht.isCSSPreprocessorFile(n.document.file.fullPath)){var r=Wt&&Wt.pathToUrl(n.document.file.fullPath);qt&&qt[r]&&u(qt[r])}if(t&&t.document&&ht.isCSSPreprocessorFile(t.document.file.fullPath)){var i=Wt&&Wt.pathToUrl(t.document.file.fullPath);E(null,i)}}function O(e){var t,n=new $.Deferred,r=Rt.connected();return vt.off("activeEditorChange",T),Rt.Page.off(".livedev"),Rt.off(".livedev"),Ht?Ht.always(b):b(),h(),Wt&&(Wt.stop(),Wt=null),e&&r?(t=Rt.Runtime.evaluate("window.open('', '_self').close();"),t=pt.withTimeout(t,5e3)):t=(new $.Deferred).resolve(),t.always(function(){Rt.connected()?Rt.disconnect().always(n.resolve):n.resolve()}),n.promise()}function M(e,r){function i(){var e="mac"===brackets.platform?Ct.closeLiveBrowser():$.Deferred().resolve();e.done(function(){d(at,r||"explicit_close"),Bt.resolve()}).fail(function(e){e&&(r+=" ("+e+")"),d(at,r||"explicit_close"),Bt.resolve()})}if(Bt)return Bt;Bt=new $.Deferred,Bt.always(function(){Bt=null});var o=Bt.promise();return n(Vt)&&Vt.reject(),t.status===at?Bt.resolve():O(e).always(i),o}function L(e,t){var n,r,i=t.frame.url;t.frame.parentId||!i.match(/^file:\/\//i)&&Wt&&(n=Wt.getBaseUrl(),n&&(r=new RegExp("^"+Mt.regexEscape(n),"i"),i.match(r)||M(!1,"navigated_away")))}function R(){M(!1,"closed_unknown_reason")}function N(e,t){var n;t&&t.reason&&(n="detached_"+t.reason),M(!1,n)}function x(){return Ht?Ht:(b(),it.forOwn(qt,function(e){u(e)}),C())}function A(){x(),Rt.Page.reload()}function P(){return M(!0)}function k(){function e(){n&&Rt.connected()?Rt.Runtime.evaluate("window.isBracketsLiveDevelopmentInterstitialPageLoaded",function(n){var i=n.result;"boolean"===i.type&&i.value?(window.clearTimeout(r),t.resolve()):window.setTimeout(e,100)}):t.reject()}var t=$.Deferred(),n=!0,r=window.setTimeout(function(){n=!1,t.reject()},1e4);return e(),t.promise()}function F(){Rt.Runtime.evaluate("window.navigator.userAgent",function(e){Rt.setUserAgent(e.result.value)});var e=Rt.Page.enable().then(function(){return Rt.DOM.enable().then(w,w)});e.done(function(){C().then(Vt.resolve,Vt.reject),D().done(function(e){e&&$t?(e!==$t.doc&&m(e),Wt?Rt.Page.navigate(Wt.pathToUrl(e.file.fullPath)):console.error("LiveDevelopment._onInterstitialPageLoad(): No server active")):P()})})}function U(){Rt.Page.on("frameNavigated.livedev",L),Rt.on("disconnect.livedev",R),k().fail(function(){P(),ft.showModalDialog(mt.DIALOG_ID_ERROR,Ot.LIVE_DEVELOPMENT_ERROR_TITLE,l(Ot.LIVE_DEV_LOADING_ERROR_MESSAGE))}).done(F)}function j(){ft.showModalDialog(mt.DIALOG_ID_ERROR,Ot.LIVE_DEVELOPMENT_ERROR_TITLE,l(Ot.LIVE_DEV_NEED_HTML_MESSAGE)),Vt.reject()}function V(){ft.showModalDialog(mt.DIALOG_ID_ERROR,Ot.LIVE_DEVELOPMENT_ERROR_TITLE,l(Ot.LIVE_DEV_SERVER_NOT_READY_MESSAGE)),Vt.reject()}function B(){var e=!1,n=0;Rt.connectToURL(jt).fail(function r(i){if("CANCEL"===i)return void Vt.reject(i);if(n>3){d(ot);var o=ft.showModalDialog(mt.DIALOG_ID_LIVE_DEVELOPMENT,Ot.LIVE_DEVELOPMENT_RELAUNCH_TITLE,l(Ot.LIVE_DEVELOPMENT_ERROR_MESSAGE),[{className:ft.DIALOG_BTN_CLASS_LEFT,id:ft.DIALOG_BTN_CANCEL,text:Ot.CANCEL},{className:ft.DIALOG_BTN_CLASS_PRIMARY,id:ft.DIALOG_BTN_OK,text:Ot.RELAUNCH_CHROME}]);
return void o.done(function(t){t===ft.DIALOG_BTN_OK?(d(at),M().done(function(){e=!1,G(!0)}).fail(function(){d(ot),e=!1,Vt.reject("CLOSE_LIVE_BROWSER")})):M().done(function(){e=!1,Vt.reject("CANCEL")}).fail(function(){d(ot),e=!1,Vt.reject("CLOSE_LIVE_BROWSER")})})}n++,e||t.status===ot||Ct.openLiveBrowser(jt,!0).done(function(){e=!0}).fail(function(e){var t;d(ot),t=e===Et.NOT_FOUND?Ot.ERROR_CANT_FIND_CHROME:Mt.format(Ot.ERROR_LAUNCHING_BROWSER,e),ft.showModalDialog(mt.DIALOG_ID_ERROR,Ot.ERROR_LAUNCHING_BROWSER_TITLE,l(t)),Vt.reject("OPEN_LIVE_BROWSER")}),t.status!==ot&&window.setTimeout(function(){Rt.connectToURL(jt).fail(r)},3e3)})}function H(e){d(st),m(e),Wt.start(),Rt.one("connect",U),B(),Vt.done(function(){vt.on("activeEditorChange",T),T(null,vt.getActiveEditor(),null)})}function W(e){var n=new $.Deferred,r=!1;if(Wt=It.getServer(e.file.fullPath),r=!t.config.experimental&&!Wt&&St.isServerHtmlFileExt(e.file.fullPath))Dt.showProjectPreferencesDialog("",Ot.LIVE_DEV_NEED_BASEURL_MESSAGE).done(function(t){t===ft.DIALOG_BTN_OK&&Tt.getBaseUrl()?W(e).then(n.resolve,n.reject):n.reject()});else if(Wt){var i=Wt.readyToServe();i?i.then(n.resolve,function(){V(),n.reject()}):(V(),n.reject())}else n.reject();return n.promise()}function G(e){if(n(Bt))return Bt.then(function(){return G(e)});if(!e){if(n(Vt))return Vt;Vt=new $.Deferred,Vt.always(function(){Vt=null})}return D().done(function(e){var t,n=e&&W(e)||(new $.Deferred).reject();e&&!e._masterEditor&&(t=wt.getWorkingSet(wt.ALL_PANES).length,wt.addToWorkingSet(wt.ACTIVE_PANE,e.file),t||wt._edit(wt.ACTIVE_PANE,e)),n.done(function(){H(e)}).fail(function(){j()})}),Vt.promise()}function K(){var e=a(vt.getActiveEditor());e&&e.updateHighlight&&e.updateHighlight()}function q(){Rt.connected()&&Ut.highlight&&Ut.highlight.hide()}function z(){Rt.connected()&&Ut.highlight&&Ut.highlight.redraw()}function Y(){var e=r();if(e&&Rt.connected()){var n=Wt&&Wt.pathToUrl(e.file.fullPath),i=Ut.network&&Ut.network.wasURLRequested(n),o=t.config.experimental||Wt&&Wt.canServe(e.file.fullPath);!i&&o?(d(st),h(),m(e),Rt.Page.navigate(n).then(function(){d(ct)},function(){M(!1,"closed_unknown_reason")})):i&&K()}}function X(e,t){if(Rt.connected()&&Wt){var n=t.file.fullPath,r=n&&Wt.get(n),i=r&&r.isLiveEditingEnabled&&r.isLiveEditingEnabled();if(!i){var o=Wt.pathToUrl(n),a=Ut.network&&Ut.network.wasURLRequested(o);a&&A()}}}function Q(e,t){t&&Rt.connected()&&Wt&&Ut.network&&Ut.network.wasURLRequested(Wt.pathToUrl(t.file.fullPath))&&d(y(t)?ut:ct)}function J(){return{baseUrl:Tt.getBaseUrl(),pathResolver:Tt.makeProjectRelativeIfPossible,root:Tt.getProjectRoot().fullPath}}function Z(){return new Lt(J())}function et(){return new _t(J())}function tt(e){t.config=e,Rt.on("error",_),Rt.Inspector.on("detached",N),Ft.on("styleSheetAdded.livedev",E),wt.on("currentFileChange",Y),gt.on("documentSaved",X).on("dirtyFlagChange",Q),Tt.on("beforeProjectClose beforeAppClose",P),It.registerServer({create:Z},99),It.registerServer({create:et},0),d(at)}function nt(){return Wt}function rt(){return Wt&&Wt.getBaseUrl()}e("utils/Global");var it=e("thirdparty/lodash"),ot=t.STATUS_ERROR=-1,at=t.STATUS_INACTIVE=0,st=t.STATUS_CONNECTING=1,lt=t.STATUS_LOADING_AGENTS=2,ct=t.STATUS_ACTIVE=3,ut=t.STATUS_OUT_OF_SYNC=4,dt=t.STATUS_SYNC_ERROR=5,pt=e("utils/Async"),ht=e("language/CSSUtils"),ft=e("widgets/Dialogs"),mt=e("widgets/DefaultDialogs"),gt=e("document/DocumentManager"),vt=e("editor/EditorManager"),yt=e("utils/EventDispatcher"),_t=e("LiveDevelopment/Servers/FileServer").FileServer,Et=e("filesystem/FileSystemError"),bt=e("file/FileUtils"),St=e("LiveDevelopment/LiveDevelopmentUtils"),It=e("LiveDevelopment/LiveDevServerManager"),wt=e("view/MainViewManager"),Ct=e("utils/NativeApp"),Dt=e("preferences/PreferencesDialogs"),Tt=e("project/ProjectManager"),Ot=e("strings"),Mt=e("utils/StringUtils"),Lt=e("LiveDevelopment/Servers/UserServer").UserServer,Rt=e("LiveDevelopment/Inspector/Inspector"),Nt=e("LiveDevelopment/Documents/CSSDocument"),xt=e("LiveDevelopment/Documents/CSSPreprocessorDocument"),At=e("LiveDevelopment/Documents/HTMLDocument"),Pt=e("LiveDevelopment/Documents/JSDocument"),kt="live-preview-sync-error",Ft=e("LiveDevelopment/Agents/CSSAgent"),Ut={console:e("LiveDevelopment/Agents/ConsoleAgent"),remote:e("LiveDevelopment/Agents/RemoteAgent"),network:e("LiveDevelopment/Agents/NetworkAgent"),dom:e("LiveDevelopment/Agents/DOMAgent"),css:Ft,script:e("LiveDevelopment/Agents/ScriptAgent"),highlight:e("LiveDevelopment/Agents/HighlightAgent"),"goto":e("LiveDevelopment/Agents/GotoAgent"),edit:e("LiveDevelopment/Agents/EditAgent")},jt=window.location.pathname;jt=jt.replace("/test/SpecRunner.html","/src/index.html"),jt=jt.substr(0,jt.lastIndexOf("/"))+"/LiveDevelopment/launch.html",jt=window.location.origin+jt;var $t,Vt,Bt,Ht,Wt,Gt={console:!0,remote:!0,network:!0,css:!0,highlight:!0},Kt=[],qt={};yt.makeEventDispatcher(t),t.launcherUrl=jt,t._getServer=nt,t._getInitialDocFromCurrent=D,t.agents=Ut,t.open=G,t.close=P,t.reconnect=x,t.reload=A,t.enableAgent=g,t.disableAgent=v,t.getLiveDocForPath=o,t.showHighlight=K,t.hideHighlight=q,t.redrawHighlight=z,t.init=tt,t.getCurrentProjectServerConfig=J,t.getServerBaseUrl=rt}),define("utils/NodeDomain",["require","exports","module","utils/NodeConnection","utils/EventDispatcher"],function(e,t,n){"use strict";function r(e,t){var n=new i;this.connection=n,this._domainName=e,this._domainPath=t,this._domainLoaded=!1,this._load=this._load.bind(this),this._connectionPromise=n.connect(!0).then(this._load),n.on("close",function(e,t){this.connection.off(a),this._domainLoaded=!1,this._connectionPromise=t.then(this._load)}.bind(this))}var i=e("utils/NodeConnection"),o=e("utils/EventDispatcher"),a=".NodeDomainEvent";o.makeEventDispatcher(r.prototype),r.prototype.connection=null,r.prototype._connectionPromise=null,r.prototype._domainName=null,r.prototype._domainPath=null,r.prototype._domainLoaded=!1,r.prototype._load=function(){var e=this.connection;return e.loadDomains(this._domainPath,!0).done(function(){this._domainLoaded=!0,this._connectionPromise=null;var t=Object.keys(e.domainEvents[this._domainName]);t.forEach(function(t){var n=this._domainName+":"+t+a;e.on(n,function(){var e=Array.prototype.slice.call(arguments,1);o.triggerWithArray(this,t,e)}.bind(this))},this)}.bind(this)).fail(function(e){console.error('[NodeDomain] Error loading domain "'+this._domainName+'": '+e)}.bind(this))},r.prototype.ready=function(){return this._domainLoaded&&this.connection.connected()},r.prototype.promise=function(){if(this._connectionPromise)return this._connectionPromise;var e=new $.Deferred;return this.ready()?e.resolve():e.reject(),e.promise()},r.prototype.exec=function(e){var t,n=this.connection,r=Array.prototype.slice.call(arguments,1),i=function(){var t,i=n.domains[this._domainName],o=i&&i[e];return t=o?o.apply(i,r):(new $.Deferred).reject().promise()}.bind(this);return t=this.ready()?i():this._connectionPromise?this._connectionPromise.then(i):(new $.Deferred.reject).promise()},n.exports=r}),define("text!LiveDevelopment/MultiBrowserImpl/transports/remote/NodeSocketTransportRemote.js",[],function(){return'/*\n * Copyright (c) 2014 Adobe Systems Incorporated. All rights reserved.\n *  \n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the "Software"), \n * to deal in the Software without restriction, including without limitation \n * the rights to use, copy, modify, merge, publish, distribute, sublicense, \n * and/or sell copies of the Software, and to permit persons to whom the \n * Software is furnished to do so, subject to the following conditions:\n *  \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *  \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER \n * DEALINGS IN THE SOFTWARE.\n * \n */\n\n/*jslint browser: true, vars: true, plusplus: true, devel: true, nomen: true, indent: 4, forin: true, maxerr: 50, regexp: true */\n/*global WebSocket */\n\n// This is a transport injected into the browser via a script that handles the low\n// level communication between the live development protocol handlers on both sides.\n// This transport provides a web socket mechanism. It\'s injected separately from the\n// protocol handler so that the transport can be changed separately.\n\n(function (global) {\n    "use strict";\n    \n    var WebSocketTransport = {\n        /**\n         * @private\n         * The WebSocket that we communicate with Brackets over.\n         * @type {?WebSocket}\n         */\n        _ws: null,\n        \n        /**\n         * @private\n         * An object that contains callbacks to handle various transport events. See `setCallbacks()`.\n         * @type {?{connect: ?function, message: ?function(string), close: ?function}}\n         */\n        _callbacks: null,\n        \n        /**\n         * Sets the callbacks that should be called when various transport events occur. All callbacks\n         * are optional, but you should at least implement "message" or nothing interesting will happen :)\n         * @param {?{connect: ?function, message: ?function(string), close: ?function}} callbacks\n         *      The callbacks to set.\n         *      connect - called when a connection is established to Brackets\n         *      message(msgStr) - called with a string message sent from Brackets\n         *      close - called when Brackets closes the connection\n         */\n        setCallbacks: function (callbacks) {\n            if (!global._Brackets_LiveDev_Socket_Transport_URL) {\n                console.error("[Brackets LiveDev] No socket transport URL injected");\n            } else {\n                this._callbacks = callbacks;\n            }\n        },\n        \n        /**\n         * Connects to the NodeSocketTransport in Brackets at the given WebSocket URL.\n         * @param {string} url\n         */\n        connect: function (url) {\n            var self = this;\n            this._ws = new WebSocket(url);\n            \n            // One potential source of confusion: the transport sends two "types" of messages -\n            // these are distinct from the protocol\'s own messages. This is because this transport\n            // needs to send an initial "connect" message telling the Brackets side of the transport\n            // the URL of the page that it\'s connecting from, distinct from the actual protocol \n            // message traffic. Actual protocol messages are sent as a JSON payload in a message of\n            // type "message".\n            //\n            // Other transports might not need to do this - for example, a transport that simply\n            // talks to an iframe within the same process already knows what URL that iframe is\n            // pointing to, so the only comunication that needs to happen via postMessage() is the\n            // actual protocol message strings, and no extra wrapping is necessary.\n            \n            this._ws.onopen = function (event) {\n                // Send the initial "connect" message to tell the other end what URL we\'re from.\n                self._ws.send(JSON.stringify({\n                    type: "connect",\n                    url: global.location.href\n                }));\n                console.log("[Brackets LiveDev] Connected to Brackets at " + url);\n                if (self._callbacks && self._callbacks.connect) {\n                    self._callbacks.connect();\n                }\n            };\n            this._ws.onmessage = function (event) {\n                console.log("[Brackets LiveDev] Got message: " + event.data);\n                if (self._callbacks && self._callbacks.message) {\n                    self._callbacks.message(event.data);\n                }\n            };\n            this._ws.onclose = function (event) {\n                self._ws = null;\n                if (self._callbacks && self._callbacks.close) {\n                    self._callbacks.close();\n                }\n            };\n            // TODO: onerror\n        },\n        \n        /**\n         * Sends a message over the transport.\n         * @param {string} msgStr The message to send.\n         */\n        send: function (msgStr) {\n            if (this._ws) {\n                // See comment in `connect()` above about why we wrap the message in a transport message\n                // object.\n                this._ws.send(JSON.stringify({\n                    type: "message",\n                    message: msgStr\n                }));\n            } else {\n                console.log("[Brackets LiveDev] Tried to send message over closed connection: " + msgStr);\n            }\n        },\n        \n        /** \n         * Establish web socket connection.\n         */\n        enable: function () {\n            this.connect(global._Brackets_LiveDev_Socket_Transport_URL);\n        }\n    };\n    global._Brackets_LiveDev_Transport = WebSocketTransport;\n}(this));\n'}),define("LiveDevelopment/MultiBrowserImpl/transports/NodeSocketTransport",["require","exports","module","file/FileUtils","utils/EventDispatcher","utils/NodeDomain","text!LiveDevelopment/MultiBrowserImpl/transports/remote/NodeSocketTransportRemote.js"],function(e,t,n){"use strict";function r(){return"<script>\n"+s+"this._Brackets_LiveDev_Socket_Transport_URL = 'ws://localhost:"+u+"';\n</script>\n"}var i=e("file/FileUtils"),o=e("utils/EventDispatcher"),a=e("utils/NodeDomain"),s=e("text!LiveDevelopment/MultiBrowserImpl/transports/remote/NodeSocketTransportRemote.js"),l=i.getNativeBracketsDirectoryPath()+"/"+i.getNativeModuleDirectoryPath(n)+"/node/NodeSocketTransportDomain",c=new a("nodeSocketTransport",l),u=8123;["connect","message","close"].forEach(function(e){c.on(e,function(){console.log("NodeSocketTransport - event - "+e+" - "+JSON.stringify(Array.prototype.slice.call(arguments,1))),t.trigger(e,Array.prototype.slice.call(arguments,1))})}),o.makeEventDispatcher(t),t.getRemoteScript=r,["start","send","close"].forEach(function(e){t[e]=function(){var t=Array.prototype.slice.call(arguments);t.unshift(e),console.log("NodeSocketTransport - "+t),c.exec.apply(c,t)}})}),define("text!LiveDevelopment/MultiBrowserImpl/protocol/remote/LiveDevProtocolRemote.js",[],function(){return'/*\n * Copyright (c) 2014 Adobe Systems Incorporated. All rights reserved.\n *  \n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the "Software"), \n * to deal in the Software without restriction, including without limitation \n * the rights to use, copy, modify, merge, publish, distribute, sublicense, \n * and/or sell copies of the Software, and to permit persons to whom the \n * Software is furnished to do so, subject to the following conditions:\n *  \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *  \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER \n * DEALINGS IN THE SOFTWARE.\n * \n */\n\n/*jslint vars: true, plusplus: true, devel: true, nomen: true, indent: 4, forin: true, maxerr: 50, regexp: true */\n/*jslint evil: true */\n\n// This is the script that Brackets live development injects into HTML pages in order to\n// establish and maintain the live development socket connection. Note that Brackets may\n// also inject other scripts via "evaluate" once this has connected back to Brackets.\n\n(function (global) {\n    "use strict";\n    \n    // This protocol handler assumes that there is also an injected transport script that\n    // has the following methods:\n    //     setCallbacks(obj) - a method that takes an object with a "message" callback that\n    //         will be called with the message string whenever a message is received by the transport.\n    //     send(msgStr) - sends the given message string over the transport.\n    var transport = global._Brackets_LiveDev_Transport;\n\n    /**\n     * Manage messaging between Editor and Browser at the protocol layer.\n     * Handle messages that arrives through the current transport and dispatch them \n     * to subscribers. Subscribers are handlers that implements remote commands/functions.\n     * Property \'method\' of messages body is used as the \'key\' to identify message types.   \n     * Provide a \'send\' operation that allows remote commands sending messages to the Editor.\n     */\n    var MessageBroker = {\n                \n        /**\n         * Collection of handlers (subscribers) per each method.\n         * To be pushed by \'on\' and consumed by \'trigger\' stored this way: \n         *      handlers[method] = [handler1, handler2, ...]\n         */\n        handlers: {},\n        \n         /**\n          * Dispatch messages to handlers according to msg.method value.\n          * @param {Object} msg Message to be dispatched.\n          */\n        trigger: function (msg) {\n            var msgHandlers;\n            if (!msg.method) {\n                // no message type, ignoring it\n                // TODO: should we trigger a generic event?\n                console.log("[Brackets LiveDev] Received message without method.");\n                return;\n            }\n            // get handlers for msg.method\n            msgHandlers = this.handlers[msg.method];\n            \n            if (msgHandlers && msgHandlers.length > 0) {\n                // invoke handlers with the received message\n                msgHandlers.forEach(function (handler) {\n                    try {\n                        // TODO: check which context should be used to call handlers here.\n                        handler(msg);\n                        return;\n                    } catch (e) {\n                        console.log("[Brackets LiveDev] Error executing a handler for " + msg.method);\n                        console.log(e.stack);\n                        return;\n                    }\n                });\n            } else {\n                // no subscribers, ignore it.\n                // TODO: any other default handling? (eg. specific respond, trigger as a generic event, etc.);\n                console.log("[Brackets LiveDev] No subscribers for message " + msg.method);\n                return;\n            }\n        },\n        \n        /**\n         * Send a response of a particular message to the Editor.\n         * Original message must provide an \'id\' property\n         * @param {Object} orig Original message.\n         * @param {Object} response Message to be sent as the response.\n         */\n        respond: function (orig, response) {\n            if (!orig.id) {\n                console.log("[Brackets LiveDev] Trying to send a response for a message with no ID");\n                return;\n            }\n            response.id = orig.id;\n            this.send(response);\n        },\n        \n        /**\n         * Subscribe handlers to specific messages.\n         * @param {string} method Message type.\n         * @param {function} handler.\n         * TODO: add handler name or any identification mechanism to then implement \'off\'?\n         */\n        on: function (method, handler) {\n            if (!method || !handler) {\n                return;\n            }\n            if (!this.handlers[method]) {\n                //initialize array\n                this.handlers[method] = [];\n            }\n            // add handler to the stack\n            this.handlers[method].push(handler);\n        },\n        \n        /**\n         * Send a message to the Editor.\n         * @param {string} msgStr Message to be sent.\n         */\n        send: function (msgStr) {\n            transport.send(JSON.stringify(msgStr));\n        }\n    };\n    \n    /**\n     * Runtime Domain. Implements remote commands for "Runtime.*"\n     */\n    var Runtime = {\n        /**\n         * Evaluate an expresion and return its result.\n         */\n        evaluate: function (msg) {\n            console.log("Runtime.evaluate");\n            var result = eval(msg.params.expression);\n            MessageBroker.respond(msg, {\n                result: JSON.stringify(result) // TODO: in original protocol this is an object handle\n            });\n        }\n    };\n    \n    // subscribe handler to method Runtime.evaluate\n    MessageBroker.on("Runtime.evaluate", Runtime.evaluate);\n    \n    /**\n     * CSS Domain.\n     */\n    var CSS = {\n        \n        setStylesheetText : function (msg) {\n            \n            if (!msg || !msg.params || !msg.params.text || !msg.params.url) {\n                return;\n            }\n            \n            var i,\n                node;\n\n            var head = document.getElementsByTagName(\'head\')[0];\n            // create an style element to replace the one loaded with <link>\n            var s = document.createElement(\'style\');\n            s.type = \'text/css\';\n            s.appendChild(document.createTextNode(msg.params.text));\n\n            for (i = 0; i < document.styleSheets.length; i++) {\n                node = document.styleSheets[i];\n                if (node.ownerNode.id === msg.params.url) {\n                    head.insertBefore(s, node.ownerNode); // insert the style element here\n                    // now can remove the style element previously created (if any)\n                    node.ownerNode.parentNode.removeChild(node.ownerNode);\n                } else if (node.href === msg.params.url  && !node.disabled) {\n                    // if the link element to change \n                    head.insertBefore(s, node.ownerNode); // insert the style element here\n                    node.disabled = true;\n                    i++; // since we have just inserted a stylesheet\n                }\n            }\n            s.id = msg.params.url;\n        },\n            \n        /**\n        * retrieves the content of the stylesheet\n        * TODO: it now depends on reloadCSS implementation\n        */\n        getStylesheetText: function (msg) {\n            var i,\n                sheet,\n                text = "";\n            for (i = 0; i < document.styleSheets.length; i++) {\n                sheet = document.styleSheets[i];\n                // if it was already \'reloaded\'\n                if (sheet.ownerNode.id ===  msg.params.url) {\n                    text = sheet.ownerNode.textContent;\n                } else if (sheet.href === msg.params.url && !sheet.disabled) {\n                    var j,\n                        rules = document.styleSheets[i].cssRules;\n                    for (j = 0; j < rules.length; j++) {\n                        text += rules[j].cssText + \'\\n\';\n                    }\n                }\n            }\n            \n            MessageBroker.respond(msg, {\n                text: text\n            });\n        }\n    };\n    \n    MessageBroker.on("CSS.setStylesheetText", CSS.setStylesheetText);\n    MessageBroker.on("CSS.getStylesheetText", CSS.getStylesheetText);\n    \n    /**\n     * Page Domain.\n     */\n    var Page = {\n        /**\n         * Reload the current page optionally ignoring cache.\n         * @param {Object} msg\n         */\n        reload: function (msg) {\n            // just reload the page\n            window.location.reload(msg.params.ignoreCache);\n        },\n        \n        /**\n         * Navigate to a different page.\n         * @param {Object} msg\n         */\n        navigate: function (msg) {\n            if (msg.params.url) {\n                // navigate to a new page.\n                window.location.replace(msg.params.url);\n            }\n        }\n    };\n         \n    // subscribe handler to method Page.reload\n    MessageBroker.on("Page.reload", Page.reload);\n    MessageBroker.on("Page.navigate", Page.navigate);\n    MessageBroker.on("ConnectionClose", Page.close);\n        \n    \n    \n    // By the time this executes, there must already be an active transport.\n    if (!transport) {\n        console.error("[Brackets LiveDev] No transport set");\n        return;\n    }\n    \n    var ProtocolManager = {\n        \n        _documentObserver: {},\n        \n        _protocolHandler: {},\n        \n        enable: function () {\n            transport.setCallbacks(this._protocolHandler);\n            transport.enable();\n        },\n        \n        onConnect: function () {\n            this._documentObserver.start(window.document, transport);\n        },\n        \n        onClose: function () {\n            // TODO: This is absolutely temporary solution.\n            var body = document.getElementsByTagName("body")[0],\n                overlay = document.createElement("div"),\n                background = document.createElement("div"),\n                status = document.createElement("div");\n            \n            overlay.style.width = "100%";\n            overlay.style.height = "100%";\n            overlay.style.zIndex = 2227;\n            overlay.style.position = "absolute";\n            overlay.style.top = 0;\n            overlay.style.left = 0;\n            \n            background.style.backgroundColor = "#fff";\n            background.style.opacity = 0.5;\n            background.style.width = "100%";\n            background.style.height = "100%";\n            background.style.position = "absolute";\n            background.style.top = 0;\n            background.style.left = 0;            \n\n            status.textContent = "Live Development Session has Ended";\n            status.style.width = "100%";\n            status.style.color = "#fff";\n            status.style.backgroundColor = "#666";\n            status.style.position = "absolute";\n            status.style.top = 0;\n            status.style.left = 0;\n            status.style.padding = "0.2em";\n            status.style.verticalAlign = "top";\n            status.style.textAlign = "center";\n            overlay.appendChild(background);\n            overlay.appendChild(status);\n            body.appendChild(overlay);\n            \n            // change the title as well\n            document.title = "(Brackets Live Preview: closed) " + document.title;\n        },\n        \n        setDocumentObserver: function (documentOberver) {\n            if (!documentOberver) {\n                return;\n            }\n            this._documentObserver = documentOberver;\n        },\n        \n        setProtocolHandler: function (protocolHandler) {\n            if (!protocolHandler) {\n                return;\n            }\n            this._protocolHandler = protocolHandler;\n        }\n    };\n    \n    // exposing ProtocolManager\n    global._Brackets_LiveDev_ProtocolManager = ProtocolManager;\n        \n    /**\n     * The remote handler for the protocol.\n     */\n    var ProtocolHandler = {\n        /**\n         * Handles a message from the transport. Parses it as JSON and delegates\n         * to MessageBroker who is in charge of routing them to handlers.\n         * @param {string} msgStr The protocol message as stringified JSON.\n         */\n        message: function (msgStr) {\n            var msg;\n            try {\n                msg = JSON.parse(msgStr);\n            } catch (e) {\n                console.log("[Brackets LiveDev] Invalid Message Received");\n                // TODO: we should probably send back an error message here?\n                return;\n            }\n            // delegates handling/routing to MessageBroker.\n            MessageBroker.trigger(msg);\n        },\n        \n        close: function (evt) {\n            ProtocolManager.onClose();\n        },\n        \n        connect: function (evt) {\n            ProtocolManager.onConnect();\n        }\n    };\n    \n    ProtocolManager.setProtocolHandler(ProtocolHandler);\n    \n    window.addEventListener(\'load\', function () {\n        ProtocolManager.enable();\n    });\n    \n}(this));\n'}),define("text!LiveDevelopment/MultiBrowserImpl/protocol/remote/DocumentObserver.js",[],function(){return'/*\n * Copyright (c) 2014 Adobe Systems Incorporated. All rights reserved.\n *  \n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the "Software"), \n * to deal in the Software without restriction, including without limitation \n * the rights to use, copy, modify, merge, publish, distribute, sublicense, \n * and/or sell copies of the Software, and to permit persons to whom the \n * Software is furnished to do so, subject to the following conditions:\n *  \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *  \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER \n * DEALINGS IN THE SOFTWARE.\n * \n */\n\n/*jslint vars: true, plusplus: true, devel: true, nomen: true, indent: 4, forin: true, maxerr: 50, regexp: true */\n/*global setInterval, clearInterval */\n\n(function (global) {\n    "use strict";\n    \n    var ProtocolManager = global._Brackets_LiveDev_ProtocolManager;\n    \n    var _document = null;\n    var _transport;\n\n    \n    /**\n     * Retrieves related documents (external CSS and JS files)\n     * \n     * @return {{scripts: object, stylesheets: object}} Related scripts and stylesheets\n     */\n    function related() {\n\n        var rel = {\n            scripts: {},\n            stylesheets: {}\n        };\n        var i;\n        // iterate on document scripts (HTMLCollection doesn\'t provide forEach iterator).\n        for (i = 0; i < _document.scripts.length; i++) {\n            // add only external scripts\n            if (_document.scripts[i].src) {\n                rel.scripts[_document.scripts[i].src] = true;\n            }\n        }\n          \n        var s, j;\n        //traverse @import rules\n        var traverseRules = function _traverseRules(sheet, base) {\n            var i;\n            if (sheet.href && sheet.cssRules) {\n                if (rel.stylesheets[sheet.href] === undefined) {\n                    rel.stylesheets[sheet.href] = [];\n                }\n                rel.stylesheets[sheet.href].push(base);\n                \n                \n                for (i = 0; i < sheet.cssRules.length; i++) {\n                    if (sheet.cssRules[i].href) {\n                        traverseRules(sheet.cssRules[i].styleSheet, base);\n                    }\n                }\n            }\n        };\n        //iterate on document.stylesheets (StyleSheetList doesn\'t provide forEach iterator).\n        for (j = 0; j < document.styleSheets.length; j++) {\n            s = document.styleSheets[j];\n            traverseRules(s, s.href);\n        }\n        return rel;\n    }\n    \n    /**\n     * Common functions.\n     */\n    var Utils = {\n        \n        isExternalStylesheet: function (node) {\n            return (node.nodeName.toUpperCase() === "LINK" && node.rel === "stylesheet" && node.href);\n        },\n        isExternalScript: function (node) {\n            return (node.nodeName.toUpperCase() === "SCRIPT" && node.src);\n        }\n    };\n    \n    /**\n     * CSS related commands and notifications\n     */\n    var CSS = {\n        \n            /**\n            * Maintains a map of stylesheets loaded thorugh @import rules and their parents.\n            * Populated by extractImports, consumed by notifyImportsAdded / notifyImportsRemoved.\n            * @type {\n            */\n            stylesheets : {},\n        \n            /**\n             * Check the stylesheet that was just added be really loaded \n             * to be able to extract potential import-ed stylesheets.\n             * It invokes notifyStylesheetAdded once the sheet is loaded.\n             * @param  {string} href Absolute URL of the stylesheet.\n             */\n            checkForStylesheetLoaded : function (href) {\n                var self = this;\n  \n\n                // Inspect CSSRules for @imports:\n                // styleSheet obejct is required to scan CSSImportRules but\n                // browsers differ on the implementation of MutationObserver interface.\n                // Webkit triggers notifications before stylesheets are loaded, \n                // Firefox does it after loading.\n                // There are also differences on when \'load\' event is triggered for \n                // the \'link\' nodes. Webkit triggers it before stylesheet is loaded.\n                // Some references to check:\n                //      http://www.phpied.com/when-is-a-stylesheet-really-loaded/\n                //      http://stackoverflow.com/questions/17747616/webkit-dynamically-created-stylesheet-when-does-it-really-load\n                //        http://stackoverflow.com/questions/11425209/are-dom-mutation-observers-slower-than-dom-mutation-events      \n                //\n                // TODO: This is just a temporary \'cross-browser\' solution, it needs optimization.\n                var loadInterval = setInterval(function () {\n                    var i;\n                    for (i = 0; i < document.styleSheets.length; i++) {\n                        if (document.styleSheets[i].href === href) {\n                            //clear interval\n                            clearInterval(loadInterval);\n                            // notify stylesheets added\n                            self.notifyStylesheetAdded(href);\n                            break;\n                        }\n                    }\n                }, 50);\n            },\n        \n            onStylesheetRemoved : function (url) {\n                // get style node created when setting new text for stylesheet.\n                var s = document.getElementById(url);\n                // remove \n                if (s && s.parentNode && s.parentNode.removeChild) {\n                    s.parentNode.removeChild(s);\n                }\n            },\n        \n            /**\n             * Send a notification for the stylesheet added and  \n             * its import-ed styleshets based on document.stylesheets diff\n             * from previous status. It also updates stylesheets status. \n             */\n            notifyStylesheetAdded : function () {\n                var added = {},\n                    current,\n                    newStatus;\n                \n                current = this.stylesheets;\n                newStatus = related().stylesheets;\n                \n                Object.keys(newStatus).forEach(function (v, i) {\n                    if (!current[v]) {\n                        added[v] = newStatus[v];\n                    }\n                });\n                              \n                Object.keys(added).forEach(function (v, i) {\n                    _transport.send(JSON.stringify({\n                        method: "StylesheetAdded",\n                        href: v,\n                        roots: [added[v]]\n                    }));\n                });\n                \n                this.stylesheets = newStatus;\n            },\n        \n            /**\n             * Send a notification for the removed stylesheet and  \n             * its import-ed styleshets based on document.stylesheets diff\n             * from previous status. It also updates stylesheets status.\n             */\n            notifyStylesheetRemoved : function () {\n                \n                var self = this;\n                var removed = {},\n                    newStatus,\n                    current;\n                \n                current = self.stylesheets;\n                newStatus = related().stylesheets;\n                \n                Object.keys(current).forEach(function (v, i) {\n                    if (!newStatus[v]) {\n                        removed[v] = current[v];\n                        // remove node created by setStylesheetText if any\n                        self.onStylesheetRemoved(current[v]);\n                    }\n                });\n                \n                Object.keys(removed).forEach(function (v, i) {\n                    _transport.send(JSON.stringify({\n                        method: "StylesheetRemoved",\n                        href: v,\n                        roots: [removed[v]]\n                    }));\n                });\n                \n                self.stylesheets = newStatus;\n            }\n        };\n\n    \n    /* process related docs added */\n    function _onNodesAdded(nodes) {\n        var i;\n        for (i = 0; i < nodes.length; i++) {\n            //check for Javascript files\n            if (Utils.isExternalScript(nodes[i])) {\n                _transport.send(JSON.stringify({\n                    method: \'ScriptAdded\',\n                    src: nodes[i].src\n                }));\n            }\n            //check for stylesheets\n            if (Utils.isExternalStylesheet(nodes[i])) {\n                CSS.checkForStylesheetLoaded(nodes[i].href);\n            }\n        }\n    }\n    /* process related docs removed */\n    function _onNodesRemoved(nodes) {\n        var i;\n        //iterate on removed nodes\n        for (i = 0; i < nodes.length; i++) {\n            \n            // check for external JS files\n            if (Utils.isExternalScript(nodes[i])) {\n                _transport.send(JSON.stringify({\n                    method: \'ScriptRemoved\',\n                    src: nodes[i].src\n                }));\n            }\n            //check for external StyleSheets\n            if (Utils.isExternalStylesheet(nodes[i])) {\n                CSS.notifyStylesheetRemoved(nodes[i].href);\n            }\n        }\n    }\n\n    function _enableListeners() {\n        // enable MutationOberver if it\'s supported\n        var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;\n        if (MutationObserver) {\n            var observer = new MutationObserver(function (mutations) {\n                mutations.forEach(function (mutation) {\n                    if (mutation.addedNodes.length > 0) {\n                        _onNodesAdded(mutation.addedNodes);\n                    }\n                    if (mutation.removedNodes.length > 0) {\n                        _onNodesRemoved(mutation.removedNodes);\n                    }\n                });\n            });\n            observer.observe(_document, {\n                childList: true,\n                subtree: true\n            });\n        } else {\n            // use MutationEvents as fallback \n            document.addEventListener(\'DOMNodeInserted\', function niLstnr(e) {\n                _onNodesAdded([e.target]);\n            });\n            document.addEventListener(\'DOMNodeRemoved\', function nrLstnr(e) {\n                _onNodesRemoved([e.target]);\n            });\n        }\n    }\n    \n    \n    /**\n     * Start listening for events and send initial related documents message.\n     * \n     * @param {HTMLDocument} document\n     * @param {object} transport Live development transport connection\n     */\n    function start(document, transport) {\n        _transport = transport;\n        _document = document;\n        // start listening to node changes\n        _enableListeners();\n        \n        var rel = related();\n        \n        // send the current status of related docs. \n        _transport.send(JSON.stringify({\n            method: "DocumentRelated",\n            related: rel\n        }));\n        // initialize stylesheets with current status for further notifications.\n        CSS.stylesheets = rel.stylesheets;\n    }\n    \n    /**\n     * Stop listening.\n     * TODO currently a no-op.\n     */\n    function stop() {\n    \n    }\n\n    var DocumentObserver = {\n        start: start,\n        stop: stop,\n        related: related\n    };\n    \n    ProtocolManager.setDocumentObserver(DocumentObserver);\n    \n}(this));'
}),define("LiveDevelopment/MultiBrowserImpl/protocol/LiveDevProtocol",["require","exports","module","utils/EventDispatcher","text!LiveDevelopment/MultiBrowserImpl/protocol/remote/LiveDevProtocolRemote.js","text!LiveDevelopment/MultiBrowserImpl/protocol/remote/DocumentObserver.js","text!LiveDevelopment/Agents/RemoteFunctions.js"],function(e,t){"use strict";function n(){return Object.keys(b)}function r(e,n){var r,i=JSON.parse(n),o=i.method||"event";i.id?(r=w[i.id],r&&(delete w[i.id],i.error?r.reject(i):r.resolve(i))):(i.clientId=e,t.trigger(o,i))}function i(e,t){var r=I++,i=new $.Deferred;return t=t||n(),e.id=r,w[r]=i,S.send(t,JSON.stringify(e)),i.promise()}function o(e,n){b[e]=!0,t.trigger("ConnectionConnect",{clientId:e,url:n})}function a(e){delete b[e],t.trigger("ConnectionClose",{clientId:e})}function s(e){S&&S.off(".livedev"),S=e,S.on("connect.livedev",function(e,t){o(t[0],t[1])}).on("message.livedev",function(e,t){r(t[0],t[1])}).on("close.livedev",function(e,t){a(t[0])}),S.start()}function l(){var e="";return e+=_,e+="window._LD=("+E+"())","<script>\n"+e+"</script>\n"}function c(){var e=S.getRemoteScript()||"",t=l()||"";return e+"<script>\n"+y+"</script>\n"+t}function u(e,t){return i({method:"Runtime.evaluate",params:{expression:e}},t)}function d(e,t){return i({method:"CSS.setStylesheetText",params:{url:e,text:t}})}function p(e,t){return i({method:"CSS.getStylesheetText",params:{url:e}},t)}function h(e,t){return i({method:"Page.reload",params:{ignoreCache:!0}},t)}function f(e,t){return i({method:"Page.navigate",params:{url:e}},t)}function m(e){S.close(e)}function g(){n().forEach(function(e){m(e)}),b={}}var v=e("utils/EventDispatcher"),y=e("text!LiveDevelopment/MultiBrowserImpl/protocol/remote/LiveDevProtocolRemote.js"),_=e("text!LiveDevelopment/MultiBrowserImpl/protocol/remote/DocumentObserver.js"),E=e("text!LiveDevelopment/Agents/RemoteFunctions.js"),b={},S=null,I=1,w={};v.makeEventDispatcher(t),t.setTransport=s,t.getRemoteScript=c,t.evaluate=u,t.setStylesheetText=d,t.getStylesheetText=p,t.reload=h,t.navigate=f,t.close=m,t.getConnectionIds=n,t.closeAllConnections=g}),define("LiveDevelopment/MultiBrowserImpl/launchers/Launcher",["require","exports","module","file/FileUtils","utils/NodeDomain"],function(e,t,n){"use strict";function r(e){u.exec("launch",e)}var i=e("file/FileUtils"),o=e("utils/NodeDomain"),a=i.getNativeBracketsDirectoryPath(),s=i.getNativeModuleDirectoryPath(n),l="node/LauncherDomain",c=[a,s,l].join("/"),u=new o("launcher",c);t.launch=r}),define("LiveDevelopment/MultiBrowserImpl/documents/LiveDocument",["require","exports","module","editor/EditorManager","utils/EventDispatcher","preferences/PreferencesManager","thirdparty/lodash"],function(e,t,n){"use strict";function r(e,t,n,r,o){this.protocol=e,this.urlResolver=t,this.doc=n,this.roots=o||[],this._onActiveEditorChange=this._onActiveEditorChange.bind(this),this._onCursorActivity=this._onCursorActivity.bind(this),this._onHighlightPrefChange=this._onHighlightPrefChange.bind(this),i.on("activeEditorChange",this._onActiveEditorChange),a.stateManager.getPreference("livedev.highlight").on("change",this._onHighlightPrefChange),$(window).focus(this._onHighlightPrefChange),r&&this._attachToEditor(r)}var i=e("editor/EditorManager"),o=e("utils/EventDispatcher"),a=e("preferences/PreferencesManager"),s=e("thirdparty/lodash"),l="live-preview-sync-error";o.makeEventDispatcher(r.prototype),r.prototype.close=function(){this._clearErrorDisplay(),this._detachFromEditor(),i.off("activeEditorChange",this._onActiveEditorChange),a.stateManager.getPreference("livedev.highlight").off("change",this._onHighlightPrefChange)},r.prototype.isLiveEditingEnabled=function(){return!1},r.prototype.setInstrumentationEnabled=function(){},r.prototype.getResponseData=function(){return{body:this.doc.getText()}},r.prototype._onHighlightPrefChange=function(){this.isHighlightEnabled()?this.updateHighlight():this.hideHighlight()},r.prototype._onActiveEditorChange=function(e,t){t&&t.document===this.doc&&this._attachToEditor(t)},r.prototype._attachToEditor=function(e){this.editor=e,this.editor&&(this.editor.on("cursorActivity",this._onCursorActivity),this.updateHighlight())},r.prototype._detachFromEditor=function(){this.editor&&(this.hideHighlight(),this.editor.off("cursorActivity",this._onCursorActivity),this.editor=null)},r.prototype._onCursorActivity=function(){this.editor&&this.updateHighlight()},r.prototype._updateErrorDisplay=function(){var e,t,n,r,i=this;this.editor&&(this.editor._codeMirror.operation(function(){i._clearErrorDisplay(),i._errorLineHandles=i._errorLineHandles||[],i.errors.forEach(function(o){for(e=o.startPos.line,t=o.endPos.line,n=e;t+1>n;n++)r=i.editor._codeMirror.addLineClass(n,"wrap",l),i._errorLineHandles.push(r)})}),this.trigger("errorStatusChanged",!!this.errors.length))},r.prototype._clearErrorDisplay=function(){var e,t=this;this.editor&&this._errorLineHandles&&this._errorLineHandles.length&&this.editor._codeMirror.operation(function(){for(;;){if(e=t._errorLineHandles.pop(),!e)break;t.editor._codeMirror.removeLineClass(e,"wrap",l)}})},r.prototype.isHighlightEnabled=function(){return a.getViewState("livedev.highlight")},r.prototype.updateHighlight=function(){},r.prototype.hideHighlight=function(e){e||(this._lastHighlight=null),this.protocol.evaluate("_LD.hideHighlight()")},r.prototype.highlightRule=function(e){this._lastHighlight!==e&&(this._lastHighlight=e,this.protocol.evaluate("_LD.highlightRule("+JSON.stringify(e)+")"))},r.prototype.highlightDomElement=function(e){var t="";Array.isArray(e)||(e=[e]),s.each(e,function(e){""!==t&&(t+=","),t+="[data-brackets-id='"+e+"']"}),this.highlightRule(t)},r.prototype.redrawHighlights=function(){this.isHighlightEnabled()&&this.protocol.evaluate("_LD.redrawHighlights()")},n.exports=r}),define("LiveDevelopment/MultiBrowserImpl/documents/LiveCSSDocument",["require","exports","module","thirdparty/lodash","language/CSSUtils","utils/EventDispatcher","LiveDevelopment/MultiBrowserImpl/documents/LiveDocument"],function(e,t,n){"use strict";var r=e("thirdparty/lodash"),i=e("language/CSSUtils"),o=e("utils/EventDispatcher"),a=e("LiveDevelopment/MultiBrowserImpl/documents/LiveDocument"),s=function(){a.apply(this,arguments),this.doc.addRef(),this.onChange=this.onChange.bind(this),this.onDeleted=this.onDeleted.bind(this),this.doc.on("change.LiveCSSDocument",this.onChange),this.doc.on("deleted.LiveCSSDocument",this.onDeleted)};s.prototype=Object.create(a.prototype),s.prototype.constructor=s,s.prototype.parentClass=a.prototype,o.makeEventDispatcher(s.prototype),s.prototype.close=function(){this.doc.off(".LiveCSSDocument"),this.doc.releaseRef(),this.parentClass.close.call(this)},s.prototype._updateBrowser=function(){var e;for(e=0;e<this.roots.length;e++)this.doc.url!==this.roots[e].toString()?this.trigger("updateDoc",this.roots[e]):this.protocol.setStylesheetText(this.doc.url,this.doc.getText());this.redrawHighlights()},s.prototype.updateHighlight=function(){if(this.isHighlightEnabled()&&this.editor){var e=this.editor,t=[];r.each(this.editor.getSelections(),function(n){var r=i.findSelectorAtDocumentPos(e,n.reversed?n.end:n.start);r&&t.push(r)}),t.length?this.highlightRule(t.join(",")):this.hideHighlight()}},s.prototype.isLiveEditingEnabled=function(){return!0},s.prototype.onChange=function(){this._updateBrowser()},s.prototype.onDeleted=function(){this.close(),this.trigger("deleted",[this])},s.prototype.getSourceFromBrowser=function(){var e=new $.Deferred;return this.protocol.getStylesheetText(this.doc.url).then(function(t){e.resolve(t.text)},e.reject),e.promise()},n.exports=s}),define("LiveDevelopment/MultiBrowserImpl/language/HTMLSimpleDOM",["require","exports","module","language/HTMLTokenizer","thirdparty/murmurhash3_gc","utils/PerfUtils"],function(e,t){"use strict";function n(e){$.extend(this,e)}function r(e){var t=e.parent.children.indexOf(e);return 0===t?e.parent.tagID+".0":e.parent.children[t-1].tagID+"t"}function i(e,t){return{line:e.line+t.line,ch:0===t.line?e.ch+t.ch:t.ch}}function o(e,t){return{line:e.line,ch:e.ch+t}}function a(e,t,n){this.stack=[],this.text=e,this.t=new c(e),this.currentTag=null,this.startOffset=t||0,this.startOffsetPos=n||{line:0,ch:0}}function s(e,t){var n=new a(e);return n.build(t)}function l(e){function t(e){n+=e.tag?r+"TAG "+e.tagID+" "+e.tag+" "+JSON.stringify(e.attributes)+"\n":r+"TEXT "+(e.tagID||"- ")+e.content+"\n",e.isElement()&&(r+="  ",e.children.forEach(t),r=r.slice(2))}var n="",r="";return t(e),n}var c=e("language/HTMLTokenizer").Tokenizer,u=e("thirdparty/murmurhash3_gc"),d=e("utils/PerfUtils"),p=Math.floor(65535*Math.random()),h=1,f={li:{li:!0},dt:{dd:!0,dt:!0},dd:{dd:!0,dt:!0},address:{p:!0},article:{p:!0},aside:{p:!0},blockquote:{p:!0},dir:{p:!0},div:{p:!0},dl:{p:!0},fieldset:{p:!0},footer:{p:!0},form:{p:!0},h1:{p:!0},h2:{p:!0},h3:{p:!0},h4:{p:!0},h5:{p:!0},h6:{p:!0},header:{p:!0},hgroup:{p:!0},hr:{p:!0},main:{p:!0},menu:{p:!0},nav:{p:!0},ol:{p:!0},p:{p:!0},pre:{p:!0},section:{p:!0},table:{p:!0},ul:{p:!0},rt:{rp:!0,rt:!0},rp:{rp:!0,rt:!0},optgroup:{optgroup:!0,option:!0},option:{option:!0},tbody:{thead:!0,tbody:!0,tfoot:!0},tfoot:{tbody:!0},tr:{tr:!0,th:!0,td:!0},th:{th:!0,td:!0},td:{thead:!0,th:!0,td:!0},body:{head:!0,link:!0,script:!0}},m={area:!0,base:!0,basefont:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,isindex:!0,keygen:!0,link:!0,menuitem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};n.prototype={update:function(){if(this.isElement()){var e,t,n="",r="";for(e=0;e<this.children.length;e++)t=this.children[e],t.isElement()?(r+=String(t.tagID),n+=String(t.tagID)+t.attributeSignature+t.subtreeSignature):(r+=t.textSignature,n+=t.textSignature);this.childSignature=u.hashString(r,r.length,p),this.subtreeSignature=u.hashString(n,n.length,p)}else this.textSignature=u.hashString(this.content,this.content.length,p)},updateAttributeSignature:function(){var e=JSON.stringify(this.attributes);this.attributeSignature=u.hashString(e,e.length,p)},isElement:function(){return!!this.children},isText:function(){return!this.children}},a.prototype._logError=function(e){var t={token:e},n=e?e.startPos||e.endPos:this.startOffsetPos,r=e?e.endPos:this.startOffsetPos;t.startPos=i(this.startOffsetPos,n),t.endPos=i(this.startOffsetPos,r),this.errors||(this.errors=[]),this.errors.push(t)},a.prototype.build=function(e,t){function a(e,t){l=h[h.length-1],h.pop(),l.update(),l.end=u.startOffset+e,l.endPos=i(u.startOffsetPos,t)}var s,l,c,u=this,p=0,h=this.stack,g=null,v={};t=t||{};var y="HTMLInstr. Build DOM Full",_="HTMLInstr. Build DOM Partial";for(d.markStart([y,_]);null!==(s=this.t.nextToken());){if("text"!==s.type&&"comment"!==s.type&&c&&(c=null),"error"===s.type)return d.finalizeMeasurement(y),d.addMeasurement(_),this._logError(s),null;if("opentagname"===s.type){var E,b=s.contents.toLowerCase();if(f.hasOwnProperty(b))for(var S=f[b];h.length>0&&S.hasOwnProperty(h[h.length-1].tag);)a(s.start-1,o(s.startPos,-1));E=new n({tag:s.contents.toLowerCase(),children:[],attributes:{},parent:h.length?h[h.length-1]:null,start:this.startOffset+s.start-1,startPos:i(this.startOffsetPos,o(s.startPos,-1))}),E.tagID=this.getID(E,t),v[E.tagID]&&(E.tagID=this.getNewID()),v[E.tagID]=E,E.parent&&E.parent.children.push(E),this.currentTag=E,m.hasOwnProperty(E.tag)?E.update():h.push(E)}else if("opentagend"===s.type||"selfclosingtag"===s.type)this.currentTag&&("selfclosingtag"===s.type&&h.length&&h[h.length-1]===this.currentTag?a(s.end,s.endPos):(this.currentTag.openEnd=this.currentTag.end=this.startOffset+s.end,this.currentTag.endPos=i(this.startOffsetPos,s.endPos),l=this.currentTag,this.currentTag.updateAttributeSignature(),this.currentTag=null));else if("closetag"===s.type){var I=s.contents.toLowerCase();if(!m.hasOwnProperty(I)){var w;for(w=h.length-1;w>=0&&h[w].tag!==I;w--);if(e&&w!==h.length-1)return d.finalizeMeasurement(y),d.addMeasurement(_),this._logError(s),null;if(w>=0){do h.length===w+1?a(s.end+1,o(s.endPos,1)):a(s.start-2,o(s.startPos,-2));while(h.length>w)}else if(e)return d.finalizeMeasurement(y),d.addMeasurement(_),this._logError(s),null}}else if("attribname"===s.type)g=s.contents.toLowerCase(),this.currentTag.attributes[g]="";else if("attribvalue"===s.type&&null!==g)this.currentTag.attributes[g]=s.contents,g=null;else if("text"===s.type&&h.length){var C,D=h[h.length-1];c?(C=c,C.content+=s.contents):(C=new n({parent:h[h.length-1],content:s.contents}),D.children.push(C),C.tagID=r(C),v[C.tagID]=C,c=C),C.update()}p=s.end}if(h.length){if(e)return d.finalizeMeasurement(y),d.addMeasurement(_),this._logError(s),null;for(var T=this.text.split("\n"),O={line:T.length-1,ch:T[T.length-1].length};h.length;)a(this.text.length,O)}var M=l;return M?(M.nodeMap=v,d.addMeasurement(y),d.finalizeMeasurement(_),M):(this._logError(s),null)},a.prototype.getNewID=function(){return h++},a.prototype.getID=a.prototype.getNewID,t.build=s,t.Builder=a,t.SimpleNode=n,t._dumpDOM=l,t._offsetPos=o,t._getTextNodeID=r,t._seed=p}),define("LiveDevelopment/MultiBrowserImpl/language/HTMLInstrumentation",["require","exports","module","document/DocumentManager","language/HTMLDOMDiff","LiveDevelopment/MultiBrowserImpl/language/HTMLSimpleDOM"],function(e,t){"use strict";function n(e,t){I.hasOwnProperty(t.file.fullPath)&&(delete I[t.file.fullPath],t.off(".htmlInstrumentation"))}function r(e,t){return e&&t&&e.line===t.line&&e.ch===t.ch}function i(e,t){return e=e.filter(function(e){return!!e.tagID}).map(function(e){return t[e.tagID]||(t[e.tagID]={mark:e,range:e.find()}),t[e.tagID]}),e.sort(function(e,t){return e.range.from.line===t.range.from.line?e.range.from.ch-t.range.from.ch:e.range.from.line-t.range.from.line}),e}function o(e,t,n,o){var a,s;return o=o||{},a=i(e._codeMirror.findMarksAt(t),o),a.length?(s=a[a.length-1],n&&(r(s.range.from,t)||r(s.range.to,t))&&(s=a.length>1?a[a.length-2]:null),s.mark):null}function a(e,t,n){var r=o(e,t,!1,n);return r?r.tagID:-1}function s(e,t){t.children.forEach(function(t){t.isElement()&&s(e,t)});var n=e.markText(t.startPos,t.endPos);n.tagID=t.tagID}function l(e,t){var n=e._codeMirror,r=n.getAllMarks();n.operation(function(){r.forEach(function(e){e.hasOwnProperty("tagID")&&e.clear()})}),s(n,t)}function c(e,t,n){function r(e){return/[<>\/=\"\']/.test(e)}var i,a,s=0;if(this.isIncremental=!1,n&&1===n.length){var l=n[0];if(!r(l.text)&&!r(l.removed)){var c=o(t,l.from,!0);if(c){var u=c.find();u&&(i=t._codeMirror.getRange(u.from,u.to),this.changedTagID=c.tagID,a=u.from,s=t._codeMirror.indexFromPos(a),this.isIncremental=!0)}}}this.changedTagID||(i=t.document.getText()),b.Builder.call(this,i,s,a),this.editor=t,this.cm=t._codeMirror,this.previousDOM=e}function u(e,t){for(var n=e.parent;n&&n.tagID!==t;)n=n.parent;return!!n}function d(e,t,n){S||(n=void 0);var r=new c(e,t,n),i=r.update();if(!i)return{errors:r.errors};var o=E.domdiff(i.oldSubtree,i.newSubtree);return i.newSubtree!==i.newDOM&&delete i.newSubtree.nodeMap,{dom:i.newDOM,edits:o,_wasIncremental:r.isIncremental}}function p(e,t){var n=I[e.document.file.fullPath];n&&n.dom&&!I[e.document.file.fullPath].invalid||(t=null);var r=d(n&&n.dom,e,t);return r.errors?(n&&(n.invalid=!0),{errors:r.errors}):(I[e.document.file.fullPath]={timestamp:e.document.diskTimestamp,dom:r.dom,dirty:!1},r.dom.fullBuild=!1,{edits:r.edits})}function h(e,t){function n(e){e.tagID=e.attributes["data-brackets-id"],delete e.attributes["data-brackets-id"],e.children.forEach(function(t){t.parent=e,t.isElement()?n(t):t.isText()&&(t.update(),t.tagID=b.getTextNodeID(t),i[t.tagID]=t)}),e.update(),i[e.tagID]=e,e.tagID===t&&(r=e)}var r,i={};return n(e),r=r||e,r.nodeMap=i,r}function f(e,t){var n,r=I[e.document.file.fullPath],i=r.dom;return n=h(t,i.tagID),{diff:E.domdiff(i,n),browser:n,editor:i}}function m(e){I.hasOwnProperty(e.file.fullPath)||(I[e.file.fullPath]=null);var t=I[e.file.fullPath];if(t&&!t.invalid&&t.timestamp===e.diskTimestamp)return t.dom;var n=e.getText(),r=b.build(n);return r&&(I[e.file.fullPath]={timestamp:e.diskTimestamp,dom:r,dirty:!1},r.fullBuild=!0),r}function g(e,t){function n(i){if(i.tag){var l,u=" data-brackets-id='"+i.tagID+"'";if(o.fullBuild)l=i.start;else{var d=r[i.tagID];d?l=e._codeMirror.indexFromPos(d.range.from):(console.warn("generateInstrumentedHTML(): couldn't find existing mark for tagID "+i.tagID),l=i.start)}var p=l+i.tag.length+1;s+=a.substr(c,p-c)+u,c=p,t&&"head"===i.tag&&(p=i.openEnd,s+=a.substr(c,p-c)+t,c=p)}i.isElement()&&i.children.forEach(n)}var r,i=e.document,o=m(i),a=i.getText(),s="",c=0;return o?(o.fullBuild?l(e,o):(r={},e._codeMirror.getAllMarks().forEach(function(e){e.tagID&&(r[e.tagID]={mark:e,range:e.find()})})),n(o),s+=a.substr(c)):null}function v(e){var t=I[e.document.file.fullPath],n=t&&t.dom;return n?n.fullBuild?void l(e,n):void console.error("Tried to mark text from a stale DOM for "+e.document.file.fullPath):void console.error("Couldn't find the dom for "+e.document.file.fullPath)}function y(){I={}}var _=e("document/DocumentManager"),E=e("language/HTMLDOMDiff"),b=e("LiveDevelopment/MultiBrowserImpl/language/HTMLSimpleDOM"),S=!0,I={};c.prototype=Object.create(b.Builder.prototype),c.prototype.getID=function(e,t){var n=a(this.editor,b._offsetPos(e.startPos,1),t);if(-1===n||u(e,n))n=this.getNewID();else{var r=this.previousDOM.nodeMap[n];r&&r.tag===e.tag||(n=this.getNewID())}return n},c.prototype._updateMarkedRanges=function(e,t){var n=Object.keys(e),i=this.cm,o=i.getAllMarks();i.operation(function(){o.forEach(function(o){if(o.hasOwnProperty("tagID")&&e[o.tagID]){var a=e[o.tagID],s=t[o.tagID];s&&r(s.range.from,a.startPos)&&r(s.range.to,a.endPos)||(o.clear(),o=i.markText(a.startPos,a.endPos),o.tagID=a.tagID),n.splice(n.indexOf(String(a.tagID)),1)}}),n.forEach(function(t){var n,r=e[t];r.isElement()&&(n=i.markText(r.startPos,r.endPos),n.tagID=Number(t))})})},c.prototype._buildNodeMap=function(e){function t(e){e.tagID&&(n[e.tagID]=e),e.isElement()&&e.children.forEach(t)}var n={};t(e),e.nodeMap=n},c.prototype._handleDeletions=function(e,t,n){var r=[];if(Object.keys(t).forEach(function(t){n.hasOwnProperty(t)||(r.push(t),delete e[t])}),r.length){var i=this.cm.getAllMarks();i.forEach(function(e){e.hasOwnProperty("tagID")&&-1!==r.indexOf(e.tagID)&&e.clear()})}},c.prototype.update=function(){var e={},t=this.build(!0,e),n={newDOM:t,oldSubtree:this.previousDOM,newSubtree:t};if(!t)return null;if(this.changedTagID){var r=this.previousDOM.nodeMap[this.changedTagID],i=r.parent;if(i){var o=i.children.indexOf(r);if(-1===o)console.error("DOMUpdater.update(): couldn't locate old subtree in tree");else{r.parent=null,t.parent=i,i.children[o]=t,$.extend(this.previousDOM.nodeMap,t.nodeMap),this._updateMarkedRanges(t.nodeMap,e),this._buildNodeMap(r),this._handleDeletions(this.previousDOM.nodeMap,r.nodeMap,t.nodeMap);for(var a=i;a;)a.update(),a=a.parent;n.newDOM=this.previousDOM,n.oldSubtree=r}}}else l(this.editor,n.newDOM);return n},_.on("beforeDocumentDelete",n),t._markText=v,t._getMarkerAtDocumentPos=o,t._getTagIDAtDocumentPos=a,t._markTextFromDOM=l,t._updateDOM=d,t._allowIncremental=S,t._getBrowserDiff=f,t._resetCache=y,t.scanDocument=m,t.generateInstrumentedHTML=g,t.getUnappliedEditList=p}),define("LiveDevelopment/MultiBrowserImpl/documents/LiveHTMLDocument",["require","exports","module","utils/EventDispatcher","utils/PerfUtils","thirdparty/lodash","LiveDevelopment/MultiBrowserImpl/documents/LiveDocument","LiveDevelopment/MultiBrowserImpl/language/HTMLInstrumentation"],function(e,t,n){"use strict";function r(){s.apply(this,arguments),this._instrumentationEnabled=!1,this._relatedDocuments={stylesheets:{},scripts:{}},this._onChange=this._onChange.bind(this),this.doc.on("change",this._onChange),this._onRelated=this._onRelated.bind(this),this.protocol.on("DocumentRelated",this._onRelated),this._onStylesheetAdded=this._onStylesheetAdded.bind(this),this.protocol.on("StylesheetAdded",this._onStylesheetAdded),this._onStylesheetRemoved=this._onStylesheetRemoved.bind(this),this.protocol.on("StylesheetRemoved",this._onStylesheetRemoved),this._onScriptAdded=this._onScriptAdded.bind(this),this.protocol.on("ScriptAdded",this._onScriptAdded),this._onScriptRemoved=this._onScriptRemoved.bind(this),this.protocol.on("ScriptRemoved",this._onScriptRemoved)}var i=e("utils/EventDispatcher"),o=e("utils/PerfUtils"),a=e("thirdparty/lodash"),s=e("LiveDevelopment/MultiBrowserImpl/documents/LiveDocument"),l=e("LiveDevelopment/MultiBrowserImpl/language/HTMLInstrumentation");r.prototype=Object.create(s.prototype),r.prototype.constructor=r,r.prototype.parentClass=s.prototype,i.makeEventDispatcher(r.prototype),r.prototype.isLiveEditingEnabled=function(){return this._instrumentationEnabled},r.prototype.setInstrumentationEnabled=function(e){this.editor&&(e&&!this._instrumentationEnabled&&(l.scanDocument(this.doc),l._markText(this.editor)),this._instrumentationEnabled=e)},r.prototype.getResponseData=function(){var e;return this._instrumentationEnabled&&(e=l.generateInstrumentedHTML(this.editor,this.protocol.getRemoteScript())),{body:e||this.doc.getText()}},r.prototype.close=function(){this.doc.off("change",this._onChange),this.parentClass.close.call(this)},r.prototype.updateHighlight=function(){if(this.editor&&this.isHighlightEnabled()){var e=this.editor,t=[];a.each(this.editor.getSelections(),function(n){var r=l._getTagIDAtDocumentPos(e,n.reversed?n.end:n.start);-1!==r&&t.push(r)}),t.length?this.highlightDomElement(t):this.hideHighlight()}},r.prototype._compareWithBrowser=function(){},r.prototype._onChange=function(e,t,n){if(this._instrumentationEnabled){var r="LiveHTMLDocument applyDOMEdits",i=o.isActive(r);i||o.markStart(r);var a,s=this,c=l.getUnappliedEditList(this.editor,n);c.edits&&(a=this.protocol.evaluate("_LD.applyDOMEdits("+JSON.stringify(c.edits)+")"),a.always(function(){i||o.addMeasurement(r)})),this.errors=c.errors||[],this._updateErrorDisplay(),this._debug&&(console.log("Edits applied to browser were:"),console.log(JSON.stringify(c.edits,null,2)),a.done(function(){s._compareWithBrowser(n)}))}},r.prototype._onRelated=function(e,t){this._relatedDocuments=t.related},r.prototype._onStylesheetAdded=function(e,t){this._relatedDocuments.stylesheets[t.href]=!0},r.prototype._onStylesheetRemoved=function(e,t){delete this._relatedDocuments.stylesheets[t.href]},r.prototype._onScriptAdded=function(e,t){this._relatedDocuments.scripts[t.src]=!0},r.prototype._onScriptRemoved=function(e,t){delete this._relatedDocuments.scripts[t.src]},r.prototype.isRelated=function(e){return this._relatedDocuments.scripts[this.urlResolver(e)]||this._relatedDocuments.stylesheets[this.urlResolver(e)]},r.prototype.getRelated=function(){return this._relatedDocuments},n.exports=r}),define("LiveDevelopment/LiveDevMultiBrowser",["require","exports","module","command/CommandManager","command/Commands","widgets/Dialogs","widgets/DefaultDialogs","document/DocumentManager","editor/EditorManager","utils/EventDispatcher","file/FileUtils","view/MainViewManager","preferences/PreferencesDialogs","project/ProjectManager","strings","thirdparty/lodash","LiveDevelopment/LiveDevelopmentUtils","LiveDevelopment/LiveDevServerManager","LiveDevelopment/MultiBrowserImpl/transports/NodeSocketTransport","LiveDevelopment/MultiBrowserImpl/protocol/LiveDevProtocol","LiveDevelopment/MultiBrowserImpl/launchers/Launcher","LiveDevelopment/MultiBrowserImpl/documents/LiveCSSDocument","LiveDevelopment/MultiBrowserImpl/documents/LiveHTMLDocument"],function(e,t){"use strict";function n(e){return"css"===e.getLanguage().getId()?ft:ct.isHtmlFileExt(e.file.fullPath)?mt:null}function r(){return t.status>H}function i(e){return B?B.get(e):null}function o(e){e.off(".livedev"),e.close()}function a(e){var t=gt[e];t&&delete gt[e],B&&B.remove(t),o(t)}function s(e,n){if(e!==t.status){t.status=e;var r=e===H?n:null;t.trigger("statusChange",e,r)}}function l(){j&&(o(j),j=void 0),Object.keys(gt).forEach(function(e){o(gt[e]),delete gt[e]}),B&&B.clear()}function c(e){return B&&B.pathToUrl(e)}function u(e,t,i){var o,a=n(e);return a?(o=new a(vt,c,e,t,i),o.on("errorStatusChanged.livedev",function(e,t){r()&&s(t?q:G)}),o):null}function d(e){var t=B&&B.get(e.file.fullPath),n=t&&t.isLiveEditingEnabled();return e.isDirty&&!n}function p(e,t,r){var o=B&&B.urlToPath(t),a=!!gt[t];if(o&&!a){var s=et.getDocumentForPath(o);s.done(function(e){if(n(e)===ft&&(!j||e!==j.doc)){var t=u(e,null,r);t&&(B.add(t),gt[e.url]=t,t.on("updateDoc",function(e,t){var n=B.urlToPath(t),r=i(n);r._updateBrowser()}))}})}}function h(){var e,t,n=et.getCurrentDocument();if(n&&(e=n.file.fullPath,ct.isStaticHtmlFileExt(e)||ct.isServerHtmlFileExt(e)))return(new $.Deferred).resolve(n);var r=new $.Deferred,i=at.getBaseUrl(),o=i&&i.length;return at.getAllFiles().done(function(n){var i,a=at.getProjectRoot().fullPath,s=!1,l=!0;i=e?rt.getDirectoryPath(e):a;for(var c=n.filter(function(e){var t=rt.getParentPath(e.fullPath);return 0===i.indexOf(t)}),u=function(e){if(0===e.fullPath.indexOf(i)){if("index"!==rt.getFilenameWithoutExtension(e.name))return!1;if(o){if(ct.isServerHtmlFileExt(e.name)||ct.isStaticHtmlFileExt(e.name))return!0}else if(ct.isStaticHtmlFileExt(e.name))return!0}};!s&&l;)t=lt.findIndex(c,u),-1===t?(i=rt.getParentPath(i),-1===i.indexOf(a)&&(l=!1)):s=!0;return-1!==t?void et.getDocumentForPath(c[t].fullPath).then(r.resolve,r.resolve):void r.resolve(null)}),r.promise()}function f(e,n){t.status!==H&&(l(),vt.closeAllConnections(),B&&(B.stop(),B=null)),s(H,n||"explicit_close")}function m(){return f(!0),(new $.Deferred).resolve().promise()}function g(){J.showModalDialog(Z.DIALOG_ID_ERROR,st.LIVE_DEVELOPMENT_ERROR_TITLE,st.LIVE_DEV_NEED_HTML_MESSAGE)}function v(){J.showModalDialog(Z.DIALOG_ID_ERROR,st.LIVE_DEVELOPMENT_ERROR_TITLE,st.LIVE_DEV_SERVER_NOT_READY_MESSAGE)}function y(e){e._ensureMasterEditor(),j=u(e,e._masterEditor),B.add(j)}function _(e){V.launch(e)}function E(e){e&&j&&e===j.doc?B?(t.status<G&&_(B.pathToUrl(e.file.fullPath)),t.status===Y&&vt.navigate(B.pathToUrl(e.file.fullPath)),vt.on("ConnectionConnect.livedev",function(e,t){1===vt.getConnectionIds().length&&j&&t.url===c(j.doc.file.fullPath)&&s(G)}).on("ConnectionClose.livedev",function(){0===vt.getConnectionIds().length&&t.status<=G&&f(!1,"detached_target_closed")}).on("DocumentRelated.livedev",function(e,t){var n=t.related,r=Object.keys(n.stylesheets);r.forEach(function(e){p(null,e,n.stylesheets[e])})}).on("StylesheetAdded.livedev",function(e,t){p(null,t.href,t.roots)}).on("StylesheetRemoved.livedev",function(e,t){a(t.href)})):console.error("LiveDevelopment._open(): No server active"):m()}function b(e){y(e),B.start(),E(e)}function S(e){var t=new $.Deferred,n=!1;if(B=ut.getServer(e.file.fullPath),n=!B&&ct.isServerHtmlFileExt(e.file.fullPath))ot.showProjectPreferencesDialog("",st.LIVE_DEV_NEED_BASEURL_MESSAGE).done(function(n){n===J.DIALOG_BTN_OK&&at.getBaseUrl()?S(e).then(t.resolve,t.reject):t.reject()});else if(B){var r=B.readyToServe();r?r.then(t.resolve,function(){v(),t.reject()}):(v(),t.reject())}else t.reject();return t.promise()}function I(){var e=et.getCurrentDocument();if(r()&&e){var t=B&&B.pathToUrl(e.file.fullPath),n=B&&B.canServe(e.file.fullPath);j.doc.url!==t&&n&&(l(),y(e),s(Y),E(e))}}function w(){h().done(function(e){var t,n=e&&S(e)||(new $.Deferred).reject();e&&!e._masterEditor&&(t=it.getWorkingSetSize(it.ALL_PANES),it.addToWorkingSet(it.ACTIVE_PANE,e.file),t||X.execute(Q.CMD_OPEN,{fullPath:e.file.fullPath})),n.done(function(){s(W),b(e)}).fail(function(){g()})})}function C(e,t){if(r()&&B){var n=t.file.fullPath,i=n&&B.get(n),o=i&&i.isLiveEditingEnabled&&i.isLiveEditingEnabled();o||j.isRelated(n)&&"javascript"===t.getLanguage().getId()&&(s(z),vt.reload())}}function D(e,t){if(r()&&B){var n=t.file.fullPath;j.isRelated(n)&&s(d(t)?K:G)}}function T(e){vt.setTransport(e)}function O(e){return e&&e.launch?void(V=e):void console.log("Invalid launcher object: ",e,new Error("LiveDevMultiBrowser.setLauncher()"))}function M(){it.on("currentFileChange",I),et.on("documentSaved",C).on("dirtyFlagChange",D),at.on("beforeProjectClose beforeAppClose",m),T(dt),O(ht),s(H)}function L(e){return e?i(e.document.file.fullPath):null}function R(){var e=L(tt.getActiveEditor());e&&e.updateHighlight&&e.updateHighlight()}function N(){vt&&vt.evaluate("_LD.hideHighlight()")}function x(){vt&&vt.evaluate("_LD.redrawHighlights()")}function A(){return $.Deferred().resolve()}function P(){vt&&vt.reload()}function k(){return{baseUrl:at.getBaseUrl(),pathResolver:at.makeProjectRelativeIfPossible,root:at.getProjectRoot().fullPath}}function F(){return B&&B.getBaseUrl()}function U(){return j}var j,V,B,H=t.STATUS_INACTIVE=0,W=t.STATUS_CONNECTING=1,G=t.STATUS_ACTIVE=2,K=t.STATUS_OUT_OF_SYNC=3,q=t.STATUS_SYNC_ERROR=4,z=t.STATUS_RELOADING=5,Y=t.STATUS_RESTARTING=6,X=e("command/CommandManager"),Q=e("command/Commands"),J=e("widgets/Dialogs"),Z=e("widgets/DefaultDialogs"),et=e("document/DocumentManager"),tt=e("editor/EditorManager"),nt=e("utils/EventDispatcher"),rt=e("file/FileUtils"),it=e("view/MainViewManager"),ot=e("preferences/PreferencesDialogs"),at=e("project/ProjectManager"),st=e("strings"),lt=e("thirdparty/lodash"),ct=e("LiveDevelopment/LiveDevelopmentUtils"),ut=e("LiveDevelopment/LiveDevServerManager"),dt=e("LiveDevelopment/MultiBrowserImpl/transports/NodeSocketTransport"),pt=e("LiveDevelopment/MultiBrowserImpl/protocol/LiveDevProtocol"),ht=e("LiveDevelopment/MultiBrowserImpl/launchers/Launcher"),ft=e("LiveDevelopment/MultiBrowserImpl/documents/LiveCSSDocument"),mt=e("LiveDevelopment/MultiBrowserImpl/documents/LiveHTMLDocument"),gt={},vt=pt;nt.makeEventDispatcher(t),t._server=B,t._getCurrentLiveDoc=U,t._getInitialDocFromCurrent=h,t.open=w,t.close=m,t.reconnect=A,t.reload=P,t.getLiveDocForPath=i,t.showHighlight=R,t.hideHighlight=N,t.redrawHighlight=x,t.init=M,t.isActive=r,t.getServerBaseUrl=F,t.getCurrentProjectServerConfig=k,t.setTransport=T,t.setLauncher=O}),define("text!LiveDevelopment/main.less",[],function(){return'/*\n * Copyright (c) 2012 Adobe Systems Incorporated. All rights reserved.\n *  \n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the "Software"), \n * to deal in the Software without restriction, including without limitation \n * the rights to use, copy, modify, merge, publish, distribute, sublicense, \n * and/or sell copies of the Software, and to permit persons to whom the \n * Software is furnished to do so, subject to the following conditions:\n *  \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *  \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER \n * DEALINGS IN THE SOFTWARE.\n * \n */\n\n\n.CodeMirror {\n    .highlight {\n        background: #ecc;\n    }\n    .flash {\n       -webkit-animation: flash 1s;\n    }\n}\n  \n@-webkit-keyframes flash {\n    from {\n        background: #ecc;\n    }\n    to {\n        background: inherit;\n    }\n}'}),define("LiveDevelopment/main",["require","exports","module","document/DocumentManager","command/Commands","utils/AppInit","LiveDevelopment/LiveDevelopment","LiveDevelopment/LiveDevMultiBrowser","LiveDevelopment/Inspector/Inspector","command/CommandManager","preferences/PreferencesManager","widgets/Dialogs","widgets/DefaultDialogs","utils/UrlParams","strings","utils/ExtensionUtils","utils/StringUtils","text!LiveDevelopment/main.less"],function(e,t,n){"use strict";function r(e,t){var n,r=!!F.get(e);return n=void 0===t?!r:!!t,n!==r&&F.set(e,n),n}function i(e){var t=r(k,e);C.get(E.TOGGLE_LIVE_PREVIEW_MB_MODE).setChecked(t),C.get(E.FILE_PROJECT_SETTINGS).setEnabled(!t)}function o(){var t=e("text!LiveDevelopment/main.less"),n=new less.Parser;n.parse(t,function(e,t){console.assert(!e,e),R.addEmbeddedStyleSheet(t.toCSS())
})}function a(e,t,n,r){$("span",e).remove(),e.removeClass(P),t&&t.length>0?$('<span class="label">').addClass(n).text(t).appendTo(e):e.addClass(n),r&&e.attr("title",r)}function s(){y.status>=y.STATUS_ACTIVE?y.close():y.status<=y.STATUS_INACTIVE&&(x.get("skipLiveDevelopmentInfo")||D.getViewState("livedev.afterFirstLaunch")?y.open():(D.setViewState("livedev.afterFirstLaunch","true"),T.showModalDialog(O.DIALOG_ID_INFO,L.LIVE_DEVELOPMENT_INFO_TITLE,L.LIVE_DEVELOPMENT_INFO_MESSAGE).done(function(){y.open()})))}function l(e){if(v.twipsy("hide").removeData("twipsy"),e&&"explicit_close"!==e){var t=L["LIVE_DEV_"+e.toUpperCase()];t||(t=N.format(L.LIVE_DEV_CLOSED_UNKNOWN_REASON,e));var n={placement:"left",trigger:"manual",autoHideDelay:5e3,title:function(){return t}};v.twipsy(n).twipsy("show")}}function c(){v||(v=$("#toolbar-go-live"),v.click(function(){s()})),y.on("statusChange",function(e,t,n){a(v,null,g[t+1].style,g[t+1].tooltip),l(n),A.autoconnect&&window.sessionStorage.setItem("live.enabled",3===t)}),a(v,null,g[1].style,g[1].tooltip)}function u(){y.on("statusChange",function(e,t){C.get(E.FILE_LIVE_FILE_PREVIEW).setChecked(t===y.STATUS_ACTIVE),C.get(E.FILE_LIVE_HIGHLIGHT).setEnabled(t===y.STATUS_ACTIVE)})}function d(){C.get(E.FILE_LIVE_HIGHLIGHT).setChecked(A.highlight)}function p(){A.highlight=!A.highlight,d(),A.highlight?y.showHighlight():y.hideHighlight(),D.setViewState("livedev.highlight",A.highlight)}function h(e){e?(y=I,g=[{tooltip:L.LIVE_DEV_STATUS_TIP_NOT_CONNECTED,style:"warning"},{tooltip:L.LIVE_DEV_STATUS_TIP_NOT_CONNECTED,style:""},{tooltip:L.LIVE_DEV_STATUS_TIP_PROGRESS1,style:"info"},{tooltip:L.LIVE_DEV_STATUS_TIP_CONNECTED,style:"success"},{tooltip:L.LIVE_DEV_STATUS_TIP_OUT_OF_SYNC,style:"out-of-sync"},{tooltip:L.LIVE_DEV_STATUS_TIP_SYNC_ERROR,style:"sync-error"},{tooltip:L.LIVE_DEV_STATUS_TIP_PROGRESS1,style:"info"},{tooltip:L.LIVE_DEV_STATUS_TIP_PROGRESS1,style:"info"}]):(y=S,g=[{tooltip:L.LIVE_DEV_STATUS_TIP_NOT_CONNECTED,style:"warning"},{tooltip:L.LIVE_DEV_STATUS_TIP_NOT_CONNECTED,style:""},{tooltip:L.LIVE_DEV_STATUS_TIP_PROGRESS1,style:"info"},{tooltip:L.LIVE_DEV_STATUS_TIP_PROGRESS2,style:"info"},{tooltip:L.LIVE_DEV_STATUS_TIP_CONNECTED,style:"success"},{tooltip:L.LIVE_DEV_STATUS_TIP_OUT_OF_SYNC,style:"out-of-sync"},{tooltip:L.LIVE_DEV_STATUS_TIP_SYNC_ERROR,style:"sync-error"}]),c(),u(),i(e)}function f(){window.ld=S,window.i=w,window.report=function(e){window.params=e,console.info(e)}}function m(){S.status>=S.STATUS_ACTIVE&&S.reload()}var g,v,y,_=e("document/DocumentManager"),E=e("command/Commands"),b=e("utils/AppInit"),S=e("LiveDevelopment/LiveDevelopment"),I=e("LiveDevelopment/LiveDevMultiBrowser"),w=e("LiveDevelopment/Inspector/Inspector"),C=e("command/CommandManager"),D=e("preferences/PreferencesManager"),T=e("widgets/Dialogs"),O=e("widgets/DefaultDialogs"),M=e("utils/UrlParams").UrlParams,L=e("strings"),R=e("utils/ExtensionUtils"),N=e("utils/StringUtils"),x=new M,A={experimental:!1,debug:!0,autoconnect:!1,highlight:!0,highlightConfig:{borderColor:{r:255,g:229,b:153,a:.66},contentColor:{r:111,g:168,b:220,a:.55},marginColor:{r:246,g:178,b:107,a:.66},paddingColor:{r:147,g:196,b:125,a:.66},showInfo:!0}},P=["warning","info","success","out-of-sync","sync-error"].join(" "),k="multibrowser",F=D.getExtensionPrefs("livedev"),U=F.definePreference(k,"boolean",!1);b.appReady(function(){x.parse(),w.init(A),S.init(A),I.init(A),o(),d(),h(F.get(k)),A.debug&&f(),A.autoconnect&&"true"===window.sessionStorage.getItem("live.enabled")&&_.getCurrentDocument()&&s(),$(window).focus(function(){w.connected()&&A.highlight&&S.redrawHighlight()}),U.on("change",function(){y&&y.status>=y.STATUS_ACTIVE?y.close().done(function(){y.off("statusChange"),h(F.get(k))}):h(F.get(k))})}),D.stateManager.definePreference("livedev.highlight","boolean",!0).on("change",function(){A.highlight=D.getViewState("livedev.highlight"),d()}),D.convertPreferences(n,{highlight:"user livedev.highlight",afterFirstLaunch:"user livedev.afterFirstLaunch"},!0),A.highlight=D.getViewState("livedev.highlight"),C.register(L.CMD_LIVE_FILE_PREVIEW,E.FILE_LIVE_FILE_PREVIEW,s),C.register(L.CMD_LIVE_HIGHLIGHT,E.FILE_LIVE_HIGHLIGHT,p),C.register(L.CMD_RELOAD_LIVE_PREVIEW,E.CMD_RELOAD_LIVE_PREVIEW,m),C.register(L.CMD_TOGGLE_LIVE_PREVIEW_MB_MODE,E.TOGGLE_LIVE_PREVIEW_MB_MODE,i),C.get(E.FILE_LIVE_HIGHLIGHT).setEnabled(!1)}),define("utils/ColorUtils",["require","exports","module"],function(e,t){"use strict";function n(e,t){return t?e.prepend($("<span>").addClass("color-swatch").css("backgroundColor",t)):e.addClass("no-swatch-margin"),e}var r=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],i=new RegExp(/#[a-f0-9]{6}\b|#[a-f0-9]{3}\b|\brgb\(\s*(?:[0-9]{1,2}|1[0-9]{2}|2[0-4][0-9]|25[0-5])\b\s*,\s*(?:[0-9]{1,2}|1[0-9]{2}|2[0-4][0-9]|25[0-5])\b\s*,\s*(?:[0-9]{1,2}|1[0-9]{2}|2[0-4][0-9]|25[0-5])\b\s*\)|\brgb\(\s*(?:[0-9]{1,2}%|100%)\s*,\s*(?:[0-9]{1,2}%|100%)\s*,\s*(?:[0-9]{1,2}%|100%)\s*\)|\brgba\(\s*(?:[0-9]{1,2}|1[0-9]{2}|2[0-4][0-9]|25[0-5])\b\s*,\s*(?:[0-9]{1,2}|1[0-9]{2}|2[0-4][0-9]|25[0-5])\b\s*,\s*(?:[0-9]{1,2}|1[0-9]{2}|2[0-4][0-9]|25[0-5])\b\s*,\s*(?:1|1\.0|0|0?\.[0-9]{1,3})\s*\)|\brgba\(\s*(?:[0-9]{1,2}%|100%)\s*,\s*(?:[0-9]{1,2}%|100%)\s*,\s*(?:[0-9]{1,2}%|100%)\s*,\s*(?:1|1\.0|0|0?\.[0-9]{1,3})\s*\)|\bhsl\(\s*(?:[0-9]{1,3})\b\s*,\s*(?:[0-9]{1,2}|100)\b%\s*,\s*(?:[0-9]{1,2}|100)\b%\s*\)|\bhsla\(\s*(?:[0-9]{1,3})\b\s*,\s*(?:[0-9]{1,2}|100)\b%\s*,\s*(?:[0-9]{1,2}|100)\b%\s*,\s*(?:1|1\.0|0|0?\.[0-9]{1,3})\s*\)|\b/.source+r.join("\\b|\\b")+"\\b","gi");t.COLOR_NAMES=r,t.COLOR_REGEX=i,t.formatColorHint=n}),define("language/XMLUtils",["require","exports","module","utils/TokenUtils"],function(e,t){"use strict";function n(e,t,n,r,i,o,a){return{token:e||null,tokenType:t||null,offset:n||0,exclusionList:r||[],tagName:i||"",attrName:o||"",shouldReplace:a||!1}}function r(e,t){var n,r,i,o,a,l,c,u=[];if(n=$.extend({},t),r=s.getInitialContext(e._codeMirror,n),a=$.extend(!0,{},r),null===a.token.type&&d.test(a.token.string)&&s.moveSkippingWhitespace(s.moveNextToken,a)){if(null===a.token.type&&"="===a.token.string||"string"===a.token.type)return null;s.moveSkippingWhitespace(s.movePrevToken,a)}for("attribute"===a.token.type&&s.moveSkippingWhitespace(s.moveNextToken,a)&&null===a.token.type&&"="===a.token.string&&(c=!0),n=$.extend({},t),i=s.getInitialContext(e._codeMirror,n);s.movePrevToken(i);){if(i.token.type&&i.token.type.indexOf("tag bracket")>=0&&("</"===i.token.string||-1!==i.token.string.indexOf(">")))return null;if("attribute"===i.token.type&&u.push(i.token.string),"tag"===i.token.type&&(l=i.token.string,s.movePrevToken(i))){if("tag bracket"===i.token.type&&"<"===i.token.string)break;return null}}for(n=$.extend({},t),o=s.getInitialContext(e._codeMirror,n);s.moveNextToken(o);){if("string"===o.token.type&&'"'===o.token.string)return null;if("tag bracket"===o.token.type&&(o.token.string.indexOf(">")>=0||"<"===o.token.string))break;"attribute"===o.token.type&&-1===u.indexOf(o.token.string)&&u.push(o.token.string)}return{tagName:l,exclusionList:u,shouldReplace:c}}function i(e,t){var n,r,i,o,a,l,c=[];for(n=s.getInitialContext(e._codeMirror,t),o=s.offsetInToken(n),"string"===n.token.type&&/\s+/.test(n.token.string)&&(a=n.token.string.substr(1,o),l=n.token.string.substr(o),/^['"]$/.test(n.token.string.substr(-1,1))&&(l=l.substr(0,l.length-1)),c=c.concat(a.split(/\s+/).slice(0,-1)),c=c.concat(l.split(/\s+/)),c=c.filter(function(e){return e.length>0?!0:void 0}));s.movePrevToken(n);){if("tag bracket"===n.token.type){if("</"===n.token.string)return null;if(n.token.string.indexOf(">")>=0||"<"===n.token.string)break}if("attribute"!==n.token.type||i||(i=n.token.string),"tag"===n.token.type&&(r=n.token.string,s.movePrevToken(n))){if("tag bracket"===n.token.type&&"<"===n.token.string)break;return null}}return{tagName:r,attrName:i,exclusionList:c}}function o(e,t){var o,a,p,h;if(o=s.getInitialContext(e._codeMirror,t),a=s.offsetInToken(o),o.token&&"tag bracket"===o.token.type&&"<"===o.token.string)return n(o.token,l);if(o.token&&"tag"===o.token.type){if(s.movePrevToken(o)&&"tag bracket"===o.token.type&&"<"===o.token.string)return s.moveNextToken(o),n(o.token,l,a)}else if(o.token&&("attribute"===o.token.type||null===o.token.type&&d.test(o.token.string))){if(p=r(e,t),p&&p.tagName)return n(o.token,c,a,p.exclusionList,p.tagName,null,p.shouldReplace)}else if(o.token&&(null===o.token.type&&"="===o.token.string||"string"===o.token.type&&/^['"]$/.test(o.token.string.charAt(0)))){if("string"===o.token.type&&/^['"]$/.test(o.token.string.substr(-1,1))&&1!==o.token.string.length&&o.token.end===t.ch)return n();if(h=i(e,t),h&&h.tagName&&h.attrName)return n(o.token,u,a,h.exclusionList,h.tagName,h.attrName)}return n()}function a(e){var t;return"="===e.token.string?"":(t=e.token.string.substr(1,e.offset-1),t.split(/\s+/).slice(-1)[0])}var s=e("utils/TokenUtils"),l=1,c=2,u=3,d=/^\s+$/;t.getTagInfo=o,t.getValueQuery=a,t.regexWhitespace=d,t.TOKEN_TAG=l,t.TOKEN_ATTR=c,t.TOKEN_VALUE=u}),define("editor/EditorStatusBar",["require","exports","module","thirdparty/lodash","utils/AnimationUtils","utils/AppInit","widgets/DropdownButton","editor/EditorManager","view/MainViewManager","editor/Editor","file/FileUtils","utils/KeyEvent","language/LanguageManager","preferences/PreferencesManager","widgets/StatusBar","strings","utils/StringUtils"],function(e){"use strict";function t(e,t,n){return k.format(e>1?n:t,e)}function n(e){var t=e.document,n=t.getLanguage();g.$button.css("width","auto"),g.$button.prop("disabled",t.isUntitled()),g.$button.text(n.getName())}function r(e){var n=e.lineCount();y.text(t(n,P.STATUSBAR_LINE_COUNT_SINGULAR,P.STATUSBAR_LINE_COUNT_PLURAL))}function i(e){var t=M.getUseTabChar(e);_.text(t?P.STATUSBAR_TAB_SIZE:P.STATUSBAR_SPACES),_.attr("title",t?P.STATUSBAR_INDENT_TOOLTIP_SPACES:P.STATUSBAR_INDENT_TOOLTIP_TABS),E.attr("title",t?P.STATUSBAR_INDENT_SIZE_TOOLTIP_TABS:P.STATUSBAR_INDENT_SIZE_TOOLTIP_SPACES)}function o(e){return M.getUseTabChar(e)?M.getTabSize(e):M.getSpaceUnits(e)}function a(e){var t=o(e);E.text(t),b.val(t)}function s(){var e=T.getActiveEditor(),t=e&&e.document.file.fullPath;M.setUseTabChar(!M.getUseTabChar(t),t),i(t),a(t)}function l(e,n){n=n||T.getActiveEditor();var r=n.getCursorPos(!0),i=k.format(P.STATUSBAR_CURSOR_POSITION,r.line+1,r.ch+1),o=n.getSelections(),a="";if(o.length>1)a=k.format(P.STATUSBAR_SELECTION_MULTIPLE,o.length);else if(n.hasSelection()){var s=o[0];if(s.start.line!==s.end.line){var l=s.end.line-s.start.line+1;0===s.end.ch&&l--,a=t(l,P.STATUSBAR_SELECTION_LINE_SINGULAR,P.STATUSBAR_SELECTION_LINE_PLURAL)}else{var c=n.getColOffset(s.end)-n.getColOffset(s.start);a=t(c,P.STATUSBAR_SELECTION_CH_SINGULAR,P.STATUSBAR_SELECTION_CH_PLURAL)}}v.text(i+a)}function c(e,t){E.removeClass("hidden"),b.addClass("hidden"),b.off("blur keyup"),O.focusActivePane();var n=parseInt(t,10);if(M.getUseTabChar(e)){if(!M.setTabSize(n,e))return}else if(!M.setSpaceUnits(n,e))return;a(e),l()}function u(e,t,n,r){S.text()!==(n?P.STATUSBAR_OVERWRITE:P.STATUSBAR_INSERT)&&(S.text(n?P.STATUSBAR_OVERWRITE:P.STATUSBAR_INSERT),r||w.animateUsingClass(S[0],"flash",1500))}function d(e){var t=T.getActiveEditor(),n=!t._codeMirror.state.overwrite;u(e,t,n,!0),t.toggleOverwrite(n)}function p(e){e.toggleOverwrite(S.text()===P.STATUSBAR_OVERWRITE),S.attr("title",P.STATUSBAR_INSOVR_TOOLTIP)}function h(e,t,o){if(o&&(o.off(".statusbar"),o.document.off(".statusbar"),o.document.releaseRef()),t){var s=t.document.file.fullPath;A.showAllPanes(),t.on("cursorActivity.statusbar",l),t.on("optionChange.statusbar",function(){i(s),a(s)}),t.on("change.statusbar",function(){window.setTimeout(function(){r(t)},0)}),t.on("overwriteToggle.statusbar",u),t.document.addRef(),t.document.on("languageChanged.statusbar",function(){n(t)}),l(null,t),n(t),r(t),p(t),i(s),a(s)}else A.hideAllPanes()}function f(){var e=I.values(N.getLanguages()).filter(function(e){return!e.isBinary()});e.sort(function(e,t){return e.getName().toLowerCase().localeCompare(t.getName().toLowerCase())}),g.items=e,g.items.unshift("---"),g.items.unshift(F)}function m(){v=$("#status-cursor"),y=$("#status-file"),_=$("#indent-type"),E=$("#indent-width-label"),b=$("#indent-width-input"),S=$("#status-overwrite"),g=new D("",[],function(e){var t=T.getActiveEditor().document,n=N.getLanguageForPath(t.file.fullPath,!0);if(e===F){var r=I.escape(k.format(P.STATUSBAR_SET_DEFAULT_LANG,L.getSmartFileExtension(t.file.fullPath)));return{html:r,enabled:t.getLanguage()!==n}}var i=I.escape(e.getName());return e===n&&(i+=" <span class='default-language'>"+P.STATUSBAR_DEFAULT_LANG+"</span>"),e===t.getLanguage()&&(i="<span class='checked-language'></span>"+i),i}),g.dropdownExtraClasses="dropdown-status-bar",g.$button.addClass("btn-status-bar"),$("#status-language").append(g.$button),g.$button.attr("title",P.STATUSBAR_LANG_TOOLTIP),_.on("click",s),E.on("click",function(){var e=T.getActiveEditor().document.file.fullPath;b.val(o(e)),E.addClass("hidden"),b.removeClass("hidden"),b.focus(),b.on("blur",function(){c(e,b.val())}).on("keyup",function(t){t.keyCode===R.DOM_VK_RETURN?b.blur():t.keyCode===R.DOM_VK_ESCAPE&&c(e,!1)})}),b.focus(function(){b.select()}),g.on("select",function(e,t){var n=T.getActiveEditor().document,r=n.file.fullPath;if(t===F){var i=x.get("language.fileExtensions");i[L.getSmartFileExtension(r)]=n.getLanguage().getId(),x.set("language.fileExtensions",i)}else{var o=N.getLanguageForPath(r,!0);N.setLanguageOverrideForPath(r,t===o?null:t)}}),S.on("click",d)}var g,v,y,_,E,b,S,I=e("thirdparty/lodash"),w=e("utils/AnimationUtils"),C=e("utils/AppInit"),D=e("widgets/DropdownButton").DropdownButton,T=e("editor/EditorManager"),O=e("view/MainViewManager"),M=e("editor/Editor").Editor,L=e("file/FileUtils"),R=e("utils/KeyEvent"),N=e("language/LanguageManager"),x=e("preferences/PreferencesManager"),A=e("widgets/StatusBar"),P=e("strings"),k=e("utils/StringUtils"),F={};T.on("activeEditorChange",h),C.htmlReady(m),C.appReady(function(){f(),N.on("languageAdded languageModified",f),h(null,T.getActiveEditor(),null),A.show()})}),define("editor/EditorCommandHandlers",["require","exports","module","command/Commands","strings","command/CommandManager","editor/EditorManager","utils/StringUtils","utils/TokenUtils","thirdparty/CodeMirror2/lib/codemirror","thirdparty/lodash"],function(e){"use strict";function t(e,t){var n,r,i=[],o="";for(n=e.length;n<t.length;n++)r=t.charAt(n),i.push(o+"[^"+F.regexEscape(r)+"]"),o&&i.push(o+"$"),o+=r;return new RegExp("^\\s*"+F.regexEscape(e)+"($|"+i.join("|")+")")}function n(e,n,r){var i,o,a=[];return e.forEach(function(e){i=F.regexEscape(e),o=!0,n&&0===n.indexOf(e)&&(a.push(t(e,n)),o=!1),r&&n!==r&&0===r.indexOf(e)&&(a.push(t(e,r)),o=!1),o&&a.push(new RegExp("^\\s*"+i))}),a}function r(e,t){return t.some(function(t){return e.match(t)})}function i(e,t,n){var r=null;return t.forEach(function(t,i){e.match(t)&&(r&&r.length<n[i].length||!r)&&(r=n[i])}),r}function o(e,t,n,i){var o,a,s=!1;for(o=t;n>=o;o++)if(a=e.document.getLine(o),a.match(/\S/)&&!r(a,i)){s=!0;break}return s}function a(e,t,r,a,s){var l=e.document,c=s.selectionForEdit,u=s.selectionsToTrack,d=n(t,r,a),p=c.start.line,h=c.end.line,f=[];0===c.end.ch&&h--;var m,g,v,y,_=o(e,p,h,d);if(_){for(m=p;h>=m;m++)f.push({text:t[0],start:{line:m,ch:0}});V.each(u,function(e){0===e.start.ch&&0!==j.cmpPos(e.start,e.end)?(e.start={line:e.start.line,ch:0},e.end={line:e.end.line,ch:e.end.line===h?e.end.ch+t[0].length:0}):e.isBeforeEdit=!0})}else{for(m=p;h>=m;m++)g=l.getLine(m),v=i(g,d,t),v&&(y=g.indexOf(v),f.push({text:"",start:{line:m,ch:y},end:{line:m,ch:y+v.length}}));V.each(u,function(e){e.isBeforeEdit=!0})}return{edit:f,selection:u}}function s(e,t,n,i,o,a){for(var l=U.moveSkippingWhitespace(U.movePrevToken,e);l&&r(e.token.string,a);)l=U.moveSkippingWhitespace(U.movePrevToken,e);return l&&"comment"===e.token.type?e.token.string.match(i)||e.token.string.match(o)?t===n&&e.token.string.length===t.length?!s(e,t,n,i,o,a):e.token.string.match(i):!0:!1}function l(e,t,i,a,l,c){var u,d,p,h,f,m,g=e.document,v=U.getInitialContext(e._codeMirror,{line:l.start.line,ch:l.start.ch}),y=e.indexFromPos(l.end),_=n(a,t,i),E=new RegExp("^"+F.regexEscape(t),"g"),b=new RegExp(F.regexEscape(i)+"$","g"),S=null,I=null,w=!0,C=!1,D=!1,T=!1,O=!1,M=!0,L=[];for(c||(c=[V.cloneDeep(l)]),v.token.type||/\S/.test(v.token.string)||(M=U.moveSkippingWhitespace(U.moveNextToken,v));M&&"comment"!==v.token.type;)M=U.moveSkippingWhitespace(U.moveNextToken,v)&&e.indexFromPos(v.pos)<=y,w=!1;if(M&&"comment"===v.token.type)if(r(v.token.string,_)?0===v.token.start&&!v.token.string.match(/^\\s*/)&&w?(d=U.getInitialContext(e._codeMirror,{line:v.pos.line,ch:v.token.start}),C=s(d,t,i,E,b,_)):C=!1:(C=!0,v.token.string===t&&t===i&&(d=U.getInitialContext(e._codeMirror,{line:v.pos.line,ch:v.token.start}),p=s(d,t,i,E,b,_),p?U.moveSkippingWhitespace(U.movePrevToken,v):U.moveSkippingWhitespace(U.moveNextToken,v))),C){for(f=V.cloneDeep(v.pos),M=!0;M&&!v.token.string.match(E);)M=U.moveSkippingWhitespace(U.movePrevToken,v);for(S=M&&{line:v.pos.line,ch:v.token.start},v.token.string===t&&t===i&&(v=U.getInitialContext(e._codeMirror,V.cloneDeep(f)));M&&!v.token.string.match(b);)M=U.moveSkippingWhitespace(U.moveNextToken,v);I=M&&{line:v.pos.line,ch:v.token.end-i.length};do M=U.moveSkippingWhitespace(U.moveNextToken,v)&&e.indexFromPos(v.pos)<=y;while(M&&!v.token.string.match(E));T=M&&!!v.token.string.match(E),h=I&&{line:I.line,ch:I.ch+i.length},(h&&j.cmpPos(l.start,h)>0||S&&j.cmpPos(l.end,S)<0)&&(D=!0)}else m=l.end.line,0===l.end.ch&&e.hasSelection()&&m--,o(e,l.start.line,m,_)?D=!0:O=!0;else D=!0;if(T)u={edit:[],selection:c};else if(O)u=null;else{if(D){var R=0===l.start.ch&&0===l.end.ch&&l.start.line<l.end.line;R?(L.push({text:i+"\n",start:l.end}),L.push({text:t+"\n",start:l.start})):(L.push({text:i,start:l.end}),L.push({text:t,start:l.start})),V.each(c,function(e){function n(e){j.cmpPos(e,l.end)>0&&(R?e.line++:e.line===l.end.line&&(e.ch+=i.length)),j.cmpPos(e,l.start)>=0&&(R?e.line++:e.line===l.start.line&&(e.ch+=t.length))}n(e.start),n(e.end)})}else{var N=g.getLine(S.line).trim(),x=0===S.ch&&t.length===N.length,A=!1;I&&(N=g.getLine(I.line).trim(),A=0===I.ch&&i.length===N.length),I&&L.push(x&&A?{text:"",start:I,end:{line:I.line+1,ch:0}}:{text:"",start:I,end:{line:I.line,ch:I.ch+i.length}}),L.push(x&&A?{text:"",start:S,end:{line:S.line+1,ch:0}}:{text:"",start:S,end:{line:S.line,ch:S.ch+t.length}}),V.each(c,function(e){e.isBeforeEdit=!0})}u={edit:L,selection:c}}return u}function c(e,t,n,r){var i=r.selectionForEdit;return i.end.line===i.start.line+1&&0===i.end.ch&&(i.end={line:i.start.line,ch:e.document.getLine(i.start.line).length}),l(e,t,n,[],i,r.selectionsToTrack)}function u(e,t){var n=e.convertToLineSelections(t,{mergeAdjacent:!1}),r=[];return V.each(n,function(t){var n,i=t.selectionForEdit,o=e.getModeForRange(i.start,i.end);if(o){var s=e.document.getLanguage().getLanguageForMode(o.name||o);s.hasLineCommentSyntax()?n=a(e,s.getLineCommentPrefixes(),s.getBlockCommentPrefix(),s.getBlockCommentSuffix(),t):s.hasBlockCommentSyntax()&&(n=c(e,s.getBlockCommentPrefix(),s.getBlockCommentSuffix(),t))}n||(n={selection:t.selectionsToTrack}),r.push(n)}),r}function d(e){e=e||k.getFocusedEditor(),e&&e.setSelections(e.document.doMultipleEdits(u(e,e.getSelections())))}function p(e){if(e=e||k.getFocusedEditor()){var t=[],n=[];V.each(e.getSelections(),function(r){var i=e.getModeForRange(r.start,r.end),o={edit:[],selection:[r]};if(i){var a=e.document.getLanguage().getLanguageForMode(i.name||i);a.hasBlockCommentSyntax()&&(o=l(e,a.getBlockCommentPrefix(),a.getBlockCommentSuffix(),a.getLineCommentPrefixes(),r),o||n.push(r))}o&&t.push(o)}),t.push.apply(t,u(e,n)),e.setSelections(e.document.doMultipleEdits(t))}}function h(e){if(e=e||k.getFocusedEditor()){var t=e.getSelections(),n="",r=[],i=[],o=[],a=e.document;V.each(t,function(e){0===j.cmpPos(e.start,e.end)?o.push(e):i.push(e)});var s=e.convertToLineSelections(o);V.each(s,function(t){var i=t.selectionForEdit;i.end.line===e.lineCount()&&(n="\n"),r.push({edit:{text:a.getRange(i.start,i.end)+n,start:i.start}})}),V.each(i,function(e){r.push({edit:{text:a.getRange(e.start,e.end),start:e.start}})}),a.doMultipleEdits(r)}}function f(e){if(e=e||k.getFocusedEditor()){var t,n,r=e.document,i=e.convertToLineSelections(e.getSelections()),o=[];V.each(i,function(i){var a=i.selectionForEdit;t=a.start,n=a.end,n.line===e.getLastVisibleLine()+1&&(t.line>e.getFirstVisibleLine()&&(t.line-=1,t.ch=r.getLine(t.line).length),n.line-=1,n.ch=r.getLine(n.line).length),o.push({edit:{text:"",start:t,end:n}})}),r.doMultipleEdits(o)}}function m(e,t){if(e=e||k.getFocusedEditor()){var n=e.document,r=e.convertToLineSelections(e.getSelections()),i=!!k.getFocusedInlineWidget(),o=e.getFirstVisibleLine(),a=e.getLastVisibleLine(),s=e.lineCount(),l=0,c=[],u=[],d={};V.each(r,function(e){var r=e.selectionForEdit,u=[];switch(t){case B:if(r.start.line!==o){var d=n.getRange({line:r.start.line-1,ch:0},r.start);r.end.line===a+1&&(i?(d=d.substring(0,d.length-1),l=n.getLine(r.end.line-1).length,u.push({text:"\n",start:{line:r.end.line-1,ch:l}})):d="\n"+d.substring(0,d.length-1)),u.push({text:"",start:{line:r.start.line-1,ch:0},end:r.start}),u.push({text:d,start:{line:r.end.line-1,ch:0}}),V.each(e.selectionsToTrack,function(e){e.start.line--,e.end.line--}),c.push({edit:u,selection:e.selectionsToTrack})}break;case H:if(r.end.line<=a){var p=n.getRange(r.end,{line:r.end.line+1,ch:0}),h=r.end;r.end.line===a&&(i?(r.end.line===s-1&&(p+="\n"),l=n.getLine(r.end.line-1).length,u.push({text:"\n",start:{line:r.end.line,ch:n.getLine(r.end.line).length}})):(p+="\n",h={line:r.end.line-1,ch:n.getLine(r.end.line-1).length})),u.push({text:"",start:h,end:{line:r.end.line+1,ch:0}}),l&&u.push({text:"",start:{line:r.end.line-1,ch:l},end:{line:r.end.line,ch:0}}),u.push({text:p,start:{line:r.start.line,ch:0}}),c.push({edit:u})}}}),c.length&&(u=n.doMultipleEdits(c),d.ch=0,t===B?(e.setSelections(u),d.line=e.getSelection().start.line):t===H?d.line=e.getSelection().end.line:(console.error("EditorCommandHandler.moveLine() called with invalid argument 'direction' = %d",t),d=null),e._codeMirror.scrollIntoView(d))}}function g(e){m(e,B)}function v(e){m(e,H)}function y(e,t){if(e=e||k.getFocusedEditor()){var n,r,i=e.getSelections(),o=!!k.getFocusedInlineWidget(),a=e.getLastVisibleLine(),s=e.document,l=[];s.batchOperation(function(){V.each(i,function(e,n){if(0===n||t===B&&e.start.line>i[n-1].start.line||t===H&&e.end.line>i[n-1].end.line){switch(t){case B:r=e.start.line;break;case H:r=e.end.line,(0===j.cmpPos(e.start,e.end)||0!==e.end.ch)&&r++}var c;c=r>a&&o?{line:r-1,ch:s.getLine(r-1).length}:{line:r,ch:0},l.push({edit:{text:"\n",start:c},selection:{start:c,end:c,primary:e.primary}})}else e.primary&&(l[l.length-1].selections[0].primary=!0)}),n=s.doMultipleEdits(l,"+input"),V.each(n,function(e){s._masterEditor._codeMirror.indentLine(e.start.line,"smart",!0),e.start.ch=null,e.end=e.start})}),e.setSelections(n)}}function _(e){y(e,B)}function E(e){y(e,H)}function b(){var e=k.getFocusedEditor();e&&e._codeMirror.execCommand("indentMore")}function S(){var e=k.getFocusedEditor();e&&e._codeMirror.execCommand("indentLess")}function I(e){e=e||k.getFocusedEditor(),e&&e.setSelections(V.pluck(e.convertToLineSelections(e.getSelections(),{expandEndAtStartOfLine:!0}),"selectionForEdit"))}function w(e){e=e||k.getFocusedEditor(),e&&e._codeMirror.execCommand("splitSelectionByLine")}function C(e,t){if(e=e||k.getFocusedEditor()){var n=e.getSelections(),r=[];V.each(n,function(n){var i,o;(-1===t&&n.start.line>e.getFirstVisibleLine()||1===t&&n.end.line<e.getLastVisibleLine())&&(i=V.clone(-1===t?n.start:n.end),o=e.getColOffset(i),i.line+=t,i.ch=e.getCharIndexForColumn(i.line,o),r.push({start:i,end:i,primary:n.primary}),n.primary=!1)}),e.setSelections(n.concat(r))}}function D(e){C(e,-1)}function T(e){C(e,1)}function O(e){var t=k.getFocusedEditor(),n=new $.Deferred;return t?(t[e](),n.resolve()):n.reject(),n.promise()}function M(){return O("undo")}function L(){return O("redo")}function R(){return(new $.Deferred).reject().promise()}function N(){var e=new $.Deferred,t=k.getFocusedEditor();return t?(t.selectAllNoScroll(),e.resolve()):e.reject(),e.promise()}var x=e("command/Commands"),A=e("strings"),P=e("command/CommandManager"),k=e("editor/EditorManager"),F=e("utils/StringUtils"),U=e("utils/TokenUtils"),j=e("thirdparty/CodeMirror2/lib/codemirror"),V=e("thirdparty/lodash"),B=-1,H=1;P.register(A.CMD_INDENT,x.EDIT_INDENT,b),P.register(A.CMD_UNINDENT,x.EDIT_UNINDENT,S),P.register(A.CMD_COMMENT,x.EDIT_LINE_COMMENT,d),P.register(A.CMD_BLOCK_COMMENT,x.EDIT_BLOCK_COMMENT,p),P.register(A.CMD_DUPLICATE,x.EDIT_DUPLICATE,h),P.register(A.CMD_DELETE_LINES,x.EDIT_DELETE_LINES,f),P.register(A.CMD_LINE_UP,x.EDIT_LINE_UP,g),P.register(A.CMD_LINE_DOWN,x.EDIT_LINE_DOWN,v),P.register(A.CMD_OPEN_LINE_ABOVE,x.EDIT_OPEN_LINE_ABOVE,_),P.register(A.CMD_OPEN_LINE_BELOW,x.EDIT_OPEN_LINE_BELOW,E),P.register(A.CMD_SELECT_LINE,x.EDIT_SELECT_LINE,I),P.register(A.CMD_SPLIT_SEL_INTO_LINES,x.EDIT_SPLIT_SEL_INTO_LINES,w),P.register(A.CMD_ADD_CUR_TO_NEXT_LINE,x.EDIT_ADD_CUR_TO_NEXT_LINE,T),P.register(A.CMD_ADD_CUR_TO_PREV_LINE,x.EDIT_ADD_CUR_TO_PREV_LINE,D),P.register(A.CMD_UNDO,x.EDIT_UNDO,M),P.register(A.CMD_REDO,x.EDIT_REDO,L),P.register(A.CMD_CUT,x.EDIT_CUT,R),P.register(A.CMD_COPY,x.EDIT_COPY,R),P.register(A.CMD_PASTE,x.EDIT_PASTE,R),P.register(A.CMD_SELECT_ALL,x.EDIT_SELECT_ALL,N)}),define("editor/EditorOptionHandlers",["require","exports","module","utils/AppInit","editor/Editor","command/Commands","command/CommandManager","preferences/PreferencesManager","strings","thirdparty/lodash"],function(e){"use strict";function t(e){var t=m[e];t&&s.get(t).setChecked(l.get(e))}function n(e){return function(){l.set(e,!l.get(e))}}function r(){u.each(m,function(e,t){s.get(e).setChecked(l.get(t))}),o.getShowLineNumbers()||o._toggleLinePadding(!0)}var i=e("utils/AppInit"),o=e("editor/Editor").Editor,a=e("command/Commands"),s=e("command/CommandManager"),l=e("preferences/PreferencesManager"),c=e("strings"),u=e("thirdparty/lodash"),d="showLineNumbers",p="styleActiveLine",h="wordWrap",f="closeBrackets",m={};m[d]=a.TOGGLE_LINE_NUMBERS,m[p]=a.TOGGLE_ACTIVE_LINE,m[h]=a.TOGGLE_WORD_WRAP,m[f]=a.TOGGLE_CLOSE_BRACKETS,Object.keys(m).forEach(function(e){l.on("change",e,function(){t(e)})}),s.register(c.CMD_TOGGLE_LINE_NUMBERS,a.TOGGLE_LINE_NUMBERS,n(d)),s.register(c.CMD_TOGGLE_ACTIVE_LINE,a.TOGGLE_ACTIVE_LINE,n(p)),s.register(c.CMD_TOGGLE_WORD_WRAP,a.TOGGLE_WORD_WRAP,n(h)),s.register(c.CMD_TOGGLE_CLOSE_BRACKETS,a.TOGGLE_CLOSE_BRACKETS,n(f)),i.htmlReady(r)}),define("utils/BuildInfoUtils",["require","exports","module","filesystem/FileSystem","file/FileUtils","utils/Global"],function(e,t){"use strict";function n(e,t){var r=new $.Deferred;if(brackets.inBrowser)r.reject();else{var a=i.getFileForPath(e);o.readAsText(a).done(function(i){if(0===i.indexOf("ref: ")){var o=e.substr(0,e.lastIndexOf("/")),a=i.substr(5).trim(),s=i.substr(16).trim();n(o+"/"+a,t).done(function(e){r.resolve({branch:s,sha:e.sha.trim()})}).fail(function(){r.resolve({branch:s})})}else r.resolve({sha:i})}).fail(function(){r.reject()})}return r.promise()}function r(){var e=new $.Deferred,t=o.getNativeBracketsDirectoryPath(),r=t.substr(0,t.lastIndexOf("/"))+"/.git/HEAD";return n(r).done(function(t){e.resolve(t.branch||"HEAD",t.sha||"unknown",!0)}).fail(function(){e.resolve(brackets.metadata.repository.branch,brackets.metadata.repository.SHA,!1)}),e.promise()}var i=e("filesystem/FileSystem"),o=e("file/FileUtils");e("utils/Global"),t.getBracketsSHA=r}),define("text!htmlContent/about-dialog.html",[],function(){return'<div class="about-dialog modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">{{Strings.ABOUT}}</h1>\n    </div>\n    <div class="modal-body no-padding">\n        <img class="about-icon" src="{{ABOUT_ICON}}">\n        <div class="about-text">\n            <h2>{{APP_NAME_ABOUT_BOX}}</h2>\n            <div class="about-info">\n                <p class="dialog-message">{{Strings.ABOUT_TEXT_LINE1}} <span id="about-build-number">{{BUILD_INFO}}</span>\n                  {{#BUILD_TIMESTAMP}}\n                  <br><span class="dialog-message">{{Strings.ABOUT_TEXT_BUILD_TIMESTAMP}}{{BUILD_TIMESTAMP}}</span>\n                  {{/BUILD_TIMESTAMP}}\n                </p>\n\n                <p class="dialog-message"><!-- $NON-NLS$ -->Copyright 2012 - 2015 Adobe Systems Incorporated and its licensors. All rights reserved.</p>\n                <p class="dialog-message">{{{Strings.ABOUT_TEXT_WEB_PLATFORM_DOCS}}}</p>\n                <p class="dialog-message">{{{Strings.ABOUT_TEXT_LINE3}}}</p>\n                <p class="dialog-message">{{{Strings.ABOUT_TEXT_LINE4}}}</p>\n                <p class="dialog-message">\n                    {{Strings.ABOUT_TEXT_LINE5}}\n                    <span class="spinner inline"></span>\n                </p>\n                <div class="about-contributors">\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="modal-footer">\n        <button class="dialog-button btn primary" data-button-id="ok">{{Strings.CLOSE}}</button>\n    </div>\n</div>\n'}),define("text!htmlContent/contributors-list.html",[],function(){return'{{#.}}<a href="{{html_url}}" title="{{login}} - {{html_url}}"><img src="{{avatar_url}}?size=30" alt="{{login}}" width="30" height="30" /></a>{{/.}}\n'}),define("help/HelpCommandHandlers",["require","exports","module","utils/AppInit","utils/BuildInfoUtils","command/CommandManager","command/Commands","widgets/Dialogs","file/FileUtils","utils/NativeApp","strings","utils/StringUtils","utils/UpdateNotification","text!htmlContent/about-dialog.html","text!htmlContent/contributors-list.html","utils/Global"],function(e){"use strict";function t(){f.checkForUpdate(!0)}function n(e){return function(){e&&d.openURLInDefaultBrowser(e)}}function r(){brackets.app.showExtensionsFolder(u.convertToNativePath(decodeURI(window.location.href)),function(){})}function i(){function e(t,n,r,i){i=i||new $.Deferred,r=r||[];var o=h.format(t,y,n);return $.ajax({url:o,dataType:"json",cache:!1}).done(function(o){r=r.concat(o||[]),n&&o.length===y?e(t,n+1,r,i):i.resolve(r)}).fail(function(){r.length?i.resolve(r):i.reject()}),i.promise()}var t={ABOUT_ICON:brackets.config.about_icon,APP_NAME_ABOUT_BOX:brackets.config.app_name_about,BUILD_TIMESTAMP:brackets.config.build_timestamp,BUILD_INFO:v||"",Strings:p};
c.showModalDialogUsingTemplate(Mustache.render(m,t));var n,r=$(".about-dialog.instance"),i=r.find(".about-contributors"),o=r.find(".spinner"),a=brackets.config.contributors_url;-1!==a.indexOf("{1}")&&(n=1),o.addClass("spin"),e(a,n).done(function(e){var t=e.length,n=0;e.forEach(function(e){e.avatar_url=e.avatar_url.split("?")[0]}),i.html(Mustache.render(g,e)),i.find("img").one("load",function(){$(this).css("opacity",1),n++,n>=t&&o.removeClass("spin")}).each(function(){this.complete&&$(this).trigger("load")})}).fail(function(){o.removeClass("spin"),i.html(Mustache.render("<p class='dialog-message'>{{ABOUT_TEXT_LINE6}}</p>",p))})}var o=e("utils/AppInit"),a=e("utils/BuildInfoUtils"),s=e("command/CommandManager"),l=e("command/Commands"),c=e("widgets/Dialogs"),u=e("file/FileUtils"),d=e("utils/NativeApp"),p=e("strings"),h=e("utils/StringUtils"),f=e("utils/UpdateNotification"),m=e("text!htmlContent/about-dialog.html"),g=e("text!htmlContent/contributors-list.html");e("utils/Global");var v,y=100;o.appReady(function(){a.getBracketsSHA().done(function(e,t){t=t?t.substr(0,9):"",(e||t)&&(v=h.format("({0} {1})",e,t).trim())})}),s.register(p.CMD_CHECK_FOR_UPDATE,l.HELP_CHECK_FOR_UPDATE,t),s.register(p.CMD_HOW_TO_USE_BRACKETS,l.HELP_HOW_TO_USE_BRACKETS,n(brackets.config.how_to_use_url)),s.register(p.CMD_SUPPORT,l.HELP_SUPPORT,n(brackets.config.support_url)),s.register(p.CMD_SUGGEST,l.HELP_SUGGEST,n(brackets.config.suggest_feature_url)),s.register(p.CMD_RELEASE_NOTES,l.HELP_RELEASE_NOTES,n(brackets.config.release_notes_url)),s.register(p.CMD_GET_INVOLVED,l.HELP_GET_INVOLVED,n(brackets.config.get_involved_url)),s.register(p.CMD_SHOW_EXTENSIONS_FOLDER,l.HELP_SHOW_EXT_FOLDER,r),s.register(p.CMD_HOMEPAGE,l.HELP_HOMEPAGE,n(brackets.config.homepage_url)),s.register(p.CMD_TWITTER,l.HELP_TWITTER,n(brackets.config.twitter_url)),s.register(p.CMD_ABOUT,l.HELP_ABOUT,i)}),define("text!htmlContent/edit-filter-dialog.html",[],function(){return'<div class="file-filter-dialog modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">{{Strings.FILE_FILTER_DIALOG}}</h1>\n    </div>\n    <div class="modal-body">\n        <div class="dialog-message">\n            {{{instruction}}}\n            <textarea class="exclusions-editor"></textarea>\n            <input type="text" class="exclusions-name" placeholder="{{Strings.FILTER_NAME_PLACEHOLDER}}">\n            <div class="exclusions-filecount">{{Strings.FILTER_COUNTING_FILES}}</div>\n        </div>\n    </div>\n    <div class="modal-footer">\n        <button class="dialog-button btn" data-button-id="cancel">{{Strings.CANCEL}}</button>\n        <button class="dialog-button btn primary" data-button-id="ok">{{Strings.OK}}</button>\n    </div>\n</div>\n'}),define("text!htmlContent/filter-name.html",[],function(){return"<div class='filter-trash-icon'>&times;</div><!-- \n--><span class='recent-filter-name'>{{{filter-name}}}</span><!-- \n--><span class='recent-filter-patterns'>{{{filter-patterns}}}</span><!-- \n--><span class='filter-edit-icon'></span>"}),define("search/FileFilters",["require","exports","module","thirdparty/lodash","widgets/Dialogs","widgets/DropdownButton","utils/StringUtils","strings","preferences/PreferencesManager","text!htmlContent/edit-filter-dialog.html","text!htmlContent/filter-name.html"],function(e,t){"use strict";function n(e){return _.isArray(e)?e.length>2?e.slice(0,2).join(", ")+" "+S.format(I.FILE_FILTER_CLIPPED_SUFFIX,e.length-2):e.join(", "):""}function r(){var e=[I.NEW_FILE_FILTER,I.CLEAR_FILE_FILTER],t=w.get("fileFilters")||[];t.length&&(e.push("---"),t=t.filter(function(e){return""!==n(e.patterns)}),e=e.concat(t)),M.items=e}function i(e,t){var n=-1;return t&&e.length?_.findIndex(e,_.partial(_.isEqual,t)):n}function o(){var e=w.get("fileFilters")||[],t=w.getViewState("activeFileFilter"),n=w.getViewState("search.exclusions")||[],r=null;return void 0===t&&n.length?(r={name:"",patterns:n},t=i(e,r),-1===t&&(t=e.length,e.push(r),w.set("fileFilters",e)),w.setViewState("activeFileFilter",t)):t>-1&&t<e.length&&(r=e[t]),r}function a(){var e=o();if(e&&e.patterns.length){var t=e.name||n(e.patterns);M.setButtonLabel(S.format(I.EXCLUDE_FILE_FILTER,t))}else M.setButtonLabel(I.NO_FILE_FILTER)}function s(e,t){var n=w.get("fileFilters")||[];if(e){if(-1===t)t=n.length,n.push(e);else{if(!(t>-1&&t<n.length))return void console.log("setActiveFilter is called with an invalid index: "+t);_.isEqual(n[t],e)||(n[t]=e)}w.set("fileFilters",n),w.setViewState("activeFileFilter",t)}else w.setViewState("activeFileFilter",-1)}function l(e){var t=e.map(function(e){if("**"!==e.substr(0,2)&&(e="**"+e),"**"!==e.substr(-2,2)){var t=e.lastIndexOf("/");-1===e.indexOf(".",t+1)&&(e+="**")}return e}),n=t.map(function(e){var t,n="";for(t=0;t<e.length;t++){var r=e[t];"*"===r?"*"===e[t+1]?"/"===e[t+2]&&"/"===e[t-1]?(n+="(.*/)?",t+=2):(n+=".*",t++):n+="[^/]*":n+="?"===r?"[^/]":S.regexEscape(r)}return"^"+n+"$"});return n.join("|")}function c(e,t){if(!e)return!0;var n=new RegExp(e);return!t.match(n)}function u(e,t){if(!e)return t;var n=new RegExp(e);return t.filter(function(e){return!e.fullPath.match(n)})}function d(e,t){function n(){var e=f.val().split("\n");return e.filter(function(e){return e.trim().length})}function i(){O.promise.done(function(e){var t=n();if(t.length){var r=u(l(t),e);m.html(S.format(I.FILTER_FILE_COUNT,r.length,e.length,O.label))}else m.html(S.format(I.FILTER_FILE_COUNT_ALL,e.length,O.label))})}function o(){var e=f.val().trim();g.prop("disabled",!e.length)}var c=window.document.activeElement,d={instruction:S.format(I.FILE_FILTER_INSTRUCTIONS,brackets.config.glob_help_url),Strings:I},p=E.showModalDialogUsingTemplate(Mustache.render(C,d)),h=p.getElement().find(".exclusions-name"),f=p.getElement().find(".exclusions-editor");h.val(e.name),f.val(e.patterns.join("\n")).focus(),p.done(function(e){e===E.DIALOG_BTN_OK&&(s({name:h.val(),patterns:n()},t),a(),r()),c.focus()});var m=p.getElement().find(".exclusions-filecount"),g=p.getElement().find(".primary");return f.on("input",o),o(),O?(f.on("input",_.debounce(i,400)),i()):m.hide(),p.getPromise()}function p(){var e=o();return e&&e.patterns.length?l(e.patterns):""}function h(e){var t=w.get("fileFilters")||[],n=w.getViewState("activeFileFilter"),i=$(e.target).parent().data("index")-T;e.stopPropagation(),t.splice(i,1),w.set("fileFilters",t),n===i?s(null):n>i&&(--n,s(t[n],n)),a(),r(),M.refresh()}function f(e){var t=w.get("fileFilters")||[],n=$(e.target).parent().data("index")-T;e.stopPropagation(),M.closeDropdown(),d(t[n],n)}function m(e,t){var n=w.getViewState("activeFileFilter"),r=n>-1?n+T:-1;M.setChecked(r,!0),t.find(".filter-trash-icon").on("click",h),t.find(".filter-edit-icon").on("click",f)}function g(e){function t(e,t){if(T>t)return"<span class='recent-filter-name'></span>"+_.escape(e);var r=n(e.patterns),i={"filter-name":_.escape(e.name||r),"filter-patterns":e.name?" - "+_.escape(r):""};return Mustache.render(D,i)}return O=e,M=new b("",[],t),a(),r(),M.$button.addClass("file-filter-picker no-focus"),M.on("listRendered",m),M.on("select",function(e,t,n){0===n?(M.closeDropdown(),d({name:"",patterns:[]},-1)):1===n?(M.setChecked(n,!1),s(null),a()):n>=T&&t&&(s(t,n-T),M.setChecked(n,!0),a())}),M.$button}function v(){M&&M.showDropdown()}function y(){M&&M.closeDropdown()}var _=e("thirdparty/lodash"),E=e("widgets/Dialogs"),b=e("widgets/DropdownButton").DropdownButton,S=e("utils/StringUtils"),I=e("strings"),w=e("preferences/PreferencesManager"),C=e("text!htmlContent/edit-filter-dialog.html"),D=e("text!htmlContent/filter-name.html"),T=3,O=null,M=null;t.showDropdown=v,t.closeDropdown=y,t.createFilterPicker=g,t.commitPicker=p,t.getActiveFilter=o,t.setActiveFilter=s,t.editFilter=d,t.compile=l,t.filterPath=c,t.filterFileList=u}),define("text!htmlContent/findreplace-bar.html",[],function(){return'<div class="find-input-group">\n    <div id="find-group"><!--\n        --><div class="search-input-container"><input type="text" id="find-what" placeholder="{{queryPlaceholder}}" value="{{initialQuery}}" /><div class="error"></div><span id="find-counter"></span></div><!--\n        --><button id="find-case-sensitive" class="btn no-focus" tabindex="-1" title="{{Strings.BUTTON_CASESENSITIVE_HINT}}"><div class="button-icon"></div></button><!--\n        --><button id="find-regexp" class="btn no-focus" tabindex="-1" title="{{Strings.BUTTON_REGEXP_HINT}}"><div class="button-icon"></div></button><!--\n        {{^multifile}}\n        --><div class="navigator"><!--\n            --><button id="find-prev" class="btn no-focus" tabindex="-1" title="{{Strings.BUTTON_PREV_HINT}}">{{Strings.BUTTON_PREV}}</button><!--\n            --><button id="find-next" class="btn no-focus" tabindex="-1" title="{{Strings.BUTTON_NEXT_HINT}}">{{Strings.BUTTON_NEXT}}</button><!--\n        --></div><!--\n        {{/multifile}}\n    --></div>\n\n    {{#replace}}\n    <div id="replace-group" {{#scope}}class="has-scope"{{/scope}}><!--\n        --><input type="text" id="replace-with" placeholder="{{Strings.REPLACE_PLACEHOLDER}}" value="{{initialReplaceText}}" /><!--\n        {{^multifile}}\n        --><button id="replace-yes" class="btn no-focus" tabindex="-1">{{Strings.BUTTON_REPLACE}}</button><!--\n        {{/multifile}}\n        --><button id="replace-all" class="btn no-focus {{#multifile}}solo{{/multifile}}" tabindex="-1">{{replaceAllLabel}}</button></div>\n    {{/replace}}\n</div>\n\n{{#multifile}}\n<div class="scope-group">\n    <div class="no-results-message">{{Strings.FIND_NO_RESULTS}}</div>\n    <div class="message">\n        <span id="searchlabel">{{{scopeLabel}}}</span>\n    </div>\n    <!-- For Find in Files, the filter picker will be added here programmatically. -->\n</div>\n{{/multifile}}\n'}),define("search/FindBar",["require","exports","module","thirdparty/lodash","utils/EventDispatcher","command/Commands","command/KeyBindingManager","utils/KeyEvent","widgets/ModalBar","preferences/PreferencesManager","view/MainViewManager","strings","utils/ViewUtils","text!htmlContent/findreplace-bar.html"],function(e,t,n){"use strict";function r(e){var t={multifile:!1,replace:!1,queryPlaceholder:"",initialQuery:"",initialReplaceText:"",scopeLabel:""};this._options=i.extend(t,e),this._closed=!1,this._enabled=!0}var i=e("thirdparty/lodash"),o=e("utils/EventDispatcher"),a=e("command/Commands"),s=e("command/KeyBindingManager"),l=e("utils/KeyEvent"),c=e("widgets/ModalBar").ModalBar,u=e("preferences/PreferencesManager"),d=e("view/MainViewManager"),p=e("strings"),h=e("utils/ViewUtils"),f=e("text!htmlContent/findreplace-bar.html");o.makeEventDispatcher(r.prototype),r._addFindBar=function(e){r._bars=r._bars||[],r._bars.push(e)},r._removeFindBar=function(e){r._bars&&i.pull(r._bars,e)},r._closeFindBars=function(){var e=r._bars;e&&(e.forEach(function(e){e.close(!0,!1)}),e=[])},r.prototype._options=null,r.prototype._closed=!1,r.prototype._enabled=!0,r.prototype._modalBar=null,r.prototype.$=function(e){return this._modalBar?$(e,this._modalBar.getRoot()):$()},r.prototype._updateSearchBarFromPrefs=function(){this.$("#find-case-sensitive").toggleClass("active",!!u.getViewState("caseSensitive")),this.$("#find-regexp").toggleClass("active",!!u.getViewState("regexp"))},r.prototype._updatePrefsFromSearchBar=function(){u.setViewState("caseSensitive",this.$("#find-case-sensitive").is(".active")),u.setViewState("regexp",this.$("#find-regexp").is(".active"))},r.prototype._addShortcutToTooltip=function(e,t){var n=s.getKeyBindings(t)[0];if(n){var r=e.attr("title");r=r?r+" ":"",e.attr("title",r+"("+s.formatKeyDescriptor(n.displayKey)+")")}},r.prototype.open=function(){var e=this;r._closeFindBars();var t=i.clone(this._options);t.Strings=p,t.replaceAllLabel=t.multifile?p.BUTTON_REPLACE_ALL_IN_FILES:p.BUTTON_REPLACE_ALL,this._modalBar=new c(Mustache.render(f,t),!0),this._modalBar.on("close",function(){e.showError(null),e._modalBar=null,e._closed=!0,r._removeFindBar(e),d.focusActivePane(),e.trigger("close")}),r._addFindBar(this);var n=this._modalBar.getRoot();n.on("input","#find-what",function(){e.trigger("queryChange")}).on("click","#find-case-sensitive, #find-regexp",function(t){$(t.currentTarget).toggleClass("active"),e._updatePrefsFromSearchBar(),e.trigger("queryChange")}).on("keydown","#find-what, #replace-with",function(t){t.keyCode===l.DOM_VK_RETURN&&(t.preventDefault(),t.stopPropagation(),e._options.multifile?$(t.target).is("#find-what")?e._options.replace?e.focusReplace():e.trigger("doFind"):e.trigger("doReplaceAll"):e.trigger("doFind",t.shiftKey))}),this._options.multifile||(this._addShortcutToTooltip($("#find-next"),a.CMD_FIND_NEXT),this._addShortcutToTooltip($("#find-prev"),a.CMD_FIND_PREVIOUS),n.on("click","#find-next",function(){e.trigger("doFind",!1)}).on("click","#find-prev",function(){e.trigger("doFind",!0)})),this._options.replace&&(this._addShortcutToTooltip($("#replace-yes"),a.CMD_REPLACE),n.on("click","#replace-yes",function(){e.trigger("doReplace")}).on("click","#replace-all",function(){e.trigger("doReplaceAll")}).on("keydown",function(t){t.keyCode!==l.DOM_VK_TAB||t.ctrlKey||t.metaKey||t.altKey||("replace-with"!==t.target.id||t.shiftKey?"find-what"===t.target.id&&t.shiftKey&&(e.$("#replace-with").focus(),t.preventDefault()):(e.$("#find-what").focus(),t.preventDefault()))})),this._updateSearchBarFromPrefs(),this.focusQuery()},r.prototype.close=function(e){this._modalBar&&this._modalBar.close(!0,!e)},r.prototype.isClosed=function(){return this._closed},r.prototype.getOptions=function(){return this._options},r.prototype.getQueryInfo=function(){return{query:this.$("#find-what").val()||"",isCaseSensitive:this.$("#find-case-sensitive").is(".active"),isRegexp:this.$("#find-regexp").is(".active")}},r.prototype.showError=function(e,t){var n=this.$(".error");e?(t?n.html(e):n.text(e),n.show()):n.hide()},r.prototype.showFindCount=function(e){this.$("#find-counter").text(e)},r.prototype.showNoResults=function(e,t){h.toggleClass(this.$("#find-what"),"no-results",e);var n=this.$(".no-results-message");t?n.show():n.hide()},r.prototype.getReplaceText=function(){return this.$("#replace-with").val()||""},r.prototype.enable=function(e){this.$("#find-what, #replace-with, #find-prev, #find-next, #find-case-sensitive, #find-regexp").prop("disabled",!e),this._enabled=e},r.prototype.isEnabled=function(){return this._enabled},r.prototype.isReplaceEnabled=function(){return this.$("#replace-yes").is(":enabled")},r.prototype.enableNavigation=function(e){this.isEnabled()&&this.$("#find-prev, #find-next").prop("disabled",!e)},r.prototype.enableReplace=function(e){this.isEnabled&&this.$("#replace-yes, #replace-all").prop("disabled",!e)},r.prototype._focus=function(e){this.$(e).focus().get(0).select()},r.prototype.focusQuery=function(){this._focus("#find-what")},r.prototype.focusReplace=function(){this._focus("#replace-with")},u.stateManager.definePreference("caseSensitive","boolean",!1),u.stateManager.definePreference("regexp","boolean",!1),u.convertPreferences(n,{caseSensitive:"user",regexp:"user"},!0),t.FindBar=r}),define("search/FindUtils",["require","exports","module","utils/Async","document/DocumentManager","view/MainViewManager","filesystem/FileSystem","file/FileUtils","search/FindBar","project/ProjectManager","strings","utils/StringUtils","thirdparty/lodash"],function(e,t){"use strict";function n(e,t){return e=e.replace(/(\$+)(\d{1,2}|&)/g,function(e,n,r){if(n.length%2===1){if("&"===r)return n.substr(1)+(t[0]||"");var i=parseInt(r,10);if(0!==i)return n.substr(1)+(t[i]||"")}return e}),e=e.replace(/\$\$/g,"$")}function r(e,t){function n(e){var t=e.getSelectedText();return t?t.replace(/^\n*/,"").split("\n")[0]:""}var r="",i="";if(e&&!e.isClosed())r=e.getQueryInfo().query,i=e.getReplaceText();else{var o=g._bars&&E.find(g._bars,function(e){return!e.isClosed()});o?(r=o.getQueryInfo().query,i=o.getReplaceText()):t&&(r=n(t))}return{query:r,replaceText:i}}function i(e,r,i,o){return e.diskTimestamp.getTime()!==r.timestamp.getTime()?(new $.Deferred).reject(t.ERROR_FILE_CHANGED).promise():(e.batchOperation(function(){r.matches.reverse().forEach(function(t){t.isChecked&&e.replaceRange(o?n(i,t.result):i,t.start,t.end)})}),(new $.Deferred).resolve().promise())}function o(e,r,i,o){var a=f.getFileForPath(e);return p.getDocumentText(a,!0).then(function(e,s,l){if(s.getTime()!==r.timestamp.getTime())return(new $.Deferred).reject(t.ERROR_FILE_CHANGED).promise();var c=[],u=0;r.matches.forEach(function(t){t.isChecked&&(c.push(e.slice(u,t.startOffset)),c.push(o?n(i,t.result):i),u=t.endOffset)}),c.push(e.slice(u));var p=c.join("");return l===m.LINE_ENDINGS_CRLF&&(p=p.replace(/\n/g,"\r\n")),d.promisify(a,"write",p)})}function a(e,t,n,r){var a=p.getOpenDocumentForPath(e);return r=r||{},a||!r.forceFilesOpen&&-1===h.findInWorkingSet(h.ALL_PANES,e)?a?i(a,t,n,r.isRegexp):o(e,t,n,r.isRegexp):p.getDocumentForPath(e).then(function(e){return i(e,t,n,r.isRegexp)})}function s(e){return e.matches.some(function(e){return e.isChecked})}function l(e,t,n){return d.doInParallel_aggregateErrors(Object.keys(e),function(r){return a(r,e[r],t,n)}).done(function(){if(n&&n.forceFilesOpen){var t=p.getCurrentDocument();if(!t||!e[t.file.fullPath]||!s(e[t.file.fullPath])){var r=Object.keys(e).sort(m.comparePaths),i=E.find(r,function(t){return s(e[t])});if(i){var o=p.getOpenDocumentForPath(i);o&&h._edit(h.ACTIVE_PANE,o)}}}})}function c(e){return e?_.format(y.FIND_IN_FILES_SCOPED,_.breakableUrl(v.makeProjectRelativeIfPossible(e.fullPath))):y.FIND_IN_FILES_NO_SCOPE}function u(e){var t;if(!e||!e.query)return{empty:!0};var n="gm";if(e.isCaseSensitive||(n+="i"),e.isRegexp)try{t=new RegExp(e.query,n)}catch(r){return{valid:!1,error:r.message}}else t=new RegExp(_.regexEscape(e.query),n);return{valid:!0,queryExpr:t}}var d=e("utils/Async"),p=e("document/DocumentManager"),h=e("view/MainViewManager"),f=e("filesystem/FileSystem"),m=e("file/FileUtils"),g=e("search/FindBar").FindBar,v=e("project/ProjectManager"),y=e("strings"),_=e("utils/StringUtils"),E=e("thirdparty/lodash");t.parseDollars=n,t.getInitialQuery=r,t.hasCheckedMatches=s,t.performReplacements=l,t.labelForScope=c,t.parseQueryInfo=u,t.ERROR_FILE_CHANGED="fileChanged"}),define("search/SearchModel",["require","exports","module","file/FileUtils","utils/EventDispatcher","search/FindUtils"],function(e,t){"use strict";function n(){this.clear()}var r=e("file/FileUtils"),i=e("utils/EventDispatcher"),o=e("search/FindUtils");i.makeEventDispatcher(n.prototype),n.MAX_TOTAL_RESULTS=1e5,n.prototype.results=null,n.prototype.queryInfo=null,n.prototype.queryExpr=null,n.prototype.isReplace=!1,n.prototype.replaceText=null,n.prototype.scope=null,n.prototype.filter=null,n.prototype.numMatches=0,n.prototype.foundMaximum=!1,n.prototype.exceedsMaximum=!1,n.prototype.clear=function(){this.results={},this.queryInfo=null,this.queryExpr=null,this.isReplace=!1,this.replaceText=null,this.scope=null,this.numMatches=0,this.foundMaximum=!1,this.exceedsMaximum=!1,this.fireChanged()},n.prototype.setQueryInfo=function(e){var t=o.parseQueryInfo(e);return t.valid?(this.queryInfo=e,this.queryExpr=t.queryExpr,!0):!1},n.prototype.setResults=function(e,t){this.removeResults(e),!this.foundMaximum&&t.matches.length&&(t.collapsed=!!t.collapsed,this.results[e]=t,this.numMatches+=t.matches.length,this.numMatches>=n.MAX_TOTAL_RESULTS&&(this.foundMaximum=!0,this.numMatches>n.MAX_TOTAL_RESULTS&&(this.results[e].matches.pop(),this.numMatches--,this.exceedsMaximum=!0)))},n.prototype.removeResults=function(e){this.results[e]&&(this.numMatches-=this.results[e].matches.length,delete this.results[e])},n.prototype.hasResults=function(){return Object.keys(this.results).length>0},n.prototype.countFilesMatches=function(){return{files:Object.keys(this.results).length,matches:this.numMatches}},n.prototype.getSortedFiles=function(e){return Object.keys(this.results).sort(function(t,n){return e===t?-1:e===n?1:r.comparePaths(t,n)})},n.prototype.fireChanged=function(e){this.trigger("change",e)},t.SearchModel=n}),define("search/FindInFiles",["require","exports","module","thirdparty/lodash","search/FileFilters","utils/Async","utils/StringUtils","project/ProjectManager","document/Document","document/DocumentManager","view/MainViewManager","filesystem/FileSystem","language/LanguageManager","search/SearchModel","utils/PerfUtils","search/FindUtils"],function(e,t){"use strict";function n(){I.off("documentChange",m),D.off("change",g),w.off("fileNameChange",v)}function r(){x.hasResults()&&(n(),I.on("documentChange",m),D.on("change",g),w.on("fileNameChange",v))}function i(e,t){if(x.foundMaximum||-1===e.search(t))return[];for(var n,r,i,o,a,s,l,c,u,d,p,h,f,m,g=b.getLines(e),v=[];null!==(n=t.exec(e));){if(r=b.offsetToLineNum(g,n.index),i=g[r],o=n.index-e.lastIndexOf("\n",n.index)-1,s=n[0].split("\n"),l=s.length,a=n[0].length,c=s[s.length-1].length,u=1===l?o+a:c,m=1===l?u:i.length,f=0,N>=m?i=i.substr(0,Math.min(N,i.length)):a>N?(i=i.substr(o,o+N),f=o):(d=N-a,h=Math.floor(Math.min(d/2,i.length-m)),p=Math.ceil(d-h),f=o-p,i=i.substring(f,m+h)),v.push({start:{line:r,ch:o},end:{line:r+l-1,ch:u},highlightOffset:f,startOffset:n.index,endOffset:n.index+a,line:i,result:n,isChecked:!0}),v.length>O.MAX_TOTAL_RESULTS){t.lastIndex=0;break}0===a&&t.lastIndex++}return v}function o(e,t){var n,r,o,a,s,l,c=!1,u=e.file.fullPath,d=x.results[u];x.removeResults(u),t.forEach(function(t){if(a=[],s=0,l=0,t.from&&t.to){for(n=0;n<t.text.length;n++)a.push(e.getLine(t.from.line+n));r=a.length-1-(t.to.line-t.from.line),d&&(d.matches.forEach(function(e){e.end.line<t.from.line?s++:e.end.line<=t.to.line?l++:(e.start.line+=r,e.end.line+=r)}),l>0&&d.matches.splice(s,l),c=!0),o=i(a.join("\r\n"),x.queryExpr),o.length&&(o.forEach(function(e,n){o[n].start.line+=t.from.line,o[n].end.line+=t.from.line}),d?Array.prototype.splice.apply(d.matches,[s,0].concat(o)):d={matches:o,collapsed:!1,timestamp:e.diskTimestamp},c=!0)}else d={matches:i(e.getText(),x.queryExpr),timestamp:e.diskTimestamp},c=!0}),d&&d.matches.length&&x.setResults(u,d),c&&x.fireChanged(!0)}function a(e,t){return t?t.isDirectory?0===e.fullPath.indexOf(t.fullPath):e.fullPath===t.fullPath:!0}function s(e){return!T.getLanguageForPath(e).isBinary()}function l(e){function t(t){return a(t,e)&&s(t.fullPath)}return e&&e.isFile?(new $.Deferred).resolve(t(e)?[e]:[]).promise():S.getAllFiles(t,!0)}function c(e){if(x&&x.scope){if(!a(e,x.scope))return!1}else if(0!==e.fullPath.indexOf(S.getProjectRoot().fullPath)&&-1===C.findInWorkingSet(C.ALL_PANES,e.fullPath))return!1;return s(e.fullPath)?_.filterPath(x.filter,e.fullPath):!1}function u(e){var t=new $.Deferred;return w.getDocumentText(e).done(function(n,r){var o=i(n,x.queryExpr);x.setResults(e.fullPath,{matches:o,timestamp:r}),t.resolve(!!o.length)}).fail(function(){t.resolve(!1)}),t.promise()}function d(e,n,i){x.filter=i;var o=x.setQueryInfo(e);if(!o)return null;var a=x.scope?x.scope.fullPath:S.getProjectRoot().fullPath,s=M.markStart("FindIn: "+a+" - "+e.query);return n.then(function(e){return e=_.filterFileList(i,e),e.length?E.doInParallel(e,u):R}).then(function(e){return t._searchDone=!0,M.addMeasurement(s),r(),e===R?e:x.results},function(e){return console.log("find in files failed: ",e),M.finalizeMeasurement(s),e})}function p(){n(),x.clear()}function h(e,t,n,r,i){return p(),x.scope=t,void 0!==r&&(x.isReplace=!0,x.replaceText=r),i=i||l(t),d(e,i,n)}function f(e,n,r){return L.performReplacements(e,n,r).always(function(){t._replaceDone=!0})}var m,g,v,y=e("thirdparty/lodash"),_=e("search/FileFilters"),E=e("utils/Async"),b=e("utils/StringUtils"),S=e("project/ProjectManager"),I=e("document/Document"),w=e("document/DocumentManager"),C=e("view/MainViewManager"),D=e("filesystem/FileSystem"),T=e("language/LanguageManager"),O=e("search/SearchModel").SearchModel,M=e("utils/PerfUtils"),L=e("search/FindUtils"),R={},N=200,x=new O;m=function(e,t,n){c(t.file)&&o(t,n)},v=function(e,t,n){var r=!1;y.forEach(x.results,function(e,i){0===i.indexOf(t)&&(x.removeResults(i),x.setResults(i.replace(t,n),e),r=!0)}),r&&x.fireChanged()},g=function(e,t,n,r){function i(e){Object.keys(x.results).forEach(function(t){(t===e.fullPath||e.isDirectory&&0===t.indexOf(e.fullPath))&&(x.removeResults(t),a=!0)})}function o(e){var t=[],n=new $.Deferred,r=function(e){return S.shouldShow(e)?(e.isFile&&s(e.name)&&c(e)&&t.push(e),!0):!1};return e.visit(r,function(e){return e?void n.reject(e):void E.doInParallel(t,function(e){return u(e).done(function(e){a=a||e})}).always(n.resolve)}),n.promise()}var a=!1;if(t){var l;if(t.isDirectory)if(n&&r)r.forEach(i),l=E.doInParallel(n,o);else{i(t);var d=$.Deferred();l=d.promise(),t.getContents(function(e,t){E.doInParallel(t,o).always(d.resolve)})}else i(t),l=o(t);l.always(function(){a&&x.fireChanged()})}},t.searchModel=x,t.doSearchInScope=h,t.doReplace=f,t.getCandidateFiles=l,t.clearSearch=p,t.ZERO_FILES_TO_SEARCH=R,t._documentChangeHandler=m,t._fileNameChangeHandler=v,t._fileSystemChangeHandler=g}),define("text!htmlContent/search-panel.html",[],function(){return'<div id="{{panelID}}" class="search-results bottom-panel vert-resizable top-resizer no-focus">\n    <div class="toolbar simple-toolbar-layout">\n        <div class="title"></div>\n        <a href="#" class="close">&times;</a>\n    </div>\n    <div class="table-container resizable-content"></div>\n</div>\n'}),define("text!htmlContent/search-results.html",[],function(){return'<table class="bottom-panel-table table table-striped table-condensed row-highlight">\n    <tbody>\n        {{#searchList}}\n        <tr class="file-section" data-file-index="{{fileIndex}}">\n            {{#replace}}<td class="checkbox-column"><input type="checkbox" class="check-one-file" {{#isChecked}}checked="true"{{/isChecked}} /></td>{{/replace}}\n            <td colspan="2">\n                <span class="disclosure-triangle {{^isCollapsed}}expanded{{/isCollapsed}}" title="{{Strings.FIND_IN_FILES_EXPAND_COLLAPSE}}"></span>\n                {{{filename}}}\n            </td>\n        </tr>\n        {{#items}}\n        <tr data-file-index="{{fileIndex}}" data-item-index="{{itemIndex}}" data-match-index="{{matchIndex}}" {{#isCollapsed}}style="display:none;"{{/isCollapsed}}>\n            {{#replace}}<td class="checkbox-column"><input type="checkbox" class="check-one" {{#isChecked}}checked="true"{{/isChecked}} /></td>{{/replace}}\n            <td class="line-number">{{line}}</td>\n            <td class="line-text">{{pre}}<span class="highlight">{{highlight}}</span>{{post}}</td>\n        </tr>\n        {{/items}}\n        {{/searchList}}\n    </tbody>\n</table>\n'}),define("text!htmlContent/search-summary.html",[],function(){return'{{#replace}}\n<div class="fixed-col"><input type="checkbox" class="check-all" {{#allChecked}}checked="checked"{{/allChecked}} /></div>\n{{/replace}}\n<div class="fixed-col">{{titleLabel}} &quot;</div>\n<div class="contracting-col">{{query}}</div>\n<div class="fixed-col">&quot;</div>\n{{#replace}}\n<div class="fixed-col">&nbsp;{{Strings.FIND_REPLACE_TITLE_WITH}} &quot;</div>\n<div class="contracting-col">{{replaceWith}}</div>\n<div class="fixed-col">&quot;</div>\n{{/replace}}\n{{#scope}}\n<div class="contracting-col">{{{scope}}}</div>\n{{/scope}}\n<div class="fixed-col">&nbsp;{{{summary}}}</div>\n{{#hasPages}}\n<div class="pagination-col">\n    <span class="first-page {{^hasPrev}}disabled{{/hasPrev}}"></span>\n    <span class="prev-page {{^hasPrev}}disabled{{/hasPrev}}"></span>\n    {{{results}}}\n    <span class="next-page {{^hasNext}}disabled{{/hasNext}}"></span>\n    <span class="last-page {{^hasNext}}disabled{{/hasNext}}"></span>\n</div>\n{{/hasPages}}\n{{#replace}}\n<div class="replace-col">\n    <button class="btn small replace-checked">{{Strings.BUTTON_REPLACE}}</button>\n</div>\n{{/replace}}'}),define("search/SearchResultsView",["require","exports","module","command/CommandManager","utils/EventDispatcher","command/Commands","document/DocumentManager","editor/EditorManager","project/ProjectManager","project/FileViewController","file/FileUtils","search/FindUtils","view/WorkspaceManager","utils/StringUtils","strings","thirdparty/lodash","text!htmlContent/search-panel.html","text!htmlContent/search-results.html","text!htmlContent/search-summary.html"],function(e,t){"use strict";function n(e,t,n){var r=Mustache.render(g,{panelID:t});this._panel=p.createBottomPanel(n,$(r),100),this._$summary=this._panel.$panel.find(".title"),this._$table=this._panel.$panel.find(".table-container"),this._model=e}var r=e("command/CommandManager"),i=e("utils/EventDispatcher"),o=e("command/Commands"),a=e("document/DocumentManager"),s=e("editor/EditorManager"),l=e("project/ProjectManager"),c=e("project/FileViewController"),u=e("file/FileUtils"),d=e("search/FindUtils"),p=e("view/WorkspaceManager"),h=e("utils/StringUtils"),f=e("strings"),m=e("thirdparty/lodash"),g=e("text!htmlContent/search-panel.html"),v=e("text!htmlContent/search-results.html"),y=e("text!htmlContent/search-summary.html"),_=100,E=400;i.makeEventDispatcher(n.prototype),n.prototype._model=null,n.prototype._searchList=[],n.prototype._panel=null,n.prototype._initialFilePath=null,n.prototype._currentStart=0,n.prototype._allChecked=!1,n.prototype._$selectedRow=null,n.prototype._$summary=null,n.prototype._$table=null,n.prototype._timeoutID=null,n.prototype._handleModelChange=function(e){if(this._model.isReplace)return void this.close();var t=this;this._timeoutID&&window.clearTimeout(this._timeoutID),e?this._timeoutID=window.setTimeout(function(){t._updateResults(),t._timeoutID=null},E):this._updateResults()},n.prototype._addPanelListeners=function(){function e(e){var t=n._panel.$panel.find(".file-section"),r=t.filter(function(){return $(this).find(".check-one-file").is(":checked")});r.length===t.length&&e.prop("checked",!0)}function t(t,r){var i=0===t.data("item-index")?t:t.prevUntil(".file-section").last(),o=i.prev(),a=o.nextUntil(".file-section"),s=o.find(".check-one-file"),l=n._panel.$panel.find(".check-all");if(r){if(!s.is(":checked")){var c=a.filter(function(){return $(this).find(".check-one").is(":checked")});c.length===a.length&&(s.prop("checked",!0),l.is(":checked")||e(l))}}else l.is(":checked")&&l.prop("checked",!1),s.is(":checked")&&s.prop("checked",!1)}var n=this;this._panel.$panel.off(".searchResults").on("click.searchResults",".close",function(){n.close()}).on("click.searchResults",".first-page:not(.disabled)",function(){n._currentStart=0,n._render()}).on("click.searchResults",".prev-page:not(.disabled)",function(){n._currentStart-=_,n._render()}).on("click.searchResults",".next-page:not(.disabled)",function(){n._currentStart+=_,n._render()}).on("click.searchResults",".last-page:not(.disabled)",function(){n._currentStart=n._getLastCurrentStart(),n._render()}).on("dblclick.searchResults",".table-container tr:not(.file-section)",function(){var e=n._searchList[$(this).data("file-index")];c.openFileAndAddToWorkingSet(e.fullPath)}).on("click.searchResults .table-container",function(e){var t=$(e.target).closest("tr");if(t.length){n._$selectedRow&&n._$selectedRow.removeClass("selected"),t.addClass("selected"),n._$selectedRow=t;var i=n._searchList[t.data("file-index")],a=i.fullPath;if(t.hasClass("file-section")){var l,c=!n._model.results[a].collapsed;l=e.metaKey||e.ctrlKey?$(e.target).closest("table").find(".file-section"):t,l.each(function(){a=n._searchList[$(this).data("file-index")].fullPath,i=n._model.results[a],i.collapsed!==c&&(i.collapsed=c,$(this).nextUntil(".file-section").toggle(),$(this).find(".disclosure-triangle").toggleClass("expanded"))}),(e.metaKey||e.ctrlKey)&&m.forEach(n._model.results,function(e){e.collapsed=c})}else{var u=i.items[t.data("item-index")];r.execute(o.FILE_OPEN,{fullPath:a}).done(function(){s.getCurrentFullEditor().setSelection(u.start,u.end,!0)})}}}),this._model.isReplace&&this._panel.$panel.on("click.searchResults",".check-all",function(){var e=$(this).is(":checked");m.forEach(n._model.results,function(t){t.matches.forEach(function(t){t.isChecked=e})}),n._$table.find(".check-one").prop("checked",e),n._$table.find(".check-one-file").prop("checked",e),n._allChecked=e}).on("click.searchResults",".check-one-file",function(t){var r=$(this).is(":checked"),i=$(t.target).closest("tr"),o=n._searchList[i.data("file-index")],a=i.nextUntil(".file-section"),s=n._panel.$panel.find(".check-all");
o&&n._model.results[o.fullPath].matches.forEach(function(e){e.isChecked=r}),a.find(".check-one").prop("checked",r),r?s.is(":checked")||e(s):s.is(":checked")&&s.prop("checked",!1),t.stopPropagation()}).on("click.searchResults",".check-one",function(e){var r=$(e.target).closest("tr"),i=n._searchList[r.data("file-index")],o=n._model.results[i.fullPath].matches[r.data("match-index")];o.isChecked=$(this).is(":checked"),t(r,o.isChecked),e.stopPropagation()}).on("click.searchResults",".replace-checked",function(){n.trigger("replaceAll")})},n.prototype._showSummary=function(){var e,t,n=this._model.countFilesMatches(),r=this._getLastIndex(n.matches);e=h.format(f.FIND_NUM_FILES,n.files,n.files>1?f.FIND_IN_FILES_FILES:f.FIND_IN_FILES_FILE),t=h.format(f.FIND_TITLE_SUMMARY,this._model.exceedsMaximum?f.FIND_IN_FILES_MORE_THAN:"",String(n.matches),n.matches>1?f.FIND_IN_FILES_MATCHES:f.FIND_IN_FILES_MATCH,e),this._$summary.html(Mustache.render(y,{query:this._model.queryInfo.query&&this._model.queryInfo.query.toString()||"",replaceWith:this._model.replaceText,titleLabel:this._model.isReplace?f.FIND_REPLACE_TITLE_LABEL:f.FIND_TITLE_LABEL,scope:this._model.scope?"&nbsp;"+d.labelForScope(this._model.scope)+"&nbsp;":"",summary:t,allChecked:this._allChecked,hasPages:n.matches>_,results:h.format(f.FIND_IN_FILES_PAGING,this._currentStart+1,r),hasPrev:this._currentStart>0,hasNext:r<n.matches,replace:this._model.isReplace,Strings:f}))},n.prototype._render=function(){var e,t,n,r,i,o=this._model.countFilesMatches(),a=this._model.getSortedFiles(this._initialFilePath),s=this._getLastIndex(o.matches),c=0,d=!1,p=!0,m=this;this._showSummary(),this._searchList=[],a.some(function(o){if(d=!0,r=m._model.results[o],c+r.matches.length<m._currentStart)c+=r.matches.length,d=!1;else if(c<m._currentStart)n=m._currentStart-c,c=m._currentStart;else{if(!(s>c))return!0;n=0}if(d&&n<r.matches.length){for(e=[],p=!0;n<r.matches.length&&s>c;)t=r.matches[n],i=t.start.line!==t.end.line,e.push({fileIndex:m._searchList.length,itemIndex:e.length,matchIndex:n,line:t.start.line+1,pre:t.line.substr(0,t.start.ch-t.highlightOffset),highlight:t.line.substring(t.start.ch-t.highlightOffset,i?void 0:t.end.ch-t.highlightOffset),post:i?"…":t.line.substr(t.end.ch-t.highlightOffset),start:t.start,end:t.end,isChecked:t.isChecked,isCollapsed:r.collapsed}),t.isChecked||(p=!1),c++,n++;var a=u.getDirectoryPath(l.makeProjectRelativeIfPossible(o)),g=u.getDirectoryPath(a),v=h.format(f.FIND_IN_FILES_FILE_PATH,h.breakableUrl(u.getBaseName(o)),h.breakableUrl(g),g?"&mdash;":"");m._searchList.push({fileIndex:m._searchList.length,filename:v,fullPath:o,isChecked:p,items:e,isCollapsed:r.collapsed})}}),this._$table.empty().append(Mustache.render(v,{replace:this._model.isReplace,searchList:this._searchList,Strings:f})),this._$selectedRow&&(this._$selectedRow.removeClass("selected"),this._$selectedRow=null),this._panel.show(),this._$table.scrollTop(0)},n.prototype._updateResults=function(){if(this._panel.isVisible()){var e=this._$table.scrollTop(),t=this._$selectedRow?this._$selectedRow.index():null,n=this._model.countFilesMatches().matches;this._currentStart>n&&(this._currentStart=this._getLastCurrentStart(n)),this._render(),this._$table.scrollTop(e),t&&(this._$selectedRow=this._$table.find("tr:eq("+t+")"),this._$selectedRow.addClass("selected"))}},n.prototype._getLastIndex=function(e){return Math.min(this._currentStart+_,e)},n.prototype._getLastCurrentStart=function(e){return e=e||this._model.countFilesMatches().matches,Math.floor((e-1)/_)*_},n.prototype.open=function(){this._currentStart=0,this._$selectedRow=null,this._allChecked=!0;var e=a.getCurrentDocument();this._initialFilePath=e?e.file.fullPath:null,this._render(),this._addPanelListeners(),this._model.on("change.SearchResultsView",this._handleModelChange.bind(this))},n.prototype.close=function(){this._panel&&this._panel.isVisible()&&(this._$table.empty(),this._panel.hide(),this._panel.$panel.off(".searchResults"),this._model.off("change.SearchResultsView"),this.trigger("close"))},t.SearchResultsView=n}),define("search/FindInFilesUI",["require","exports","module","utils/AppInit","command/CommandManager","command/Commands","widgets/Dialogs","widgets/DefaultDialogs","editor/EditorManager","view/WorkspaceManager","search/FileFilters","file/FileUtils","search/FindBar","search/FindInFiles","search/FindUtils","document/InMemoryFile","project/ProjectManager","search/SearchResultsView","widgets/StatusBar","strings","utils/StringUtils","thirdparty/lodash"],function(e,t){"use strict";function n(e,t,n,r,i){return _.doSearchInScope(e,t,n,r,i).done(function(e){if(_.searchModel.hasResults())M.open(),L&&L.close();else if(M.close(),L){var t=!1;L.enable(!0),L.focusQuery(),e===_.ZERO_FILES_TO_SEARCH?L.showError(D.format(C.FIND_IN_FILES_ZERO_FILES,E.labelForScope(_.searchModel.scope)),!0):t=!0,L.showNoResults(!0,t)}w.hideBusyIndicator()}).fail(function(e){console.log("find in files failed: ",e),w.hideBusyIndicator()})}function r(e,t){function r(){var e=L.getQueryInfo(),t=E.parseQueryInfo(e);L.enableReplace(t.valid),t.valid||t.empty?(L.showNoResults(!1),L.showError(null)):(L.showNoResults(!0,!1),L.showError(t.error))}function i(t){var r=L.getQueryInfo();if(r&&r.query){L.enable(!1),w.showBusyIndicator(!0);var i;i=l?g.commitPicker(l):null,n(r,e,i,t,c)}return null}function o(){i(L.getReplaceText())}if(!e||f.canOpenPath(e.fullPath)){if(e instanceof b)return void u.execute(d.FILE_OPEN,{fullPath:e.fullPath}).done(function(){u.execute(d.CMD_FIND)});var a=f.getActiveEditor(),s=E.getInitialQuery(L,a);L&&L.close(),L=new y({multifile:!0,replace:t,initialQuery:s.query,initialReplaceText:s.replaceText,queryPlaceholder:C.FIND_QUERY_PLACEHOLDER,scopeLabel:E.labelForScope(e)}),L.open(),L._modalBar.isLockedOpen=function(){return!L.isEnabled()||$(".modal.instance .exclusions-editor").length>0};var l,c=_.getCandidateFiles(e);L.on("doFind.FindInFiles",function(){i()}).on("queryChange.FindInFiles",r).on("close.FindInFiles",function(){L.off(".FindInFiles"),L=null}),t&&L.on("doReplaceAll.FindInFiles",o);var p=L._modalBar.height();if(!e||e.isDirectory){var h={label:E.labelForScope(e),promise:c};l=g.createFilterPicker(h),L._modalBar.getRoot().find(".scope-group").append(l)}r();var v,S=f.getCurrentFullEditor();S&&(v=S.getScrollPos(),v.y-=p),m.recomputeLayout(),S&&S._codeMirror.scrollTo(v.x,v.y+L._modalBar.height())}}function i(e){function t(e){w.showBusyIndicator(!0),_.doReplace(r,n,{forceFilesOpen:e,isRegexp:o}).fail(function(e){var t=C.REPLACE_IN_FILES_ERRORS+v.makeDialogFileList(e.map(function(e){return S.makeProjectRelativeIfPossible(e.item)}));p.showModalDialog(h.DIALOG_ID_ERROR,C.REPLACE_IN_FILES_ERRORS_TITLE,t,[{className:p.DIALOG_BTN_CLASS_PRIMARY,id:p.DIALOG_BTN_OK,text:C.BUTTON_REPLACE_WITHOUT_UNDO}])}).always(function(){w.hideBusyIndicator()})}var n=e.replaceText;if(null!==n){var r=T.cloneDeep(e.results),i=Object.keys(r).filter(function(e){return E.hasCheckedMatches(r[e])}),o=e.queryInfo.isRegexp;i.length<=O?(M.close(),t(!0)):p.showModalDialog(h.DIALOG_ID_INFO,C.REPLACE_WITHOUT_UNDO_WARNING_TITLE,D.format(C.REPLACE_WITHOUT_UNDO_WARNING,O),[{className:p.DIALOG_BTN_CLASS_NORMAL,id:p.DIALOG_BTN_CANCEL,text:C.CANCEL},{className:p.DIALOG_BTN_CLASS_PRIMARY,id:p.DIALOG_BTN_OK,text:C.BUTTON_REPLACE_WITHOUT_UNDO}]).done(function(e){e===p.DIALOG_BTN_OK&&(M.close(),t(!1))})}}function o(){r(null,!0)}function a(){var e=S.getSelectedItem();r(e)}function s(){var e=S.getSelectedItem();r(e,!0)}function l(){L&&L.close()}var c=e("utils/AppInit"),u=e("command/CommandManager"),d=e("command/Commands"),p=e("widgets/Dialogs"),h=e("widgets/DefaultDialogs"),f=e("editor/EditorManager"),m=e("view/WorkspaceManager"),g=e("search/FileFilters"),v=e("file/FileUtils"),y=e("search/FindBar").FindBar,_=e("search/FindInFiles"),E=e("search/FindUtils"),b=e("document/InMemoryFile"),S=e("project/ProjectManager"),I=e("search/SearchResultsView").SearchResultsView,w=e("widgets/StatusBar"),C=e("strings"),D=e("utils/StringUtils"),T=e("thirdparty/lodash"),O=20,M=null,L=null;c.htmlReady(function(){var e=_.searchModel;M=new I(e,"find-in-files-results","find-in-files.results"),M.on("replaceAll",function(){i(e)}).on("close",function(){_.clearSearch()})}),S.on("beforeProjectClose",function(){M.close()}),u.register(C.CMD_FIND_IN_FILES,d.CMD_FIND_IN_FILES,r),u.register(C.CMD_FIND_IN_SELECTED,d.CMD_FIND_IN_SELECTED,a),u.register(C.CMD_FIND_IN_SUBTREE,d.CMD_FIND_IN_SUBTREE,a),u.register(C.CMD_REPLACE_IN_FILES,d.CMD_REPLACE_IN_FILES,o),u.register(C.CMD_REPLACE_IN_SELECTED,d.CMD_REPLACE_IN_SELECTED,s),u.register(C.CMD_REPLACE_IN_SUBTREE,d.CMD_REPLACE_IN_SUBTREE,s),t.searchAndShowResults=n,t._showFindBar=r,t._closeFindBar=l}),define("search/ScrollTrackMarkers",["require","exports","module","thirdparty/lodash","view/WorkspaceManager"],function(e,t){"use strict";function n(e){return $(e.getRootElement()).children(".CodeMirror-vscrollbar")}function r(){var e=n(u);if(p=e[0].offsetHeight,p>0)d="win"===brackets.platform?0:"mac"===brackets.platform?4:2,p-=2*d;else{var t=$(u.getRootElement()).find("> .CodeMirror-scroll > .CodeMirror-sizer > div > .CodeMirror-lines > div")[0];p=t.offsetHeight,d=t.offsetTop}}function i(e){var t="";e.forEach(function(e){var n=Math.round(e.line/u.lineCount()*p)+d;n--,t+="<div class='tickmark' style='top:"+n+"px'></div>"}),$(".tickmark-track",u.getRootElement()).append($(t))}function o(){u&&($(".tickmark-track",u.getRootElement()).empty(),g=[],h=null)}function a(e,t){if(!(t&&e===u||!t&&!u))if(t){if(console.assert(!u),u=e,u.isTextSubset())return;var o=n(u),a=$("<div class='tickmark-track'></div>");o.parent().append(a),r(),m.on("workspaceUpdateLayout.ScrollTrackMarkers",f.debounce(function(){g.length&&(r(),$(".tickmark-track",u.getRootElement()).empty(),i(g))},300))}else console.assert(u===e),$(".tickmark-track",e.getRootElement()).remove(),u=null,g=[],m.off("workspaceUpdateLayout.ScrollTrackMarkers")}function s(e,t){console.assert(u===e),g=g.concat(t),i(t)}function l(e){h&&(h.removeClass("tickmark-current"),h=null),-1!==e&&(h=$(".tickmark-track > .tickmark",u.getRootElement()).eq(e).addClass("tickmark-current"))}function c(){return g}var u,d,p,h,f=e("thirdparty/lodash"),m=e("view/WorkspaceManager"),g=[];t._getTickmarks=c,t.clear=o,t.setVisible=a,t.addTickmarks=s,t.markCurrent=l}),define("search/FindReplace",["require","exports","module","command/CommandManager","command/Commands","view/MainViewManager","strings","utils/StringUtils","editor/Editor","editor/EditorManager","search/FindBar","search/FindUtils","search/FindInFilesUI","search/ScrollTrackMarkers","thirdparty/lodash","thirdparty/CodeMirror2/lib/codemirror"],function(e,t){"use strict";function n(){this.searchStartPos=null,this.parsedQuery=null,this.queryInfo=null,this.foundAny=!1,this.marked=[],this.resultSet=[],this.matchIndex=-1,this.markedCurrent=null}function r(e){return e._searchState||(e._searchState=new n),e._searchState}function i(e,t,n){return e.getSearchCursor(t.parsedQuery,n,!t.queryInfo.isCaseSensitive)}function o(e){if(R&&R.showError(null),!e||!e.query)return"";if(!e.isRegexp)return e.query;try{return new RegExp(e.query,e.isCaseSensitive?"":"i")}catch(t){return R&&R.showError(t.message),""}}function a(e,t){e.queryInfo=t,e.parsedQuery=t?o(t):null}function s(e,t,n){e.foundAny&&R&&(-1===e.matchIndex?e.matchIndex=W.findIndex(e.resultSet,t):(e.matchIndex=n?e.matchIndex-1:e.matchIndex+1,e.matchIndex=(e.matchIndex+e.resultSet.length)%e.resultSet.length,W.isEqual(e.resultSet[e.matchIndex],t)||(e.matchIndex=W.findIndex(e.resultSet,t))),console.assert(-1!==e.matchIndex),-1!==e.matchIndex&&R.showFindCount(k.format(P.FIND_MATCH_INDEX,e.matchIndex+1,e.resultSet.length)))}function l(e,t,n,o){var a=e._codeMirror,s=r(a),l=i(a,s,n||e.getCursorPos(!1,t?"start":"end"));return s.lastMatch=l.find(t),s.lastMatch||o===!1||(l=i(a,s,t?{line:a.lineCount()-1}:{line:0,ch:0}),s.lastMatch=l.find(t)),s.lastMatch?{start:l.from(),end:l.to()}:(a.setCursor(e.getCursorPos()),null)}function c(e,t,n,r){var i=W.find(t,function(e){return e.primary})||W.last(t),o=e.isLineVisible(i.start.line),a=F.BOUNDARY_CHECK_NORMAL;r&&o&&(a=F.BOUNDARY_IGNORE_TOP);var s=W.find(t,function(e){return e.primary});s||(s=W.last(t)),e._codeMirror.scrollIntoView({from:s.start,to:s.end}),e.setSelections(t,n,a)}function u(e,t){for(var n=e._codeMirror,r=t.ch,i=r,o=n.getLine(t.line);r&&G.isWordChar(o.charAt(r-1));)--r;for(;i<o.length&&G.isWordChar(o.charAt(i));)++i;return{start:{line:t.line,ch:r},end:{line:t.line,ch:i},text:o.slice(r,i)}}function d(e,t){return 0===G.cmpPos(e.start,t.start)&&0===G.cmpPos(e.end,t.end)}function p(e,t){if(e=e||U.getActiveEditor()){var n,i,o,s=e.getSelections(),p=!1;if(W.each(s,function(r,a){var s=0===G.cmpPos(r.start,r.end);if(r.primary&&(n=r,i=a,s||(o=e.document.getRange(n.start,n.end))),s){var l=u(e,r.start);r.start=l.start,r.end=l.end,r.primary&&t&&(o=l.text)}}),o&&o.length){var h=r(e._codeMirror);a(h,{query:o,isCaseSensitive:!1,isRegexp:!1});var f,m,g=n.end;do if(f=l(e,!1,g),f&&(m=W.find(s,W.partial(d,f)),g=f.end,0===G.cmpPos(g,n.end))){f=null;break}while(f&&m);f&&(f.primary=!0,s.push(f),p=!0)}t&&s.splice(i,1),p?c(e,s,!0,!0):c(e,s,!1)}}function h(e){return p(e,!0)}function f(e){if(e=e||U.getActiveEditor()){var t=e.getSelection(),n=[];if(0===G.cmpPos(t.start,t.end)&&(t=u(e,t.start)),0!==G.cmpPos(t.start,t.end)){var i,o={line:0,ch:0},s=r(e._codeMirror);for(a(s,{query:e.document.getRange(t.start,t.end),isCaseSensitive:!1,isRegexp:!1});null!==(i=l(e,!1,o,!1));)d(t,i)&&(i.primary=!0),n.push(i),o=i.end;n.length&&e.setSelections(n,!1)}}}function m(e,t){t.markedCurrent&&(t.markedCurrent.clear(),H.markCurrent(-1))}function g(e,t,n,i){var o=e._codeMirror;o.operation(function(){var a=r(o);m(o,a);var u=l(e,t,i);if(u){if(a.resultSet.length&&(s(a,{from:u.start,to:u.end},t),a.marked.length&&H.markCurrent(a.matchIndex)),c(e,[u],!0,n),R&&!R.isClosed()){var d=a.marked.length?"searching-current-match":"CodeMirror-searching searching-current-match";a.markedCurrent=o.markText(u.start,u.end,{className:d,startStyle:"searching-first",endStyle:"searching-last"})}}else o.setCursor(e.getCursorPos())})}function v(e,t){e.operation(function(){t.marked.forEach(function(e){e.clear()}),m(e,t)}),t.marked.length=0,t.markedCurrent=null,H.clear(),t.resultSet=[],t.matchIndex=-1}function y(e){e.operation(function(){var t=r(e);t.parsedQuery&&(a(t,null),v(e,t))})}function _(e,t){t?$(e.getRootElement()).addClass("find-highlighting"):$(e.getRootElement()).removeClass("find-highlighting"),H.setVisible(e,t)}function E(e){function t(e){R.showNoResults(!o.foundAny&&R.getQueryInfo().query),R.enableNavigation(o.foundAny&&e>1),R.enableReplace(o.foundAny)}var n=e._codeMirror,o=r(n);n.operation(function(){if(o.marked&&v(n,o),!o.parsedQuery)return R.showFindCount(""),o.foundAny=!1,void t();var r=i(n,o);if(n.getValue().length<=K){for(o.resultSet=[];r.findNext();)o.resultSet.push(r.pos);if(o.resultSet.length<=q){_(e,!0),o.resultSet.forEach(function(e){o.marked.push(n.markText(e.from,e.to,{className:"CodeMirror-searching",startStyle:"searching-first",endStyle:"searching-last"}))});var a=o.resultSet.map(function(e){return e.from});H.addTickmarks(e,a)}0===o.resultSet.length&&R.showFindCount(P.FIND_NO_RESULTS),o.foundAny=o.resultSet.length>0,t(o.resultSet.length)}else R.showFindCount(""),o.foundAny=r.findNext(),t()})}function b(e,t,n){a(t,R.getQueryInfo()),E(e),t.parsedQuery?g(e,!1,!0,t.searchStartPos):n||e._codeMirror.setCursor(t.searchStartPos)}function S(e,t){var n=e._codeMirror,i=r(n);i.searchStartPos=e.getCursorPos(!1,"start");var o=V.getInitialQuery(R,e);R&&R.close(),R=new j({multifile:!1,replace:t,initialQuery:o.query,initialReplaceText:o.replaceText,queryPlaceholder:P.FIND_QUERY_PLACEHOLDER}),R.open(),R.on("queryChange.FindReplace",function(){b(e,i)}).on("doFind.FindReplace",function(t,n){g(e,n)}).on("close.FindReplace",function(){v(n,i),_(e,!1),R.off(".FindReplace"),R=null}),b(e,i,!0)}function I(e,t){var n=r(e._codeMirror);return n.parsedQuery?void g(e,t):void S(e,!1)}function w(){R&&R.close()}function C(e,t){var n=e._codeMirror,i=r(n),o=R.getReplaceText();t?(R.close(),B.searchAndShowResults(i.queryInfo,e.document.file,null,o)):(n.replaceSelection(i.queryInfo.isRegexp?V.parseDollars(o,i.lastMatch):o),E(e),g(e),i.lastMatch||R.close())}function D(e){return R&&R.getOptions().replace&&R.isReplaceEnabled()?void C(e,!1):(S(e,!0),void R.on("doReplace.FindReplace",function(){C(e,!1)}).on("doReplaceAll.FindReplace",function(){C(e,!0)}))}function T(){var e=U.getActiveEditor();e&&(y(e._codeMirror),I(e,!1))}function O(){var e=U.getActiveEditor();e&&I(e)}function M(){var e=U.getActiveEditor();e&&I(e,!0)}function L(){var e=U.getActiveEditor();e&&D(e)}var R,N=e("command/CommandManager"),x=e("command/Commands"),A=e("view/MainViewManager"),P=e("strings"),k=e("utils/StringUtils"),F=e("editor/Editor"),U=e("editor/EditorManager"),j=e("search/FindBar").FindBar,V=e("search/FindUtils"),B=e("search/FindInFilesUI"),H=e("search/ScrollTrackMarkers"),W=e("thirdparty/lodash"),G=e("thirdparty/CodeMirror2/lib/codemirror"),K=5e5,q=2e3;A.on("currentFileChange",w),N.register(P.CMD_FIND,x.CMD_FIND,T),N.register(P.CMD_FIND_NEXT,x.CMD_FIND_NEXT,O),N.register(P.CMD_REPLACE,x.CMD_REPLACE,L),N.register(P.CMD_FIND_PREVIOUS,x.CMD_FIND_PREVIOUS,M),N.register(P.CMD_FIND_ALL_AND_SELECT,x.CMD_FIND_ALL_AND_SELECT,f),N.register(P.CMD_ADD_NEXT_MATCH,x.CMD_ADD_NEXT_MATCH,p),N.register(P.CMD_SKIP_CURRENT_MATCH,x.CMD_SKIP_CURRENT_MATCH,h),t._getWordAt=u,t._expandWordAndAddNextToSelection=p,t._findAllAndSelect=f}),define("text!htmlContent/install-extension-dialog.html",[],function(){return'<div class="install-extension-dialog modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">\n            {{#isUpdate}}{{Strings.UPDATE_EXTENSION_TITLE}}{{/isUpdate}}\n            {{^isUpdate}}{{Strings.INSTALL_EXTENSION_TITLE}}{{/isUpdate}}\n        </h1>\n    </div>\n    <div class="modal-body">\n        <div class="field-container input-field">\n            <input type="text" placeholder="{{INSTALL_EXTENSION_HINT}}" class="url" />\n        </div>\n        <div class="field-container message-field">\n            <div class="message"></div>\n        </div>\n    </div>\n    <div class="modal-footer">\n        {{#includeBrowseExtensions}}<button class="btn left browse-extensions">{{Strings.BROWSE_EXTENSIONS}}</button>{{/includeBrowseExtensions}}\n        <button class="dialog-button btn" data-button-id="cancel">{{Strings.CANCEL}}</button>\n        <button class="dialog-button btn primary" data-button-id="ok" disabled>{{Strings.INSTALL}}</button>\n    </div>\n</div>\n'}),define("extensibility/InstallExtensionDialog",["require","exports","module","widgets/Dialogs","filesystem/File","utils/StringUtils","strings","filesystem/FileSystem","utils/KeyEvent","extensibility/Package","utils/NativeApp","text!htmlContent/install-extension-dialog.html"],function(e,t){"use strict";function n(e,t){this._installer=e,this._state=g,this._installResult=null,this._isUpdate=t,this._cancelTimeout=1e4}function r(e){this._isLocalFile=e}function i(){var e=new n(new r);return e.show()}function o(e,t){var i=e instanceof l,o=new n(new r(i),t);return o.show(e.fullPath||e)}function a(e){return o(e,!0)}var s=e("widgets/Dialogs"),l=e("filesystem/File"),c=e("utils/StringUtils"),u=e("strings"),d=e("filesystem/FileSystem"),p=e("utils/KeyEvent"),h=e("extensibility/Package"),f=e("utils/NativeApp"),m=e("text!htmlContent/install-extension-dialog.html"),g=0,v=1,y=2,_=3,E=4,b=5,S=6,I=7,w=8,C=9,D=10,T=11;n.prototype.$dlg=null,n.prototype.$url=null,n.prototype.$okButton=null,n.prototype.$cancelButton=null,n.prototype.$inputArea=null,n.prototype.$msgArea=null,n.prototype.$msg=null,n.prototype.$browseExtensionsButton=null,n.prototype._dialogDeferred=null,n.prototype._installer=null,n.prototype._state=null,n.prototype._enterState=function(e){var t,n,r=this,i=this._state;switch(this._state=e,e){case v:this.$msg.find(".spinner").remove(),this.$msgArea.hide(),this.$inputArea.show(),this.$okButton.prop("disabled",!0).text(u.INSTALL);break;case y:this.$okButton.prop("disabled",!1);break;case _:t=this.$url.val().trim(),this.$inputArea.hide(),this.$browseExtensionsButton.hide(),this.$msg.text(c.format(u.INSTALLING_FROM,t)).append("<span class='spinner inline spin'/>"),this.$msgArea.show(),this.$okButton.prop("disabled",!0),this._installer.install(t).done(function(e){r._installResult=e,r._enterState(e.installationStatus===h.InstallationStatuses.ALREADY_INSTALLED||e.installationStatus===h.InstallationStatuses.OLDER_VERSION||e.installationStatus===h.InstallationStatuses.SAME_VERSION?C:e.installationStatus===h.InstallationStatuses.NEEDS_UPDATE?T:E)}).fail(function(e){"CANCELED"===e?(console.assert(r._state===S||r._state===I),r._enterState(w)):(r._errorMessage=h.formatError(e),r._enterState(b))});break;case S:this.$cancelButton.prop("disabled",!0),this.$msg.text(u.CANCELING_INSTALL),this._installer.cancel(),window.setTimeout(function(){r._state===S&&r._enterState(I)},this._cancelTimeout);break;case I:this.$msg.text(u.CANCELING_HUNG),this.$okButton.removeAttr("disabled").text(u.CLOSE);break;case E:case b:case w:case T:n=e===E?u.INSTALL_SUCCEEDED:e===b?u.INSTALL_FAILED:e===T?u.EXTENSION_UPDATE_INSTALLED:u.INSTALL_CANCELED,this.$msg.html($("<strong/>").text(n)),this._errorMessage&&this.$msg.append($("<p/>").text(this._errorMessage)),this.$okButton.removeAttr("disabled").text(u.CLOSE),this.$cancelButton.hide();break;case C:var o=this._installResult,a=o.installationStatus,l=u["EXTENSION_"+a];a===h.InstallationStatuses.OLDER_VERSION&&(l=c.format(l,o.metadata.version,o.installedVersion)),this.$msg.text(l),this.$okButton.prop("disabled",!1).text(u.OVERWRITE);break;case D:this._enterState(g);break;case g:$(document.body).off(".installDialog"),s.cancelModalDialogIfOpen("install-extension-dialog"),i===E||i===T||i===D?this._dialogDeferred.resolve(this._installResult):this._dialogDeferred.reject()}},n.prototype._handleCancel=function(){if(this._state===_)this._enterState(S);else if(this._state===C){if(this._installResult&&this._installResult.localPath&&!this._installResult.keepFile){var e=this._installResult.localPath;d.getFileForPath(e).unlink()}this._enterState(g)}else this._state!==S&&this._enterState(g)},n.prototype._handleOk=function(){this._state===E||this._state===b||this._state===w||this._state===I||this._state===T?this._enterState(g):this._state===y?this._enterState(_):this._state===C&&this._enterState(D)},n.prototype._handleKeyUp=function(e){e.keyCode===p.DOM_VK_ESCAPE&&this._handleCancel()},n.prototype._handleUrlInput=function(){var e=this.$url.val().trim(),t=""!==e;t||this._state!==y?t&&this._state===v&&this._enterState(y):this._enterState(v)},n.prototype._close=function(){this._state!==g&&this._enterState(g)},n.prototype.show=function(e){if(this._state!==g)return this._dialogDeferred.promise();var t={Strings:u,isUpdate:this._isUpdate,includeBrowseExtensions:!!brackets.config.extension_listing_url};return s.showModalDialogUsingTemplate(Mustache.render(m,t),!1),this.$dlg=$(".install-extension-dialog.instance"),this.$url=this.$dlg.find(".url").focus(),this.$okButton=this.$dlg.find(".dialog-button[data-button-id='ok']"),this.$cancelButton=this.$dlg.find(".dialog-button[data-button-id='cancel']"),this.$inputArea=this.$dlg.find(".input-field"),this.$msgArea=this.$dlg.find(".message-field"),this.$msg=this.$msgArea.find(".message"),this.$browseExtensionsButton=this.$dlg.find(".browse-extensions"),this.$okButton.on("click",this._handleOk.bind(this)),this.$cancelButton.on("click",this._handleCancel.bind(this)),this.$url.on("input",this._handleUrlInput.bind(this)),this.$browseExtensionsButton.on("click",function(){f.openURLInDefaultBrowser(brackets.config.extension_listing_url)}),$(window.document.body).on("keyup.installDialog",this._handleKeyUp.bind(this)),this._enterState(v),e&&(this.$url.val(e),this._enterState(y),this._enterState(_)),this._dialogDeferred=new $.Deferred,this._dialogDeferred.promise()},r.prototype.install=function(e){if(this.pendingInstall)return console.error("Extension installation already pending"),(new $.Deferred).reject("DOWNLOAD_ID_IN_USE").promise();if(this._isLocalFile){var t=new $.Deferred;this.pendingInstall={promise:t.promise(),cancel:function(){}},h.installFromPath(e).then(function(e){e.keepFile=!0,t.resolve(e)},t.reject)}else this.pendingInstall=h.installFromURL(e);var n=this.pendingInstall.promise,r=this;return this.pendingInstall.promise.always(function(){r.pendingInstall=null}),n},r.prototype.cancel=function(){this.pendingInstall.cancel()},t.showDialog=i,t.installUsingDialog=o,t.updateUsingDialog=a,t._Dialog=n}),define("extensibility/registry_utils",["require","exports","module"],function(e,t){"use strict";function n(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}t.lastVersionDate=function(){var e;return this.versions&&this.versions.length&&(e=this.versions[this.versions.length-1].published,e&&(e=new Date(e),e=e.toLocaleDateString(brackets.getLocale(),{year:"numeric",month:"2-digit",day:"2-digit"}))),e||""},t.formatUserId=function(){var e;if(this.owner){var t=this.owner.split(":");e=t[1]}return e},t.ownerLink=function(){var e;if(this.owner){var t=this.owner.split(":");"github"===t[0]&&(e="https://github.com/"+t[1])}return e},t.authorInfo=function(){var e="",r=t.ownerLink.call(this),i=t.formatUserId.call(this);return this.metadata&&this.metadata.author?e=n(this.metadata.author.name||this.metadata.author):i&&(e=n(i)),r&&(e="<a href='"+n(r)+"' title='"+n(r)+"'>"+e+"</a>"),e},t.sortRegistry=function(e,t){function n(e){return e.versions?new Date(e.versions[e.versions.length-1].published).getTime():Number.NEGATIVE_INFINITY}var r=[];return Object.keys(e).forEach(function(t){r.push(e[t])}),r.sort(function(e,r){return n(t&&r[t]||r)-n(t&&e[t]||e)}),r}}),define("utils/LocalizationUtils",["require","exports","module","strings"],function(e,t){"use strict";function n(e){var t="LOCALE_"+e.toUpperCase().replace("-","_"),n=r[t];return void 0===n?e:n}var r=e("strings");t.getLocalizedLabel=n}),define("text!htmlContent/extension-manager-view-item.html",[],function(){return'<tr>\n    <td class="ext-info">\n        <span class="ext-name">{{#metadata.title}}{{metadata.title}}{{/metadata.title}}{{^metadata.title}}{{metadata.name}}{{/metadata.title}}</span>\n        {{#authorInfo}}\n            <span class="muted ext-author">{{{authorInfo}}}</span>\n        {{/authorInfo}}\n        <span class="muted ext-version">{{metadata.version}}</span>\n        {{#hasVersionInfo}}\n            <span class="muted ext-date"> &mdash; {{lastVersionDate}}</span>\n        {{/hasVersionInfo}}\n    </td>\n    <td class="ext-desc">\n        {{#showInstallButton}}\n            <!-- Warnings when trying to install extension where latest/all versions not compatible -->\n            {{^isCompatible}}\n                <div class="alert warning">\n                    {{#requiresNewer}}{{Strings.EXTENSION_INCOMPATIBLE_NEWER}}{{/requiresNewer}}\n                    {{^requiresNewer}}{{Strings.EXTENSION_INCOMPATIBLE_OLDER}}{{/requiresNewer}}\n                </div>\n            {{/isCompatible}}\n            {{#isCompatible}}\n                {{^isCompatibleLatest}}\n                    <div class="alert warning">\n                        {{installWarning}}\n                    </div>\n                {{/isCompatibleLatest}}\n            {{/isCompatible}}\n        {{/showInstallButton}}\n        <span class="ext-full-description">\n            {{#metadata.shortdescription}}\n                {{metadata.shortdescription}}\n            {{/metadata.shortdescription}}\n            {{^metadata.shortdescription}}\n                {{#metadata.description}}\n                    {{metadata.description}}\n                {{/metadata.description}}\n                {{^metadata.description}}\n                    <p class="muted"><em>{{Strings.EXTENSION_NO_DESCRIPTION}}</em></p>\n                {{/metadata.description}}\n            {{/metadata.shortdescription}}\n        </span>\n        {{#metadata.shortdescription}}\n        <a data-extension-id="{{metadata.name}}" data-toggle-desc="expand-desc" title="{{Strings.VIEW_COMPLETE_DESCRIPTION}}" href="#">...</a>\n        {{/metadata.shortdescription}}\n        {{#metadata.homepage}}\n            <p><a title="{{metadata.homepage}}" href="{{metadata.homepage}}">{{Strings.EXTENSION_MORE_INFO}}</a></p>\n        {{/metadata.homepage}}\n        {{#translated}}\n            <br/>\n            <span class="ext-translated" title="{{translatedLangs}}">{{extensionTranslated}}</span>\n        {{/translated}}\n    </td>\n    <td class="ext-action">\n        {{#showInstallButton}}\n            <button class="btn btn-mini install" data-extension-id="{{metadata.name}}" {{^allowInstall}}disabled{{/allowInstall}}>\n                {{^isInstalled}}{{Strings.INSTALL}}{{/isInstalled}}\n                {{#isInstalled}}{{Strings.EXTENSION_INSTALLED}}{{/isInstalled}}\n            </button>\n        {{/showInstallButton}}\n        {{#isInstalled}}\n            {{#showUpdateButton}}\n                <button class="btn btn-mini update" data-extension-id="{{metadata.name}}" {{^allowUpdate}}disabled title="{{updateNotAllowedReason}}"{{/allowUpdate}}>\n                    {{Strings.UPDATE}}\n                </button>\n            {{/showUpdateButton}}\n            {{#removalAllowed}}\n                <button class="btn btn-mini remove" data-extension-id="{{metadata.name}}" {{^allowRemove}}disabled title="{{Strings.CANT_REMOVE_DEV}}"{{/allowRemove}}>\n                    {{Strings.REMOVE}}\n                </button>\n            {{/removalAllowed}}\n            {{#failedToStart}}\n                {{^isMarkedForRemoval}}\n                    {{Strings.EXTENSION_ERROR}} {{#allowRemove}}(<a class="remove" data-extension-id="{{metadata.name}}">{{Strings.REMOVE}}</a>){{/allowRemove}}\n                {{/isMarkedForRemoval}}\n            {{/failedToStart}}\n            {{#isMarkedForRemoval}}\n                {{Strings.MARKED_FOR_REMOVAL}} (<a class="undo-remove" data-extension-id="{{metadata.name}}" href="#">{{Strings.UNDO_REMOVE}}</a>)\n            {{/isMarkedForRemoval}}\n            {{#isMarkedForUpdate}}\n                {{Strings.MARKED_FOR_UPDATE}} (<a class="undo-update" data-extension-id="{{metadata.name}}" href="#">{{Strings.UNDO_UPDATE}}</a>)\n            {{/isMarkedForUpdate}}\n        {{/isInstalled}}\n    </td>\n</tr>\n'}),define("extensibility/ExtensionManagerView",["require","exports","module","strings","utils/EventDispatcher","utils/StringUtils","extensibility/ExtensionManager","extensibility/registry_utils","extensibility/InstallExtensionDialog","utils/LocalizationUtils","text!htmlContent/extension-manager-view-item.html"],function(e,t){"use strict";function n(){}var r=e("strings"),i=e("utils/EventDispatcher"),o=e("utils/StringUtils"),a=e("extensibility/ExtensionManager"),s=e("extensibility/registry_utils"),l=e("extensibility/InstallExtensionDialog"),c=e("utils/LocalizationUtils"),u=e("text!htmlContent/extension-manager-view-item.html");i.makeEventDispatcher(n.prototype),n.prototype.initialize=function(e){var t=this,n=new $.Deferred;return this.model=e,this._itemTemplate=Mustache.compile(u),this._itemViews={},this.$el=$("<div class='extension-list tab-pane' id='"+this.model.source+"'/>"),this._$emptyMessage=$("<div class='empty-message'/>").appendTo(this.$el),this._$infoMessage=$("<div class='info-message'/>").appendTo(this.$el).html(this.model.infoMessage),this._$table=$("<table class='table'/>").appendTo(this.$el),this.model.initialize().done(function(){t._setupEventHandlers()}).always(function(){t._render(),n.resolve()}),n.promise()},n.prototype.$el=null,n.prototype.model=null,n.prototype._$emptyMessage=null,n.prototype._$table=null,n.prototype._itemTemplate=null,n.prototype._itemViews=null,n.prototype._toggleDescription=function(e,t,n){var i,o,a=this.model._getEntry(e);n?(i=a.metadata.description,o=r.VIEW_TRUNCATED_DESCRIPTION):(i=a.metadata.shortdescription,o=r.VIEW_COMPLETE_DESCRIPTION),t.data("toggle-desc",n?"trunc-desc":"expand-desc").attr("title",o).prev(".ext-full-description").text(i)
},n.prototype._setupEventHandlers=function(){var e=this;this.model.on("filter",function(){e._render()}).on("change",function(t,n){var r=e.model.extensions,i=e._itemViews[n];if(e._updateMessage(),-1===e.model.filterSet.indexOf(n))i&&(i.remove(),delete e._itemViews[n]);else{var o=e._renderItem(r[n],e.model._getEntry(n));i&&(i.replaceWith(o),e._itemViews[n]=o)}}),this.$el.on("click","a",function(e){var t=$(e.target);t.hasClass("undo-remove")?a.markForRemoval(t.attr("data-extension-id"),!1):t.hasClass("remove")?a.markForRemoval(t.attr("data-extension-id"),!0):t.hasClass("undo-update")?a.removeUpdate(t.attr("data-extension-id")):"expand-desc"===t.data("toggle-desc")?this._toggleDescription(t.attr("data-extension-id"),t,!0):"trunc-desc"===t.data("toggle-desc")&&this._toggleDescription(t.attr("data-extension-id"),t,!1)}.bind(this)).on("click","button.install",function(t){e._installUsingDialog($(t.target).attr("data-extension-id"))}).on("click","button.update",function(t){e._installUsingDialog($(t.target).attr("data-extension-id"),!0)}).on("click","button.remove",function(e){a.markForRemoval($(e.target).attr("data-extension-id"),!0)})},n.prototype._renderItem=function(e,t){var n=$.extend({},t);if(n.Strings=r,n.isInstalled=!!e.installInfo,n.failedToStart=e.installInfo&&e.installInfo.status===a.START_FAILED,n.hasVersionInfo=!!t.versions,e.registryInfo){var i=a.getCompatibilityInfo(e.registryInfo,brackets.metadata.apiVersion);if(n.isCompatible=i.isCompatible,n.requiresNewer=i.requiresNewer,n.isCompatibleLatest=i.isLatestVersion,!n.isCompatibleLatest){var l=n.requiresNewer?r.EXTENSION_LATEST_INCOMPATIBLE_NEWER:r.EXTENSION_LATEST_INCOMPATIBLE_OLDER;n.installWarning=o.format(l,e.registryInfo.versions[e.registryInfo.versions.length-1].version,i.compatibleVersion)}}else n.isCompatible=n.isCompatibleLatest=!0;var u=brackets.getLocale(),d=u.split("-")[0];if(t.metadata["package-i18n"]&&[d,u].forEach(function(e){t.metadata["package-i18n"].hasOwnProperty(e)&&["title","description","homepage","keywords"].forEach(function(n){t.metadata["package-i18n"][e].hasOwnProperty(n)&&(t.metadata[n]=t.metadata["package-i18n"][e][n])})}),void 0!==t.metadata.description&&(t.metadata.shortdescription=o.truncate(t.metadata.description,200)),n.isMarkedForRemoval=a.isMarkedForRemoval(t.metadata.name),n.isMarkedForUpdate=a.isMarkedForUpdate(t.metadata.name),n.showInstallButton=(this.model.source===this.model.SOURCE_REGISTRY||this.model.source===this.model.SOURCE_THEMES)&&!n.updateAvailable,n.showUpdateButton=n.updateAvailable&&!n.isMarkedForUpdate&&!n.isMarkedForRemoval,n.allowInstall=n.isCompatible&&!n.isInstalled,Array.isArray(t.metadata.i18n)&&t.metadata.i18n.length>0){n.translated=!0,n.translatedLangs=t.metadata.i18n.map(function(e){return"root"===e&&(e="en"),{name:c.getLocalizedLabel(e),locale:e}}).sort(function(e,t){var n=[e.locale,t.locale],r=n.indexOf(u);return r>-1?r:(r=n.indexOf(d),r>-1?r:e.name.localeCompare(t.name))}).map(function(e){return e.name}).join(", "),n.translatedLangs=o.format(r.EXTENSION_TRANSLATED_LANGS,n.translatedLangs);var p=brackets.isLocaleDefault()&&t.metadata.i18n.indexOf(d)>-1||t.metadata.i18n.indexOf(u)>-1;n.extensionTranslated=o.format(p?r.EXTENSION_TRANSLATED_USER_LANG:r.EXTENSION_TRANSLATED_GENERAL,t.metadata.i18n.length)}var h=e.installInfo&&e.installInfo.locationType===a.LOCATION_USER;return n.allowRemove=h,n.allowUpdate=n.showUpdateButton&&n.isCompatible&&n.updateCompatible&&h,n.allowUpdate||(n.updateNotAllowedReason=h?r.CANT_UPDATE:r.CANT_UPDATE_DEV),n.removalAllowed="installed"===this.model.source&&!n.failedToStart&&!n.isMarkedForUpdate&&!n.isMarkedForRemoval,["lastVersionDate","authorInfo"].forEach(function(e){n[e]=s[e]}),$(this._itemTemplate(n))},n.prototype._updateMessage=function(){return this.model.message?(this._$emptyMessage.css("display","block"),this._$emptyMessage.html(this.model.message),this._$infoMessage.css("display","none"),this._$table.css("display","none"),!0):(this._$emptyMessage.css("display","none"),this._$infoMessage.css("display",this.model.infoMessage?"block":"none"),this._$table.css("display",""),!1)},n.prototype._render=function(){var e=this;this._$table.empty(),this._updateMessage(),this.model.filterSet.forEach(function(t){var n=e._itemViews[t];n||(n=e._renderItem(e.model.extensions[t],e.model._getEntry(t)),e._itemViews[t]=n),n.appendTo(e._$table)}),this.trigger("render")},n.prototype._installUsingDialog=function(e,t){var n=this.model.extensions[e];if(n&&n.registryInfo){var r=a.getCompatibilityInfo(n.registryInfo,brackets.metadata.apiVersion),i=a.getExtensionURL(e,r.compatibleVersion);t?l.updateUsingDialog(i).done(a.updateFromDownload):l.installUsingDialog(i)}},n.prototype.filter=function(e){this.model.filter(e)},t.ExtensionManagerView=n}),define("extensibility/ExtensionManagerViewModel",["require","exports","module","thirdparty/lodash","extensibility/ExtensionManager","extensibility/registry_utils","utils/EventDispatcher","strings"],function(e,t){"use strict";function n(){this._handleStatusChange=this._handleStatusChange.bind(this),s.on("statusChange."+this.source,this._handleStatusChange).on("registryUpdate."+this.source,this._handleStatusChange)}function r(){n.call(this),this.infoMessage=u.REGISTRY_SANITY_CHECK_WARNING}function i(){n.call(this);var e=this;s.on("registryDownload."+this.source,function(){e._sortFullSet(),e._setInitialFilter()})}function o(){n.call(this)}var a=e("thirdparty/lodash"),s=e("extensibility/ExtensionManager"),l=e("extensibility/registry_utils"),c=e("utils/EventDispatcher"),u=e("strings"),d=[["metadata","name"],["metadata","title"],["metadata","description"],["metadata","author","name"],["metadata","keywords"],["owner"]];c.makeEventDispatcher(n.prototype),n.prototype.SOURCE_REGISTRY="registry",n.prototype.SOURCE_THEMES="themes",n.prototype.SOURCE_INSTALLED="installed",n.prototype.extensions=null,n.prototype.source=null,n.prototype.filterSet=null,n.prototype.sortedFullSet=null,n.prototype._lastQuery=null,n.prototype.infoMessage=null,n.prototype.message=null,n.prototype.notifyCount=0,n.prototype._initializeFromSourcePromise=null,n.prototype.dispose=function(){s.off("."+this.source)},n.prototype._setInitialFilter=function(){this.filterSet=a.clone(this.sortedFullSet),this.trigger("filter")},n.prototype._sortFullSet=function(){},n.prototype.initialize=function(){var e=this;return this._initializeFromSourcePromise=this._initializeFromSource().always(function(){e._updateMessage()}),this._initializeFromSourcePromise},n.prototype._handleStatusChange=function(e,t){this.trigger("change",t)},n.prototype.filter=function(e,t){function n(e,t){var n=[];return e.forEach(function(e){var r=i._getEntry(e);r&&i._entryMatchesQuery(r,t)&&n.push(e)}),n}var r,i=this;r=!t&&this._lastQuery&&0===e.indexOf(this._lastQuery)?this.filterSet:this.sortedFullSet;var o,a=e.toLowerCase().split(/\s+/),s=r;for(o=0;o<a.length;o++)s=n(s,a[o]);this._lastQuery=e,this.filterSet=s,this._updateMessage(),this.trigger("filter")},n.prototype._updateMessage=function(){this.message=this._initializeFromSourcePromise&&"rejected"===this._initializeFromSourcePromise.state()?u.EXTENSION_MANAGER_ERROR_LOAD:this.filterSet&&0===this.filterSet.length?this.sortedFullSet&&this.sortedFullSet.length?u.NO_EXTENSION_MATCHES:u.NO_EXTENSIONS:null},n.prototype._getEntry=function(){return null},n.prototype._entryMatchesQuery=function(e,t){return""===t||d.some(function(n){var r,i=e;for(r=0;r<n.length;r++)if(i=i[n[r]],!i)return!1;if(Array.isArray(i))return i.some(function(e){return-1!==e.toLowerCase().indexOf(t)});if("owner"===n[n.length-1]){var o=i.split(":");if(-1!==o[1].toLowerCase().indexOf(t))return!0}else if(-1!==i.toLowerCase().indexOf(t))return!0})},r.prototype=Object.create(n.prototype),r.prototype.constructor=r,r.prototype.source=n.prototype.SOURCE_REGISTRY,r.prototype._initializeFromSource=function(){var e=this;return s.downloadRegistry().done(function(){e.extensions=s.extensions,e.sortedFullSet=l.sortRegistry(e.extensions,"registryInfo").filter(function(e){return void 0!==e.registryInfo&&void 0===e.registryInfo.metadata.theme}).map(function(e){return e.registryInfo.metadata.name}),e._setInitialFilter()}).fail(function(){e.extensions=[],e.sortedFullSet=[],e.filterSet=[]})},r.prototype._getEntry=function(e){var t=this.extensions[e];return t?t.registryInfo:t},i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.source=n.prototype.SOURCE_INSTALLED,i.prototype._initializeFromSource=function(){var e=this;return this.extensions=s.extensions,this.sortedFullSet=Object.keys(this.extensions).filter(function(t){return e.extensions[t].installInfo&&e.extensions[t].installInfo.locationType!==s.LOCATION_DEFAULT}),this._sortFullSet(),this._setInitialFilter(),this._countUpdates(),(new $.Deferred).resolve().promise()},i.prototype._sortFullSet=function(){var e=this;this.sortedFullSet=this.sortedFullSet.sort(function(t,n){var r=e.extensions[t].installInfo.updateAvailable,i=e.extensions[n].installInfo.updateAvailable;if(r&&!i)return-1;if(!r&&i)return 1;var o=e.extensions[t].installInfo.metadata,a=e.extensions[n].installInfo.metadata,s=(o.title||o.name).toLocaleLowerCase(),l=(a.title||a.name).toLocaleLowerCase();return s.localeCompare(l)})},i.prototype._countUpdates=function(){var e=this;this.notifyCount=0,this.sortedFullSet.forEach(function(t){e.extensions[t].installInfo.updateCompatible&&!s.isMarkedForUpdate(t)&&e.notifyCount++})},i.prototype._handleStatusChange=function(e,t){var r=this.sortedFullSet.indexOf(t),i=!1;-1===r||this.extensions[t].installInfo?-1===r&&this.extensions[t].installInfo&&(this.sortedFullSet.push(t),this._sortFullSet(),i=!0):(this.sortedFullSet.splice(r,1),this._countUpdates(),i=!0),i&&this.filter(this._lastQuery||"",!0),this.extensions[t].installInfo&&this._countUpdates(),n.prototype._handleStatusChange.call(this,e,t)},i.prototype._getEntry=function(e){var t=this.extensions[e];return t?t.installInfo:t},o.prototype=Object.create(n.prototype),o.prototype.constructor=o,o.prototype.source=n.prototype.SOURCE_THEMES,o.prototype._initializeFromSource=function(){var e=this;return s.downloadRegistry().done(function(){e.extensions=s.extensions,e.sortedFullSet=l.sortRegistry(e.extensions,"registryInfo").filter(function(e){return void 0!==e.registryInfo&&e.registryInfo.metadata.theme}).map(function(e){return e.registryInfo.metadata.name}),e._setInitialFilter()}).fail(function(){e.extensions=[],e.sortedFullSet=[],e.filterSet=[]})},o.prototype._getEntry=function(e){var t=this.extensions[e];return t?t.registryInfo:t},t.RegistryViewModel=r,t.ThemesViewModel=o,t.InstalledViewModel=i}),define("text!htmlContent/extension-manager-dialog.html",[],function(){return'<div class="extension-manager-dialog modal">\n    <div class="modal-header">\n        <ul class="nav nav-tabs no-focus">\n            {{#showRegistry}}\n                <li><a href="#registry" class="registry" data-toggle="tab"><img src="styles/images/extension-manager-registry.svg"/><br/>{{Strings.EXTENSIONS_AVAILABLE_TITLE}}</a></li>\n                <li><a href="#themes" class="themes" data-toggle="tab"><img src="styles/images/themes-icon.svg"/><br/>{{Strings.EXTENSIONS_THEMES_TITLE}}</a></li>\n                <!--<li><a href="#updates" class="updates" data-toggle="tab"><img src="styles/images/extension-manager-updates.svg"/><br/>{{Strings.EXTENSIONS_UPDATES_TITLE}}</a></li>-->\n            {{/showRegistry}}\n            <li><a href="#installed" class="installed" data-toggle="tab"><span class="notification"></span><img src="styles/images/extension-manager-installed.svg"/><br/>{{Strings.EXTENSIONS_INSTALLED_TITLE}}</a></li>\n        </ul>\n        <div>\n            <button class="search-clear">&times;</button>\n            <input class="search" type="text" placeholder="{{EXTENSION_SEARCH_PLACEHOLDER}}">\n        </div>\n    </div>\n    <div class="modal-body no-padding table-striped tab-content">\n        <div class=\'spinner large spin\'/>\n    </div>\n    <div class="modal-footer">\n        <span id="install-drop-zone" class="btn left drag">\n            <span class="install-drag-message">{{Strings.INSTALL_EXTENSION_DRAG}} <a class="install-from-url">{{Strings.INSTALL_FROM_URL}}</a></span>\n            <span class="install-drop-message">{{Strings.INSTALL_EXTENSION_DROP}}</span>\n            <span class="install-validating-message">{{Strings.INSTALL_EXTENSION_VALIDATING}}</span>\n            <div id="install-drop-zone-mask"></div>\n        </span>\n        <button class="dialog-button btn primary" data-button-id="close">{{Strings.CLOSE}}</button>\n    </div>\n</div>\n'}),!function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t,n,r,i=this.element,o=i.closest("ul:not(.dropdown-menu)"),a=i.attr("data-target");a||(a=i.attr("href"),a=a&&a.replace(/.*(?=#[^\s]*$)/,"")),i.parent("li").hasClass("active")||(t=o.find(".active:last a")[0],r=e.Event("show",{relatedTarget:t}),i.trigger(r),r.isDefaultPrevented()||(n=e(a),this.activate(i.parent("li"),o),this.activate(n,n.parent(),function(){i.trigger({type:"shown",relatedTarget:t})})))},activate:function(t,n,r){function i(){o.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),a?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var o=n.find("> .active"),a=r&&e.support.transition&&o.hasClass("fade");a?o.one(e.support.transition.end,i):i(),o.removeClass("in")}};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("tab");i||r.data("tab",i=new t(this)),"string"==typeof n&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})}(window.jQuery),define("widgets/bootstrap-tab",function(){}),define("extensibility/ExtensionManagerDialog",["require","exports","module","thirdparty/lodash","widgets/Dialogs","widgets/DefaultDialogs","filesystem/FileSystem","file/FileUtils","extensibility/Package","strings","utils/StringUtils","command/Commands","command/CommandManager","extensibility/InstallExtensionDialog","utils/AppInit","utils/Async","utils/KeyEvent","extensibility/ExtensionManager","extensibility/ExtensionManagerView","extensibility/ExtensionManagerViewModel","text!htmlContent/extension-manager-dialog.html","widgets/bootstrap-tab"],function(e,t){"use strict";function n(e){e.stopPropagation(),e.preventDefault()}function r(){var e=E.hasExtensionsToRemove(),t=E.hasExtensionsToUpdate();if(e||t){var n=p.CHANGE_AND_RELOAD;e&&!t?n=p.REMOVE_AND_RELOAD:t&&!e&&(n=p.UPDATE_AND_RELOAD);var r=s.showModalDialog(l.DIALOG_ID_CHANGE_EXTENSIONS,p.CHANGE_AND_RELOAD_TITLE,p.CHANGE_AND_RELOAD_MESSAGE,[{className:s.DIALOG_BTN_CLASS_NORMAL,id:s.DIALOG_BTN_CANCEL,text:p.CANCEL},{className:s.DIALOG_BTN_CLASS_PRIMARY,id:s.DIALOG_BTN_OK,text:n}],!1),i=r.getElement();i.one("buttonClick",function(e,t){t===s.DIALOG_BTN_OK?(i.find(".dialog-button").prop("disabled",!0),i.find(".close").hide(),i.find(".dialog-message").text(p.PROCESSING_EXTENSIONS).append("<span class='spinner inline spin'/>"),E.removeMarkedExtensions().done(function(){E.updateExtensions().done(function(){r.close(),m.execute(f.APP_RELOAD)}).fail(function(e){r.close();var t=[];e.forEach(function(e){t.push(e.item),e.error&&e.error.forEach?(console.error("Errors for",e.item),e.error.forEach(function(e){console.error(d.formatError(e))})):console.error("Error for",e.item,e)}),s.showModalDialog(l.DIALOG_ID_ERROR,p.EXTENSION_MANAGER_UPDATE,h.format(p.EXTENSION_MANAGER_UPDATE_ERROR,t.join(", "))).done(function(){m.execute(f.APP_RELOAD)})})}).fail(function(e){r.close(),E.cleanupUpdates();var t=[];e.forEach(function(e){t.push(e.item)}),s.showModalDialog(l.DIALOG_ID_ERROR,p.EXTENSION_MANAGER_REMOVE,h.format(p.EXTENSION_MANAGER_REMOVE_ERROR,t.join(", "))).done(function(){m.execute(f.APP_RELOAD)})})):(r.close(),E.cleanupUpdates(),E.unmarkAllForRemoval())})}}function i(){var e,t=[],n=[],r=new $.Deferred;return brackets.app.getDroppedFiles(function(i,o){return i?(console.error(i),void r.resolve()):(e=y.doInParallel_aggregateErrors(o,function(e){var r=new $.Deferred;return c.resolve(e,function(i,o){var a,s=u.getFileExtension(e),l=o.isFile&&"zip"===s;return i?a=u.getFileErrorString(i):l||(a=p.INVALID_ZIP_FILE),a?void r.reject(a):void d.validate(e,{requirePackageJSON:!0}).done(function(e){if(e.errors.length)return void r.reject(d.formatError(e.errors));var i=e.metadata.name,a=E.extensions[i],s=a&&!!a.installInfo;s?n.push(o):t.push(o),r.resolve()}).fail(function(e){r.reject(d.formatError(e))})}),r.promise()}),void e.done(function(){var e=y.doSequentially(t,function(e){return g.installUsingDialog(e)}),i=e.then(function(){return y.doSequentially(n,function(e){return g.updateUsingDialog(e).done(function(e){E.updateFromDownload(e)})})});i.always(r.resolve)}).fail(function(e){r.reject(e)}))}),r.promise()}function o(){function e(){var e=T[w],t=""===m.val()&&(!e.filterSet||0===e.filterSet.length);return m.prop("disabled",t),v.prop("disabled",t),t}function t(){m.val(""),C.forEach(function(e){e.filter("")}),e()||m.focus()}function o(e){T[w]&&(T[w].scrollPos=$(".modal-body",f).scrollTop()),e.tab("show"),T[w]&&($(".modal-body",f).scrollTop(T[w].scrollPos||0),t())}function c(e){var t=T[e],n=f.find(".nav-tabs li").eq(e).find(".notification");t.notifyCount?(n.text(t.notifyCount),n.show()):n.hide()}var d,f,m,v,C=[],D={Strings:p,showRegistry:!!brackets.config.extension_registry},T=[];D.showRegistry&&(T.push(new S.RegistryViewModel),T.push(new S.ThemesViewModel)),T.push(new S.InstalledViewModel),d=s.showModalDialogUsingTemplate(Mustache.render(I,D)),d.done(function(){$(window.document).off(".extensionManager"),T.forEach(function(e){e.dispose()}),r()}),f=d.getElement(),m=$(".search",f),v=$(".search-clear",f),f.find(".nav-tabs a").on("click",function(){o($(this))}),$(window.document).on("keyup.extensionManager",function(e){if(e.keyCode===_.DOM_VK_TAB&&e.ctrlKey){var t=$(".nav-tabs a",f),n=w;e.shiftKey?n--:n++,n%=t.length,o(t.eq(n))}});var O=y.doInParallel(T,function(e,t){var n,r=new b,i=r.initialize(e);return i.always(function(){C[t]=r,n=e.notifyCount,c(t)}),e.on("change",function(){n!==e.notifyCount&&(n=e.notifyCount,c(t))}),i},!0);O.always(function(){$(".spinner",f).remove(),C.forEach(function(e){e.$el.appendTo($(".modal-body",f))}),$("a[data-toggle='tab']",f).each(function(t,n){$(n).on("show",function(){w=t,e()||f.find(".search").focus()})}),f.on("input",".search",function(){var e=$(this).val();C.forEach(function(t){t.filter(e)})}).on("click",".search-clear",t),T.forEach(function(t,n){t.on("change",function(){w===n&&e()})});var n=f.find(".nav-tabs li.active a");n.length?(n.parent().removeClass("active"),n.tab("show")):$("#toolbar-extension-manager").hasClass("updatesAvailable")?f.find(".nav-tabs a.installed").tab("show"):f.find(".nav-tabs a:first").tab("show")}),$(".extension-manager-dialog .install-from-url").click(function(){g.showDialog().done(E.updateFromDownload)});var M=$("#install-drop-zone"),L=$("#install-drop-zone-mask");return M.on("dragover",function(e){if(n(e),e.originalEvent.dataTransfer.files){var t=e.originalEvent.dataTransfer.items,r=!1;r=a.every(t,function(e){if("file"===e.kind){var t=e.webkitGetAsEntry(),n=u.getFileExtension(t.fullPath);return t.isFile&&"zip"===n}return!1}),r?(M.width(M.width()),M.removeClass("drag"),M.addClass("drop")):e.originalEvent.dataTransfer.dropEffect="none"}}).on("drop",n),L.on("dragover",function(e){n(e),e.originalEvent.dataTransfer.dropEffect="copy"}).on("dragleave",function(){M.removeClass("drop"),M.addClass("drag")}).on("drop",function(e){n(e),e.originalEvent.dataTransfer.files&&(i().fail(function(e){var t=p.INSTALL_EXTENSION_DROP_ERROR;t+="<ul class='dialog-list'>",e.forEach(function(e){t+="<li><span class='dialog-filename'>",t+=h.breakableUrl(e.item),t+="</span>: "+e.error+"</li>"}),t+="</ul>",s.showModalDialog(l.DIALOG_ID_ERROR,p.EXTENSION_MANAGER_TITLE,t)}).always(function(){M.removeClass("validating"),M.addClass("drag")}),M.removeClass("drop"),M.addClass("validating"))}),(new $.Deferred).resolve(d).promise()}var a=e("thirdparty/lodash"),s=e("widgets/Dialogs"),l=e("widgets/DefaultDialogs"),c=e("filesystem/FileSystem"),u=e("file/FileUtils"),d=e("extensibility/Package"),p=e("strings"),h=e("utils/StringUtils"),f=e("command/Commands"),m=e("command/CommandManager"),g=e("extensibility/InstallExtensionDialog"),v=e("utils/AppInit"),y=e("utils/Async"),_=e("utils/KeyEvent"),E=e("extensibility/ExtensionManager"),b=e("extensibility/ExtensionManagerView").ExtensionManagerView,S=e("extensibility/ExtensionManagerViewModel"),I=e("text!htmlContent/extension-manager-dialog.html");e("widgets/bootstrap-tab");var w;m.register(p.CMD_EXTENSION_MANAGER,f.FILE_EXTENSION_MANAGER,o),v.appReady(function(){$("#toolbar-extension-manager").click(o)}),t._performChanges=r}),define("text!htmlContent/image-view.html",[],function(){return'<div class="image-view">\n    <div class="image-centering">\n        <div class="image-header">\n            <div class="image-data"></div>\n            <div class="image-path"></div>	\n        </div>\n        <div class="image">\n            <div class="image-scale"></div>\n            <img class="image-preview" src="file:///{{fullPath}}?ver={{now}}">\n            <div class="image-tip">\n                <table class="tip-container">\n                    <tr>\n                        <td class="variable">x: </td>\n                        <td class="x-value"></td>\n                    </tr>\n                    <tr>\n                        <td class="variable">y: </td>\n                        <td class="y-value"></td>\n                    </tr>\n                </table>\n            </div>\n            <div class="horz-guide image-guide"></div>\n            <div class="vert-guide image-guide"></div>\n        </div>\n    </div>\n</div>'}),define("editor/ImageViewer",["require","exports","module","document/DocumentManager","text!htmlContent/image-view.html","project/ProjectManager","language/LanguageManager","view/MainViewFactory","strings","utils/StringUtils","filesystem/FileSystem","file/FileUtils","thirdparty/lodash"],function(e,t){"use strict";function n(e,t){this.file=e,this.$el=$(Mustache.render(a,{fullPath:h.encodeFilePath(e.fullPath),now:(new Date).valueOf()})),t.append(this.$el),this._naturalWidth=0,this._naturalHeight=0,this._scale=100,this._scaleDivInfo=null,this.relPath=s.makeProjectRelativeIfPossible(this.file.fullPath),this.$imagePath=this.$el.find(".image-path"),this.$imagePreview=this.$el.find(".image-preview"),this.$imageData=this.$el.find(".image-data"),this.$image=this.$el.find(".image"),this.$imageTip=this.$el.find(".image-tip"),this.$imageGuides=this.$el.find(".image-guide"),this.$imageScale=this.$el.find(".image-scale"),this.$x_value=this.$el.find(".x-value"),this.$y_value=this.$el.find(".y-value"),this.$horzGuide=this.$el.find(".horz-guide"),this.$vertGuide=this.$el.find(".vert-guide"),this.$imagePath.text(this.relPath).attr("title",this.relPath),this.$imagePreview.on("load",f.bind(this._onImageLoaded,this)),m[e.fullPath]=this}function r(e,t){var r=t.getViewForPath(e.fullPath);return r?t.showView(r):(r=new n(e,t.$content),t.addView(r,!0)),(new $.Deferred).resolve().promise()}function i(e,t){if(t&&!t.isDirectory){var n=m[t.fullPath];n&&n.refresh()}}var o=e("document/DocumentManager"),a=e("text!htmlContent/image-view.html"),s=e("project/ProjectManager"),l=e("language/LanguageManager"),c=e("view/MainViewFactory"),u=e("strings"),d=e("utils/StringUtils"),p=e("filesystem/FileSystem"),h=e("file/FileUtils"),f=e("thirdparty/lodash"),m={};n.prototype._onFilenameChange=function(e,t,n){this.file.fullPath===n&&(this.relPath=s.makeProjectRelativeIfPossible(n),this.$imagePath.text(this.relPath).attr("title",this.relPath))},n.prototype._onImageLoaded=function(e){this._naturalWidth=e.currentTarget.naturalWidth,this._naturalHeight=e.currentTarget.naturalHeight;var t=h.getFileExtension(this.file.fullPath),n=this._naturalWidth+" &times; "+this._naturalHeight+" "+u.UNIT_PIXELS;"ico"===t&&(n+=" ("+u.IMAGE_VIEWER_LARGEST_ICON+")");var r=this;this.file.stat(function(e,t){if(e)r.$imageData.html(n);else{var i="";t.size&&(i=" &mdash; "+d.prettyPrintBytes(t.size,2));var o=n+i;r.$imageData.html(o).attr("title",o.replace("&times;","x").replace("&mdash;","-"))}}),o.on("fileNameChange.ImageView",f.bind(this._onFilenameChange,this)),this.$imageTip.hide(),this.$imageGuides.hide(),this.$image.on("mousemove.ImageView",".image-preview",f.bind(this._showImageTip,this)).on("mouseleave.ImageView",".image-preview",f.bind(this._hideImageTip,this)),this._updateScale()},n.prototype._updateScale=function(){var e=this.$imagePreview.width();e&&e<this._naturalWidth?(this._scale=e/this._naturalWidth*100,this.$imageScale.text(Math.floor(this._scale)+"%").css("left",this.$imagePreview.position().left+5).show()):(this._scale=100,this._scaleDivInfo=null,this.$imageScale.text("").hide())},n.prototype._showImageTip=function(e){if(0!==Math.floor(this._scale)){var t=Math.round(100*e.offsetX/this._scale),n=Math.round(100*e.offsetY/this._scale),r=this.$imagePreview.position(),i=e.offsetX+r.left,o=e.offsetY+r.top,a=this.$imagePreview.width(),s=this.$imagePreview.height(),l=$(window).width(),c=4===this._naturalWidth.toString().length,u=112,d=120,p=10,h=-54,f=-82,m=-90;if(0>t||t>=this._naturalWidth||0>n||n>=this._naturalHeight)return this._hideImageTip(e),void this.$imagePreview.css("cursor","auto");this.$imagePreview.css("cursor","none"),this._handleMouseEnterOrExitScaleSticker(i,o),(e.pageX+u>l||c&&e.pageX+d>l)&&(p=c?m:f),this.$x_value.text(t+"px"),this.$y_value.text(n+"px"),this.$imageTip.css({left:i+p,top:o+h}).show(),this.$horzGuide.css({left:r.left,top:o,width:a-1}).show(),this.$vertGuide.css({left:i,top:r.top,height:s-1}).show()}},n.prototype._hideImageTip=function(e){var t=$(e.target),n=t.position(),r=this.$imagePreview.position(),i=r.left+this.$imagePreview.width(),o=r.top+this.$imagePreview.height(),a=n.left+e.offsetX,s=n.top+e.offsetY;(a<r.left||a>=i||s<r.top||s>=o)&&(this._hideGuidesAndTip(),this._scaleDivInfo&&(this._scaleDivInfo=null,this.$imageScale.show()))},n.prototype._hideGuidesAndTip=function(){this.$imageTip.hide(),this.$imageGuides.hide()},n.prototype._handleMouseEnterOrExitScaleSticker=function(e,t){var n,r,i,o,a=this.$imagePreview.position(),s=this.$imageScale.position(),l=this.$imagePreview.width(),c=this.$imagePreview.height();this._scaleDivInfo?(n=this._scaleDivInfo.left,r=this._scaleDivInfo.top,i=this._scaleDivInfo.right,o=this._scaleDivInfo.bottom,l+a.left<i&&(i=l+a.left),c+a.top<o&&(o=c+a.top)):(n=s.left,r=s.top,i=this.$imageScale.width()+n,o=this.$imageScale.height()+r),this._scaleDivInfo?(n>e||e>i||r>t||t>o)&&(this._scaleDivInfo=null,this.$imageScale.show()):e>=n&&i>=e&&t>=r&&o>=t&&e<a.left+l&&t<a.top+c&&(this._scaleDivInfo={left:s.left,top:s.top,right:i,bottom:o},this.$imageScale.hide())},n.prototype.getFile=function(){return this.file},n.prototype.updateLayout=function(){this._hideGuidesAndTip();var e=this.$el.parent(),t=e.position(),n=e.innerWidth(),r=e.innerHeight(),i=e.outerWidth(),o=e.outerHeight();this.$el.css({top:t.top+(o-r)/2,left:t.left+(i-n)/2,width:n,height:r}),this._updateScale()},n.prototype.destroy=function(){delete m[this.file.fullPath],o.off(".ImageView"),this.$image.off(".ImageView"),this.$el.remove()},n.prototype.refresh=function(){var e=this.$imagePreview.attr("src"),t=(new Date).valueOf(),n=e.indexOf("?");n>0&&(e=e.slice(0,n)),e=e+"?ver="+t,this.$imagePreview.attr("src",e)},p.on("change",i),c.registerViewFactory({canOpenFile:function(e){var t=l.getLanguageForPath(e);return"image"===t.getId()},openFile:function(e,t){return r(e,t)}}),t.ImageView=n}),define("project/FileIndexManager",["require","exports","module","project/ProjectManager"],function(e,t){"use strict";function n(){console.error("Warning: FileIndexManager is deprecated. Use ProjectManager.getAllFiles() instead")}function r(e){if("css"===e)return a.getLanguageFilter("css");if("all"===e)return null;throw new Error("Invalid index name:",e)}function i(e){return n(),a.getAllFiles(r(e))}function o(e,t){n();var i=r(e);return a.getAllFiles(function(e){return i&&!i(e)?!1:e.name===t})}var a=e("project/ProjectManager");t.getFileInfoList=i,t.getFilenameMatches=o}),define("file/NativeFileError",[],function(){"use strict";var e={};return e.NOT_FOUND_ERR="NotFoundError",e.SECURITY_ERR="SecurityError",e.ABORT_ERR="AbortError",e.NOT_READABLE_ERR="NotReadableError",e.NO_MODIFICATION_ALLOWED_ERR="NoModificationAllowedError",e.INVALID_STATE_ERR="InvalidStateError",e.SYNTAX_ERR="SyntaxError",e.INVALID_MODIFICATION_ERR="InvalidModificationError",e.QUOTA_EXCEEDED_ERR="QuotaExceededError",e.TYPE_MISMATCH_ERR="TypeMismatchError",e.PATH_EXISTS_ERR="PathExistsError",e}),define("file/NativeFileSystem",["require","exports","module","filesystem/FileSystem","filesystem/File","filesystem/Directory","file/NativeFileError"],function(e,t){"use strict";function n(e,t){console.error("Warning: '"+e+"' is deprecated. Use '"+t+"' instead")}var r=e("filesystem/FileSystem"),i=e("filesystem/File"),o=e("filesystem/Directory"),a=e("file/NativeFileError"),s={showOpenDialog:function(e,t,i,o,a,s,l){n("NativeFileSystem.showOpenDialog()","FileSystem.showOpenDialog()"),r.showOpenDialog(e,t,i,o,a,function(e,t){e?l&&l(e):s(t)})},showSaveDialog:function(e,t,i,o,a){n("NativeFileSystem.showSaveDialog()","FileSystem.showSaveDialog()"),r.showSaveDialog(e,t,i,function(e,t){e?a&&a(e):o(t)})},requestNativeFileSystem:function(e,t,i){n("NativeFileSystem.requestNativeFileSystem()","FileSystem.resolve()"),r.resolve(e,function(e,n){if(e)i(e);else{var r={root:n};t(r)}})},resolveNativeFileSystemPath:function(e,t,i){n("NativeFileSystem.resolveNativeFileSystemPath()","FileSystem.resolve()"),r.resolve(e,function(e,n){e?i(e):t(n)})}};s.FileEntry=function(e){return n("new NativeFileSystem.FileEntry()","FileSystem.getFileForPath()"),r.getFileForPath(e)},s.DirectoryEntry=function(e){return n("new NativeFileSystem.DirectoryEntry()","FileSystem.getDirectoryForPath()"),r.getDirectoryForPath(e)},i.prototype.createWriter=function(e){n("File.createWriter()","File.write()");var t=this;e({write:function(e){var n=this;n.onwritestart&&n.onwritestart(),t.write(e,function(e){e?n.onerror&&n.onerror(e):(n.onwrite&&n.onwrite(),n.onwriteend&&n.onwriteend())})}})},o.prototype.createReader=function(){n("Directory.createReader()","Directory.getContents()");var e=this;return{readEntries:function(t,n){e.getContents(function(e,r){e?n(e):t(r)})}}},o.prototype.getFile=function(e,t,i,o){if(t&&t.create)throw new Error("Directory.getFile() is deprecated and no longer supports 'create: true'. Use File.write(\"\") instead.");n("Directory.getFile()","FileSystem.resolve()"),"/"!==e[0]&&":"!==e[1]&&(e=this.fullPath+e),r.resolve(e,function(e,t){e?o(e):t.isDirectory?o(a.TYPE_MISMATCH_ERR):i(t)})},o.prototype.getDirectory=function(){throw new Error("Directory.getDirectory() has been removed. Use FileSystem.getDirectoryForPath() and/or Directory.create() instead.")},t.NativeFileSystem=s}),define("view/PanelManager",["require","exports","module","view/WorkspaceManager","utils/EventDispatcher","utils/DeprecationWarning"],function(e,t){"use strict";function n(e,n){o.deprecateEvent(t,r,e,n,"PanelManager."+e,"MainViewManager."+n)}var r=e("view/WorkspaceManager"),i=e("utils/EventDispatcher"),o=e("utils/DeprecationWarning");t.createBottomPanel=function(e,t,n){return o.deprecationWarning("Use WorkspaceManager.createBottomPanel() instead of PanelManager.createBottomPanel().",!0),r.createBottomPanel(e,t,n)},i.makeEventDispatcher(t),n("editorAreaResize","workspaceUpdateLayout")}),define("brackets",["require","exports","module","widgets/bootstrap-dropdown","widgets/bootstrap-modal","widgets/bootstrap-twipsy-mod","thirdparty/path-utils/path-utils.min","thirdparty/smart-auto-complete-local/jquery.smart_autocomplete","thirdparty/CodeMirror2/addon/fold/xml-fold","thirdparty/CodeMirror2/addon/edit/matchtags","thirdparty/CodeMirror2/addon/edit/matchbrackets","thirdparty/CodeMirror2/addon/edit/closebrackets","thirdparty/CodeMirror2/addon/edit/closetag","thirdparty/CodeMirror2/addon/scroll/scrollpastend","thirdparty/CodeMirror2/addon/selection/active-line","thirdparty/CodeMirror2/addon/selection/mark-selection","thirdparty/CodeMirror2/addon/mode/multiplex","thirdparty/CodeMirror2/addon/mode/overlay","thirdparty/CodeMirror2/addon/search/match-highlighter","thirdparty/CodeMirror2/addon/search/searchcursor","thirdparty/CodeMirror2/keymap/sublime","utils/AppInit","language/LanguageManager","project/ProjectManager","document/DocumentManager","editor/EditorManager","language/JSUtils","project/WorkingSetView","document/DocumentCommandHandlers","project/FileViewController","project/FileSyncManager","command/KeyBindingManager","command/Commands","command/CommandManager","editor/CodeHintManager","utils/PerfUtils","filesystem/FileSystem","command/Menus","text!htmlContent/main-view.html","strings","widgets/Dialogs","widgets/DefaultDialogs","utils/ExtensionLoader","utils/Async","utils/UpdateNotification","utils/UrlParams","preferences/PreferencesManager","utils/ExtensionUtils","utils/DragAndDrop","language/CodeInspection","utils/NativeApp","utils/DeprecationWarning","view/ViewCommandHandlers","view/MainViewManager","utils/Global","editor/CSSInlineEditor","project/WorkingSetSort","search/QuickOpen","file/FileUtils","project/SidebarView","utils/Resizer","LiveDevelopment/main","utils/NodeConnection","utils/NodeDomain","utils/ColorUtils","view/ThemeManager","thirdparty/lodash","language/XMLUtils","thirdparty/CodeMirror2/lib/codemirror","command/DefaultMenus","document/ChangedDocumentTracker","editor/EditorStatusBar","editor/EditorCommandHandlers","editor/EditorOptionHandlers","help/HelpCommandHandlers","search/FindInFilesUI","search/FindReplace","extensibility/InstallExtensionDialog","extensibility/ExtensionManagerDialog","editor/ImageViewer","project/FileIndexManager","file/NativeFileSystem","file/NativeFileError","view/PanelManager","language/CSSUtils","document/Document","LiveDevelopment/Agents/DOMAgent","filesystem/File","search/FileFilters","file/FileUtils","search/FindInFiles","search/FindInFilesUI","language/HTMLInstrumentation","LiveDevelopment/Inspector/Inspector","extensibility/InstallExtensionDialog","LiveDevelopment/LiveDevelopment","LiveDevelopment/LiveDevMultiBrowser","LiveDevelopment/LiveDevServerManager","view/MainViewFactory","editor/MultiRangeInlineEditor","LiveDevelopment/Agents/RemoteAgent","search/ScrollTrackMarkers","utils/UpdateNotification"],function(e){"use strict";
function t(){brackets.test={CodeHintManager:v,CodeInspection:N,CommandManager:g,Commands:m,CSSUtils:e("language/CSSUtils"),DefaultDialogs:w,Dialogs:I,DocumentCommandHandlers:d,DocumentManager:s,DocumentModule:e("document/Document"),DOMAgent:e("LiveDevelopment/Agents/DOMAgent"),DragAndDrop:R,EditorManager:l,ExtensionLoader:C,ExtensionUtils:L,File:e("filesystem/File"),FileFilters:e("search/FileFilters"),FileSyncManager:h,FileSystem:_,FileViewController:p,FileUtils:e("file/FileUtils"),FindInFiles:e("search/FindInFiles"),FindInFilesUI:e("search/FindInFilesUI"),HTMLInstrumentation:e("language/HTMLInstrumentation"),Inspector:e("LiveDevelopment/Inspector/Inspector"),InstallExtensionDialog:e("extensibility/InstallExtensionDialog"),JSUtils:c,KeyBindingManager:f,LanguageManager:o,LiveDevelopment:e("LiveDevelopment/LiveDevelopment"),LiveDevMultiBrowser:e("LiveDevelopment/LiveDevMultiBrowser"),LiveDevServerManager:e("LiveDevelopment/LiveDevServerManager"),MainViewManager:k,MainViewFactory:e("view/MainViewFactory"),Menus:E,MultiRangeInlineEditor:e("editor/MultiRangeInlineEditor").MultiRangeInlineEditor,NativeApp:x,PerfUtils:y,PreferencesManager:M,ProjectManager:a,RemoteAgent:e("LiveDevelopment/Agents/RemoteAgent"),ScrollTrackMarkers:e("search/ScrollTrackMarkers"),UpdateNotification:e("utils/UpdateNotification"),WorkingSetView:u,doneLoading:!1},i.appReady(function(){brackets.test.doneLoading=!0})}function n(){y.addMeasurement("window.document Ready");var e=/Mac OS X 10\D([\d+])\D/.exec(navigator.userAgent);if(e&&e[1]&&Number(e[1])>=7){var n=$("<div style='position:fixed;left:-50px;width:50px;height:50px;overflow:auto;'><div style='width:100px;height:100px;'/></div>").appendTo(window.document.body);n.outerWidth()===n.get(0).clientWidth&&$(".sidebar").removeClass("quiet-scrollbars"),n.remove()}D.waitForAll([o.ready,M.ready]).always(function(){var e=U.get("extensions"),n=C.init(e?e.split(","):null);n.always(function(){i._dispatchReady(i.EXTENSIONS_LOADED),P.restoreFontSize();var e=a.getInitialProjectPath();a.openProject(e).always(function(){t();var n=new $.Deferred;U.get("skipSampleProjectLoad")||M.getViewState("afterFirstLaunch")?n.resolve():(M.setViewState("afterFirstLaunch","true"),a.isWelcomeProjectPath(e)?_.resolve(e+"index.html",function(e,t){if(e)n.reject();else{var r=g.execute(m.CMD_ADD_TO_WORKINGSET_AND_OPEN,{fullPath:t.fullPath});r.then(n.resolve,n.reject)}}):n.resolve()),n.always(function(){if(i._dispatchReady(i.APP_READY),y.addMeasurement("Application Startup"),M._isUserScopeCorrupt()){var e,t=M.getUserPrefFile(),n=k.findInAllWorkingSets(t);n.length&&(e=n[0].paneId),p.openFileAndAddToWorkingSet(t,e).done(function(){I.showModalDialog(w.DIALOG_ID_ERROR,S.ERROR_PREFS_CORRUPT_TITLE,S.ERROR_PREFS_CORRUPT).done(function(){k.focusActivePane()})})}}),brackets.app.getPendingFilesToOpen&&brackets.app.getPendingFilesToOpen(function(e,t){R.openDroppedFiles(t)})})})}),U.get("skipUpdateCheck")||brackets.inBrowser||i.appReady(function(){T.launchAutomaticUpdate()})}function r(){$("body").addClass("platform-"+brackets.platform),$("body").addClass(brackets.inBrowser?"in-browser":"in-appshell"),brackets.nativeMenus?$("body").addClass("has-appshell-menus"):!function(){var e=$.fn.focus;$.fn.focus=function(){return this.hasClass("dropdown-toggle")?void 0:e.apply(this,arguments)}}(),$("body").html(Mustache.render(b,S)),$("title").text(brackets.config.app_title),R.attachHandlers(),$(window).focus(function(){h.syncOpenDocuments()}),$("html").on("mousedown",".inline-widget",function(e){1===e.button&&e.preventDefault()}),$("html").on("mousedown",".no-focus",function(e){var t=$(e.target),n=t.is("input")||t.is("textarea")||t.is("select");n||e.preventDefault()}),window.document.body.addEventListener("click",function(e){for(var t,n=e.target;n;){if("A"===n.tagName){t=n.getAttribute("href"),t&&!t.match(/^#/)&&x.openURLInDefaultBrowser(t),e.preventDefault();break}n=n.parentElement}},!0);var e=window.open;window.open=function(t){if(!t.match(/^file:\/\//)&&!t.match(/^about:blank/)&&-1!==t.indexOf(":"))throw new Error("Brackets-shell is not a secure general purpose web browser. Use NativeApp.openURLInDefaultBrowser() to open URLs in the user's main browser");return e.apply(window,arguments)};var t=jQuery.fn.init;jQuery.fn.init=function(e,n){var r=new t(e,n);return e&&e._EventDispatcher&&(r.on=e.on.bind(e),r.one=e.one.bind(e),r.off=e.off.bind(e),A.deprecationWarning("Deprecated: Do not use $().on/off() on Brackets modules and model objects. Call on()/off() directly on the object without a $() wrapper.",!0,4)),r}}e("widgets/bootstrap-dropdown"),e("widgets/bootstrap-modal"),e("widgets/bootstrap-twipsy-mod"),e("thirdparty/path-utils/path-utils.min"),e("thirdparty/smart-auto-complete-local/jquery.smart_autocomplete"),e("thirdparty/CodeMirror2/addon/fold/xml-fold"),e("thirdparty/CodeMirror2/addon/edit/matchtags"),e("thirdparty/CodeMirror2/addon/edit/matchbrackets"),e("thirdparty/CodeMirror2/addon/edit/closebrackets"),e("thirdparty/CodeMirror2/addon/edit/closetag"),e("thirdparty/CodeMirror2/addon/scroll/scrollpastend"),e("thirdparty/CodeMirror2/addon/selection/active-line"),e("thirdparty/CodeMirror2/addon/selection/mark-selection"),e("thirdparty/CodeMirror2/addon/mode/multiplex"),e("thirdparty/CodeMirror2/addon/mode/overlay"),e("thirdparty/CodeMirror2/addon/search/match-highlighter"),e("thirdparty/CodeMirror2/addon/search/searchcursor"),e("thirdparty/CodeMirror2/keymap/sublime");var i=e("utils/AppInit"),o=e("language/LanguageManager"),a=e("project/ProjectManager"),s=e("document/DocumentManager"),l=e("editor/EditorManager"),c=e("language/JSUtils"),u=e("project/WorkingSetView"),d=e("document/DocumentCommandHandlers"),p=e("project/FileViewController"),h=e("project/FileSyncManager"),f=e("command/KeyBindingManager"),m=e("command/Commands"),g=e("command/CommandManager"),v=e("editor/CodeHintManager"),y=e("utils/PerfUtils"),_=e("filesystem/FileSystem"),E=e("command/Menus"),b=e("text!htmlContent/main-view.html"),S=e("strings"),I=e("widgets/Dialogs"),w=e("widgets/DefaultDialogs"),C=e("utils/ExtensionLoader"),D=e("utils/Async"),T=e("utils/UpdateNotification"),O=e("utils/UrlParams").UrlParams,M=e("preferences/PreferencesManager"),L=e("utils/ExtensionUtils"),R=e("utils/DragAndDrop"),N=e("language/CodeInspection"),x=e("utils/NativeApp"),A=e("utils/DeprecationWarning"),P=e("view/ViewCommandHandlers"),k=e("view/MainViewManager");e("utils/Global"),e("editor/CSSInlineEditor"),e("project/WorkingSetSort"),e("search/QuickOpen"),e("file/FileUtils"),e("project/SidebarView"),e("utils/Resizer"),e("LiveDevelopment/main"),e("utils/NodeConnection"),e("utils/NodeDomain"),e("utils/ColorUtils"),e("view/ThemeManager"),e("thirdparty/lodash"),e("language/XMLUtils");var F=e("thirdparty/CodeMirror2/lib/codemirror");Object.defineProperty(window,"CodeMirror",{get:function(){return A.deprecationWarning('Use brackets.getModule("thirdparty/CodeMirror2/lib/codemirror") instead of global CodeMirror.',!0),F}}),e("command/DefaultMenus"),e("document/ChangedDocumentTracker"),e("editor/EditorStatusBar"),e("editor/EditorCommandHandlers"),e("editor/EditorOptionHandlers"),e("help/HelpCommandHandlers"),e("search/FindInFilesUI"),e("search/FindReplace"),e("extensibility/InstallExtensionDialog"),e("extensibility/ExtensionManagerDialog"),e("editor/ImageViewer"),e("project/FileIndexManager"),e("file/NativeFileSystem"),e("file/NativeFileError"),e("view/PanelManager"),y.addMeasurement("brackets module dependencies resolved");var U=new O;U.parse();var j=y.markStart("User viewstate loading");M._smUserScopeLoading.always(function(){y.addMeasurement(j),r(),i._dispatchReady(i.HTML_READY),$(window.document).ready(n)})});